<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta charset="utf-8"></meta><meta http-equiv="X-UA-Compatible" content="IE=edge"></meta><meta name="viewport" content="width=device-width, initial-scale=1"></meta><title>Guide to the Secure Configuration of Red Hat Enterprise Linux 6 | OpenSCAP Security Guide
        </title><style>
/*!
 * Bootstrap v3.2.0 (http://getbootstrap.com)
 * Copyright 2011-2014 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 */
/*! normalize.css v3.0.1 | MIT License | git.io/normalize */html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block;vertical-align:baseline}audio:not([controls]){display:none;height:0}[hidden],template{display:none}a{background:transparent}a:active,a:hover{outline:0}abbr[title]{border-bottom:1px dotted}b,strong{font-weight:bold}dfn{font-style:italic}h1{font-size:2em;margin:0.67em 0}mark{background:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sup{top:-0.5em}sub{bottom:-0.25em}img{border:0}svg:not(:root){overflow:hidden}figure{margin:1em 40px}hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}pre{overflow:auto}code,kbd,pre,samp{font-family:monospace, monospace;font-size:1em}button,input,optgroup,select,textarea{color:inherit;font:inherit;margin:0}button{overflow:visible}button,select{text-transform:none}button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}button[disabled],html input[disabled]{cursor:default}button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}input{line-height:normal}input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}input[type="number"]::-webkit-inner-spin-button,input[type="number"]::-webkit-outer-spin-button{height:auto}input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}fieldset{border:1px solid #c0c0c0;margin:0 2px;padding:0.35em 0.625em 0.75em}legend{border:0;padding:0}textarea{overflow:auto}optgroup{font-weight:bold}table{border-collapse:collapse;border-spacing:0}td,th{padding:0}@media print{*{text-shadow:none !important;color:#000 !important;background:transparent !important;box-shadow:none !important}a,a:visited{text-decoration:underline}a[href]:after{content:" (" attr(href) ")"}abbr[title]:after{content:" (" attr(title) ")"}a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}p,h2,h3{orphans:3;widows:3}h2,h3{page-break-after:avoid}select{background:#fff !important}.navbar{display:none}.table td,.table th{background-color:#fff !important}.btn>.caret,.dropup>.btn>.caret{border-top-color:#000 !important}.label{border:1px solid #000}.table{border-collapse:collapse !important}.table-bordered th,.table-bordered td{border:1px solid #ddd !important}}*{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}*:before,*:after{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}html{font-size:10px;-webkit-tap-highlight-color:rgba(0,0,0,0)}body{font-family:"Helvetica Neue",Helvetica,Arial,sans-serif;font-size:14px;line-height:1.42857143;color:#333;background-color:#fff}input,button,select,textarea{font-family:inherit;font-size:inherit;line-height:inherit}a{color:#428bca;text-decoration:none}a:hover,a:focus{color:#2a6496;text-decoration:underline}a:focus{outline:thin dotted;outline:5px auto -webkit-focus-ring-color;outline-offset:-2px}figure{margin:0}img{vertical-align:middle}.img-responsive{display:block;width:100% \9;max-width:100%;height:auto}.img-rounded{border-radius:6px}.img-thumbnail{padding:4px;line-height:1.42857143;background-color:#fff;border:1px solid #ddd;border-radius:4px;-webkit-transition:all .2s ease-in-out;-o-transition:all .2s ease-in-out;transition:all .2s ease-in-out;display:inline-block;width:100% \9;max-width:100%;height:auto}.img-circle{border-radius:50%}hr{margin-top:20px;margin-bottom:20px;border:0;border-top:1px solid #eee}.sr-only{position:absolute;width:1px;height:1px;margin:-1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}.sr-only-focusable:active,.sr-only-focusable:focus{position:static;width:auto;height:auto;margin:0;overflow:visible;clip:auto}h1,h2,h3,h4,h5,h6,.h1,.h2,.h3,.h4,.h5,.h6{font-family:inherit;font-weight:500;line-height:1.1;color:inherit}h1 small,h2 small,h3 small,h4 small,h5 small,h6 small,.h1 small,.h2 small,.h3 small,.h4 small,.h5 small,.h6 small,h1 .small,h2 .small,h3 .small,h4 .small,h5 .small,h6 .small,.h1 .small,.h2 .small,.h3 .small,.h4 .small,.h5 .small,.h6 .small{font-weight:normal;line-height:1;color:#777}h1,.h1,h2,.h2,h3,.h3{margin-top:20px;margin-bottom:10px}h1 small,.h1 small,h2 small,.h2 small,h3 small,.h3 small,h1 .small,.h1 .small,h2 .small,.h2 .small,h3 .small,.h3 .small{font-size:65%}h4,.h4,h5,.h5,h6,.h6{margin-top:10px;margin-bottom:10px}h4 small,.h4 small,h5 small,.h5 small,h6 small,.h6 small,h4 .small,.h4 .small,h5 .small,.h5 .small,h6 .small,.h6 .small{font-size:75%}h1,.h1{font-size:36px}h2,.h2{font-size:30px}h3,.h3{font-size:24px}h4,.h4{font-size:18px}h5,.h5{font-size:14px}h6,.h6{font-size:12px}p{margin:0 0 10px}.lead{margin-bottom:20px;font-size:16px;font-weight:300;line-height:1.4}@media (min-width:768px){.lead{font-size:21px}}small,.small{font-size:85%}cite{font-style:normal}mark,.mark{background-color:#fcf8e3;padding:.2em}.text-left{text-align:left}.text-right{text-align:right}.text-center{text-align:center}.text-justify{text-align:justify}.text-nowrap{white-space:nowrap}.text-lowercase{text-transform:lowercase}.text-uppercase{text-transform:uppercase}.text-capitalize{text-transform:capitalize}.text-muted{color:#777}.text-primary{color:#428bca}a.text-primary:hover{color:#3071a9}.text-success{color:#3c763d}a.text-success:hover{color:#2b542c}.text-info{color:#31708f}a.text-info:hover{color:#245269}.text-warning{color:#8a6d3b}a.text-warning:hover{color:#66512c}.text-danger{color:#a94442}a.text-danger:hover{color:#843534}.bg-primary{color:#fff;background-color:#428bca}a.bg-primary:hover{background-color:#3071a9}.bg-success{background-color:#dff0d8}a.bg-success:hover{background-color:#c1e2b3}.bg-info{background-color:#d9edf7}a.bg-info:hover{background-color:#afd9ee}.bg-warning{background-color:#fcf8e3}a.bg-warning:hover{background-color:#f7ecb5}.bg-danger{background-color:#f2dede}a.bg-danger:hover{background-color:#e4b9b9}.page-header{padding-bottom:9px;margin:40px 0 20px;border-bottom:1px solid #eee}ul,ol{margin-top:0;margin-bottom:10px}ul ul,ol ul,ul ol,ol ol{margin-bottom:0}.list-unstyled{padding-left:0;list-style:none}.list-inline{padding-left:0;list-style:none;margin-left:-5px}.list-inline>li{display:inline-block;padding-left:5px;padding-right:5px}dl{margin-top:0;margin-bottom:20px}dt,dd{line-height:1.42857143}dt{font-weight:bold}dd{margin-left:0}@media (min-width:768px){.dl-horizontal dt{float:left;width:160px;clear:left;text-align:right;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.dl-horizontal dd{margin-left:180px}}abbr[title],abbr[data-original-title]{cursor:help;border-bottom:1px dotted #777}.initialism{font-size:90%;text-transform:uppercase}blockquote{padding:10px 20px;margin:0 0 20px;font-size:17.5px;border-left:5px solid #eee}blockquote p:last-child,blockquote ul:last-child,blockquote ol:last-child{margin-bottom:0}blockquote footer,blockquote small,blockquote .small{display:block;font-size:80%;line-height:1.42857143;color:#777}blockquote footer:before,blockquote small:before,blockquote .small:before{content:'\2014 \00A0'}.blockquote-reverse,blockquote.pull-right{padding-right:15px;padding-left:0;border-right:5px solid #eee;border-left:0;text-align:right}.blockquote-reverse footer:before,blockquote.pull-right footer:before,.blockquote-reverse small:before,blockquote.pull-right small:before,.blockquote-reverse .small:before,blockquote.pull-right .small:before{content:''}.blockquote-reverse footer:after,blockquote.pull-right footer:after,.blockquote-reverse small:after,blockquote.pull-right small:after,.blockquote-reverse .small:after,blockquote.pull-right .small:after{content:'\00A0 \2014'}blockquote:before,blockquote:after{content:""}address{margin-bottom:20px;font-style:normal;line-height:1.42857143}code,kbd,pre,samp{font-family:Menlo,Monaco,Consolas,"Courier New",monospace}code{padding:2px 4px;font-size:90%;color:#c7254e;background-color:#f9f2f4;border-radius:4px}kbd{padding:2px 4px;font-size:90%;color:#fff;background-color:#333;border-radius:3px;box-shadow:inset 0 -1px 0 rgba(0,0,0,0.25)}kbd kbd{padding:0;font-size:100%;box-shadow:none}pre{display:block;padding:9.5px;margin:0 0 10px;font-size:13px;line-height:1.42857143;word-break:break-all;word-wrap:break-word;color:#333;background-color:#f5f5f5;border:1px solid #ccc;border-radius:4px}pre code{padding:0;font-size:inherit;color:inherit;white-space:pre-wrap;background-color:transparent;border-radius:0}.pre-scrollable{max-height:340px;overflow-y:scroll}.container{margin-right:auto;margin-left:auto;padding-left:15px;padding-right:15px}@media (min-width:768px){.container{width:750px}}@media (min-width:992px){.container{width:970px}}@media (min-width:1200px){.container{width:1170px}}.container-fluid{margin-right:auto;margin-left:auto;padding-left:15px;padding-right:15px}.row{margin-left:-15px;margin-right:-15px}.col-xs-1, .col-sm-1, .col-md-1, .col-lg-1, .col-xs-2, .col-sm-2, .col-md-2, .col-lg-2, .col-xs-3, .col-sm-3, .col-md-3, .col-lg-3, .col-xs-4, .col-sm-4, .col-md-4, .col-lg-4, .col-xs-5, .col-sm-5, .col-md-5, .col-lg-5, .col-xs-6, .col-sm-6, .col-md-6, .col-lg-6, .col-xs-7, .col-sm-7, .col-md-7, .col-lg-7, .col-xs-8, .col-sm-8, .col-md-8, .col-lg-8, .col-xs-9, .col-sm-9, .col-md-9, .col-lg-9, .col-xs-10, .col-sm-10, .col-md-10, .col-lg-10, .col-xs-11, .col-sm-11, .col-md-11, .col-lg-11, .col-xs-12, .col-sm-12, .col-md-12, .col-lg-12{position:relative;min-height:1px;padding-left:15px;padding-right:15px}.col-xs-1, .col-xs-2, .col-xs-3, .col-xs-4, .col-xs-5, .col-xs-6, .col-xs-7, .col-xs-8, .col-xs-9, .col-xs-10, .col-xs-11, .col-xs-12{float:left}.col-xs-12{width:100%}.col-xs-11{width:91.66666667%}.col-xs-10{width:83.33333333%}.col-xs-9{width:75%}.col-xs-8{width:66.66666667%}.col-xs-7{width:58.33333333%}.col-xs-6{width:50%}.col-xs-5{width:41.66666667%}.col-xs-4{width:33.33333333%}.col-xs-3{width:25%}.col-xs-2{width:16.66666667%}.col-xs-1{width:8.33333333%}.col-xs-pull-12{right:100%}.col-xs-pull-11{right:91.66666667%}.col-xs-pull-10{right:83.33333333%}.col-xs-pull-9{right:75%}.col-xs-pull-8{right:66.66666667%}.col-xs-pull-7{right:58.33333333%}.col-xs-pull-6{right:50%}.col-xs-pull-5{right:41.66666667%}.col-xs-pull-4{right:33.33333333%}.col-xs-pull-3{right:25%}.col-xs-pull-2{right:16.66666667%}.col-xs-pull-1{right:8.33333333%}.col-xs-pull-0{right:auto}.col-xs-push-12{left:100%}.col-xs-push-11{left:91.66666667%}.col-xs-push-10{left:83.33333333%}.col-xs-push-9{left:75%}.col-xs-push-8{left:66.66666667%}.col-xs-push-7{left:58.33333333%}.col-xs-push-6{left:50%}.col-xs-push-5{left:41.66666667%}.col-xs-push-4{left:33.33333333%}.col-xs-push-3{left:25%}.col-xs-push-2{left:16.66666667%}.col-xs-push-1{left:8.33333333%}.col-xs-push-0{left:auto}.col-xs-offset-12{margin-left:100%}.col-xs-offset-11{margin-left:91.66666667%}.col-xs-offset-10{margin-left:83.33333333%}.col-xs-offset-9{margin-left:75%}.col-xs-offset-8{margin-left:66.66666667%}.col-xs-offset-7{margin-left:58.33333333%}.col-xs-offset-6{margin-left:50%}.col-xs-offset-5{margin-left:41.66666667%}.col-xs-offset-4{margin-left:33.33333333%}.col-xs-offset-3{margin-left:25%}.col-xs-offset-2{margin-left:16.66666667%}.col-xs-offset-1{margin-left:8.33333333%}.col-xs-offset-0{margin-left:0}@media (min-width:768px){.col-sm-1, .col-sm-2, .col-sm-3, .col-sm-4, .col-sm-5, .col-sm-6, .col-sm-7, .col-sm-8, .col-sm-9, .col-sm-10, .col-sm-11, .col-sm-12{float:left}.col-sm-12{width:100%}.col-sm-11{width:91.66666667%}.col-sm-10{width:83.33333333%}.col-sm-9{width:75%}.col-sm-8{width:66.66666667%}.col-sm-7{width:58.33333333%}.col-sm-6{width:50%}.col-sm-5{width:41.66666667%}.col-sm-4{width:33.33333333%}.col-sm-3{width:25%}.col-sm-2{width:16.66666667%}.col-sm-1{width:8.33333333%}.col-sm-pull-12{right:100%}.col-sm-pull-11{right:91.66666667%}.col-sm-pull-10{right:83.33333333%}.col-sm-pull-9{right:75%}.col-sm-pull-8{right:66.66666667%}.col-sm-pull-7{right:58.33333333%}.col-sm-pull-6{right:50%}.col-sm-pull-5{right:41.66666667%}.col-sm-pull-4{right:33.33333333%}.col-sm-pull-3{right:25%}.col-sm-pull-2{right:16.66666667%}.col-sm-pull-1{right:8.33333333%}.col-sm-pull-0{right:auto}.col-sm-push-12{left:100%}.col-sm-push-11{left:91.66666667%}.col-sm-push-10{left:83.33333333%}.col-sm-push-9{left:75%}.col-sm-push-8{left:66.66666667%}.col-sm-push-7{left:58.33333333%}.col-sm-push-6{left:50%}.col-sm-push-5{left:41.66666667%}.col-sm-push-4{left:33.33333333%}.col-sm-push-3{left:25%}.col-sm-push-2{left:16.66666667%}.col-sm-push-1{left:8.33333333%}.col-sm-push-0{left:auto}.col-sm-offset-12{margin-left:100%}.col-sm-offset-11{margin-left:91.66666667%}.col-sm-offset-10{margin-left:83.33333333%}.col-sm-offset-9{margin-left:75%}.col-sm-offset-8{margin-left:66.66666667%}.col-sm-offset-7{margin-left:58.33333333%}.col-sm-offset-6{margin-left:50%}.col-sm-offset-5{margin-left:41.66666667%}.col-sm-offset-4{margin-left:33.33333333%}.col-sm-offset-3{margin-left:25%}.col-sm-offset-2{margin-left:16.66666667%}.col-sm-offset-1{margin-left:8.33333333%}.col-sm-offset-0{margin-left:0}}@media (min-width:992px){.col-md-1, .col-md-2, .col-md-3, .col-md-4, .col-md-5, .col-md-6, .col-md-7, .col-md-8, .col-md-9, .col-md-10, .col-md-11, .col-md-12{float:left}.col-md-12{width:100%}.col-md-11{width:91.66666667%}.col-md-10{width:83.33333333%}.col-md-9{width:75%}.col-md-8{width:66.66666667%}.col-md-7{width:58.33333333%}.col-md-6{width:50%}.col-md-5{width:41.66666667%}.col-md-4{width:33.33333333%}.col-md-3{width:25%}.col-md-2{width:16.66666667%}.col-md-1{width:8.33333333%}.col-md-pull-12{right:100%}.col-md-pull-11{right:91.66666667%}.col-md-pull-10{right:83.33333333%}.col-md-pull-9{right:75%}.col-md-pull-8{right:66.66666667%}.col-md-pull-7{right:58.33333333%}.col-md-pull-6{right:50%}.col-md-pull-5{right:41.66666667%}.col-md-pull-4{right:33.33333333%}.col-md-pull-3{right:25%}.col-md-pull-2{right:16.66666667%}.col-md-pull-1{right:8.33333333%}.col-md-pull-0{right:auto}.col-md-push-12{left:100%}.col-md-push-11{left:91.66666667%}.col-md-push-10{left:83.33333333%}.col-md-push-9{left:75%}.col-md-push-8{left:66.66666667%}.col-md-push-7{left:58.33333333%}.col-md-push-6{left:50%}.col-md-push-5{left:41.66666667%}.col-md-push-4{left:33.33333333%}.col-md-push-3{left:25%}.col-md-push-2{left:16.66666667%}.col-md-push-1{left:8.33333333%}.col-md-push-0{left:auto}.col-md-offset-12{margin-left:100%}.col-md-offset-11{margin-left:91.66666667%}.col-md-offset-10{margin-left:83.33333333%}.col-md-offset-9{margin-left:75%}.col-md-offset-8{margin-left:66.66666667%}.col-md-offset-7{margin-left:58.33333333%}.col-md-offset-6{margin-left:50%}.col-md-offset-5{margin-left:41.66666667%}.col-md-offset-4{margin-left:33.33333333%}.col-md-offset-3{margin-left:25%}.col-md-offset-2{margin-left:16.66666667%}.col-md-offset-1{margin-left:8.33333333%}.col-md-offset-0{margin-left:0}}@media (min-width:1200px){.col-lg-1, .col-lg-2, .col-lg-3, .col-lg-4, .col-lg-5, .col-lg-6, .col-lg-7, .col-lg-8, .col-lg-9, .col-lg-10, .col-lg-11, .col-lg-12{float:left}.col-lg-12{width:100%}.col-lg-11{width:91.66666667%}.col-lg-10{width:83.33333333%}.col-lg-9{width:75%}.col-lg-8{width:66.66666667%}.col-lg-7{width:58.33333333%}.col-lg-6{width:50%}.col-lg-5{width:41.66666667%}.col-lg-4{width:33.33333333%}.col-lg-3{width:25%}.col-lg-2{width:16.66666667%}.col-lg-1{width:8.33333333%}.col-lg-pull-12{right:100%}.col-lg-pull-11{right:91.66666667%}.col-lg-pull-10{right:83.33333333%}.col-lg-pull-9{right:75%}.col-lg-pull-8{right:66.66666667%}.col-lg-pull-7{right:58.33333333%}.col-lg-pull-6{right:50%}.col-lg-pull-5{right:41.66666667%}.col-lg-pull-4{right:33.33333333%}.col-lg-pull-3{right:25%}.col-lg-pull-2{right:16.66666667%}.col-lg-pull-1{right:8.33333333%}.col-lg-pull-0{right:auto}.col-lg-push-12{left:100%}.col-lg-push-11{left:91.66666667%}.col-lg-push-10{left:83.33333333%}.col-lg-push-9{left:75%}.col-lg-push-8{left:66.66666667%}.col-lg-push-7{left:58.33333333%}.col-lg-push-6{left:50%}.col-lg-push-5{left:41.66666667%}.col-lg-push-4{left:33.33333333%}.col-lg-push-3{left:25%}.col-lg-push-2{left:16.66666667%}.col-lg-push-1{left:8.33333333%}.col-lg-push-0{left:auto}.col-lg-offset-12{margin-left:100%}.col-lg-offset-11{margin-left:91.66666667%}.col-lg-offset-10{margin-left:83.33333333%}.col-lg-offset-9{margin-left:75%}.col-lg-offset-8{margin-left:66.66666667%}.col-lg-offset-7{margin-left:58.33333333%}.col-lg-offset-6{margin-left:50%}.col-lg-offset-5{margin-left:41.66666667%}.col-lg-offset-4{margin-left:33.33333333%}.col-lg-offset-3{margin-left:25%}.col-lg-offset-2{margin-left:16.66666667%}.col-lg-offset-1{margin-left:8.33333333%}.col-lg-offset-0{margin-left:0}}table{background-color:transparent}th{text-align:left}.table{width:100%;max-width:100%;margin-bottom:20px}.table>thead>tr>th,.table>tbody>tr>th,.table>tfoot>tr>th,.table>thead>tr>td,.table>tbody>tr>td,.table>tfoot>tr>td{padding:8px;line-height:1.42857143;vertical-align:top;border-top:1px solid #ddd}.table>thead>tr>th{vertical-align:bottom;border-bottom:2px solid #ddd}.table>caption+thead>tr:first-child>th,.table>colgroup+thead>tr:first-child>th,.table>thead:first-child>tr:first-child>th,.table>caption+thead>tr:first-child>td,.table>colgroup+thead>tr:first-child>td,.table>thead:first-child>tr:first-child>td{border-top:0}.table>tbody+tbody{border-top:2px solid #ddd}.table .table{background-color:#fff}.table-condensed>thead>tr>th,.table-condensed>tbody>tr>th,.table-condensed>tfoot>tr>th,.table-condensed>thead>tr>td,.table-condensed>tbody>tr>td,.table-condensed>tfoot>tr>td{padding:5px}.table-bordered{border:1px solid #ddd}.table-bordered>thead>tr>th,.table-bordered>tbody>tr>th,.table-bordered>tfoot>tr>th,.table-bordered>thead>tr>td,.table-bordered>tbody>tr>td,.table-bordered>tfoot>tr>td{border:1px solid #ddd}.table-bordered>thead>tr>th,.table-bordered>thead>tr>td{border-bottom-width:2px}.table-striped>tbody>tr:nth-child(odd)>td,.table-striped>tbody>tr:nth-child(odd)>th{background-color:#f9f9f9}.table-hover>tbody>tr:hover>td,.table-hover>tbody>tr:hover>th{background-color:#f5f5f5}table col[class*="col-"]{position:static;float:none;display:table-column}table td[class*="col-"],table th[class*="col-"]{position:static;float:none;display:table-cell}.table>thead>tr>td.active,.table>tbody>tr>td.active,.table>tfoot>tr>td.active,.table>thead>tr>th.active,.table>tbody>tr>th.active,.table>tfoot>tr>th.active,.table>thead>tr.active>td,.table>tbody>tr.active>td,.table>tfoot>tr.active>td,.table>thead>tr.active>th,.table>tbody>tr.active>th,.table>tfoot>tr.active>th{background-color:#f5f5f5}.table-hover>tbody>tr>td.active:hover,.table-hover>tbody>tr>th.active:hover,.table-hover>tbody>tr.active:hover>td,.table-hover>tbody>tr:hover>.active,.table-hover>tbody>tr.active:hover>th{background-color:#e8e8e8}.table>thead>tr>td.success,.table>tbody>tr>td.success,.table>tfoot>tr>td.success,.table>thead>tr>th.success,.table>tbody>tr>th.success,.table>tfoot>tr>th.success,.table>thead>tr.success>td,.table>tbody>tr.success>td,.table>tfoot>tr.success>td,.table>thead>tr.success>th,.table>tbody>tr.success>th,.table>tfoot>tr.success>th{background-color:#dff0d8}.table-hover>tbody>tr>td.success:hover,.table-hover>tbody>tr>th.success:hover,.table-hover>tbody>tr.success:hover>td,.table-hover>tbody>tr:hover>.success,.table-hover>tbody>tr.success:hover>th{background-color:#d0e9c6}.table>thead>tr>td.info,.table>tbody>tr>td.info,.table>tfoot>tr>td.info,.table>thead>tr>th.info,.table>tbody>tr>th.info,.table>tfoot>tr>th.info,.table>thead>tr.info>td,.table>tbody>tr.info>td,.table>tfoot>tr.info>td,.table>thead>tr.info>th,.table>tbody>tr.info>th,.table>tfoot>tr.info>th{background-color:#d9edf7}.table-hover>tbody>tr>td.info:hover,.table-hover>tbody>tr>th.info:hover,.table-hover>tbody>tr.info:hover>td,.table-hover>tbody>tr:hover>.info,.table-hover>tbody>tr.info:hover>th{background-color:#c4e3f3}.table>thead>tr>td.warning,.table>tbody>tr>td.warning,.table>tfoot>tr>td.warning,.table>thead>tr>th.warning,.table>tbody>tr>th.warning,.table>tfoot>tr>th.warning,.table>thead>tr.warning>td,.table>tbody>tr.warning>td,.table>tfoot>tr.warning>td,.table>thead>tr.warning>th,.table>tbody>tr.warning>th,.table>tfoot>tr.warning>th{background-color:#fcf8e3}.table-hover>tbody>tr>td.warning:hover,.table-hover>tbody>tr>th.warning:hover,.table-hover>tbody>tr.warning:hover>td,.table-hover>tbody>tr:hover>.warning,.table-hover>tbody>tr.warning:hover>th{background-color:#faf2cc}.table>thead>tr>td.danger,.table>tbody>tr>td.danger,.table>tfoot>tr>td.danger,.table>thead>tr>th.danger,.table>tbody>tr>th.danger,.table>tfoot>tr>th.danger,.table>thead>tr.danger>td,.table>tbody>tr.danger>td,.table>tfoot>tr.danger>td,.table>thead>tr.danger>th,.table>tbody>tr.danger>th,.table>tfoot>tr.danger>th{background-color:#f2dede}.table-hover>tbody>tr>td.danger:hover,.table-hover>tbody>tr>th.danger:hover,.table-hover>tbody>tr.danger:hover>td,.table-hover>tbody>tr:hover>.danger,.table-hover>tbody>tr.danger:hover>th{background-color:#ebcccc}@media screen and (max-width:767px){.table-responsive{width:100%;margin-bottom:15px;overflow-y:hidden;overflow-x:auto;-ms-overflow-style:-ms-autohiding-scrollbar;border:1px solid #ddd;-webkit-overflow-scrolling:touch}.table-responsive>.table{margin-bottom:0}.table-responsive>.table>thead>tr>th,.table-responsive>.table>tbody>tr>th,.table-responsive>.table>tfoot>tr>th,.table-responsive>.table>thead>tr>td,.table-responsive>.table>tbody>tr>td,.table-responsive>.table>tfoot>tr>td{white-space:nowrap}.table-responsive>.table-bordered{border:0}.table-responsive>.table-bordered>thead>tr>th:first-child,.table-responsive>.table-bordered>tbody>tr>th:first-child,.table-responsive>.table-bordered>tfoot>tr>th:first-child,.table-responsive>.table-bordered>thead>tr>td:first-child,.table-responsive>.table-bordered>tbody>tr>td:first-child,.table-responsive>.table-bordered>tfoot>tr>td:first-child{border-left:0}.table-responsive>.table-bordered>thead>tr>th:last-child,.table-responsive>.table-bordered>tbody>tr>th:last-child,.table-responsive>.table-bordered>tfoot>tr>th:last-child,.table-responsive>.table-bordered>thead>tr>td:last-child,.table-responsive>.table-bordered>tbody>tr>td:last-child,.table-responsive>.table-bordered>tfoot>tr>td:last-child{border-right:0}.table-responsive>.table-bordered>tbody>tr:last-child>th,.table-responsive>.table-bordered>tfoot>tr:last-child>th,.table-responsive>.table-bordered>tbody>tr:last-child>td,.table-responsive>.table-bordered>tfoot>tr:last-child>td{border-bottom:0}}fieldset{padding:0;margin:0;border:0;min-width:0}legend{display:block;width:100%;padding:0;margin-bottom:20px;font-size:21px;line-height:inherit;color:#333;border:0;border-bottom:1px solid #e5e5e5}label{display:inline-block;max-width:100%;margin-bottom:5px;font-weight:bold}input[type="search"]{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}input[type="radio"],input[type="checkbox"]{margin:4px 0 0;margin-top:1px \9;line-height:normal}input[type="file"]{display:block}input[type="range"]{display:block;width:100%}select[multiple],select[size]{height:auto}input[type="file"]:focus,input[type="radio"]:focus,input[type="checkbox"]:focus{outline:thin dotted;outline:5px auto -webkit-focus-ring-color;outline-offset:-2px}output{display:block;padding-top:7px;font-size:14px;line-height:1.42857143;color:#555}.form-control{display:block;width:100%;height:34px;padding:6px 12px;font-size:14px;line-height:1.42857143;color:#555;background-color:#fff;background-image:none;border:1px solid #ccc;border-radius:4px;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,0.075);box-shadow:inset 0 1px 1px rgba(0,0,0,0.075);-webkit-transition:border-color ease-in-out .15s, box-shadow ease-in-out .15s;-o-transition:border-color ease-in-out .15s, box-shadow ease-in-out .15s;transition:border-color ease-in-out .15s, box-shadow ease-in-out .15s}.form-control:focus{border-color:#66afe9;outline:0;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, 0.6);box-shadow:inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, 0.6)}.form-control::-moz-placeholder{color:#777;opacity:1}.form-control:-ms-input-placeholder{color:#777}.form-control::-webkit-input-placeholder{color:#777}.form-control[disabled],.form-control[readonly],fieldset[disabled] .form-control{cursor:not-allowed;background-color:#eee;opacity:1}textarea.form-control{height:auto}input[type="search"]{-webkit-appearance:none}input[type="date"],input[type="time"],input[type="datetime-local"],input[type="month"]{line-height:34px;line-height:1.42857143 \0}input[type="date"].input-sm,input[type="time"].input-sm,input[type="datetime-local"].input-sm,input[type="month"].input-sm{line-height:30px}input[type="date"].input-lg,input[type="time"].input-lg,input[type="datetime-local"].input-lg,input[type="month"].input-lg{line-height:46px}.form-group{margin-bottom:15px}.radio,.checkbox{position:relative;display:block;min-height:20px;margin-top:10px;margin-bottom:10px}.radio label,.checkbox label{padding-left:20px;margin-bottom:0;font-weight:normal;cursor:pointer}.radio input[type="radio"],.radio-inline input[type="radio"],.checkbox input[type="checkbox"],.checkbox-inline input[type="checkbox"]{position:absolute;margin-left:-20px;margin-top:4px \9}.radio+.radio,.checkbox+.checkbox{margin-top:-5px}.radio-inline,.checkbox-inline{display:inline-block;padding-left:20px;margin-bottom:0;vertical-align:middle;font-weight:normal;cursor:pointer}.radio-inline+.radio-inline,.checkbox-inline+.checkbox-inline{margin-top:0;margin-left:10px}input[type="radio"][disabled],input[type="checkbox"][disabled],input[type="radio"].disabled,input[type="checkbox"].disabled,fieldset[disabled] input[type="radio"],fieldset[disabled] input[type="checkbox"]{cursor:not-allowed}.radio-inline.disabled,.checkbox-inline.disabled,fieldset[disabled] .radio-inline,fieldset[disabled] .checkbox-inline{cursor:not-allowed}.radio.disabled label,.checkbox.disabled label,fieldset[disabled] .radio label,fieldset[disabled] .checkbox label{cursor:not-allowed}.form-control-static{padding-top:7px;padding-bottom:7px;margin-bottom:0}.form-control-static.input-lg,.form-control-static.input-sm{padding-left:0;padding-right:0}.input-sm,.form-horizontal .form-group-sm .form-control{height:30px;padding:5px 10px;font-size:12px;line-height:1.5;border-radius:3px}select.input-sm{height:30px;line-height:30px}textarea.input-sm,select[multiple].input-sm{height:auto}.input-lg,.form-horizontal .form-group-lg .form-control{height:46px;padding:10px 16px;font-size:18px;line-height:1.33;border-radius:6px}select.input-lg{height:46px;line-height:46px}textarea.input-lg,select[multiple].input-lg{height:auto}.has-feedback{position:relative}.has-feedback .form-control{padding-right:42.5px}.form-control-feedback{position:absolute;top:25px;right:0;z-index:2;display:block;width:34px;height:34px;line-height:34px;text-align:center}.input-lg+.form-control-feedback{width:46px;height:46px;line-height:46px}.input-sm+.form-control-feedback{width:30px;height:30px;line-height:30px}.has-success .help-block,.has-success .control-label,.has-success .radio,.has-success .checkbox,.has-success .radio-inline,.has-success .checkbox-inline{color:#3c763d}.has-success .form-control{border-color:#3c763d;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,0.075);box-shadow:inset 0 1px 1px rgba(0,0,0,0.075)}.has-success .form-control:focus{border-color:#2b542c;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,0.075),0 0 6px #67b168;box-shadow:inset 0 1px 1px rgba(0,0,0,0.075),0 0 6px #67b168}.has-success .input-group-addon{color:#3c763d;border-color:#3c763d;background-color:#dff0d8}.has-success .form-control-feedback{color:#3c763d}.has-warning .help-block,.has-warning .control-label,.has-warning .radio,.has-warning .checkbox,.has-warning .radio-inline,.has-warning .checkbox-inline{color:#8a6d3b}.has-warning .form-control{border-color:#8a6d3b;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,0.075);box-shadow:inset 0 1px 1px rgba(0,0,0,0.075)}.has-warning .form-control:focus{border-color:#66512c;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,0.075),0 0 6px #c0a16b;box-shadow:inset 0 1px 1px rgba(0,0,0,0.075),0 0 6px #c0a16b}.has-warning .input-group-addon{color:#8a6d3b;border-color:#8a6d3b;background-color:#fcf8e3}.has-warning .form-control-feedback{color:#8a6d3b}.has-error .help-block,.has-error .control-label,.has-error .radio,.has-error .checkbox,.has-error .radio-inline,.has-error .checkbox-inline{color:#a94442}.has-error .form-control{border-color:#a94442;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,0.075);box-shadow:inset 0 1px 1px rgba(0,0,0,0.075)}.has-error .form-control:focus{border-color:#843534;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,0.075),0 0 6px #ce8483;box-shadow:inset 0 1px 1px rgba(0,0,0,0.075),0 0 6px #ce8483}.has-error .input-group-addon{color:#a94442;border-color:#a94442;background-color:#f2dede}.has-error .form-control-feedback{color:#a94442}.has-feedback label.sr-only~.form-control-feedback{top:0}.help-block{display:block;margin-top:5px;margin-bottom:10px;color:#737373}@media (min-width:768px){.form-inline .form-group{display:inline-block;margin-bottom:0;vertical-align:middle}.form-inline .form-control{display:inline-block;width:auto;vertical-align:middle}.form-inline .input-group{display:inline-table;vertical-align:middle}.form-inline .input-group .input-group-addon,.form-inline .input-group .input-group-btn,.form-inline .input-group .form-control{width:auto}.form-inline .input-group>.form-control{width:100%}.form-inline .control-label{margin-bottom:0;vertical-align:middle}.form-inline .radio,.form-inline .checkbox{display:inline-block;margin-top:0;margin-bottom:0;vertical-align:middle}.form-inline .radio label,.form-inline .checkbox label{padding-left:0}.form-inline .radio input[type="radio"],.form-inline .checkbox input[type="checkbox"]{position:relative;margin-left:0}.form-inline .has-feedback .form-control-feedback{top:0}}.form-horizontal .radio,.form-horizontal .checkbox,.form-horizontal .radio-inline,.form-horizontal .checkbox-inline{margin-top:0;margin-bottom:0;padding-top:7px}.form-horizontal .radio,.form-horizontal .checkbox{min-height:27px}.form-horizontal .form-group{margin-left:-15px;margin-right:-15px}@media (min-width:768px){.form-horizontal .control-label{text-align:right;margin-bottom:0;padding-top:7px}}.form-horizontal .has-feedback .form-control-feedback{top:0;right:15px}@media (min-width:768px){.form-horizontal .form-group-lg .control-label{padding-top:14.3px}}@media (min-width:768px){.form-horizontal .form-group-sm .control-label{padding-top:6px}}.btn{display:inline-block;margin-bottom:0;font-weight:normal;text-align:center;vertical-align:middle;cursor:pointer;background-image:none;border:1px solid transparent;white-space:nowrap;padding:6px 12px;font-size:14px;line-height:1.42857143;border-radius:4px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.btn:focus,.btn:active:focus,.btn.active:focus{outline:thin dotted;outline:5px auto -webkit-focus-ring-color;outline-offset:-2px}.btn:hover,.btn:focus{color:#333;text-decoration:none}.btn:active,.btn.active{outline:0;background-image:none;-webkit-box-shadow:inset 0 3px 5px rgba(0,0,0,0.125);box-shadow:inset 0 3px 5px rgba(0,0,0,0.125)}.btn.disabled,.btn[disabled],fieldset[disabled] .btn{cursor:not-allowed;pointer-events:none;opacity:.65;filter:alpha(opacity=65);-webkit-box-shadow:none;box-shadow:none}.btn-default{color:#333;background-color:#fff;border-color:#ccc}.btn-default:hover,.btn-default:focus,.btn-default:active,.btn-default.active,.open>.dropdown-toggle.btn-default{color:#333;background-color:#e6e6e6;border-color:#adadad}.btn-default:active,.btn-default.active,.open>.dropdown-toggle.btn-default{background-image:none}.btn-default.disabled,.btn-default[disabled],fieldset[disabled] .btn-default,.btn-default.disabled:hover,.btn-default[disabled]:hover,fieldset[disabled] .btn-default:hover,.btn-default.disabled:focus,.btn-default[disabled]:focus,fieldset[disabled] .btn-default:focus,.btn-default.disabled:active,.btn-default[disabled]:active,fieldset[disabled] .btn-default:active,.btn-default.disabled.active,.btn-default[disabled].active,fieldset[disabled] .btn-default.active{background-color:#fff;border-color:#ccc}.btn-default .badge{color:#fff;background-color:#333}.btn-primary{color:#fff;background-color:#428bca;border-color:#357ebd}.btn-primary:hover,.btn-primary:focus,.btn-primary:active,.btn-primary.active,.open>.dropdown-toggle.btn-primary{color:#fff;background-color:#3071a9;border-color:#285e8e}.btn-primary:active,.btn-primary.active,.open>.dropdown-toggle.btn-primary{background-image:none}.btn-primary.disabled,.btn-primary[disabled],fieldset[disabled] .btn-primary,.btn-primary.disabled:hover,.btn-primary[disabled]:hover,fieldset[disabled] .btn-primary:hover,.btn-primary.disabled:focus,.btn-primary[disabled]:focus,fieldset[disabled] .btn-primary:focus,.btn-primary.disabled:active,.btn-primary[disabled]:active,fieldset[disabled] .btn-primary:active,.btn-primary.disabled.active,.btn-primary[disabled].active,fieldset[disabled] .btn-primary.active{background-color:#428bca;border-color:#357ebd}.btn-primary .badge{color:#428bca;background-color:#fff}.btn-success{color:#fff;background-color:#5cb85c;border-color:#4cae4c}.btn-success:hover,.btn-success:focus,.btn-success:active,.btn-success.active,.open>.dropdown-toggle.btn-success{color:#fff;background-color:#449d44;border-color:#398439}.btn-success:active,.btn-success.active,.open>.dropdown-toggle.btn-success{background-image:none}.btn-success.disabled,.btn-success[disabled],fieldset[disabled] .btn-success,.btn-success.disabled:hover,.btn-success[disabled]:hover,fieldset[disabled] .btn-success:hover,.btn-success.disabled:focus,.btn-success[disabled]:focus,fieldset[disabled] .btn-success:focus,.btn-success.disabled:active,.btn-success[disabled]:active,fieldset[disabled] .btn-success:active,.btn-success.disabled.active,.btn-success[disabled].active,fieldset[disabled] .btn-success.active{background-color:#5cb85c;border-color:#4cae4c}.btn-success .badge{color:#5cb85c;background-color:#fff}.btn-info{color:#fff;background-color:#5bc0de;border-color:#46b8da}.btn-info:hover,.btn-info:focus,.btn-info:active,.btn-info.active,.open>.dropdown-toggle.btn-info{color:#fff;background-color:#31b0d5;border-color:#269abc}.btn-info:active,.btn-info.active,.open>.dropdown-toggle.btn-info{background-image:none}.btn-info.disabled,.btn-info[disabled],fieldset[disabled] .btn-info,.btn-info.disabled:hover,.btn-info[disabled]:hover,fieldset[disabled] .btn-info:hover,.btn-info.disabled:focus,.btn-info[disabled]:focus,fieldset[disabled] .btn-info:focus,.btn-info.disabled:active,.btn-info[disabled]:active,fieldset[disabled] .btn-info:active,.btn-info.disabled.active,.btn-info[disabled].active,fieldset[disabled] .btn-info.active{background-color:#5bc0de;border-color:#46b8da}.btn-info .badge{color:#5bc0de;background-color:#fff}.btn-warning{color:#fff;background-color:#f0ad4e;border-color:#eea236}.btn-warning:hover,.btn-warning:focus,.btn-warning:active,.btn-warning.active,.open>.dropdown-toggle.btn-warning{color:#fff;background-color:#ec971f;border-color:#d58512}.btn-warning:active,.btn-warning.active,.open>.dropdown-toggle.btn-warning{background-image:none}.btn-warning.disabled,.btn-warning[disabled],fieldset[disabled] .btn-warning,.btn-warning.disabled:hover,.btn-warning[disabled]:hover,fieldset[disabled] .btn-warning:hover,.btn-warning.disabled:focus,.btn-warning[disabled]:focus,fieldset[disabled] .btn-warning:focus,.btn-warning.disabled:active,.btn-warning[disabled]:active,fieldset[disabled] .btn-warning:active,.btn-warning.disabled.active,.btn-warning[disabled].active,fieldset[disabled] .btn-warning.active{background-color:#f0ad4e;border-color:#eea236}.btn-warning .badge{color:#f0ad4e;background-color:#fff}.btn-danger{color:#fff;background-color:#d9534f;border-color:#d43f3a}.btn-danger:hover,.btn-danger:focus,.btn-danger:active,.btn-danger.active,.open>.dropdown-toggle.btn-danger{color:#fff;background-color:#c9302c;border-color:#ac2925}.btn-danger:active,.btn-danger.active,.open>.dropdown-toggle.btn-danger{background-image:none}.btn-danger.disabled,.btn-danger[disabled],fieldset[disabled] .btn-danger,.btn-danger.disabled:hover,.btn-danger[disabled]:hover,fieldset[disabled] .btn-danger:hover,.btn-danger.disabled:focus,.btn-danger[disabled]:focus,fieldset[disabled] .btn-danger:focus,.btn-danger.disabled:active,.btn-danger[disabled]:active,fieldset[disabled] .btn-danger:active,.btn-danger.disabled.active,.btn-danger[disabled].active,fieldset[disabled] .btn-danger.active{background-color:#d9534f;border-color:#d43f3a}.btn-danger .badge{color:#d9534f;background-color:#fff}.btn-link{color:#428bca;font-weight:normal;cursor:pointer;border-radius:0}.btn-link,.btn-link:active,.btn-link[disabled],fieldset[disabled] .btn-link{background-color:transparent;-webkit-box-shadow:none;box-shadow:none}.btn-link,.btn-link:hover,.btn-link:focus,.btn-link:active{border-color:transparent}.btn-link:hover,.btn-link:focus{color:#2a6496;text-decoration:underline;background-color:transparent}.btn-link[disabled]:hover,fieldset[disabled] .btn-link:hover,.btn-link[disabled]:focus,fieldset[disabled] .btn-link:focus{color:#777;text-decoration:none}.btn-lg,.btn-group-lg>.btn{padding:10px 16px;font-size:18px;line-height:1.33;border-radius:6px}.btn-sm,.btn-group-sm>.btn{padding:5px 10px;font-size:12px;line-height:1.5;border-radius:3px}.btn-xs,.btn-group-xs>.btn{padding:1px 5px;font-size:12px;line-height:1.5;border-radius:3px}.btn-block{display:block;width:100%}.btn-block+.btn-block{margin-top:5px}input[type="submit"].btn-block,input[type="reset"].btn-block,input[type="button"].btn-block{width:100%}.fade{opacity:0;-webkit-transition:opacity .15s linear;-o-transition:opacity .15s linear;transition:opacity .15s linear}.fade.in{opacity:1}.collapse{display:none}.collapse.in{display:block}tr.collapse.in{display:table-row}tbody.collapse.in{display:table-row-group}.collapsing{position:relative;height:0;overflow:hidden;-webkit-transition:height .35s ease;-o-transition:height .35s ease;transition:height .35s ease}.btn-group,.btn-group-vertical{position:relative;display:inline-block;vertical-align:middle}.btn-group>.btn,.btn-group-vertical>.btn{position:relative;float:left}.btn-group>.btn:hover,.btn-group-vertical>.btn:hover,.btn-group>.btn:focus,.btn-group-vertical>.btn:focus,.btn-group>.btn:active,.btn-group-vertical>.btn:active,.btn-group>.btn.active,.btn-group-vertical>.btn.active{z-index:2}.btn-group>.btn:focus,.btn-group-vertical>.btn:focus{outline:0}.btn-group .btn+.btn,.btn-group .btn+.btn-group,.btn-group .btn-group+.btn,.btn-group .btn-group+.btn-group{margin-left:-1px}.btn-toolbar{margin-left:-5px}.btn-toolbar .btn-group,.btn-toolbar .input-group{float:left}.btn-toolbar>.btn,.btn-toolbar>.btn-group,.btn-toolbar>.input-group{margin-left:5px}.btn-group>.btn:not(:first-child):not(:last-child):not(.dropdown-toggle){border-radius:0}.btn-group>.btn:first-child{margin-left:0}.btn-group>.btn:first-child:not(:last-child):not(.dropdown-toggle){border-bottom-right-radius:0;border-top-right-radius:0}.btn-group>.btn:last-child:not(:first-child),.btn-group>.dropdown-toggle:not(:first-child){border-bottom-left-radius:0;border-top-left-radius:0}.btn-group>.btn-group{float:left}.btn-group>.btn-group:not(:first-child):not(:last-child)>.btn{border-radius:0}.btn-group>.btn-group:first-child>.btn:last-child,.btn-group>.btn-group:first-child>.dropdown-toggle{border-bottom-right-radius:0;border-top-right-radius:0}.btn-group>.btn-group:last-child>.btn:first-child{border-bottom-left-radius:0;border-top-left-radius:0}.btn-group .dropdown-toggle:active,.btn-group.open .dropdown-toggle{outline:0}.btn-group>.btn+.dropdown-toggle{padding-left:8px;padding-right:8px}.btn-group>.btn-lg+.dropdown-toggle{padding-left:12px;padding-right:12px}.btn-group.open .dropdown-toggle{-webkit-box-shadow:inset 0 3px 5px rgba(0,0,0,0.125);box-shadow:inset 0 3px 5px rgba(0,0,0,0.125)}.btn-group.open .dropdown-toggle.btn-link{-webkit-box-shadow:none;box-shadow:none}.btn .caret{margin-left:0}.btn-lg .caret{border-width:5px 5px 0;border-bottom-width:0}.dropup .btn-lg .caret{border-width:0 5px 5px}.btn-group-vertical>.btn,.btn-group-vertical>.btn-group,.btn-group-vertical>.btn-group>.btn{display:block;float:none;width:100%;max-width:100%}.btn-group-vertical>.btn-group>.btn{float:none}.btn-group-vertical>.btn+.btn,.btn-group-vertical>.btn+.btn-group,.btn-group-vertical>.btn-group+.btn,.btn-group-vertical>.btn-group+.btn-group{margin-top:-1px;margin-left:0}.btn-group-vertical>.btn:not(:first-child):not(:last-child){border-radius:0}.btn-group-vertical>.btn:first-child:not(:last-child){border-top-right-radius:4px;border-bottom-right-radius:0;border-bottom-left-radius:0}.btn-group-vertical>.btn:last-child:not(:first-child){border-bottom-left-radius:4px;border-top-right-radius:0;border-top-left-radius:0}.btn-group-vertical>.btn-group:not(:first-child):not(:last-child)>.btn{border-radius:0}.btn-group-vertical>.btn-group:first-child:not(:last-child)>.btn:last-child,.btn-group-vertical>.btn-group:first-child:not(:last-child)>.dropdown-toggle{border-bottom-right-radius:0;border-bottom-left-radius:0}.btn-group-vertical>.btn-group:last-child:not(:first-child)>.btn:first-child{border-top-right-radius:0;border-top-left-radius:0}.btn-group-justified{display:table;width:100%;table-layout:fixed;border-collapse:separate}.btn-group-justified>.btn,.btn-group-justified>.btn-group{float:none;display:table-cell;width:1%}.btn-group-justified>.btn-group .btn{width:100%}.btn-group-justified>.btn-group .dropdown-menu{left:auto}[data-toggle="buttons"]>.btn>input[type="radio"],[data-toggle="buttons"]>.btn>input[type="checkbox"]{position:absolute;z-index:-1;opacity:0;filter:alpha(opacity=0)}.input-group{position:relative;display:table;border-collapse:separate}.input-group[class*="col-"]{float:none;padding-left:0;padding-right:0}.input-group .form-control{position:relative;z-index:2;float:left;width:100%;margin-bottom:0}.input-group-lg>.form-control,.input-group-lg>.input-group-addon,.input-group-lg>.input-group-btn>.btn{height:46px;padding:10px 16px;font-size:18px;line-height:1.33;border-radius:6px}select.input-group-lg>.form-control,select.input-group-lg>.input-group-addon,select.input-group-lg>.input-group-btn>.btn{height:46px;line-height:46px}textarea.input-group-lg>.form-control,textarea.input-group-lg>.input-group-addon,textarea.input-group-lg>.input-group-btn>.btn,select[multiple].input-group-lg>.form-control,select[multiple].input-group-lg>.input-group-addon,select[multiple].input-group-lg>.input-group-btn>.btn{height:auto}.input-group-sm>.form-control,.input-group-sm>.input-group-addon,.input-group-sm>.input-group-btn>.btn{height:30px;padding:5px 10px;font-size:12px;line-height:1.5;border-radius:3px}select.input-group-sm>.form-control,select.input-group-sm>.input-group-addon,select.input-group-sm>.input-group-btn>.btn{height:30px;line-height:30px}textarea.input-group-sm>.form-control,textarea.input-group-sm>.input-group-addon,textarea.input-group-sm>.input-group-btn>.btn,select[multiple].input-group-sm>.form-control,select[multiple].input-group-sm>.input-group-addon,select[multiple].input-group-sm>.input-group-btn>.btn{height:auto}.input-group-addon,.input-group-btn,.input-group .form-control{display:table-cell}.input-group-addon:not(:first-child):not(:last-child),.input-group-btn:not(:first-child):not(:last-child),.input-group .form-control:not(:first-child):not(:last-child){border-radius:0}.input-group-addon,.input-group-btn{width:1%;white-space:nowrap;vertical-align:middle}.input-group-addon{padding:6px 12px;font-size:14px;font-weight:normal;line-height:1;color:#555;text-align:center;background-color:#eee;border:1px solid #ccc;border-radius:4px}.input-group-addon.input-sm{padding:5px 10px;font-size:12px;border-radius:3px}.input-group-addon.input-lg{padding:10px 16px;font-size:18px;border-radius:6px}.input-group-addon input[type="radio"],.input-group-addon input[type="checkbox"]{margin-top:0}.input-group .form-control:first-child,.input-group-addon:first-child,.input-group-btn:first-child>.btn,.input-group-btn:first-child>.btn-group>.btn,.input-group-btn:first-child>.dropdown-toggle,.input-group-btn:last-child>.btn:not(:last-child):not(.dropdown-toggle),.input-group-btn:last-child>.btn-group:not(:last-child)>.btn{border-bottom-right-radius:0;border-top-right-radius:0}.input-group-addon:first-child{border-right:0}.input-group .form-control:last-child,.input-group-addon:last-child,.input-group-btn:last-child>.btn,.input-group-btn:last-child>.btn-group>.btn,.input-group-btn:last-child>.dropdown-toggle,.input-group-btn:first-child>.btn:not(:first-child),.input-group-btn:first-child>.btn-group:not(:first-child)>.btn{border-bottom-left-radius:0;border-top-left-radius:0}.input-group-addon:last-child{border-left:0}.input-group-btn{position:relative;font-size:0;white-space:nowrap}.input-group-btn>.btn{position:relative}.input-group-btn>.btn+.btn{margin-left:-1px}.input-group-btn>.btn:hover,.input-group-btn>.btn:focus,.input-group-btn>.btn:active{z-index:2}.input-group-btn:first-child>.btn,.input-group-btn:first-child>.btn-group{margin-right:-1px}.input-group-btn:last-child>.btn,.input-group-btn:last-child>.btn-group{margin-left:-1px}.nav{margin-bottom:0;padding-left:0;list-style:none}.nav>li{position:relative;display:block}.nav>li>a{position:relative;display:block;padding:10px 15px}.nav>li>a:hover,.nav>li>a:focus{text-decoration:none;background-color:#eee}.nav>li.disabled>a{color:#777}.nav>li.disabled>a:hover,.nav>li.disabled>a:focus{color:#777;text-decoration:none;background-color:transparent;cursor:not-allowed}.nav .open>a,.nav .open>a:hover,.nav .open>a:focus{background-color:#eee;border-color:#428bca}.nav .nav-divider{height:1px;margin:9px 0;overflow:hidden;background-color:#e5e5e5}.nav>li>a>img{max-width:none}.nav-tabs{border-bottom:1px solid #ddd}.nav-tabs>li{float:left;margin-bottom:-1px}.nav-tabs>li>a{margin-right:2px;line-height:1.42857143;border:1px solid transparent;border-radius:4px 4px 0 0}.nav-tabs>li>a:hover{border-color:#eee #eee #ddd}.nav-tabs>li.active>a,.nav-tabs>li.active>a:hover,.nav-tabs>li.active>a:focus{color:#555;background-color:#fff;border:1px solid #ddd;border-bottom-color:transparent;cursor:default}.nav-tabs.nav-justified{width:100%;border-bottom:0}.nav-tabs.nav-justified>li{float:none}.nav-tabs.nav-justified>li>a{text-align:center;margin-bottom:5px}.nav-tabs.nav-justified>.dropdown .dropdown-menu{top:auto;left:auto}@media (min-width:768px){.nav-tabs.nav-justified>li{display:table-cell;width:1%}.nav-tabs.nav-justified>li>a{margin-bottom:0}}.nav-tabs.nav-justified>li>a{margin-right:0;border-radius:4px}.nav-tabs.nav-justified>.active>a,.nav-tabs.nav-justified>.active>a:hover,.nav-tabs.nav-justified>.active>a:focus{border:1px solid #ddd}@media (min-width:768px){.nav-tabs.nav-justified>li>a{border-bottom:1px solid #ddd;border-radius:4px 4px 0 0}.nav-tabs.nav-justified>.active>a,.nav-tabs.nav-justified>.active>a:hover,.nav-tabs.nav-justified>.active>a:focus{border-bottom-color:#fff}}.nav-pills>li{float:left}.nav-pills>li>a{border-radius:4px}.nav-pills>li+li{margin-left:2px}.nav-pills>li.active>a,.nav-pills>li.active>a:hover,.nav-pills>li.active>a:focus{color:#fff;background-color:#428bca}.nav-stacked>li{float:none}.nav-stacked>li+li{margin-top:2px;margin-left:0}.nav-justified{width:100%}.nav-justified>li{float:none}.nav-justified>li>a{text-align:center;margin-bottom:5px}.nav-justified>.dropdown .dropdown-menu{top:auto;left:auto}@media (min-width:768px){.nav-justified>li{display:table-cell;width:1%}.nav-justified>li>a{margin-bottom:0}}.nav-tabs-justified{border-bottom:0}.nav-tabs-justified>li>a{margin-right:0;border-radius:4px}.nav-tabs-justified>.active>a,.nav-tabs-justified>.active>a:hover,.nav-tabs-justified>.active>a:focus{border:1px solid #ddd}@media (min-width:768px){.nav-tabs-justified>li>a{border-bottom:1px solid #ddd;border-radius:4px 4px 0 0}.nav-tabs-justified>.active>a,.nav-tabs-justified>.active>a:hover,.nav-tabs-justified>.active>a:focus{border-bottom-color:#fff}}.tab-content>.tab-pane{display:none}.tab-content>.active{display:block}.nav-tabs .dropdown-menu{margin-top:-1px;border-top-right-radius:0;border-top-left-radius:0}.navbar{position:relative;min-height:50px;margin-bottom:20px;border:1px solid transparent}@media (min-width:768px){.navbar{border-radius:4px}}@media (min-width:768px){.navbar-header{float:left}}.navbar-collapse{overflow-x:visible;padding-right:15px;padding-left:15px;border-top:1px solid transparent;box-shadow:inset 0 1px 0 rgba(255,255,255,0.1);-webkit-overflow-scrolling:touch}.navbar-collapse.in{overflow-y:auto}@media (min-width:768px){.navbar-collapse{width:auto;border-top:0;box-shadow:none}.navbar-collapse.collapse{display:block !important;height:auto !important;padding-bottom:0;overflow:visible !important}.navbar-collapse.in{overflow-y:visible}.navbar-fixed-top .navbar-collapse,.navbar-static-top .navbar-collapse,.navbar-fixed-bottom .navbar-collapse{padding-left:0;padding-right:0}}.navbar-fixed-top .navbar-collapse,.navbar-fixed-bottom .navbar-collapse{max-height:340px}@media (max-width:480px) and (orientation:landscape){.navbar-fixed-top .navbar-collapse,.navbar-fixed-bottom .navbar-collapse{max-height:200px}}.container>.navbar-header,.container-fluid>.navbar-header,.container>.navbar-collapse,.container-fluid>.navbar-collapse{margin-right:-15px;margin-left:-15px}@media (min-width:768px){.container>.navbar-header,.container-fluid>.navbar-header,.container>.navbar-collapse,.container-fluid>.navbar-collapse{margin-right:0;margin-left:0}}.navbar-static-top{z-index:1000;border-width:0 0 1px}@media (min-width:768px){.navbar-static-top{border-radius:0}}.navbar-fixed-top,.navbar-fixed-bottom{position:fixed;right:0;left:0;z-index:1030;-webkit-transform:translate3d(0, 0, 0);transform:translate3d(0, 0, 0)}@media (min-width:768px){.navbar-fixed-top,.navbar-fixed-bottom{border-radius:0}}.navbar-fixed-top{top:0;border-width:0 0 1px}.navbar-fixed-bottom{bottom:0;margin-bottom:0;border-width:1px 0 0}.navbar-brand{float:left;padding:15px 15px;font-size:18px;line-height:20px;height:50px}.navbar-brand:hover,.navbar-brand:focus{text-decoration:none}@media (min-width:768px){.navbar>.container .navbar-brand,.navbar>.container-fluid .navbar-brand{margin-left:-15px}}.navbar-toggle{position:relative;float:right;margin-right:15px;padding:9px 10px;margin-top:8px;margin-bottom:8px;background-color:transparent;background-image:none;border:1px solid transparent;border-radius:4px}.navbar-toggle:focus{outline:0}.navbar-toggle .icon-bar{display:block;width:22px;height:2px;border-radius:1px}.navbar-toggle .icon-bar+.icon-bar{margin-top:4px}@media (min-width:768px){.navbar-toggle{display:none}}.navbar-nav{margin:7.5px -15px}.navbar-nav>li>a{padding-top:10px;padding-bottom:10px;line-height:20px}@media (max-width:767px){.navbar-nav .open .dropdown-menu{position:static;float:none;width:auto;margin-top:0;background-color:transparent;border:0;box-shadow:none}.navbar-nav .open .dropdown-menu>li>a,.navbar-nav .open .dropdown-menu .dropdown-header{padding:5px 15px 5px 25px}.navbar-nav .open .dropdown-menu>li>a{line-height:20px}.navbar-nav .open .dropdown-menu>li>a:hover,.navbar-nav .open .dropdown-menu>li>a:focus{background-image:none}}@media (min-width:768px){.navbar-nav{float:left;margin:0}.navbar-nav>li{float:left}.navbar-nav>li>a{padding-top:15px;padding-bottom:15px}.navbar-nav.navbar-right:last-child{margin-right:-15px}}@media (min-width:768px){.navbar-left{float:left !important}.navbar-right{float:right !important}}.navbar-form{margin-left:-15px;margin-right:-15px;padding:10px 15px;border-top:1px solid transparent;border-bottom:1px solid transparent;-webkit-box-shadow:inset 0 1px 0 rgba(255,255,255,0.1),0 1px 0 rgba(255,255,255,0.1);box-shadow:inset 0 1px 0 rgba(255,255,255,0.1),0 1px 0 rgba(255,255,255,0.1);margin-top:8px;margin-bottom:8px}@media (min-width:768px){.navbar-form .form-group{display:inline-block;margin-bottom:0;vertical-align:middle}.navbar-form .form-control{display:inline-block;width:auto;vertical-align:middle}.navbar-form .input-group{display:inline-table;vertical-align:middle}.navbar-form .input-group .input-group-addon,.navbar-form .input-group .input-group-btn,.navbar-form .input-group .form-control{width:auto}.navbar-form .input-group>.form-control{width:100%}.navbar-form .control-label{margin-bottom:0;vertical-align:middle}.navbar-form .radio,.navbar-form .checkbox{display:inline-block;margin-top:0;margin-bottom:0;vertical-align:middle}.navbar-form .radio label,.navbar-form .checkbox label{padding-left:0}.navbar-form .radio input[type="radio"],.navbar-form .checkbox input[type="checkbox"]{position:relative;margin-left:0}.navbar-form .has-feedback .form-control-feedback{top:0}}@media (max-width:767px){.navbar-form .form-group{margin-bottom:5px}}@media (min-width:768px){.navbar-form{width:auto;border:0;margin-left:0;margin-right:0;padding-top:0;padding-bottom:0;-webkit-box-shadow:none;box-shadow:none}.navbar-form.navbar-right:last-child{margin-right:-15px}}.navbar-nav>li>.dropdown-menu{margin-top:0;border-top-right-radius:0;border-top-left-radius:0}.navbar-fixed-bottom .navbar-nav>li>.dropdown-menu{border-bottom-right-radius:0;border-bottom-left-radius:0}.navbar-btn{margin-top:8px;margin-bottom:8px}.navbar-btn.btn-sm{margin-top:10px;margin-bottom:10px}.navbar-btn.btn-xs{margin-top:14px;margin-bottom:14px}.navbar-text{margin-top:15px;margin-bottom:15px}@media (min-width:768px){.navbar-text{float:left;margin-left:15px;margin-right:15px}.navbar-text.navbar-right:last-child{margin-right:0}}.navbar-default{background-color:#f8f8f8;border-color:#e7e7e7}.navbar-default .navbar-brand{color:#777}.navbar-default .navbar-brand:hover,.navbar-default .navbar-brand:focus{color:#5e5e5e;background-color:transparent}.navbar-default .navbar-text{color:#777}.navbar-default .navbar-nav>li>a{color:#777}.navbar-default .navbar-nav>li>a:hover,.navbar-default .navbar-nav>li>a:focus{color:#333;background-color:transparent}.navbar-default .navbar-nav>.active>a,.navbar-default .navbar-nav>.active>a:hover,.navbar-default .navbar-nav>.active>a:focus{color:#555;background-color:#e7e7e7}.navbar-default .navbar-nav>.disabled>a,.navbar-default .navbar-nav>.disabled>a:hover,.navbar-default .navbar-nav>.disabled>a:focus{color:#ccc;background-color:transparent}.navbar-default .navbar-toggle{border-color:#ddd}.navbar-default .navbar-toggle:hover,.navbar-default .navbar-toggle:focus{background-color:#ddd}.navbar-default .navbar-toggle .icon-bar{background-color:#888}.navbar-default .navbar-collapse,.navbar-default .navbar-form{border-color:#e7e7e7}.navbar-default .navbar-nav>.open>a,.navbar-default .navbar-nav>.open>a:hover,.navbar-default .navbar-nav>.open>a:focus{background-color:#e7e7e7;color:#555}@media (max-width:767px){.navbar-default .navbar-nav .open .dropdown-menu>li>a{color:#777}.navbar-default .navbar-nav .open .dropdown-menu>li>a:hover,.navbar-default .navbar-nav .open .dropdown-menu>li>a:focus{color:#333;background-color:transparent}.navbar-default .navbar-nav .open .dropdown-menu>.active>a,.navbar-default .navbar-nav .open .dropdown-menu>.active>a:hover,.navbar-default .navbar-nav .open .dropdown-menu>.active>a:focus{color:#555;background-color:#e7e7e7}.navbar-default .navbar-nav .open .dropdown-menu>.disabled>a,.navbar-default .navbar-nav .open .dropdown-menu>.disabled>a:hover,.navbar-default .navbar-nav .open .dropdown-menu>.disabled>a:focus{color:#ccc;background-color:transparent}}.navbar-default .navbar-link{color:#777}.navbar-default .navbar-link:hover{color:#333}.navbar-default .btn-link{color:#777}.navbar-default .btn-link:hover,.navbar-default .btn-link:focus{color:#333}.navbar-default .btn-link[disabled]:hover,fieldset[disabled] .navbar-default .btn-link:hover,.navbar-default .btn-link[disabled]:focus,fieldset[disabled] .navbar-default .btn-link:focus{color:#ccc}.navbar-inverse{background-color:#222;border-color:#080808}.navbar-inverse .navbar-brand{color:#777}.navbar-inverse .navbar-brand:hover,.navbar-inverse .navbar-brand:focus{color:#fff;background-color:transparent}.navbar-inverse .navbar-text{color:#777}.navbar-inverse .navbar-nav>li>a{color:#777}.navbar-inverse .navbar-nav>li>a:hover,.navbar-inverse .navbar-nav>li>a:focus{color:#fff;background-color:transparent}.navbar-inverse .navbar-nav>.active>a,.navbar-inverse .navbar-nav>.active>a:hover,.navbar-inverse .navbar-nav>.active>a:focus{color:#fff;background-color:#080808}.navbar-inverse .navbar-nav>.disabled>a,.navbar-inverse .navbar-nav>.disabled>a:hover,.navbar-inverse .navbar-nav>.disabled>a:focus{color:#444;background-color:transparent}.navbar-inverse .navbar-toggle{border-color:#333}.navbar-inverse .navbar-toggle:hover,.navbar-inverse .navbar-toggle:focus{background-color:#333}.navbar-inverse .navbar-toggle .icon-bar{background-color:#fff}.navbar-inverse .navbar-collapse,.navbar-inverse .navbar-form{border-color:#101010}.navbar-inverse .navbar-nav>.open>a,.navbar-inverse .navbar-nav>.open>a:hover,.navbar-inverse .navbar-nav>.open>a:focus{background-color:#080808;color:#fff}@media (max-width:767px){.navbar-inverse .navbar-nav .open .dropdown-menu>.dropdown-header{border-color:#080808}.navbar-inverse .navbar-nav .open .dropdown-menu .divider{background-color:#080808}.navbar-inverse .navbar-nav .open .dropdown-menu>li>a{color:#777}.navbar-inverse .navbar-nav .open .dropdown-menu>li>a:hover,.navbar-inverse .navbar-nav .open .dropdown-menu>li>a:focus{color:#fff;background-color:transparent}.navbar-inverse .navbar-nav .open .dropdown-menu>.active>a,.navbar-inverse .navbar-nav .open .dropdown-menu>.active>a:hover,.navbar-inverse .navbar-nav .open .dropdown-menu>.active>a:focus{color:#fff;background-color:#080808}.navbar-inverse .navbar-nav .open .dropdown-menu>.disabled>a,.navbar-inverse .navbar-nav .open .dropdown-menu>.disabled>a:hover,.navbar-inverse .navbar-nav .open .dropdown-menu>.disabled>a:focus{color:#444;background-color:transparent}}.navbar-inverse .navbar-link{color:#777}.navbar-inverse .navbar-link:hover{color:#fff}.navbar-inverse .btn-link{color:#777}.navbar-inverse .btn-link:hover,.navbar-inverse .btn-link:focus{color:#fff}.navbar-inverse .btn-link[disabled]:hover,fieldset[disabled] .navbar-inverse .btn-link:hover,.navbar-inverse .btn-link[disabled]:focus,fieldset[disabled] .navbar-inverse .btn-link:focus{color:#444}.label{display:inline;padding:.2em .6em .3em;font-size:75%;font-weight:bold;line-height:1;color:#fff;text-align:center;white-space:nowrap;vertical-align:baseline;border-radius:.25em}a.label:hover,a.label:focus{color:#fff;text-decoration:none;cursor:pointer}.label:empty{display:none}.btn .label{position:relative;top:-1px}.label-default{background-color:#777}.label-default[href]:hover,.label-default[href]:focus{background-color:#5e5e5e}.label-primary{background-color:#428bca}.label-primary[href]:hover,.label-primary[href]:focus{background-color:#3071a9}.label-success{background-color:#5cb85c}.label-success[href]:hover,.label-success[href]:focus{background-color:#449d44}.label-info{background-color:#5bc0de}.label-info[href]:hover,.label-info[href]:focus{background-color:#31b0d5}.label-warning{background-color:#f0ad4e}.label-warning[href]:hover,.label-warning[href]:focus{background-color:#ec971f}.label-danger{background-color:#d9534f}.label-danger[href]:hover,.label-danger[href]:focus{background-color:#c9302c}.badge{display:inline-block;min-width:10px;padding:3px 7px;font-size:12px;font-weight:bold;color:#fff;line-height:1;vertical-align:baseline;white-space:nowrap;text-align:center;background-color:#777;border-radius:10px}.badge:empty{display:none}.btn .badge{position:relative;top:-1px}.btn-xs .badge{top:0;padding:1px 5px}a.badge:hover,a.badge:focus{color:#fff;text-decoration:none;cursor:pointer}a.list-group-item.active>.badge,.nav-pills>.active>a>.badge{color:#428bca;background-color:#fff}.nav-pills>li>a>.badge{margin-left:3px}.alert{padding:15px;margin-bottom:20px;border:1px solid transparent;border-radius:4px}.alert h4{margin-top:0;color:inherit}.alert .alert-link{font-weight:bold}.alert>p,.alert>ul{margin-bottom:0}.alert>p+p{margin-top:5px}.alert-dismissable,.alert-dismissible{padding-right:35px}.alert-dismissable .close,.alert-dismissible .close{position:relative;top:-2px;right:-21px;color:inherit}.alert-success{background-color:#dff0d8;border-color:#d6e9c6;color:#3c763d}.alert-success hr{border-top-color:#c9e2b3}.alert-success .alert-link{color:#2b542c}.alert-info{background-color:#d9edf7;border-color:#bce8f1;color:#31708f}.alert-info hr{border-top-color:#a6e1ec}.alert-info .alert-link{color:#245269}.alert-warning{background-color:#fcf8e3;border-color:#faebcc;color:#8a6d3b}.alert-warning hr{border-top-color:#f7e1b5}.alert-warning .alert-link{color:#66512c}.alert-danger{background-color:#f2dede;border-color:#ebccd1;color:#a94442}.alert-danger hr{border-top-color:#e4b9c0}.alert-danger .alert-link{color:#843534}@-webkit-keyframes progress-bar-stripes{from{background-position:40px 0}to{background-position:0 0}}@keyframes progress-bar-stripes{from{background-position:40px 0}to{background-position:0 0}}.progress{overflow:hidden;height:20px;margin-bottom:20px;background-color:#f5f5f5;border-radius:4px;-webkit-box-shadow:inset 0 1px 2px rgba(0,0,0,0.1);box-shadow:inset 0 1px 2px rgba(0,0,0,0.1)}.progress-bar{float:left;width:0%;height:100%;font-size:12px;line-height:20px;color:#fff;text-align:center;background-color:#428bca;-webkit-box-shadow:inset 0 -1px 0 rgba(0,0,0,0.15);box-shadow:inset 0 -1px 0 rgba(0,0,0,0.15);-webkit-transition:width .6s ease;-o-transition:width .6s ease;transition:width .6s ease}.progress-striped .progress-bar,.progress-bar-striped{background-image:-webkit-linear-gradient(45deg, rgba(255,255,255,0.15) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.15) 50%, rgba(255,255,255,0.15) 75%, transparent 75%, transparent);background-image:-o-linear-gradient(45deg, rgba(255,255,255,0.15) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.15) 50%, rgba(255,255,255,0.15) 75%, transparent 75%, transparent);background-image:linear-gradient(45deg, rgba(255,255,255,0.15) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.15) 50%, rgba(255,255,255,0.15) 75%, transparent 75%, transparent);background-size:40px 40px}.progress.active .progress-bar,.progress-bar.active{-webkit-animation:progress-bar-stripes 2s linear infinite;-o-animation:progress-bar-stripes 2s linear infinite;animation:progress-bar-stripes 2s linear infinite}.progress-bar[aria-valuenow="1"],.progress-bar[aria-valuenow="2"]{min-width:30px}.progress-bar[aria-valuenow="0"]{color:#777;min-width:30px;background-color:transparent;background-image:none;box-shadow:none}.progress-bar-success{background-color:#5cb85c}.progress-striped .progress-bar-success{background-image:-webkit-linear-gradient(45deg, rgba(255,255,255,0.15) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.15) 50%, rgba(255,255,255,0.15) 75%, transparent 75%, transparent);background-image:-o-linear-gradient(45deg, rgba(255,255,255,0.15) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.15) 50%, rgba(255,255,255,0.15) 75%, transparent 75%, transparent);background-image:linear-gradient(45deg, rgba(255,255,255,0.15) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.15) 50%, rgba(255,255,255,0.15) 75%, transparent 75%, transparent)}.progress-bar-info{background-color:#5bc0de}.progress-striped .progress-bar-info{background-image:-webkit-linear-gradient(45deg, rgba(255,255,255,0.15) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.15) 50%, rgba(255,255,255,0.15) 75%, transparent 75%, transparent);background-image:-o-linear-gradient(45deg, rgba(255,255,255,0.15) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.15) 50%, rgba(255,255,255,0.15) 75%, transparent 75%, transparent);background-image:linear-gradient(45deg, rgba(255,255,255,0.15) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.15) 50%, rgba(255,255,255,0.15) 75%, transparent 75%, transparent)}.progress-bar-warning{background-color:#f0ad4e}.progress-striped .progress-bar-warning{background-image:-webkit-linear-gradient(45deg, rgba(255,255,255,0.15) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.15) 50%, rgba(255,255,255,0.15) 75%, transparent 75%, transparent);background-image:-o-linear-gradient(45deg, rgba(255,255,255,0.15) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.15) 50%, rgba(255,255,255,0.15) 75%, transparent 75%, transparent);background-image:linear-gradient(45deg, rgba(255,255,255,0.15) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.15) 50%, rgba(255,255,255,0.15) 75%, transparent 75%, transparent)}.progress-bar-danger{background-color:#d9534f}.progress-striped .progress-bar-danger{background-image:-webkit-linear-gradient(45deg, rgba(255,255,255,0.15) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.15) 50%, rgba(255,255,255,0.15) 75%, transparent 75%, transparent);background-image:-o-linear-gradient(45deg, rgba(255,255,255,0.15) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.15) 50%, rgba(255,255,255,0.15) 75%, transparent 75%, transparent);background-image:linear-gradient(45deg, rgba(255,255,255,0.15) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.15) 50%, rgba(255,255,255,0.15) 75%, transparent 75%, transparent)}.panel{margin-bottom:20px;background-color:#fff;border:1px solid transparent;border-radius:4px;-webkit-box-shadow:0 1px 1px rgba(0,0,0,0.05);box-shadow:0 1px 1px rgba(0,0,0,0.05)}.panel-body{padding:15px}.panel-heading{padding:10px 15px;border-bottom:1px solid transparent;border-top-right-radius:3px;border-top-left-radius:3px}.panel-heading>.dropdown .dropdown-toggle{color:inherit}.panel-title{margin-top:0;margin-bottom:0;font-size:16px;color:inherit}.panel-title>a{color:inherit}.panel-footer{padding:10px 15px;background-color:#f5f5f5;border-top:1px solid #ddd;border-bottom-right-radius:3px;border-bottom-left-radius:3px}.panel>.list-group{margin-bottom:0}.panel>.list-group .list-group-item{border-width:1px 0;border-radius:0}.panel>.list-group:first-child .list-group-item:first-child{border-top:0;border-top-right-radius:3px;border-top-left-radius:3px}.panel>.list-group:last-child .list-group-item:last-child{border-bottom:0;border-bottom-right-radius:3px;border-bottom-left-radius:3px}.panel-heading+.list-group .list-group-item:first-child{border-top-width:0}.list-group+.panel-footer{border-top-width:0}.panel>.table,.panel>.table-responsive>.table,.panel>.panel-collapse>.table{margin-bottom:0}.panel>.table:first-child,.panel>.table-responsive:first-child>.table:first-child{border-top-right-radius:3px;border-top-left-radius:3px}.panel>.table:first-child>thead:first-child>tr:first-child td:first-child,.panel>.table-responsive:first-child>.table:first-child>thead:first-child>tr:first-child td:first-child,.panel>.table:first-child>tbody:first-child>tr:first-child td:first-child,.panel>.table-responsive:first-child>.table:first-child>tbody:first-child>tr:first-child td:first-child,.panel>.table:first-child>thead:first-child>tr:first-child th:first-child,.panel>.table-responsive:first-child>.table:first-child>thead:first-child>tr:first-child th:first-child,.panel>.table:first-child>tbody:first-child>tr:first-child th:first-child,.panel>.table-responsive:first-child>.table:first-child>tbody:first-child>tr:first-child th:first-child{border-top-left-radius:3px}.panel>.table:first-child>thead:first-child>tr:first-child td:last-child,.panel>.table-responsive:first-child>.table:first-child>thead:first-child>tr:first-child td:last-child,.panel>.table:first-child>tbody:first-child>tr:first-child td:last-child,.panel>.table-responsive:first-child>.table:first-child>tbody:first-child>tr:first-child td:last-child,.panel>.table:first-child>thead:first-child>tr:first-child th:last-child,.panel>.table-responsive:first-child>.table:first-child>thead:first-child>tr:first-child th:last-child,.panel>.table:first-child>tbody:first-child>tr:first-child th:last-child,.panel>.table-responsive:first-child>.table:first-child>tbody:first-child>tr:first-child th:last-child{border-top-right-radius:3px}.panel>.table:last-child,.panel>.table-responsive:last-child>.table:last-child{border-bottom-right-radius:3px;border-bottom-left-radius:3px}.panel>.table:last-child>tbody:last-child>tr:last-child td:first-child,.panel>.table-responsive:last-child>.table:last-child>tbody:last-child>tr:last-child td:first-child,.panel>.table:last-child>tfoot:last-child>tr:last-child td:first-child,.panel>.table-responsive:last-child>.table:last-child>tfoot:last-child>tr:last-child td:first-child,.panel>.table:last-child>tbody:last-child>tr:last-child th:first-child,.panel>.table-responsive:last-child>.table:last-child>tbody:last-child>tr:last-child th:first-child,.panel>.table:last-child>tfoot:last-child>tr:last-child th:first-child,.panel>.table-responsive:last-child>.table:last-child>tfoot:last-child>tr:last-child th:first-child{border-bottom-left-radius:3px}.panel>.table:last-child>tbody:last-child>tr:last-child td:last-child,.panel>.table-responsive:last-child>.table:last-child>tbody:last-child>tr:last-child td:last-child,.panel>.table:last-child>tfoot:last-child>tr:last-child td:last-child,.panel>.table-responsive:last-child>.table:last-child>tfoot:last-child>tr:last-child td:last-child,.panel>.table:last-child>tbody:last-child>tr:last-child th:last-child,.panel>.table-responsive:last-child>.table:last-child>tbody:last-child>tr:last-child th:last-child,.panel>.table:last-child>tfoot:last-child>tr:last-child th:last-child,.panel>.table-responsive:last-child>.table:last-child>tfoot:last-child>tr:last-child th:last-child{border-bottom-right-radius:3px}.panel>.panel-body+.table,.panel>.panel-body+.table-responsive{border-top:1px solid #ddd}.panel>.table>tbody:first-child>tr:first-child th,.panel>.table>tbody:first-child>tr:first-child td{border-top:0}.panel>.table-bordered,.panel>.table-responsive>.table-bordered{border:0}.panel>.table-bordered>thead>tr>th:first-child,.panel>.table-responsive>.table-bordered>thead>tr>th:first-child,.panel>.table-bordered>tbody>tr>th:first-child,.panel>.table-responsive>.table-bordered>tbody>tr>th:first-child,.panel>.table-bordered>tfoot>tr>th:first-child,.panel>.table-responsive>.table-bordered>tfoot>tr>th:first-child,.panel>.table-bordered>thead>tr>td:first-child,.panel>.table-responsive>.table-bordered>thead>tr>td:first-child,.panel>.table-bordered>tbody>tr>td:first-child,.panel>.table-responsive>.table-bordered>tbody>tr>td:first-child,.panel>.table-bordered>tfoot>tr>td:first-child,.panel>.table-responsive>.table-bordered>tfoot>tr>td:first-child{border-left:0}.panel>.table-bordered>thead>tr>th:last-child,.panel>.table-responsive>.table-bordered>thead>tr>th:last-child,.panel>.table-bordered>tbody>tr>th:last-child,.panel>.table-responsive>.table-bordered>tbody>tr>th:last-child,.panel>.table-bordered>tfoot>tr>th:last-child,.panel>.table-responsive>.table-bordered>tfoot>tr>th:last-child,.panel>.table-bordered>thead>tr>td:last-child,.panel>.table-responsive>.table-bordered>thead>tr>td:last-child,.panel>.table-bordered>tbody>tr>td:last-child,.panel>.table-responsive>.table-bordered>tbody>tr>td:last-child,.panel>.table-bordered>tfoot>tr>td:last-child,.panel>.table-responsive>.table-bordered>tfoot>tr>td:last-child{border-right:0}.panel>.table-bordered>thead>tr:first-child>td,.panel>.table-responsive>.table-bordered>thead>tr:first-child>td,.panel>.table-bordered>tbody>tr:first-child>td,.panel>.table-responsive>.table-bordered>tbody>tr:first-child>td,.panel>.table-bordered>thead>tr:first-child>th,.panel>.table-responsive>.table-bordered>thead>tr:first-child>th,.panel>.table-bordered>tbody>tr:first-child>th,.panel>.table-responsive>.table-bordered>tbody>tr:first-child>th{border-bottom:0}.panel>.table-bordered>tbody>tr:last-child>td,.panel>.table-responsive>.table-bordered>tbody>tr:last-child>td,.panel>.table-bordered>tfoot>tr:last-child>td,.panel>.table-responsive>.table-bordered>tfoot>tr:last-child>td,.panel>.table-bordered>tbody>tr:last-child>th,.panel>.table-responsive>.table-bordered>tbody>tr:last-child>th,.panel>.table-bordered>tfoot>tr:last-child>th,.panel>.table-responsive>.table-bordered>tfoot>tr:last-child>th{border-bottom:0}.panel>.table-responsive{border:0;margin-bottom:0}.panel-group{margin-bottom:20px}.panel-group .panel{margin-bottom:0;border-radius:4px}.panel-group .panel+.panel{margin-top:5px}.panel-group .panel-heading{border-bottom:0}.panel-group .panel-heading+.panel-collapse>.panel-body{border-top:1px solid #ddd}.panel-group .panel-footer{border-top:0}.panel-group .panel-footer+.panel-collapse .panel-body{border-bottom:1px solid #ddd}.panel-default{border-color:#ddd}.panel-default>.panel-heading{color:#333;background-color:#f5f5f5;border-color:#ddd}.panel-default>.panel-heading+.panel-collapse>.panel-body{border-top-color:#ddd}.panel-default>.panel-heading .badge{color:#f5f5f5;background-color:#333}.panel-default>.panel-footer+.panel-collapse>.panel-body{border-bottom-color:#ddd}.panel-primary{border-color:#428bca}.panel-primary>.panel-heading{color:#fff;background-color:#428bca;border-color:#428bca}.panel-primary>.panel-heading+.panel-collapse>.panel-body{border-top-color:#428bca}.panel-primary>.panel-heading .badge{color:#428bca;background-color:#fff}.panel-primary>.panel-footer+.panel-collapse>.panel-body{border-bottom-color:#428bca}.panel-success{border-color:#d6e9c6}.panel-success>.panel-heading{color:#3c763d;background-color:#dff0d8;border-color:#d6e9c6}.panel-success>.panel-heading+.panel-collapse>.panel-body{border-top-color:#d6e9c6}.panel-success>.panel-heading .badge{color:#dff0d8;background-color:#3c763d}.panel-success>.panel-footer+.panel-collapse>.panel-body{border-bottom-color:#d6e9c6}.panel-info{border-color:#bce8f1}.panel-info>.panel-heading{color:#31708f;background-color:#d9edf7;border-color:#bce8f1}.panel-info>.panel-heading+.panel-collapse>.panel-body{border-top-color:#bce8f1}.panel-info>.panel-heading .badge{color:#d9edf7;background-color:#31708f}.panel-info>.panel-footer+.panel-collapse>.panel-body{border-bottom-color:#bce8f1}.panel-warning{border-color:#faebcc}.panel-warning>.panel-heading{color:#8a6d3b;background-color:#fcf8e3;border-color:#faebcc}.panel-warning>.panel-heading+.panel-collapse>.panel-body{border-top-color:#faebcc}.panel-warning>.panel-heading .badge{color:#fcf8e3;background-color:#8a6d3b}.panel-warning>.panel-footer+.panel-collapse>.panel-body{border-bottom-color:#faebcc}.panel-danger{border-color:#ebccd1}.panel-danger>.panel-heading{color:#a94442;background-color:#f2dede;border-color:#ebccd1}.panel-danger>.panel-heading+.panel-collapse>.panel-body{border-top-color:#ebccd1}.panel-danger>.panel-heading .badge{color:#f2dede;background-color:#a94442}.panel-danger>.panel-footer+.panel-collapse>.panel-body{border-bottom-color:#ebccd1}.modal-open{overflow:hidden}.modal{display:none;overflow:hidden;position:fixed;top:0;right:0;bottom:0;left:0;z-index:1050;-webkit-overflow-scrolling:touch;outline:0}.modal.fade .modal-dialog{-webkit-transform:translate3d(0, -25%, 0);transform:translate3d(0, -25%, 0);-webkit-transition:-webkit-transform 0.3s ease-out;-moz-transition:-moz-transform 0.3s ease-out;-o-transition:-o-transform 0.3s ease-out;transition:transform 0.3s ease-out}.modal.in .modal-dialog{-webkit-transform:translate3d(0, 0, 0);transform:translate3d(0, 0, 0)}.modal-open .modal{overflow-x:hidden;overflow-y:auto}.modal-dialog{position:relative;width:auto;margin:10px}.modal-content{position:relative;background-color:#fff;border:1px solid #999;border:1px solid rgba(0,0,0,0.2);border-radius:6px;-webkit-box-shadow:0 3px 9px rgba(0,0,0,0.5);box-shadow:0 3px 9px rgba(0,0,0,0.5);background-clip:padding-box;outline:0}.modal-backdrop{position:fixed;top:0;right:0;bottom:0;left:0;z-index:1040;background-color:#000}.modal-backdrop.fade{opacity:0;filter:alpha(opacity=0)}.modal-backdrop.in{opacity:.5;filter:alpha(opacity=50)}.modal-header{padding:15px;border-bottom:1px solid #e5e5e5;min-height:16.42857143px}.modal-header .close{margin-top:-2px}.modal-title{margin:0;line-height:1.42857143}.modal-body{position:relative;padding:15px}.modal-footer{padding:15px;text-align:right;border-top:1px solid #e5e5e5}.modal-footer .btn+.btn{margin-left:5px;margin-bottom:0}.modal-footer .btn-group .btn+.btn{margin-left:-1px}.modal-footer .btn-block+.btn-block{margin-left:0}.modal-scrollbar-measure{position:absolute;top:-9999px;width:50px;height:50px;overflow:scroll}@media (min-width:768px){.modal-dialog{width:600px;margin:30px auto}.modal-content{-webkit-box-shadow:0 5px 15px rgba(0,0,0,0.5);box-shadow:0 5px 15px rgba(0,0,0,0.5)}.modal-sm{width:300px}}@media (min-width:992px){.modal-lg{width:900px}}.clearfix:before,.clearfix:after,.dl-horizontal dd:before,.dl-horizontal dd:after,.container:before,.container:after,.container-fluid:before,.container-fluid:after,.row:before,.row:after,.form-horizontal .form-group:before,.form-horizontal .form-group:after,.btn-toolbar:before,.btn-toolbar:after,.btn-group-vertical>.btn-group:before,.btn-group-vertical>.btn-group:after,.nav:before,.nav:after,.navbar:before,.navbar:after,.navbar-header:before,.navbar-header:after,.navbar-collapse:before,.navbar-collapse:after,.panel-body:before,.panel-body:after,.modal-footer:before,.modal-footer:after{content:" ";display:table}.clearfix:after,.dl-horizontal dd:after,.container:after,.container-fluid:after,.row:after,.form-horizontal .form-group:after,.btn-toolbar:after,.btn-group-vertical>.btn-group:after,.nav:after,.navbar:after,.navbar-header:after,.navbar-collapse:after,.panel-body:after,.modal-footer:after{clear:both}.center-block{display:block;margin-left:auto;margin-right:auto}.pull-right{float:right !important}.pull-left{float:left !important}.hide{display:none !important}.show{display:block !important}.invisible{visibility:hidden}.text-hide{font:0/0 a;color:transparent;text-shadow:none;background-color:transparent;border:0}.hidden{display:none !important;visibility:hidden !important}.affix{position:fixed;-webkit-transform:translate3d(0, 0, 0);transform:translate3d(0, 0, 0)}@-ms-viewport{width:device-width}.visible-xs,.visible-sm,.visible-md,.visible-lg{display:none !important}.visible-xs-block,.visible-xs-inline,.visible-xs-inline-block,.visible-sm-block,.visible-sm-inline,.visible-sm-inline-block,.visible-md-block,.visible-md-inline,.visible-md-inline-block,.visible-lg-block,.visible-lg-inline,.visible-lg-inline-block{display:none !important}@media (max-width:767px){.visible-xs{display:block !important}table.visible-xs{display:table}tr.visible-xs{display:table-row !important}th.visible-xs,td.visible-xs{display:table-cell !important}}@media (max-width:767px){.visible-xs-block{display:block !important}}@media (max-width:767px){.visible-xs-inline{display:inline !important}}@media (max-width:767px){.visible-xs-inline-block{display:inline-block !important}}@media (min-width:768px) and (max-width:991px){.visible-sm{display:block !important}table.visible-sm{display:table}tr.visible-sm{display:table-row !important}th.visible-sm,td.visible-sm{display:table-cell !important}}@media (min-width:768px) and (max-width:991px){.visible-sm-block{display:block !important}}@media (min-width:768px) and (max-width:991px){.visible-sm-inline{display:inline !important}}@media (min-width:768px) and (max-width:991px){.visible-sm-inline-block{display:inline-block !important}}@media (min-width:992px) and (max-width:1199px){.visible-md{display:block !important}table.visible-md{display:table}tr.visible-md{display:table-row !important}th.visible-md,td.visible-md{display:table-cell !important}}@media (min-width:992px) and (max-width:1199px){.visible-md-block{display:block !important}}@media (min-width:992px) and (max-width:1199px){.visible-md-inline{display:inline !important}}@media (min-width:992px) and (max-width:1199px){.visible-md-inline-block{display:inline-block !important}}@media (min-width:1200px){.visible-lg{display:block !important}table.visible-lg{display:table}tr.visible-lg{display:table-row !important}th.visible-lg,td.visible-lg{display:table-cell !important}}@media (min-width:1200px){.visible-lg-block{display:block !important}}@media (min-width:1200px){.visible-lg-inline{display:inline !important}}@media (min-width:1200px){.visible-lg-inline-block{display:inline-block !important}}@media (max-width:767px){.hidden-xs{display:none !important}}@media (min-width:768px) and (max-width:991px){.hidden-sm{display:none !important}}@media (min-width:992px) and (max-width:1199px){.hidden-md{display:none !important}}@media (min-width:1200px){.hidden-lg{display:none !important}}.visible-print{display:none !important}@media print{.visible-print{display:block !important}table.visible-print{display:table}tr.visible-print{display:table-row !important}th.visible-print,td.visible-print{display:table-cell !important}}.visible-print-block{display:none !important}@media print{.visible-print-block{display:block !important}}.visible-print-inline{display:none !important}@media print{.visible-print-inline{display:inline !important}}.visible-print-inline-block{display:none !important}@media print{.visible-print-inline-block{display:inline-block !important}}@media print{.hidden-print{display:none !important}}
table.treetable span.indenter{display:inline-block;text-align:right;user-select:none;-khtml-user-select:none;-moz-user-select:none;-o-user-select:none;-webkit-user-select:none;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;width:19px;margin:0;padding:0;}table.treetable span.indenter a{background-position:left center;background-repeat:no-repeat;display:inline-block;text-decoration:none;width:19px;}table.treetable tr.collapsed span.indenter a{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAKT2lDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVNnVFPpFj333vRCS4iAlEtvUhUIIFJCi4AUkSYqIQkQSoghodkVUcERRUUEG8igiAOOjoCMFVEsDIoK2AfkIaKOg6OIisr74Xuja9a89+bN/rXXPues852zzwfACAyWSDNRNYAMqUIeEeCDx8TG4eQuQIEKJHAAEAizZCFz/SMBAPh+PDwrIsAHvgABeNMLCADATZvAMByH/w/qQplcAYCEAcB0kThLCIAUAEB6jkKmAEBGAYCdmCZTAKAEAGDLY2LjAFAtAGAnf+bTAICd+Jl7AQBblCEVAaCRACATZYhEAGg7AKzPVopFAFgwABRmS8Q5ANgtADBJV2ZIALC3AMDOEAuyAAgMADBRiIUpAAR7AGDIIyN4AISZABRG8lc88SuuEOcqAAB4mbI8uSQ5RYFbCC1xB1dXLh4ozkkXKxQ2YQJhmkAuwnmZGTKBNA/g88wAAKCRFRHgg/P9eM4Ors7ONo62Dl8t6r8G/yJiYuP+5c+rcEAAAOF0ftH+LC+zGoA7BoBt/qIl7gRoXgugdfeLZrIPQLUAoOnaV/Nw+H48PEWhkLnZ2eXk5NhKxEJbYcpXff5nwl/AV/1s+X48/Pf14L7iJIEyXYFHBPjgwsz0TKUcz5IJhGLc5o9H/LcL//wd0yLESWK5WCoU41EScY5EmozzMqUiiUKSKcUl0v9k4t8s+wM+3zUAsGo+AXuRLahdYwP2SycQWHTA4vcAAPK7b8HUKAgDgGiD4c93/+8//UegJQCAZkmScQAAXkQkLlTKsz/HCAAARKCBKrBBG/TBGCzABhzBBdzBC/xgNoRCJMTCQhBCCmSAHHJgKayCQiiGzbAdKmAv1EAdNMBRaIaTcA4uwlW4Dj1wD/phCJ7BKLyBCQRByAgTYSHaiAFiilgjjggXmYX4IcFIBBKLJCDJiBRRIkuRNUgxUopUIFVIHfI9cgI5h1xGupE7yAAygvyGvEcxlIGyUT3UDLVDuag3GoRGogvQZHQxmo8WoJvQcrQaPYw2oefQq2gP2o8+Q8cwwOgYBzPEbDAuxsNCsTgsCZNjy7EirAyrxhqwVqwDu4n1Y8+xdwQSgUXACTYEd0IgYR5BSFhMWE7YSKggHCQ0EdoJNwkDhFHCJyKTqEu0JroR+cQYYjIxh1hILCPWEo8TLxB7iEPENyQSiUMyJ7mQAkmxpFTSEtJG0m5SI+ksqZs0SBojk8naZGuyBzmULCAryIXkneTD5DPkG+Qh8lsKnWJAcaT4U+IoUspqShnlEOU05QZlmDJBVaOaUt2ooVQRNY9aQq2htlKvUYeoEzR1mjnNgxZJS6WtopXTGmgXaPdpr+h0uhHdlR5Ol9BX0svpR+iX6AP0dwwNhhWDx4hnKBmbGAcYZxl3GK+YTKYZ04sZx1QwNzHrmOeZD5lvVVgqtip8FZHKCpVKlSaVGyovVKmqpqreqgtV81XLVI+pXlN9rkZVM1PjqQnUlqtVqp1Q61MbU2epO6iHqmeob1Q/pH5Z/YkGWcNMw09DpFGgsV/jvMYgC2MZs3gsIWsNq4Z1gTXEJrHN2Xx2KruY/R27iz2qqaE5QzNKM1ezUvOUZj8H45hx+Jx0TgnnKKeX836K3hTvKeIpG6Y0TLkxZVxrqpaXllirSKtRq0frvTau7aedpr1Fu1n7gQ5Bx0onXCdHZ4/OBZ3nU9lT3acKpxZNPTr1ri6qa6UbobtEd79up+6Ynr5egJ5Mb6feeb3n+hx9L/1U/W36p/VHDFgGswwkBtsMzhg8xTVxbzwdL8fb8VFDXcNAQ6VhlWGX4YSRudE8o9VGjUYPjGnGXOMk423GbcajJgYmISZLTepN7ppSTbmmKaY7TDtMx83MzaLN1pk1mz0x1zLnm+eb15vft2BaeFostqi2uGVJsuRaplnutrxuhVo5WaVYVVpds0atna0l1rutu6cRp7lOk06rntZnw7Dxtsm2qbcZsOXYBtuutm22fWFnYhdnt8Wuw+6TvZN9un2N/T0HDYfZDqsdWh1+c7RyFDpWOt6azpzuP33F9JbpL2dYzxDP2DPjthPLKcRpnVOb00dnF2e5c4PziIuJS4LLLpc+Lpsbxt3IveRKdPVxXeF60vWdm7Obwu2o26/uNu5p7ofcn8w0nymeWTNz0MPIQ+BR5dE/C5+VMGvfrH5PQ0+BZ7XnIy9jL5FXrdewt6V3qvdh7xc+9j5yn+M+4zw33jLeWV/MN8C3yLfLT8Nvnl+F30N/I/9k/3r/0QCngCUBZwOJgUGBWwL7+Hp8Ib+OPzrbZfay2e1BjKC5QRVBj4KtguXBrSFoyOyQrSH355jOkc5pDoVQfujW0Adh5mGLw34MJ4WHhVeGP45wiFga0TGXNXfR3ENz30T6RJZE3ptnMU85ry1KNSo+qi5qPNo3ujS6P8YuZlnM1VidWElsSxw5LiquNm5svt/87fOH4p3iC+N7F5gvyF1weaHOwvSFpxapLhIsOpZATIhOOJTwQRAqqBaMJfITdyWOCnnCHcJnIi/RNtGI2ENcKh5O8kgqTXqS7JG8NXkkxTOlLOW5hCepkLxMDUzdmzqeFpp2IG0yPTq9MYOSkZBxQqohTZO2Z+pn5mZ2y6xlhbL+xW6Lty8elQfJa7OQrAVZLQq2QqboVFoo1yoHsmdlV2a/zYnKOZarnivN7cyzytuQN5zvn//tEsIS4ZK2pYZLVy0dWOa9rGo5sjxxedsK4xUFK4ZWBqw8uIq2Km3VT6vtV5eufr0mek1rgV7ByoLBtQFr6wtVCuWFfevc1+1dT1gvWd+1YfqGnRs+FYmKrhTbF5cVf9go3HjlG4dvyr+Z3JS0qavEuWTPZtJm6ebeLZ5bDpaql+aXDm4N2dq0Dd9WtO319kXbL5fNKNu7g7ZDuaO/PLi8ZafJzs07P1SkVPRU+lQ27tLdtWHX+G7R7ht7vPY07NXbW7z3/T7JvttVAVVN1WbVZftJ+7P3P66Jqun4lvttXa1ObXHtxwPSA/0HIw6217nU1R3SPVRSj9Yr60cOxx++/p3vdy0NNg1VjZzG4iNwRHnk6fcJ3/ceDTradox7rOEH0x92HWcdL2pCmvKaRptTmvtbYlu6T8w+0dbq3nr8R9sfD5w0PFl5SvNUyWna6YLTk2fyz4ydlZ19fi753GDborZ752PO32oPb++6EHTh0kX/i+c7vDvOXPK4dPKy2+UTV7hXmq86X23qdOo8/pPTT8e7nLuarrlca7nuer21e2b36RueN87d9L158Rb/1tWeOT3dvfN6b/fF9/XfFt1+cif9zsu72Xcn7q28T7xf9EDtQdlD3YfVP1v+3Njv3H9qwHeg89HcR/cGhYPP/pH1jw9DBY+Zj8uGDYbrnjg+OTniP3L96fynQ89kzyaeF/6i/suuFxYvfvjV69fO0ZjRoZfyl5O/bXyl/erA6xmv28bCxh6+yXgzMV70VvvtwXfcdx3vo98PT+R8IH8o/2j5sfVT0Kf7kxmTk/8EA5jz/GMzLdsAAAAgY0hSTQAAeiUAAICDAAD5/wAAgOkAAHUwAADqYAAAOpgAABdvkl/FRgAAAHlJREFUeNrcU1sNgDAQ6wgmcAM2MICGGlg1gJnNzWQcvwQGy1j4oUl/7tH0mpwzM7SgQyO+EZAUWh2MkkzSWhJwuRAlHYsJwEwyvs1gABDuzqoJcTw5qxaIJN0bgQRgIjnlmn1heSO5PE6Y2YXe+5Cr5+h++gs12AcAS6FS+7YOsj4AAAAASUVORK5CYII=);}table.treetable tr.expanded span.indenter a{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAKT2lDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVNnVFPpFj333vRCS4iAlEtvUhUIIFJCi4AUkSYqIQkQSoghodkVUcERRUUEG8igiAOOjoCMFVEsDIoK2AfkIaKOg6OIisr74Xuja9a89+bN/rXXPues852zzwfACAyWSDNRNYAMqUIeEeCDx8TG4eQuQIEKJHAAEAizZCFz/SMBAPh+PDwrIsAHvgABeNMLCADATZvAMByH/w/qQplcAYCEAcB0kThLCIAUAEB6jkKmAEBGAYCdmCZTAKAEAGDLY2LjAFAtAGAnf+bTAICd+Jl7AQBblCEVAaCRACATZYhEAGg7AKzPVopFAFgwABRmS8Q5ANgtADBJV2ZIALC3AMDOEAuyAAgMADBRiIUpAAR7AGDIIyN4AISZABRG8lc88SuuEOcqAAB4mbI8uSQ5RYFbCC1xB1dXLh4ozkkXKxQ2YQJhmkAuwnmZGTKBNA/g88wAAKCRFRHgg/P9eM4Ors7ONo62Dl8t6r8G/yJiYuP+5c+rcEAAAOF0ftH+LC+zGoA7BoBt/qIl7gRoXgugdfeLZrIPQLUAoOnaV/Nw+H48PEWhkLnZ2eXk5NhKxEJbYcpXff5nwl/AV/1s+X48/Pf14L7iJIEyXYFHBPjgwsz0TKUcz5IJhGLc5o9H/LcL//wd0yLESWK5WCoU41EScY5EmozzMqUiiUKSKcUl0v9k4t8s+wM+3zUAsGo+AXuRLahdYwP2SycQWHTA4vcAAPK7b8HUKAgDgGiD4c93/+8//UegJQCAZkmScQAAXkQkLlTKsz/HCAAARKCBKrBBG/TBGCzABhzBBdzBC/xgNoRCJMTCQhBCCmSAHHJgKayCQiiGzbAdKmAv1EAdNMBRaIaTcA4uwlW4Dj1wD/phCJ7BKLyBCQRByAgTYSHaiAFiilgjjggXmYX4IcFIBBKLJCDJiBRRIkuRNUgxUopUIFVIHfI9cgI5h1xGupE7yAAygvyGvEcxlIGyUT3UDLVDuag3GoRGogvQZHQxmo8WoJvQcrQaPYw2oefQq2gP2o8+Q8cwwOgYBzPEbDAuxsNCsTgsCZNjy7EirAyrxhqwVqwDu4n1Y8+xdwQSgUXACTYEd0IgYR5BSFhMWE7YSKggHCQ0EdoJNwkDhFHCJyKTqEu0JroR+cQYYjIxh1hILCPWEo8TLxB7iEPENyQSiUMyJ7mQAkmxpFTSEtJG0m5SI+ksqZs0SBojk8naZGuyBzmULCAryIXkneTD5DPkG+Qh8lsKnWJAcaT4U+IoUspqShnlEOU05QZlmDJBVaOaUt2ooVQRNY9aQq2htlKvUYeoEzR1mjnNgxZJS6WtopXTGmgXaPdpr+h0uhHdlR5Ol9BX0svpR+iX6AP0dwwNhhWDx4hnKBmbGAcYZxl3GK+YTKYZ04sZx1QwNzHrmOeZD5lvVVgqtip8FZHKCpVKlSaVGyovVKmqpqreqgtV81XLVI+pXlN9rkZVM1PjqQnUlqtVqp1Q61MbU2epO6iHqmeob1Q/pH5Z/YkGWcNMw09DpFGgsV/jvMYgC2MZs3gsIWsNq4Z1gTXEJrHN2Xx2KruY/R27iz2qqaE5QzNKM1ezUvOUZj8H45hx+Jx0TgnnKKeX836K3hTvKeIpG6Y0TLkxZVxrqpaXllirSKtRq0frvTau7aedpr1Fu1n7gQ5Bx0onXCdHZ4/OBZ3nU9lT3acKpxZNPTr1ri6qa6UbobtEd79up+6Ynr5egJ5Mb6feeb3n+hx9L/1U/W36p/VHDFgGswwkBtsMzhg8xTVxbzwdL8fb8VFDXcNAQ6VhlWGX4YSRudE8o9VGjUYPjGnGXOMk423GbcajJgYmISZLTepN7ppSTbmmKaY7TDtMx83MzaLN1pk1mz0x1zLnm+eb15vft2BaeFostqi2uGVJsuRaplnutrxuhVo5WaVYVVpds0atna0l1rutu6cRp7lOk06rntZnw7Dxtsm2qbcZsOXYBtuutm22fWFnYhdnt8Wuw+6TvZN9un2N/T0HDYfZDqsdWh1+c7RyFDpWOt6azpzuP33F9JbpL2dYzxDP2DPjthPLKcRpnVOb00dnF2e5c4PziIuJS4LLLpc+Lpsbxt3IveRKdPVxXeF60vWdm7Obwu2o26/uNu5p7ofcn8w0nymeWTNz0MPIQ+BR5dE/C5+VMGvfrH5PQ0+BZ7XnIy9jL5FXrdewt6V3qvdh7xc+9j5yn+M+4zw33jLeWV/MN8C3yLfLT8Nvnl+F30N/I/9k/3r/0QCngCUBZwOJgUGBWwL7+Hp8Ib+OPzrbZfay2e1BjKC5QRVBj4KtguXBrSFoyOyQrSH355jOkc5pDoVQfujW0Adh5mGLw34MJ4WHhVeGP45wiFga0TGXNXfR3ENz30T6RJZE3ptnMU85ry1KNSo+qi5qPNo3ujS6P8YuZlnM1VidWElsSxw5LiquNm5svt/87fOH4p3iC+N7F5gvyF1weaHOwvSFpxapLhIsOpZATIhOOJTwQRAqqBaMJfITdyWOCnnCHcJnIi/RNtGI2ENcKh5O8kgqTXqS7JG8NXkkxTOlLOW5hCepkLxMDUzdmzqeFpp2IG0yPTq9MYOSkZBxQqohTZO2Z+pn5mZ2y6xlhbL+xW6Lty8elQfJa7OQrAVZLQq2QqboVFoo1yoHsmdlV2a/zYnKOZarnivN7cyzytuQN5zvn//tEsIS4ZK2pYZLVy0dWOa9rGo5sjxxedsK4xUFK4ZWBqw8uIq2Km3VT6vtV5eufr0mek1rgV7ByoLBtQFr6wtVCuWFfevc1+1dT1gvWd+1YfqGnRs+FYmKrhTbF5cVf9go3HjlG4dvyr+Z3JS0qavEuWTPZtJm6ebeLZ5bDpaql+aXDm4N2dq0Dd9WtO319kXbL5fNKNu7g7ZDuaO/PLi8ZafJzs07P1SkVPRU+lQ27tLdtWHX+G7R7ht7vPY07NXbW7z3/T7JvttVAVVN1WbVZftJ+7P3P66Jqun4lvttXa1ObXHtxwPSA/0HIw6217nU1R3SPVRSj9Yr60cOxx++/p3vdy0NNg1VjZzG4iNwRHnk6fcJ3/ceDTradox7rOEH0x92HWcdL2pCmvKaRptTmvtbYlu6T8w+0dbq3nr8R9sfD5w0PFl5SvNUyWna6YLTk2fyz4ydlZ19fi753GDborZ752PO32oPb++6EHTh0kX/i+c7vDvOXPK4dPKy2+UTV7hXmq86X23qdOo8/pPTT8e7nLuarrlca7nuer21e2b36RueN87d9L158Rb/1tWeOT3dvfN6b/fF9/XfFt1+cif9zsu72Xcn7q28T7xf9EDtQdlD3YfVP1v+3Njv3H9qwHeg89HcR/cGhYPP/pH1jw9DBY+Zj8uGDYbrnjg+OTniP3L96fynQ89kzyaeF/6i/suuFxYvfvjV69fO0ZjRoZfyl5O/bXyl/erA6xmv28bCxh6+yXgzMV70VvvtwXfcdx3vo98PT+R8IH8o/2j5sfVT0Kf7kxmTk/8EA5jz/GMzLdsAAAAgY0hSTQAAeiUAAICDAAD5/wAAgOkAAHUwAADqYAAAOpgAABdvkl/FRgAAAHFJREFUeNpi/P//PwMlgImBQsA44C6gvhfa29v3MzAwOODRc6CystIRbxi0t7fjDJjKykpGYrwwi1hxnLHQ3t7+jIGBQRJJ6HllZaUUKYEYRYBPOB0gBShKwKGA////48VtbW3/8clTnBIH3gCKkzJgAGvBX0dDm0sCAAAAAElFTkSuQmCC);}table.treetable tr.branch{background-color:#f9f9f9;}table.treetable tr.selected{background-color:#3875d7;color:#fff;}table.treetable tr span.indenter a{outline:none;}tr.rule-overview-needs-attention td a{color:#d9534f;}td.rule-result div,span.rule-result{text-align:center;font-weight:700;color:#fff;background:gray;}td.rule-result-unknown div,span.rule-result-unknown{background:#f0ad4e;}.js-only{display:none;}.rule-detail-fail,.rule-detail-error,.rule-detail-unknown{border:2px solid #d9534f;}#footer{text-align:center;margin-top:50px;}pre{overflow:auto!important;word-wrap:normal!important;white-space:pre;}div.check-system-details,div.remediation,div.description{display:inline-block;width:0;min-width:100%;overflow-x:auto;}div.modal-body{margin:50px;padding:0;}div.horizontal-scroll{overflow-x:auto;}div.top-spacer-10{margin-top:10px;}td.rule-result-fail div,span.rule-result-fail,td.rule-result-error div,span.rule-result-error{background:#d9534f;}td.rule-result-pass div,span.rule-result-pass,td.rule-result-fixed div,span.rule-result-fixed{background:#5cb85c;}.rule-result-filtered,.rule-result-filtered > *,.search-no-match,.search-no-match > *{display:none!important;}@media print{.container{width:100%;}.rule-result abbr[title]:after,.identifiers abbr[title]:after,.identifiers a[href]:after{content:"";}}</style><script>
/*! jQuery v1.11.1 | (c) 2005, 2014 jQuery Foundation, Inc. | jquery.org/license */
!function(a,b){"object"==typeof module&&"object"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error("jQuery requires a window with a document");return b(a)}:b(a)}("undefined"!=typeof window?window:this,function(a,b){var c=[],d=c.slice,e=c.concat,f=c.push,g=c.indexOf,h={},i=h.toString,j=h.hasOwnProperty,k={},l="1.11.1",m=function(a,b){return new m.fn.init(a,b)},n=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,o=/^-ms-/,p=/-([\da-z])/gi,q=function(a,b){return b.toUpperCase()};m.fn=m.prototype={jquery:l,constructor:m,selector:"",length:0,toArray:function(){return d.call(this)},get:function(a){return null!=a?0>a?this[a+this.length]:this[a]:d.call(this)},pushStack:function(a){var b=m.merge(this.constructor(),a);return b.prevObject=this,b.context=this.context,b},each:function(a,b){return m.each(this,a,b)},map:function(a){return this.pushStack(m.map(this,function(b,c){return a.call(b,c,b)}))},slice:function(){return this.pushStack(d.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(a){var b=this.length,c=+a+(0>a?b:0);return this.pushStack(c>=0&&b>c?[this[c]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:f,sort:c.sort,splice:c.splice},m.extend=m.fn.extend=function(){var a,b,c,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for("boolean"==typeof g&&(j=g,g=arguments[h]||{},h++),"object"==typeof g||m.isFunction(g)||(g={}),h===i&&(g=this,h--);i>h;h++)if(null!=(e=arguments[h]))for(d in e)a=g[d],c=e[d],g!==c&&(j&&c&&(m.isPlainObject(c)||(b=m.isArray(c)))?(b?(b=!1,f=a&&m.isArray(a)?a:[]):f=a&&m.isPlainObject(a)?a:{},g[d]=m.extend(j,f,c)):void 0!==c&&(g[d]=c));return g},m.extend({expando:"jQuery"+(l+Math.random()).replace(/\D/g,""),isReady:!0,error:function(a){throw new Error(a)},noop:function(){},isFunction:function(a){return"function"===m.type(a)},isArray:Array.isArray||function(a){return"array"===m.type(a)},isWindow:function(a){return null!=a&&a==a.window},isNumeric:function(a){return!m.isArray(a)&&a-parseFloat(a)>=0},isEmptyObject:function(a){var b;for(b in a)return!1;return!0},isPlainObject:function(a){var b;if(!a||"object"!==m.type(a)||a.nodeType||m.isWindow(a))return!1;try{if(a.constructor&&!j.call(a,"constructor")&&!j.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(c){return!1}if(k.ownLast)for(b in a)return j.call(a,b);for(b in a);return void 0===b||j.call(a,b)},type:function(a){return null==a?a+"":"object"==typeof a||"function"==typeof a?h[i.call(a)]||"object":typeof a},globalEval:function(b){b&&m.trim(b)&&(a.execScript||function(b){a.eval.call(a,b)})(b)},camelCase:function(a){return a.replace(o,"ms-").replace(p,q)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()},each:function(a,b,c){var d,e=0,f=a.length,g=r(a);if(c){if(g){for(;f>e;e++)if(d=b.apply(a[e],c),d===!1)break}else for(e in a)if(d=b.apply(a[e],c),d===!1)break}else if(g){for(;f>e;e++)if(d=b.call(a[e],e,a[e]),d===!1)break}else for(e in a)if(d=b.call(a[e],e,a[e]),d===!1)break;return a},trim:function(a){return null==a?"":(a+"").replace(n,"")},makeArray:function(a,b){var c=b||[];return null!=a&&(r(Object(a))?m.merge(c,"string"==typeof a?[a]:a):f.call(c,a)),c},inArray:function(a,b,c){var d;if(b){if(g)return g.call(b,a,c);for(d=b.length,c=c?0>c?Math.max(0,d+c):c:0;d>c;c++)if(c in b&&b[c]===a)return c}return-1},merge:function(a,b){var c=+b.length,d=0,e=a.length;while(c>d)a[e++]=b[d++];if(c!==c)while(void 0!==b[d])a[e++]=b[d++];return a.length=e,a},grep:function(a,b,c){for(var d,e=[],f=0,g=a.length,h=!c;g>f;f++)d=!b(a[f],f),d!==h&&e.push(a[f]);return e},map:function(a,b,c){var d,f=0,g=a.length,h=r(a),i=[];if(h)for(;g>f;f++)d=b(a[f],f,c),null!=d&&i.push(d);else for(f in a)d=b(a[f],f,c),null!=d&&i.push(d);return e.apply([],i)},guid:1,proxy:function(a,b){var c,e,f;return"string"==typeof b&&(f=a[b],b=a,a=f),m.isFunction(a)?(c=d.call(arguments,2),e=function(){return a.apply(b||this,c.concat(d.call(arguments)))},e.guid=a.guid=a.guid||m.guid++,e):void 0},now:function(){return+new Date},support:k}),m.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(a,b){h["[object "+b+"]"]=b.toLowerCase()});function r(a){var b=a.length,c=m.type(a);return"function"===c||m.isWindow(a)?!1:1===a.nodeType&&b?!0:"array"===c||0===b||"number"==typeof b&&b>0&&b-1 in a}var s=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u="sizzle"+-new Date,v=a.document,w=0,x=0,y=gb(),z=gb(),A=gb(),B=function(a,b){return a===b&&(l=!0),0},C="undefined",D=1<<31,E={}.hasOwnProperty,F=[],G=F.pop,H=F.push,I=F.push,J=F.slice,K=F.indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(this[b]===a)return b;return-1},L="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",M="[\\x20\\t\\r\\n\\f]",N="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",O=N.replace("w","w#"),P="\\["+M+"*("+N+")(?:"+M+"*([*^$|!~]?=)"+M+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+O+"))|)"+M+"*\\]",Q=":("+N+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+P+")*)|.*)\\)|)",R=new RegExp("^"+M+"+|((?:^|[^\\\\])(?:\\\\.)*)"+M+"+$","g"),S=new RegExp("^"+M+"*,"+M+"*"),T=new RegExp("^"+M+"*([>+~]|"+M+")"+M+"*"),U=new RegExp("="+M+"*([^\\]'\"]*?)"+M+"*\\]","g"),V=new RegExp(Q),W=new RegExp("^"+O+"$"),X={ID:new RegExp("^#("+N+")"),CLASS:new RegExp("^\\.("+N+")"),TAG:new RegExp("^("+N.replace("w","w*")+")"),ATTR:new RegExp("^"+P),PSEUDO:new RegExp("^"+Q),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+M+"*(even|odd|(([+-]|)(\\d*)n|)"+M+"*(?:([+-]|)"+M+"*(\\d+)|))"+M+"*\\)|)","i"),bool:new RegExp("^(?:"+L+")$","i"),needsContext:new RegExp("^"+M+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+M+"*((?:-\\d)?\\d*)"+M+"*\\)|)(?=[^-]|$)","i")},Y=/^(?:input|select|textarea|button)$/i,Z=/^h\d$/i,$=/^[^{]+\{\s*\[native \w/,_=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ab=/[+~]/,bb=/'|\\/g,cb=new RegExp("\\\\([\\da-f]{1,6}"+M+"?|("+M+")|.)","ig"),db=function(a,b,c){var d="0x"+b-65536;return d!==d||c?b:0>d?String.fromCharCode(d+65536):String.fromCharCode(d>>10|55296,1023&d|56320)};try{I.apply(F=J.call(v.childNodes),v.childNodes),F[v.childNodes.length].nodeType}catch(eb){I={apply:F.length?function(a,b){H.apply(a,J.call(b))}:function(a,b){var c=a.length,d=0;while(a[c++]=b[d++]);a.length=c-1}}}function fb(a,b,d,e){var f,h,j,k,l,o,r,s,w,x;if((b?b.ownerDocument||b:v)!==n&&m(b),b=b||n,d=d||[],!a||"string"!=typeof a)return d;if(1!==(k=b.nodeType)&&9!==k)return[];if(p&&!e){if(f=_.exec(a))if(j=f[1]){if(9===k){if(h=b.getElementById(j),!h||!h.parentNode)return d;if(h.id===j)return d.push(h),d}else if(b.ownerDocument&&(h=b.ownerDocument.getElementById(j))&&t(b,h)&&h.id===j)return d.push(h),d}else{if(f[2])return I.apply(d,b.getElementsByTagName(a)),d;if((j=f[3])&&c.getElementsByClassName&&b.getElementsByClassName)return I.apply(d,b.getElementsByClassName(j)),d}if(c.qsa&&(!q||!q.test(a))){if(s=r=u,w=b,x=9===k&&a,1===k&&"object"!==b.nodeName.toLowerCase()){o=g(a),(r=b.getAttribute("id"))?s=r.replace(bb,"\\$&"):b.setAttribute("id",s),s="[id='"+s+"'] ",l=o.length;while(l--)o[l]=s+qb(o[l]);w=ab.test(a)&&ob(b.parentNode)||b,x=o.join(",")}if(x)try{return I.apply(d,w.querySelectorAll(x)),d}catch(y){}finally{r||b.removeAttribute("id")}}}return i(a.replace(R,"$1"),b,d,e)}function gb(){var a=[];function b(c,e){return a.push(c+" ")>d.cacheLength&&delete b[a.shift()],b[c+" "]=e}return b}function hb(a){return a[u]=!0,a}function ib(a){var b=n.createElement("div");try{return!!a(b)}catch(c){return!1}finally{b.parentNode&&b.parentNode.removeChild(b),b=null}}function jb(a,b){var c=a.split("|"),e=a.length;while(e--)d.attrHandle[c[e]]=b}function kb(a,b){var c=b&&a,d=c&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||D)-(~a.sourceIndex||D);if(d)return d;if(c)while(c=c.nextSibling)if(c===b)return-1;return a?1:-1}function lb(a){return function(b){var c=b.nodeName.toLowerCase();return"input"===c&&b.type===a}}function mb(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}}function nb(a){return hb(function(b){return b=+b,hb(function(c,d){var e,f=a([],c.length,b),g=f.length;while(g--)c[e=f[g]]&&(c[e]=!(d[e]=c[e]))})})}function ob(a){return a&&typeof a.getElementsByTagName!==C&&a}c=fb.support={},f=fb.isXML=function(a){var b=a&&(a.ownerDocument||a).documentElement;return b?"HTML"!==b.nodeName:!1},m=fb.setDocument=function(a){var b,e=a?a.ownerDocument||a:v,g=e.defaultView;return e!==n&&9===e.nodeType&&e.documentElement?(n=e,o=e.documentElement,p=!f(e),g&&g!==g.top&&(g.addEventListener?g.addEventListener("unload",function(){m()},!1):g.attachEvent&&g.attachEvent("onunload",function(){m()})),c.attributes=ib(function(a){return a.className="i",!a.getAttribute("className")}),c.getElementsByTagName=ib(function(a){return a.appendChild(e.createComment("")),!a.getElementsByTagName("*").length}),c.getElementsByClassName=$.test(e.getElementsByClassName)&&ib(function(a){return a.innerHTML="<div class='a'></div><div class='a i'></div>",a.firstChild.className="i",2===a.getElementsByClassName("i").length}),c.getById=ib(function(a){return o.appendChild(a).id=u,!e.getElementsByName||!e.getElementsByName(u).length}),c.getById?(d.find.ID=function(a,b){if(typeof b.getElementById!==C&&p){var c=b.getElementById(a);return c&&c.parentNode?[c]:[]}},d.filter.ID=function(a){var b=a.replace(cb,db);return function(a){return a.getAttribute("id")===b}}):(delete d.find.ID,d.filter.ID=function(a){var b=a.replace(cb,db);return function(a){var c=typeof a.getAttributeNode!==C&&a.getAttributeNode("id");return c&&c.value===b}}),d.find.TAG=c.getElementsByTagName?function(a,b){return typeof b.getElementsByTagName!==C?b.getElementsByTagName(a):void 0}:function(a,b){var c,d=[],e=0,f=b.getElementsByTagName(a);if("*"===a){while(c=f[e++])1===c.nodeType&&d.push(c);return d}return f},d.find.CLASS=c.getElementsByClassName&&function(a,b){return typeof b.getElementsByClassName!==C&&p?b.getElementsByClassName(a):void 0},r=[],q=[],(c.qsa=$.test(e.querySelectorAll))&&(ib(function(a){a.innerHTML="<select msallowclip=''><option selected=''></option></select>",a.querySelectorAll("[msallowclip^='']").length&&q.push("[*^$]="+M+"*(?:''|\"\")"),a.querySelectorAll("[selected]").length||q.push("\\["+M+"*(?:value|"+L+")"),a.querySelectorAll(":checked").length||q.push(":checked")}),ib(function(a){var b=e.createElement("input");b.setAttribute("type","hidden"),a.appendChild(b).setAttribute("name","D"),a.querySelectorAll("[name=d]").length&&q.push("name"+M+"*[*^$|!~]?="),a.querySelectorAll(":enabled").length||q.push(":enabled",":disabled"),a.querySelectorAll("*,:x"),q.push(",.*:")})),(c.matchesSelector=$.test(s=o.matches||o.webkitMatchesSelector||o.mozMatchesSelector||o.oMatchesSelector||o.msMatchesSelector))&&ib(function(a){c.disconnectedMatch=s.call(a,"div"),s.call(a,"[s!='']:x"),r.push("!=",Q)}),q=q.length&&new RegExp(q.join("|")),r=r.length&&new RegExp(r.join("|")),b=$.test(o.compareDocumentPosition),t=b||$.test(o.contains)?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!(!d||1!==d.nodeType||!(c.contains?c.contains(d):a.compareDocumentPosition&&16&a.compareDocumentPosition(d)))}:function(a,b){if(b)while(b=b.parentNode)if(b===a)return!0;return!1},B=b?function(a,b){if(a===b)return l=!0,0;var d=!a.compareDocumentPosition-!b.compareDocumentPosition;return d?d:(d=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&d||!c.sortDetached&&b.compareDocumentPosition(a)===d?a===e||a.ownerDocument===v&&t(v,a)?-1:b===e||b.ownerDocument===v&&t(v,b)?1:k?K.call(k,a)-K.call(k,b):0:4&d?-1:1)}:function(a,b){if(a===b)return l=!0,0;var c,d=0,f=a.parentNode,g=b.parentNode,h=[a],i=[b];if(!f||!g)return a===e?-1:b===e?1:f?-1:g?1:k?K.call(k,a)-K.call(k,b):0;if(f===g)return kb(a,b);c=a;while(c=c.parentNode)h.unshift(c);c=b;while(c=c.parentNode)i.unshift(c);while(h[d]===i[d])d++;return d?kb(h[d],i[d]):h[d]===v?-1:i[d]===v?1:0},e):n},fb.matches=function(a,b){return fb(a,null,null,b)},fb.matchesSelector=function(a,b){if((a.ownerDocument||a)!==n&&m(a),b=b.replace(U,"='$1']"),!(!c.matchesSelector||!p||r&&r.test(b)||q&&q.test(b)))try{var d=s.call(a,b);if(d||c.disconnectedMatch||a.document&&11!==a.document.nodeType)return d}catch(e){}return fb(b,n,null,[a]).length>0},fb.contains=function(a,b){return(a.ownerDocument||a)!==n&&m(a),t(a,b)},fb.attr=function(a,b){(a.ownerDocument||a)!==n&&m(a);var e=d.attrHandle[b.toLowerCase()],f=e&&E.call(d.attrHandle,b.toLowerCase())?e(a,b,!p):void 0;return void 0!==f?f:c.attributes||!p?a.getAttribute(b):(f=a.getAttributeNode(b))&&f.specified?f.value:null},fb.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)},fb.uniqueSort=function(a){var b,d=[],e=0,f=0;if(l=!c.detectDuplicates,k=!c.sortStable&&a.slice(0),a.sort(B),l){while(b=a[f++])b===a[f]&&(e=d.push(f));while(e--)a.splice(d[e],1)}return k=null,a},e=fb.getText=function(a){var b,c="",d=0,f=a.nodeType;if(f){if(1===f||9===f||11===f){if("string"==typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=e(a)}else if(3===f||4===f)return a.nodeValue}else while(b=a[d++])c+=e(b);return c},d=fb.selectors={cacheLength:50,createPseudo:hb,match:X,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(cb,db),a[3]=(a[3]||a[4]||a[5]||"").replace(cb,db),"~="===a[2]&&(a[3]=" "+a[3]+" "),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),"nth"===a[1].slice(0,3)?(a[3]||fb.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*("even"===a[3]||"odd"===a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&fb.error(a[0]),a},PSEUDO:function(a){var b,c=!a[6]&&a[2];return X.CHILD.test(a[0])?null:(a[3]?a[2]=a[4]||a[5]||"":c&&V.test(c)&&(b=g(c,!0))&&(b=c.indexOf(")",c.length-b)-c.length)&&(a[0]=a[0].slice(0,b),a[2]=c.slice(0,b)),a.slice(0,3))}},filter:{TAG:function(a){var b=a.replace(cb,db).toLowerCase();return"*"===a?function(){return!0}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===b}},CLASS:function(a){var b=y[a+" "];return b||(b=new RegExp("(^|"+M+")"+a+"("+M+"|$)"))&&y(a,function(a){return b.test("string"==typeof a.className&&a.className||typeof a.getAttribute!==C&&a.getAttribute("class")||"")})},ATTR:function(a,b,c){return function(d){var e=fb.attr(d,a);return null==e?"!="===b:b?(e+="","="===b?e===c:"!="===b?e!==c:"^="===b?c&&0===e.indexOf(c):"*="===b?c&&e.indexOf(c)>-1:"$="===b?c&&e.slice(-c.length)===c:"~="===b?(" "+e+" ").indexOf(c)>-1:"|="===b?e===c||e.slice(0,c.length+1)===c+"-":!1):!0}},CHILD:function(a,b,c,d,e){var f="nth"!==a.slice(0,3),g="last"!==a.slice(-4),h="of-type"===b;return 1===d&&0===e?function(a){return!!a.parentNode}:function(b,c,i){var j,k,l,m,n,o,p=f!==g?"nextSibling":"previousSibling",q=b.parentNode,r=h&&b.nodeName.toLowerCase(),s=!i&&!h;if(q){if(f){while(p){l=b;while(l=l[p])if(h?l.nodeName.toLowerCase()===r:1===l.nodeType)return!1;o=p="only"===a&&!o&&"nextSibling"}return!0}if(o=[g?q.firstChild:q.lastChild],g&&s){k=q[u]||(q[u]={}),j=k[a]||[],n=j[0]===w&&j[1],m=j[0]===w&&j[2],l=n&&q.childNodes[n];while(l=++n&&l&&l[p]||(m=n=0)||o.pop())if(1===l.nodeType&&++m&&l===b){k[a]=[w,n,m];break}}else if(s&&(j=(b[u]||(b[u]={}))[a])&&j[0]===w)m=j[1];else while(l=++n&&l&&l[p]||(m=n=0)||o.pop())if((h?l.nodeName.toLowerCase()===r:1===l.nodeType)&&++m&&(s&&((l[u]||(l[u]={}))[a]=[w,m]),l===b))break;return m-=e,m===d||m%d===0&&m/d>=0}}},PSEUDO:function(a,b){var c,e=d.pseudos[a]||d.setFilters[a.toLowerCase()]||fb.error("unsupported pseudo: "+a);return e[u]?e(b):e.length>1?(c=[a,a,"",b],d.setFilters.hasOwnProperty(a.toLowerCase())?hb(function(a,c){var d,f=e(a,b),g=f.length;while(g--)d=K.call(a,f[g]),a[d]=!(c[d]=f[g])}):function(a){return e(a,0,c)}):e}},pseudos:{not:hb(function(a){var b=[],c=[],d=h(a.replace(R,"$1"));return d[u]?hb(function(a,b,c,e){var f,g=d(a,null,e,[]),h=a.length;while(h--)(f=g[h])&&(a[h]=!(b[h]=f))}):function(a,e,f){return b[0]=a,d(b,null,f,c),!c.pop()}}),has:hb(function(a){return function(b){return fb(a,b).length>0}}),contains:hb(function(a){return function(b){return(b.textContent||b.innerText||e(b)).indexOf(a)>-1}}),lang:hb(function(a){return W.test(a||"")||fb.error("unsupported lang: "+a),a=a.replace(cb,db).toLowerCase(),function(b){var c;do if(c=p?b.lang:b.getAttribute("xml:lang")||b.getAttribute("lang"))return c=c.toLowerCase(),c===a||0===c.indexOf(a+"-");while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(b){var c=a.location&&a.location.hash;return c&&c.slice(1)===b.id},root:function(a){return a===o},focus:function(a){return a===n.activeElement&&(!n.hasFocus||n.hasFocus())&&!!(a.type||a.href||~a.tabIndex)},enabled:function(a){return a.disabled===!1},disabled:function(a){return a.disabled===!0},checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,a.selected===!0},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if(a.nodeType<6)return!1;return!0},parent:function(a){return!d.pseudos.empty(a)},header:function(a){return Z.test(a.nodeName)},input:function(a){return Y.test(a.nodeName)},button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},text:function(a){var b;return"input"===a.nodeName.toLowerCase()&&"text"===a.type&&(null==(b=a.getAttribute("type"))||"text"===b.toLowerCase())},first:nb(function(){return[0]}),last:nb(function(a,b){return[b-1]}),eq:nb(function(a,b,c){return[0>c?c+b:c]}),even:nb(function(a,b){for(var c=0;b>c;c+=2)a.push(c);return a}),odd:nb(function(a,b){for(var c=1;b>c;c+=2)a.push(c);return a}),lt:nb(function(a,b,c){for(var d=0>c?c+b:c;--d>=0;)a.push(d);return a}),gt:nb(function(a,b,c){for(var d=0>c?c+b:c;++d<b;)a.push(d);return a})}},d.pseudos.nth=d.pseudos.eq;for(b in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})d.pseudos[b]=lb(b);for(b in{submit:!0,reset:!0})d.pseudos[b]=mb(b);function pb(){}pb.prototype=d.filters=d.pseudos,d.setFilters=new pb,g=fb.tokenize=function(a,b){var c,e,f,g,h,i,j,k=z[a+" "];if(k)return b?0:k.slice(0);h=a,i=[],j=d.preFilter;while(h){(!c||(e=S.exec(h)))&&(e&&(h=h.slice(e[0].length)||h),i.push(f=[])),c=!1,(e=T.exec(h))&&(c=e.shift(),f.push({value:c,type:e[0].replace(R," ")}),h=h.slice(c.length));for(g in d.filter)!(e=X[g].exec(h))||j[g]&&!(e=j[g](e))||(c=e.shift(),f.push({value:c,type:g,matches:e}),h=h.slice(c.length));if(!c)break}return b?h.length:h?fb.error(a):z(a,i).slice(0)};function qb(a){for(var b=0,c=a.length,d="";c>b;b++)d+=a[b].value;return d}function rb(a,b,c){var d=b.dir,e=c&&"parentNode"===d,f=x++;return b.first?function(b,c,f){while(b=b[d])if(1===b.nodeType||e)return a(b,c,f)}:function(b,c,g){var h,i,j=[w,f];if(g){while(b=b[d])if((1===b.nodeType||e)&&a(b,c,g))return!0}else while(b=b[d])if(1===b.nodeType||e){if(i=b[u]||(b[u]={}),(h=i[d])&&h[0]===w&&h[1]===f)return j[2]=h[2];if(i[d]=j,j[2]=a(b,c,g))return!0}}}function sb(a){return a.length>1?function(b,c,d){var e=a.length;while(e--)if(!a[e](b,c,d))return!1;return!0}:a[0]}function tb(a,b,c){for(var d=0,e=b.length;e>d;d++)fb(a,b[d],c);return c}function ub(a,b,c,d,e){for(var f,g=[],h=0,i=a.length,j=null!=b;i>h;h++)(f=a[h])&&(!c||c(f,d,e))&&(g.push(f),j&&b.push(h));return g}function vb(a,b,c,d,e,f){return d&&!d[u]&&(d=vb(d)),e&&!e[u]&&(e=vb(e,f)),hb(function(f,g,h,i){var j,k,l,m=[],n=[],o=g.length,p=f||tb(b||"*",h.nodeType?[h]:h,[]),q=!a||!f&&b?p:ub(p,m,a,h,i),r=c?e||(f?a:o||d)?[]:g:q;if(c&&c(q,r,h,i),d){j=ub(r,n),d(j,[],h,i),k=j.length;while(k--)(l=j[k])&&(r[n[k]]=!(q[n[k]]=l))}if(f){if(e||a){if(e){j=[],k=r.length;while(k--)(l=r[k])&&j.push(q[k]=l);e(null,r=[],j,i)}k=r.length;while(k--)(l=r[k])&&(j=e?K.call(f,l):m[k])>-1&&(f[j]=!(g[j]=l))}}else r=ub(r===g?r.splice(o,r.length):r),e?e(null,g,r,i):I.apply(g,r)})}function wb(a){for(var b,c,e,f=a.length,g=d.relative[a[0].type],h=g||d.relative[" "],i=g?1:0,k=rb(function(a){return a===b},h,!0),l=rb(function(a){return K.call(b,a)>-1},h,!0),m=[function(a,c,d){return!g&&(d||c!==j)||((b=c).nodeType?k(a,c,d):l(a,c,d))}];f>i;i++)if(c=d.relative[a[i].type])m=[rb(sb(m),c)];else{if(c=d.filter[a[i].type].apply(null,a[i].matches),c[u]){for(e=++i;f>e;e++)if(d.relative[a[e].type])break;return vb(i>1&&sb(m),i>1&&qb(a.slice(0,i-1).concat({value:" "===a[i-2].type?"*":""})).replace(R,"$1"),c,e>i&&wb(a.slice(i,e)),f>e&&wb(a=a.slice(e)),f>e&&qb(a))}m.push(c)}return sb(m)}function xb(a,b){var c=b.length>0,e=a.length>0,f=function(f,g,h,i,k){var l,m,o,p=0,q="0",r=f&&[],s=[],t=j,u=f||e&&d.find.TAG("*",k),v=w+=null==t?1:Math.random()||.1,x=u.length;for(k&&(j=g!==n&&g);q!==x&&null!=(l=u[q]);q++){if(e&&l){m=0;while(o=a[m++])if(o(l,g,h)){i.push(l);break}k&&(w=v)}c&&((l=!o&&l)&&p--,f&&r.push(l))}if(p+=q,c&&q!==p){m=0;while(o=b[m++])o(r,s,g,h);if(f){if(p>0)while(q--)r[q]||s[q]||(s[q]=G.call(i));s=ub(s)}I.apply(i,s),k&&!f&&s.length>0&&p+b.length>1&&fb.uniqueSort(i)}return k&&(w=v,j=t),r};return c?hb(f):f}return h=fb.compile=function(a,b){var c,d=[],e=[],f=A[a+" "];if(!f){b||(b=g(a)),c=b.length;while(c--)f=wb(b[c]),f[u]?d.push(f):e.push(f);f=A(a,xb(e,d)),f.selector=a}return f},i=fb.select=function(a,b,e,f){var i,j,k,l,m,n="function"==typeof a&&a,o=!f&&g(a=n.selector||a);if(e=e||[],1===o.length){if(j=o[0]=o[0].slice(0),j.length>2&&"ID"===(k=j[0]).type&&c.getById&&9===b.nodeType&&p&&d.relative[j[1].type]){if(b=(d.find.ID(k.matches[0].replace(cb,db),b)||[])[0],!b)return e;n&&(b=b.parentNode),a=a.slice(j.shift().value.length)}i=X.needsContext.test(a)?0:j.length;while(i--){if(k=j[i],d.relative[l=k.type])break;if((m=d.find[l])&&(f=m(k.matches[0].replace(cb,db),ab.test(j[0].type)&&ob(b.parentNode)||b))){if(j.splice(i,1),a=f.length&&qb(j),!a)return I.apply(e,f),e;break}}}return(n||h(a,o))(f,b,!p,e,ab.test(a)&&ob(b.parentNode)||b),e},c.sortStable=u.split("").sort(B).join("")===u,c.detectDuplicates=!!l,m(),c.sortDetached=ib(function(a){return 1&a.compareDocumentPosition(n.createElement("div"))}),ib(function(a){return a.innerHTML="<a href='#'></a>","#"===a.firstChild.getAttribute("href")})||jb("type|href|height|width",function(a,b,c){return c?void 0:a.getAttribute(b,"type"===b.toLowerCase()?1:2)}),c.attributes&&ib(function(a){return a.innerHTML="<input/>",a.firstChild.setAttribute("value",""),""===a.firstChild.getAttribute("value")})||jb("value",function(a,b,c){return c||"input"!==a.nodeName.toLowerCase()?void 0:a.defaultValue}),ib(function(a){return null==a.getAttribute("disabled")})||jb(L,function(a,b,c){var d;return c?void 0:a[b]===!0?b.toLowerCase():(d=a.getAttributeNode(b))&&d.specified?d.value:null}),fb}(a);m.find=s,m.expr=s.selectors,m.expr[":"]=m.expr.pseudos,m.unique=s.uniqueSort,m.text=s.getText,m.isXMLDoc=s.isXML,m.contains=s.contains;var t=m.expr.match.needsContext,u=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,v=/^.[^:#\[\.,]*$/;function w(a,b,c){if(m.isFunction(b))return m.grep(a,function(a,d){return!!b.call(a,d,a)!==c});if(b.nodeType)return m.grep(a,function(a){return a===b!==c});if("string"==typeof b){if(v.test(b))return m.filter(b,a,c);b=m.filter(b,a)}return m.grep(a,function(a){return m.inArray(a,b)>=0!==c})}m.filter=function(a,b,c){var d=b[0];return c&&(a=":not("+a+")"),1===b.length&&1===d.nodeType?m.find.matchesSelector(d,a)?[d]:[]:m.find.matches(a,m.grep(b,function(a){return 1===a.nodeType}))},m.fn.extend({find:function(a){var b,c=[],d=this,e=d.length;if("string"!=typeof a)return this.pushStack(m(a).filter(function(){for(b=0;e>b;b++)if(m.contains(d[b],this))return!0}));for(b=0;e>b;b++)m.find(a,d[b],c);return c=this.pushStack(e>1?m.unique(c):c),c.selector=this.selector?this.selector+" "+a:a,c},filter:function(a){return this.pushStack(w(this,a||[],!1))},not:function(a){return this.pushStack(w(this,a||[],!0))},is:function(a){return!!w(this,"string"==typeof a&&t.test(a)?m(a):a||[],!1).length}});var x,y=a.document,z=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,A=m.fn.init=function(a,b){var c,d;if(!a)return this;if("string"==typeof a){if(c="<"===a.charAt(0)&&">"===a.charAt(a.length-1)&&a.length>=3?[null,a,null]:z.exec(a),!c||!c[1]&&b)return!b||b.jquery?(b||x).find(a):this.constructor(b).find(a);if(c[1]){if(b=b instanceof m?b[0]:b,m.merge(this,m.parseHTML(c[1],b&&b.nodeType?b.ownerDocument||b:y,!0)),u.test(c[1])&&m.isPlainObject(b))for(c in b)m.isFunction(this[c])?this[c](b[c]):this.attr(c,b[c]);return this}if(d=y.getElementById(c[2]),d&&d.parentNode){if(d.id!==c[2])return x.find(a);this.length=1,this[0]=d}return this.context=y,this.selector=a,this}return a.nodeType?(this.context=this[0]=a,this.length=1,this):m.isFunction(a)?"undefined"!=typeof x.ready?x.ready(a):a(m):(void 0!==a.selector&&(this.selector=a.selector,this.context=a.context),m.makeArray(a,this))};A.prototype=m.fn,x=m(y);var B=/^(?:parents|prev(?:Until|All))/,C={children:!0,contents:!0,next:!0,prev:!0};m.extend({dir:function(a,b,c){var d=[],e=a[b];while(e&&9!==e.nodeType&&(void 0===c||1!==e.nodeType||!m(e).is(c)))1===e.nodeType&&d.push(e),e=e[b];return d},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c}}),m.fn.extend({has:function(a){var b,c=m(a,this),d=c.length;return this.filter(function(){for(b=0;d>b;b++)if(m.contains(this,c[b]))return!0})},closest:function(a,b){for(var c,d=0,e=this.length,f=[],g=t.test(a)||"string"!=typeof a?m(a,b||this.context):0;e>d;d++)for(c=this[d];c&&c!==b;c=c.parentNode)if(c.nodeType<11&&(g?g.index(c)>-1:1===c.nodeType&&m.find.matchesSelector(c,a))){f.push(c);break}return this.pushStack(f.length>1?m.unique(f):f)},index:function(a){return a?"string"==typeof a?m.inArray(this[0],m(a)):m.inArray(a.jquery?a[0]:a,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(a,b){return this.pushStack(m.unique(m.merge(this.get(),m(a,b))))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}});function D(a,b){do a=a[b];while(a&&1!==a.nodeType);return a}m.each({parent:function(a){var b=a.parentNode;return b&&11!==b.nodeType?b:null},parents:function(a){return m.dir(a,"parentNode")},parentsUntil:function(a,b,c){return m.dir(a,"parentNode",c)},next:function(a){return D(a,"nextSibling")},prev:function(a){return D(a,"previousSibling")},nextAll:function(a){return m.dir(a,"nextSibling")},prevAll:function(a){return m.dir(a,"previousSibling")},nextUntil:function(a,b,c){return m.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return m.dir(a,"previousSibling",c)},siblings:function(a){return m.sibling((a.parentNode||{}).firstChild,a)},children:function(a){return m.sibling(a.firstChild)},contents:function(a){return m.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:m.merge([],a.childNodes)}},function(a,b){m.fn[a]=function(c,d){var e=m.map(this,b,c);return"Until"!==a.slice(-5)&&(d=c),d&&"string"==typeof d&&(e=m.filter(d,e)),this.length>1&&(C[a]||(e=m.unique(e)),B.test(a)&&(e=e.reverse())),this.pushStack(e)}});var E=/\S+/g,F={};function G(a){var b=F[a]={};return m.each(a.match(E)||[],function(a,c){b[c]=!0}),b}m.Callbacks=function(a){a="string"==typeof a?F[a]||G(a):m.extend({},a);var b,c,d,e,f,g,h=[],i=!a.once&&[],j=function(l){for(c=a.memory&&l,d=!0,f=g||0,g=0,e=h.length,b=!0;h&&e>f;f++)if(h[f].apply(l[0],l[1])===!1&&a.stopOnFalse){c=!1;break}b=!1,h&&(i?i.length&&j(i.shift()):c?h=[]:k.disable())},k={add:function(){if(h){var d=h.length;!function f(b){m.each(b,function(b,c){var d=m.type(c);"function"===d?a.unique&&k.has(c)||h.push(c):c&&c.length&&"string"!==d&&f(c)})}(arguments),b?e=h.length:c&&(g=d,j(c))}return this},remove:function(){return h&&m.each(arguments,function(a,c){var d;while((d=m.inArray(c,h,d))>-1)h.splice(d,1),b&&(e>=d&&e--,f>=d&&f--)}),this},has:function(a){return a?m.inArray(a,h)>-1:!(!h||!h.length)},empty:function(){return h=[],e=0,this},disable:function(){return h=i=c=void 0,this},disabled:function(){return!h},lock:function(){return i=void 0,c||k.disable(),this},locked:function(){return!i},fireWith:function(a,c){return!h||d&&!i||(c=c||[],c=[a,c.slice?c.slice():c],b?i.push(c):j(c)),this},fire:function(){return k.fireWith(this,arguments),this},fired:function(){return!!d}};return k},m.extend({Deferred:function(a){var b=[["resolve","done",m.Callbacks("once memory"),"resolved"],["reject","fail",m.Callbacks("once memory"),"rejected"],["notify","progress",m.Callbacks("memory")]],c="pending",d={state:function(){return c},always:function(){return e.done(arguments).fail(arguments),this},then:function(){var a=arguments;return m.Deferred(function(c){m.each(b,function(b,f){var g=m.isFunction(a[b])&&a[b];e[f[1]](function(){var a=g&&g.apply(this,arguments);a&&m.isFunction(a.promise)?a.promise().done(c.resolve).fail(c.reject).progress(c.notify):c[f[0]+"With"](this===d?c.promise():this,g?[a]:arguments)})}),a=null}).promise()},promise:function(a){return null!=a?m.extend(a,d):d}},e={};return d.pipe=d.then,m.each(b,function(a,f){var g=f[2],h=f[3];d[f[1]]=g.add,h&&g.add(function(){c=h},b[1^a][2].disable,b[2][2].lock),e[f[0]]=function(){return e[f[0]+"With"](this===e?d:this,arguments),this},e[f[0]+"With"]=g.fireWith}),d.promise(e),a&&a.call(e,e),e},when:function(a){var b=0,c=d.call(arguments),e=c.length,f=1!==e||a&&m.isFunction(a.promise)?e:0,g=1===f?a:m.Deferred(),h=function(a,b,c){return function(e){b[a]=this,c[a]=arguments.length>1?d.call(arguments):e,c===i?g.notifyWith(b,c):--f||g.resolveWith(b,c)}},i,j,k;if(e>1)for(i=new Array(e),j=new Array(e),k=new Array(e);e>b;b++)c[b]&&m.isFunction(c[b].promise)?c[b].promise().done(h(b,k,c)).fail(g.reject).progress(h(b,j,i)):--f;return f||g.resolveWith(k,c),g.promise()}});var H;m.fn.ready=function(a){return m.ready.promise().done(a),this},m.extend({isReady:!1,readyWait:1,holdReady:function(a){a?m.readyWait++:m.ready(!0)},ready:function(a){if(a===!0?!--m.readyWait:!m.isReady){if(!y.body)return setTimeout(m.ready);m.isReady=!0,a!==!0&&--m.readyWait>0||(H.resolveWith(y,[m]),m.fn.triggerHandler&&(m(y).triggerHandler("ready"),m(y).off("ready")))}}});function I(){y.addEventListener?(y.removeEventListener("DOMContentLoaded",J,!1),a.removeEventListener("load",J,!1)):(y.detachEvent("onreadystatechange",J),a.detachEvent("onload",J))}function J(){(y.addEventListener||"load"===event.type||"complete"===y.readyState)&&(I(),m.ready())}m.ready.promise=function(b){if(!H)if(H=m.Deferred(),"complete"===y.readyState)setTimeout(m.ready);else if(y.addEventListener)y.addEventListener("DOMContentLoaded",J,!1),a.addEventListener("load",J,!1);else{y.attachEvent("onreadystatechange",J),a.attachEvent("onload",J);var c=!1;try{c=null==a.frameElement&&y.documentElement}catch(d){}c&&c.doScroll&&!function e(){if(!m.isReady){try{c.doScroll("left")}catch(a){return setTimeout(e,50)}I(),m.ready()}}()}return H.promise(b)};var K="undefined",L;for(L in m(k))break;k.ownLast="0"!==L,k.inlineBlockNeedsLayout=!1,m(function(){var a,b,c,d;c=y.getElementsByTagName("body")[0],c&&c.style&&(b=y.createElement("div"),d=y.createElement("div"),d.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",c.appendChild(d).appendChild(b),typeof b.style.zoom!==K&&(b.style.cssText="display:inline;margin:0;border:0;padding:1px;width:1px;zoom:1",k.inlineBlockNeedsLayout=a=3===b.offsetWidth,a&&(c.style.zoom=1)),c.removeChild(d))}),function(){var a=y.createElement("div");if(null==k.deleteExpando){k.deleteExpando=!0;try{delete a.test}catch(b){k.deleteExpando=!1}}a=null}(),m.acceptData=function(a){var b=m.noData[(a.nodeName+" ").toLowerCase()],c=+a.nodeType||1;return 1!==c&&9!==c?!1:!b||b!==!0&&a.getAttribute("classid")===b};var M=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,N=/([A-Z])/g;function O(a,b,c){if(void 0===c&&1===a.nodeType){var d="data-"+b.replace(N,"-$1").toLowerCase();if(c=a.getAttribute(d),"string"==typeof c){try{c="true"===c?!0:"false"===c?!1:"null"===c?null:+c+""===c?+c:M.test(c)?m.parseJSON(c):c}catch(e){}m.data(a,b,c)}else c=void 0}return c}function P(a){var b;for(b in a)if(("data"!==b||!m.isEmptyObject(a[b]))&&"toJSON"!==b)return!1;return!0}function Q(a,b,d,e){if(m.acceptData(a)){var f,g,h=m.expando,i=a.nodeType,j=i?m.cache:a,k=i?a[h]:a[h]&&h;
if(k&&j[k]&&(e||j[k].data)||void 0!==d||"string"!=typeof b)return k||(k=i?a[h]=c.pop()||m.guid++:h),j[k]||(j[k]=i?{}:{toJSON:m.noop}),("object"==typeof b||"function"==typeof b)&&(e?j[k]=m.extend(j[k],b):j[k].data=m.extend(j[k].data,b)),g=j[k],e||(g.data||(g.data={}),g=g.data),void 0!==d&&(g[m.camelCase(b)]=d),"string"==typeof b?(f=g[b],null==f&&(f=g[m.camelCase(b)])):f=g,f}}function R(a,b,c){if(m.acceptData(a)){var d,e,f=a.nodeType,g=f?m.cache:a,h=f?a[m.expando]:m.expando;if(g[h]){if(b&&(d=c?g[h]:g[h].data)){m.isArray(b)?b=b.concat(m.map(b,m.camelCase)):b in d?b=[b]:(b=m.camelCase(b),b=b in d?[b]:b.split(" ")),e=b.length;while(e--)delete d[b[e]];if(c?!P(d):!m.isEmptyObject(d))return}(c||(delete g[h].data,P(g[h])))&&(f?m.cleanData([a],!0):k.deleteExpando||g!=g.window?delete g[h]:g[h]=null)}}}m.extend({cache:{},noData:{"applet ":!0,"embed ":!0,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(a){return a=a.nodeType?m.cache[a[m.expando]]:a[m.expando],!!a&&!P(a)},data:function(a,b,c){return Q(a,b,c)},removeData:function(a,b){return R(a,b)},_data:function(a,b,c){return Q(a,b,c,!0)},_removeData:function(a,b){return R(a,b,!0)}}),m.fn.extend({data:function(a,b){var c,d,e,f=this[0],g=f&&f.attributes;if(void 0===a){if(this.length&&(e=m.data(f),1===f.nodeType&&!m._data(f,"parsedAttrs"))){c=g.length;while(c--)g[c]&&(d=g[c].name,0===d.indexOf("data-")&&(d=m.camelCase(d.slice(5)),O(f,d,e[d])));m._data(f,"parsedAttrs",!0)}return e}return"object"==typeof a?this.each(function(){m.data(this,a)}):arguments.length>1?this.each(function(){m.data(this,a,b)}):f?O(f,a,m.data(f,a)):void 0},removeData:function(a){return this.each(function(){m.removeData(this,a)})}}),m.extend({queue:function(a,b,c){var d;return a?(b=(b||"fx")+"queue",d=m._data(a,b),c&&(!d||m.isArray(c)?d=m._data(a,b,m.makeArray(c)):d.push(c)),d||[]):void 0},dequeue:function(a,b){b=b||"fx";var c=m.queue(a,b),d=c.length,e=c.shift(),f=m._queueHooks(a,b),g=function(){m.dequeue(a,b)};"inprogress"===e&&(e=c.shift(),d--),e&&("fx"===b&&c.unshift("inprogress"),delete f.stop,e.call(a,g,f)),!d&&f&&f.empty.fire()},_queueHooks:function(a,b){var c=b+"queueHooks";return m._data(a,c)||m._data(a,c,{empty:m.Callbacks("once memory").add(function(){m._removeData(a,b+"queue"),m._removeData(a,c)})})}}),m.fn.extend({queue:function(a,b){var c=2;return"string"!=typeof a&&(b=a,a="fx",c--),arguments.length<c?m.queue(this[0],a):void 0===b?this:this.each(function(){var c=m.queue(this,a,b);m._queueHooks(this,a),"fx"===a&&"inprogress"!==c[0]&&m.dequeue(this,a)})},dequeue:function(a){return this.each(function(){m.dequeue(this,a)})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,b){var c,d=1,e=m.Deferred(),f=this,g=this.length,h=function(){--d||e.resolveWith(f,[f])};"string"!=typeof a&&(b=a,a=void 0),a=a||"fx";while(g--)c=m._data(f[g],a+"queueHooks"),c&&c.empty&&(d++,c.empty.add(h));return h(),e.promise(b)}});var S=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,T=["Top","Right","Bottom","Left"],U=function(a,b){return a=b||a,"none"===m.css(a,"display")||!m.contains(a.ownerDocument,a)},V=m.access=function(a,b,c,d,e,f,g){var h=0,i=a.length,j=null==c;if("object"===m.type(c)){e=!0;for(h in c)m.access(a,b,h,c[h],!0,f,g)}else if(void 0!==d&&(e=!0,m.isFunction(d)||(g=!0),j&&(g?(b.call(a,d),b=null):(j=b,b=function(a,b,c){return j.call(m(a),c)})),b))for(;i>h;h++)b(a[h],c,g?d:d.call(a[h],h,b(a[h],c)));return e?a:j?b.call(a):i?b(a[0],c):f},W=/^(?:checkbox|radio)$/i;!function(){var a=y.createElement("input"),b=y.createElement("div"),c=y.createDocumentFragment();if(b.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",k.leadingWhitespace=3===b.firstChild.nodeType,k.tbody=!b.getElementsByTagName("tbody").length,k.htmlSerialize=!!b.getElementsByTagName("link").length,k.html5Clone="<:nav></:nav>"!==y.createElement("nav").cloneNode(!0).outerHTML,a.type="checkbox",a.checked=!0,c.appendChild(a),k.appendChecked=a.checked,b.innerHTML="<textarea>x</textarea>",k.noCloneChecked=!!b.cloneNode(!0).lastChild.defaultValue,c.appendChild(b),b.innerHTML="<input type='radio' checked='checked' name='t'/>",k.checkClone=b.cloneNode(!0).cloneNode(!0).lastChild.checked,k.noCloneEvent=!0,b.attachEvent&&(b.attachEvent("onclick",function(){k.noCloneEvent=!1}),b.cloneNode(!0).click()),null==k.deleteExpando){k.deleteExpando=!0;try{delete b.test}catch(d){k.deleteExpando=!1}}}(),function(){var b,c,d=y.createElement("div");for(b in{submit:!0,change:!0,focusin:!0})c="on"+b,(k[b+"Bubbles"]=c in a)||(d.setAttribute(c,"t"),k[b+"Bubbles"]=d.attributes[c].expando===!1);d=null}();var X=/^(?:input|select|textarea)$/i,Y=/^key/,Z=/^(?:mouse|pointer|contextmenu)|click/,$=/^(?:focusinfocus|focusoutblur)$/,_=/^([^.]*)(?:\.(.+)|)$/;function ab(){return!0}function bb(){return!1}function cb(){try{return y.activeElement}catch(a){}}m.event={global:{},add:function(a,b,c,d,e){var f,g,h,i,j,k,l,n,o,p,q,r=m._data(a);if(r){c.handler&&(i=c,c=i.handler,e=i.selector),c.guid||(c.guid=m.guid++),(g=r.events)||(g=r.events={}),(k=r.handle)||(k=r.handle=function(a){return typeof m===K||a&&m.event.triggered===a.type?void 0:m.event.dispatch.apply(k.elem,arguments)},k.elem=a),b=(b||"").match(E)||[""],h=b.length;while(h--)f=_.exec(b[h])||[],o=q=f[1],p=(f[2]||"").split(".").sort(),o&&(j=m.event.special[o]||{},o=(e?j.delegateType:j.bindType)||o,j=m.event.special[o]||{},l=m.extend({type:o,origType:q,data:d,handler:c,guid:c.guid,selector:e,needsContext:e&&m.expr.match.needsContext.test(e),namespace:p.join(".")},i),(n=g[o])||(n=g[o]=[],n.delegateCount=0,j.setup&&j.setup.call(a,d,p,k)!==!1||(a.addEventListener?a.addEventListener(o,k,!1):a.attachEvent&&a.attachEvent("on"+o,k))),j.add&&(j.add.call(a,l),l.handler.guid||(l.handler.guid=c.guid)),e?n.splice(n.delegateCount++,0,l):n.push(l),m.event.global[o]=!0);a=null}},remove:function(a,b,c,d,e){var f,g,h,i,j,k,l,n,o,p,q,r=m.hasData(a)&&m._data(a);if(r&&(k=r.events)){b=(b||"").match(E)||[""],j=b.length;while(j--)if(h=_.exec(b[j])||[],o=q=h[1],p=(h[2]||"").split(".").sort(),o){l=m.event.special[o]||{},o=(d?l.delegateType:l.bindType)||o,n=k[o]||[],h=h[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),i=f=n.length;while(f--)g=n[f],!e&&q!==g.origType||c&&c.guid!==g.guid||h&&!h.test(g.namespace)||d&&d!==g.selector&&("**"!==d||!g.selector)||(n.splice(f,1),g.selector&&n.delegateCount--,l.remove&&l.remove.call(a,g));i&&!n.length&&(l.teardown&&l.teardown.call(a,p,r.handle)!==!1||m.removeEvent(a,o,r.handle),delete k[o])}else for(o in k)m.event.remove(a,o+b[j],c,d,!0);m.isEmptyObject(k)&&(delete r.handle,m._removeData(a,"events"))}},trigger:function(b,c,d,e){var f,g,h,i,k,l,n,o=[d||y],p=j.call(b,"type")?b.type:b,q=j.call(b,"namespace")?b.namespace.split("."):[];if(h=l=d=d||y,3!==d.nodeType&&8!==d.nodeType&&!$.test(p+m.event.triggered)&&(p.indexOf(".")>=0&&(q=p.split("."),p=q.shift(),q.sort()),g=p.indexOf(":")<0&&"on"+p,b=b[m.expando]?b:new m.Event(p,"object"==typeof b&&b),b.isTrigger=e?2:3,b.namespace=q.join("."),b.namespace_re=b.namespace?new RegExp("(^|\\.)"+q.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,b.result=void 0,b.target||(b.target=d),c=null==c?[b]:m.makeArray(c,[b]),k=m.event.special[p]||{},e||!k.trigger||k.trigger.apply(d,c)!==!1)){if(!e&&!k.noBubble&&!m.isWindow(d)){for(i=k.delegateType||p,$.test(i+p)||(h=h.parentNode);h;h=h.parentNode)o.push(h),l=h;l===(d.ownerDocument||y)&&o.push(l.defaultView||l.parentWindow||a)}n=0;while((h=o[n++])&&!b.isPropagationStopped())b.type=n>1?i:k.bindType||p,f=(m._data(h,"events")||{})[b.type]&&m._data(h,"handle"),f&&f.apply(h,c),f=g&&h[g],f&&f.apply&&m.acceptData(h)&&(b.result=f.apply(h,c),b.result===!1&&b.preventDefault());if(b.type=p,!e&&!b.isDefaultPrevented()&&(!k._default||k._default.apply(o.pop(),c)===!1)&&m.acceptData(d)&&g&&d[p]&&!m.isWindow(d)){l=d[g],l&&(d[g]=null),m.event.triggered=p;try{d[p]()}catch(r){}m.event.triggered=void 0,l&&(d[g]=l)}return b.result}},dispatch:function(a){a=m.event.fix(a);var b,c,e,f,g,h=[],i=d.call(arguments),j=(m._data(this,"events")||{})[a.type]||[],k=m.event.special[a.type]||{};if(i[0]=a,a.delegateTarget=this,!k.preDispatch||k.preDispatch.call(this,a)!==!1){h=m.event.handlers.call(this,a,j),b=0;while((f=h[b++])&&!a.isPropagationStopped()){a.currentTarget=f.elem,g=0;while((e=f.handlers[g++])&&!a.isImmediatePropagationStopped())(!a.namespace_re||a.namespace_re.test(e.namespace))&&(a.handleObj=e,a.data=e.data,c=((m.event.special[e.origType]||{}).handle||e.handler).apply(f.elem,i),void 0!==c&&(a.result=c)===!1&&(a.preventDefault(),a.stopPropagation()))}return k.postDispatch&&k.postDispatch.call(this,a),a.result}},handlers:function(a,b){var c,d,e,f,g=[],h=b.delegateCount,i=a.target;if(h&&i.nodeType&&(!a.button||"click"!==a.type))for(;i!=this;i=i.parentNode||this)if(1===i.nodeType&&(i.disabled!==!0||"click"!==a.type)){for(e=[],f=0;h>f;f++)d=b[f],c=d.selector+" ",void 0===e[c]&&(e[c]=d.needsContext?m(c,this).index(i)>=0:m.find(c,this,null,[i]).length),e[c]&&e.push(d);e.length&&g.push({elem:i,handlers:e})}return h<b.length&&g.push({elem:this,handlers:b.slice(h)}),g},fix:function(a){if(a[m.expando])return a;var b,c,d,e=a.type,f=a,g=this.fixHooks[e];g||(this.fixHooks[e]=g=Z.test(e)?this.mouseHooks:Y.test(e)?this.keyHooks:{}),d=g.props?this.props.concat(g.props):this.props,a=new m.Event(f),b=d.length;while(b--)c=d[b],a[c]=f[c];return a.target||(a.target=f.srcElement||y),3===a.target.nodeType&&(a.target=a.target.parentNode),a.metaKey=!!a.metaKey,g.filter?g.filter(a,f):a},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){return null==a.which&&(a.which=null!=b.charCode?b.charCode:b.keyCode),a}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,b){var c,d,e,f=b.button,g=b.fromElement;return null==a.pageX&&null!=b.clientX&&(d=a.target.ownerDocument||y,e=d.documentElement,c=d.body,a.pageX=b.clientX+(e&&e.scrollLeft||c&&c.scrollLeft||0)-(e&&e.clientLeft||c&&c.clientLeft||0),a.pageY=b.clientY+(e&&e.scrollTop||c&&c.scrollTop||0)-(e&&e.clientTop||c&&c.clientTop||0)),!a.relatedTarget&&g&&(a.relatedTarget=g===a.target?b.toElement:g),a.which||void 0===f||(a.which=1&f?1:2&f?3:4&f?2:0),a}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==cb()&&this.focus)try{return this.focus(),!1}catch(a){}},delegateType:"focusin"},blur:{trigger:function(){return this===cb()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return m.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):void 0},_default:function(a){return m.nodeName(a.target,"a")}},beforeunload:{postDispatch:function(a){void 0!==a.result&&a.originalEvent&&(a.originalEvent.returnValue=a.result)}}},simulate:function(a,b,c,d){var e=m.extend(new m.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?m.event.trigger(e,null,b):m.event.dispatch.call(b,e),e.isDefaultPrevented()&&c.preventDefault()}},m.removeEvent=y.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)}:function(a,b,c){var d="on"+b;a.detachEvent&&(typeof a[d]===K&&(a[d]=null),a.detachEvent(d,c))},m.Event=function(a,b){return this instanceof m.Event?(a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||void 0===a.defaultPrevented&&a.returnValue===!1?ab:bb):this.type=a,b&&m.extend(this,b),this.timeStamp=a&&a.timeStamp||m.now(),void(this[m.expando]=!0)):new m.Event(a,b)},m.Event.prototype={isDefaultPrevented:bb,isPropagationStopped:bb,isImmediatePropagationStopped:bb,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=ab,a&&(a.preventDefault?a.preventDefault():a.returnValue=!1)},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=ab,a&&(a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0)},stopImmediatePropagation:function(){var a=this.originalEvent;this.isImmediatePropagationStopped=ab,a&&a.stopImmediatePropagation&&a.stopImmediatePropagation(),this.stopPropagation()}},m.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(a,b){m.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,d=this,e=a.relatedTarget,f=a.handleObj;return(!e||e!==d&&!m.contains(d,e))&&(a.type=f.origType,c=f.handler.apply(this,arguments),a.type=b),c}}}),k.submitBubbles||(m.event.special.submit={setup:function(){return m.nodeName(this,"form")?!1:void m.event.add(this,"click._submit keypress._submit",function(a){var b=a.target,c=m.nodeName(b,"input")||m.nodeName(b,"button")?b.form:void 0;c&&!m._data(c,"submitBubbles")&&(m.event.add(c,"submit._submit",function(a){a._submit_bubble=!0}),m._data(c,"submitBubbles",!0))})},postDispatch:function(a){a._submit_bubble&&(delete a._submit_bubble,this.parentNode&&!a.isTrigger&&m.event.simulate("submit",this.parentNode,a,!0))},teardown:function(){return m.nodeName(this,"form")?!1:void m.event.remove(this,"._submit")}}),k.changeBubbles||(m.event.special.change={setup:function(){return X.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(m.event.add(this,"propertychange._change",function(a){"checked"===a.originalEvent.propertyName&&(this._just_changed=!0)}),m.event.add(this,"click._change",function(a){this._just_changed&&!a.isTrigger&&(this._just_changed=!1),m.event.simulate("change",this,a,!0)})),!1):void m.event.add(this,"beforeactivate._change",function(a){var b=a.target;X.test(b.nodeName)&&!m._data(b,"changeBubbles")&&(m.event.add(b,"change._change",function(a){!this.parentNode||a.isSimulated||a.isTrigger||m.event.simulate("change",this.parentNode,a,!0)}),m._data(b,"changeBubbles",!0))})},handle:function(a){var b=a.target;return this!==b||a.isSimulated||a.isTrigger||"radio"!==b.type&&"checkbox"!==b.type?a.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return m.event.remove(this,"._change"),!X.test(this.nodeName)}}),k.focusinBubbles||m.each({focus:"focusin",blur:"focusout"},function(a,b){var c=function(a){m.event.simulate(b,a.target,m.event.fix(a),!0)};m.event.special[b]={setup:function(){var d=this.ownerDocument||this,e=m._data(d,b);e||d.addEventListener(a,c,!0),m._data(d,b,(e||0)+1)},teardown:function(){var d=this.ownerDocument||this,e=m._data(d,b)-1;e?m._data(d,b,e):(d.removeEventListener(a,c,!0),m._removeData(d,b))}}}),m.fn.extend({on:function(a,b,c,d,e){var f,g;if("object"==typeof a){"string"!=typeof b&&(c=c||b,b=void 0);for(f in a)this.on(f,b,c,a[f],e);return this}if(null==c&&null==d?(d=b,c=b=void 0):null==d&&("string"==typeof b?(d=c,c=void 0):(d=c,c=b,b=void 0)),d===!1)d=bb;else if(!d)return this;return 1===e&&(g=d,d=function(a){return m().off(a),g.apply(this,arguments)},d.guid=g.guid||(g.guid=m.guid++)),this.each(function(){m.event.add(this,a,d,c,b)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(a,b,c){var d,e;if(a&&a.preventDefault&&a.handleObj)return d=a.handleObj,m(a.delegateTarget).off(d.namespace?d.origType+"."+d.namespace:d.origType,d.selector,d.handler),this;if("object"==typeof a){for(e in a)this.off(e,b,a[e]);return this}return(b===!1||"function"==typeof b)&&(c=b,b=void 0),c===!1&&(c=bb),this.each(function(){m.event.remove(this,a,c,b)})},trigger:function(a,b){return this.each(function(){m.event.trigger(a,b,this)})},triggerHandler:function(a,b){var c=this[0];return c?m.event.trigger(a,b,c,!0):void 0}});function db(a){var b=eb.split("|"),c=a.createDocumentFragment();if(c.createElement)while(b.length)c.createElement(b.pop());return c}var eb="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",fb=/ jQuery\d+="(?:null|\d+)"/g,gb=new RegExp("<(?:"+eb+")[\\s/>]","i"),hb=/^\s+/,ib=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,jb=/<([\w:]+)/,kb=/<tbody/i,lb=/<|&#?\w+;/,mb=/<(?:script|style|link)/i,nb=/checked\s*(?:[^=]|=\s*.checked.)/i,ob=/^$|\/(?:java|ecma)script/i,pb=/^true\/(.*)/,qb=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,rb={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:k.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},sb=db(y),tb=sb.appendChild(y.createElement("div"));rb.optgroup=rb.option,rb.tbody=rb.tfoot=rb.colgroup=rb.caption=rb.thead,rb.th=rb.td;function ub(a,b){var c,d,e=0,f=typeof a.getElementsByTagName!==K?a.getElementsByTagName(b||"*"):typeof a.querySelectorAll!==K?a.querySelectorAll(b||"*"):void 0;if(!f)for(f=[],c=a.childNodes||a;null!=(d=c[e]);e++)!b||m.nodeName(d,b)?f.push(d):m.merge(f,ub(d,b));return void 0===b||b&&m.nodeName(a,b)?m.merge([a],f):f}function vb(a){W.test(a.type)&&(a.defaultChecked=a.checked)}function wb(a,b){return m.nodeName(a,"table")&&m.nodeName(11!==b.nodeType?b:b.firstChild,"tr")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function xb(a){return a.type=(null!==m.find.attr(a,"type"))+"/"+a.type,a}function yb(a){var b=pb.exec(a.type);return b?a.type=b[1]:a.removeAttribute("type"),a}function zb(a,b){for(var c,d=0;null!=(c=a[d]);d++)m._data(c,"globalEval",!b||m._data(b[d],"globalEval"))}function Ab(a,b){if(1===b.nodeType&&m.hasData(a)){var c,d,e,f=m._data(a),g=m._data(b,f),h=f.events;if(h){delete g.handle,g.events={};for(c in h)for(d=0,e=h[c].length;e>d;d++)m.event.add(b,c,h[c][d])}g.data&&(g.data=m.extend({},g.data))}}function Bb(a,b){var c,d,e;if(1===b.nodeType){if(c=b.nodeName.toLowerCase(),!k.noCloneEvent&&b[m.expando]){e=m._data(b);for(d in e.events)m.removeEvent(b,d,e.handle);b.removeAttribute(m.expando)}"script"===c&&b.text!==a.text?(xb(b).text=a.text,yb(b)):"object"===c?(b.parentNode&&(b.outerHTML=a.outerHTML),k.html5Clone&&a.innerHTML&&!m.trim(b.innerHTML)&&(b.innerHTML=a.innerHTML)):"input"===c&&W.test(a.type)?(b.defaultChecked=b.checked=a.checked,b.value!==a.value&&(b.value=a.value)):"option"===c?b.defaultSelected=b.selected=a.defaultSelected:("input"===c||"textarea"===c)&&(b.defaultValue=a.defaultValue)}}m.extend({clone:function(a,b,c){var d,e,f,g,h,i=m.contains(a.ownerDocument,a);if(k.html5Clone||m.isXMLDoc(a)||!gb.test("<"+a.nodeName+">")?f=a.cloneNode(!0):(tb.innerHTML=a.outerHTML,tb.removeChild(f=tb.firstChild)),!(k.noCloneEvent&&k.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||m.isXMLDoc(a)))for(d=ub(f),h=ub(a),g=0;null!=(e=h[g]);++g)d[g]&&Bb(e,d[g]);if(b)if(c)for(h=h||ub(a),d=d||ub(f),g=0;null!=(e=h[g]);g++)Ab(e,d[g]);else Ab(a,f);return d=ub(f,"script"),d.length>0&&zb(d,!i&&ub(a,"script")),d=h=e=null,f},buildFragment:function(a,b,c,d){for(var e,f,g,h,i,j,l,n=a.length,o=db(b),p=[],q=0;n>q;q++)if(f=a[q],f||0===f)if("object"===m.type(f))m.merge(p,f.nodeType?[f]:f);else if(lb.test(f)){h=h||o.appendChild(b.createElement("div")),i=(jb.exec(f)||["",""])[1].toLowerCase(),l=rb[i]||rb._default,h.innerHTML=l[1]+f.replace(ib,"<$1></$2>")+l[2],e=l[0];while(e--)h=h.lastChild;if(!k.leadingWhitespace&&hb.test(f)&&p.push(b.createTextNode(hb.exec(f)[0])),!k.tbody){f="table"!==i||kb.test(f)?"<table>"!==l[1]||kb.test(f)?0:h:h.firstChild,e=f&&f.childNodes.length;while(e--)m.nodeName(j=f.childNodes[e],"tbody")&&!j.childNodes.length&&f.removeChild(j)}m.merge(p,h.childNodes),h.textContent="";while(h.firstChild)h.removeChild(h.firstChild);h=o.lastChild}else p.push(b.createTextNode(f));h&&o.removeChild(h),k.appendChecked||m.grep(ub(p,"input"),vb),q=0;while(f=p[q++])if((!d||-1===m.inArray(f,d))&&(g=m.contains(f.ownerDocument,f),h=ub(o.appendChild(f),"script"),g&&zb(h),c)){e=0;while(f=h[e++])ob.test(f.type||"")&&c.push(f)}return h=null,o},cleanData:function(a,b){for(var d,e,f,g,h=0,i=m.expando,j=m.cache,l=k.deleteExpando,n=m.event.special;null!=(d=a[h]);h++)if((b||m.acceptData(d))&&(f=d[i],g=f&&j[f])){if(g.events)for(e in g.events)n[e]?m.event.remove(d,e):m.removeEvent(d,e,g.handle);j[f]&&(delete j[f],l?delete d[i]:typeof d.removeAttribute!==K?d.removeAttribute(i):d[i]=null,c.push(f))}}}),m.fn.extend({text:function(a){return V(this,function(a){return void 0===a?m.text(this):this.empty().append((this[0]&&this[0].ownerDocument||y).createTextNode(a))},null,a,arguments.length)},append:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=wb(this,a);b.appendChild(a)}})},prepend:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=wb(this,a);b.insertBefore(a,b.firstChild)}})},before:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this)})},after:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling)})},remove:function(a,b){for(var c,d=a?m.filter(a,this):this,e=0;null!=(c=d[e]);e++)b||1!==c.nodeType||m.cleanData(ub(c)),c.parentNode&&(b&&m.contains(c.ownerDocument,c)&&zb(ub(c,"script")),c.parentNode.removeChild(c));return this},empty:function(){for(var a,b=0;null!=(a=this[b]);b++){1===a.nodeType&&m.cleanData(ub(a,!1));while(a.firstChild)a.removeChild(a.firstChild);a.options&&m.nodeName(a,"select")&&(a.options.length=0)}return this},clone:function(a,b){return a=null==a?!1:a,b=null==b?a:b,this.map(function(){return m.clone(this,a,b)})},html:function(a){return V(this,function(a){var b=this[0]||{},c=0,d=this.length;if(void 0===a)return 1===b.nodeType?b.innerHTML.replace(fb,""):void 0;if(!("string"!=typeof a||mb.test(a)||!k.htmlSerialize&&gb.test(a)||!k.leadingWhitespace&&hb.test(a)||rb[(jb.exec(a)||["",""])[1].toLowerCase()])){a=a.replace(ib,"<$1></$2>");try{for(;d>c;c++)b=this[c]||{},1===b.nodeType&&(m.cleanData(ub(b,!1)),b.innerHTML=a);b=0}catch(e){}}b&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(){var a=arguments[0];return this.domManip(arguments,function(b){a=this.parentNode,m.cleanData(ub(this)),a&&a.replaceChild(b,this)}),a&&(a.length||a.nodeType)?this:this.remove()},detach:function(a){return this.remove(a,!0)},domManip:function(a,b){a=e.apply([],a);var c,d,f,g,h,i,j=0,l=this.length,n=this,o=l-1,p=a[0],q=m.isFunction(p);if(q||l>1&&"string"==typeof p&&!k.checkClone&&nb.test(p))return this.each(function(c){var d=n.eq(c);q&&(a[0]=p.call(this,c,d.html())),d.domManip(a,b)});if(l&&(i=m.buildFragment(a,this[0].ownerDocument,!1,this),c=i.firstChild,1===i.childNodes.length&&(i=c),c)){for(g=m.map(ub(i,"script"),xb),f=g.length;l>j;j++)d=i,j!==o&&(d=m.clone(d,!0,!0),f&&m.merge(g,ub(d,"script"))),b.call(this[j],d,j);if(f)for(h=g[g.length-1].ownerDocument,m.map(g,yb),j=0;f>j;j++)d=g[j],ob.test(d.type||"")&&!m._data(d,"globalEval")&&m.contains(h,d)&&(d.src?m._evalUrl&&m._evalUrl(d.src):m.globalEval((d.text||d.textContent||d.innerHTML||"").replace(qb,"")));i=c=null}return this}}),m.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){m.fn[a]=function(a){for(var c,d=0,e=[],g=m(a),h=g.length-1;h>=d;d++)c=d===h?this:this.clone(!0),m(g[d])[b](c),f.apply(e,c.get());return this.pushStack(e)}});var Cb,Db={};function Eb(b,c){var d,e=m(c.createElement(b)).appendTo(c.body),f=a.getDefaultComputedStyle&&(d=a.getDefaultComputedStyle(e[0]))?d.display:m.css(e[0],"display");return e.detach(),f}function Fb(a){var b=y,c=Db[a];return c||(c=Eb(a,b),"none"!==c&&c||(Cb=(Cb||m("<iframe frameborder='0' width='0' height='0'/>")).appendTo(b.documentElement),b=(Cb[0].contentWindow||Cb[0].contentDocument).document,b.write(),b.close(),c=Eb(a,b),Cb.detach()),Db[a]=c),c}!function(){var a;k.shrinkWrapBlocks=function(){if(null!=a)return a;a=!1;var b,c,d;return c=y.getElementsByTagName("body")[0],c&&c.style?(b=y.createElement("div"),d=y.createElement("div"),d.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",c.appendChild(d).appendChild(b),typeof b.style.zoom!==K&&(b.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:1px;width:1px;zoom:1",b.appendChild(y.createElement("div")).style.width="5px",a=3!==b.offsetWidth),c.removeChild(d),a):void 0}}();var Gb=/^margin/,Hb=new RegExp("^("+S+")(?!px)[a-z%]+$","i"),Ib,Jb,Kb=/^(top|right|bottom|left)$/;a.getComputedStyle?(Ib=function(a){return a.ownerDocument.defaultView.getComputedStyle(a,null)},Jb=function(a,b,c){var d,e,f,g,h=a.style;return c=c||Ib(a),g=c?c.getPropertyValue(b)||c[b]:void 0,c&&(""!==g||m.contains(a.ownerDocument,a)||(g=m.style(a,b)),Hb.test(g)&&Gb.test(b)&&(d=h.width,e=h.minWidth,f=h.maxWidth,h.minWidth=h.maxWidth=h.width=g,g=c.width,h.width=d,h.minWidth=e,h.maxWidth=f)),void 0===g?g:g+""}):y.documentElement.currentStyle&&(Ib=function(a){return a.currentStyle},Jb=function(a,b,c){var d,e,f,g,h=a.style;return c=c||Ib(a),g=c?c[b]:void 0,null==g&&h&&h[b]&&(g=h[b]),Hb.test(g)&&!Kb.test(b)&&(d=h.left,e=a.runtimeStyle,f=e&&e.left,f&&(e.left=a.currentStyle.left),h.left="fontSize"===b?"1em":g,g=h.pixelLeft+"px",h.left=d,f&&(e.left=f)),void 0===g?g:g+""||"auto"});function Lb(a,b){return{get:function(){var c=a();if(null!=c)return c?void delete this.get:(this.get=b).apply(this,arguments)}}}!function(){var b,c,d,e,f,g,h;if(b=y.createElement("div"),b.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",d=b.getElementsByTagName("a")[0],c=d&&d.style){c.cssText="float:left;opacity:.5",k.opacity="0.5"===c.opacity,k.cssFloat=!!c.cssFloat,b.style.backgroundClip="content-box",b.cloneNode(!0).style.backgroundClip="",k.clearCloneStyle="content-box"===b.style.backgroundClip,k.boxSizing=""===c.boxSizing||""===c.MozBoxSizing||""===c.WebkitBoxSizing,m.extend(k,{reliableHiddenOffsets:function(){return null==g&&i(),g},boxSizingReliable:function(){return null==f&&i(),f},pixelPosition:function(){return null==e&&i(),e},reliableMarginRight:function(){return null==h&&i(),h}});function i(){var b,c,d,i;c=y.getElementsByTagName("body")[0],c&&c.style&&(b=y.createElement("div"),d=y.createElement("div"),d.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",c.appendChild(d).appendChild(b),b.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",e=f=!1,h=!0,a.getComputedStyle&&(e="1%"!==(a.getComputedStyle(b,null)||{}).top,f="4px"===(a.getComputedStyle(b,null)||{width:"4px"}).width,i=b.appendChild(y.createElement("div")),i.style.cssText=b.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",i.style.marginRight=i.style.width="0",b.style.width="1px",h=!parseFloat((a.getComputedStyle(i,null)||{}).marginRight)),b.innerHTML="<table><tr><td></td><td>t</td></tr></table>",i=b.getElementsByTagName("td"),i[0].style.cssText="margin:0;border:0;padding:0;display:none",g=0===i[0].offsetHeight,g&&(i[0].style.display="",i[1].style.display="none",g=0===i[0].offsetHeight),c.removeChild(d))}}}(),m.swap=function(a,b,c,d){var e,f,g={};for(f in b)g[f]=a.style[f],a.style[f]=b[f];e=c.apply(a,d||[]);for(f in b)a.style[f]=g[f];return e};var Mb=/alpha\([^)]*\)/i,Nb=/opacity\s*=\s*([^)]*)/,Ob=/^(none|table(?!-c[ea]).+)/,Pb=new RegExp("^("+S+")(.*)$","i"),Qb=new RegExp("^([+-])=("+S+")","i"),Rb={position:"absolute",visibility:"hidden",display:"block"},Sb={letterSpacing:"0",fontWeight:"400"},Tb=["Webkit","O","Moz","ms"];function Ub(a,b){if(b in a)return b;var c=b.charAt(0).toUpperCase()+b.slice(1),d=b,e=Tb.length;while(e--)if(b=Tb[e]+c,b in a)return b;return d}function Vb(a,b){for(var c,d,e,f=[],g=0,h=a.length;h>g;g++)d=a[g],d.style&&(f[g]=m._data(d,"olddisplay"),c=d.style.display,b?(f[g]||"none"!==c||(d.style.display=""),""===d.style.display&&U(d)&&(f[g]=m._data(d,"olddisplay",Fb(d.nodeName)))):(e=U(d),(c&&"none"!==c||!e)&&m._data(d,"olddisplay",e?c:m.css(d,"display"))));for(g=0;h>g;g++)d=a[g],d.style&&(b&&"none"!==d.style.display&&""!==d.style.display||(d.style.display=b?f[g]||"":"none"));return a}function Wb(a,b,c){var d=Pb.exec(b);return d?Math.max(0,d[1]-(c||0))+(d[2]||"px"):b}function Xb(a,b,c,d,e){for(var f=c===(d?"border":"content")?4:"width"===b?1:0,g=0;4>f;f+=2)"margin"===c&&(g+=m.css(a,c+T[f],!0,e)),d?("content"===c&&(g-=m.css(a,"padding"+T[f],!0,e)),"margin"!==c&&(g-=m.css(a,"border"+T[f]+"Width",!0,e))):(g+=m.css(a,"padding"+T[f],!0,e),"padding"!==c&&(g+=m.css(a,"border"+T[f]+"Width",!0,e)));return g}function Yb(a,b,c){var d=!0,e="width"===b?a.offsetWidth:a.offsetHeight,f=Ib(a),g=k.boxSizing&&"border-box"===m.css(a,"boxSizing",!1,f);if(0>=e||null==e){if(e=Jb(a,b,f),(0>e||null==e)&&(e=a.style[b]),Hb.test(e))return e;d=g&&(k.boxSizingReliable()||e===a.style[b]),e=parseFloat(e)||0}return e+Xb(a,b,c||(g?"border":"content"),d,f)+"px"}m.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=Jb(a,"opacity");return""===c?"1":c}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":k.cssFloat?"cssFloat":"styleFloat"},style:function(a,b,c,d){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var e,f,g,h=m.camelCase(b),i=a.style;if(b=m.cssProps[h]||(m.cssProps[h]=Ub(i,h)),g=m.cssHooks[b]||m.cssHooks[h],void 0===c)return g&&"get"in g&&void 0!==(e=g.get(a,!1,d))?e:i[b];if(f=typeof c,"string"===f&&(e=Qb.exec(c))&&(c=(e[1]+1)*e[2]+parseFloat(m.css(a,b)),f="number"),null!=c&&c===c&&("number"!==f||m.cssNumber[h]||(c+="px"),k.clearCloneStyle||""!==c||0!==b.indexOf("background")||(i[b]="inherit"),!(g&&"set"in g&&void 0===(c=g.set(a,c,d)))))try{i[b]=c}catch(j){}}},css:function(a,b,c,d){var e,f,g,h=m.camelCase(b);return b=m.cssProps[h]||(m.cssProps[h]=Ub(a.style,h)),g=m.cssHooks[b]||m.cssHooks[h],g&&"get"in g&&(f=g.get(a,!0,c)),void 0===f&&(f=Jb(a,b,d)),"normal"===f&&b in Sb&&(f=Sb[b]),""===c||c?(e=parseFloat(f),c===!0||m.isNumeric(e)?e||0:f):f}}),m.each(["height","width"],function(a,b){m.cssHooks[b]={get:function(a,c,d){return c?Ob.test(m.css(a,"display"))&&0===a.offsetWidth?m.swap(a,Rb,function(){return Yb(a,b,d)}):Yb(a,b,d):void 0},set:function(a,c,d){var e=d&&Ib(a);return Wb(a,c,d?Xb(a,b,d,k.boxSizing&&"border-box"===m.css(a,"boxSizing",!1,e),e):0)}}}),k.opacity||(m.cssHooks.opacity={get:function(a,b){return Nb.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":b?"1":""},set:function(a,b){var c=a.style,d=a.currentStyle,e=m.isNumeric(b)?"alpha(opacity="+100*b+")":"",f=d&&d.filter||c.filter||"";c.zoom=1,(b>=1||""===b)&&""===m.trim(f.replace(Mb,""))&&c.removeAttribute&&(c.removeAttribute("filter"),""===b||d&&!d.filter)||(c.filter=Mb.test(f)?f.replace(Mb,e):f+" "+e)}}),m.cssHooks.marginRight=Lb(k.reliableMarginRight,function(a,b){return b?m.swap(a,{display:"inline-block"},Jb,[a,"marginRight"]):void 0}),m.each({margin:"",padding:"",border:"Width"},function(a,b){m.cssHooks[a+b]={expand:function(c){for(var d=0,e={},f="string"==typeof c?c.split(" "):[c];4>d;d++)e[a+T[d]+b]=f[d]||f[d-2]||f[0];return e}},Gb.test(a)||(m.cssHooks[a+b].set=Wb)}),m.fn.extend({css:function(a,b){return V(this,function(a,b,c){var d,e,f={},g=0;if(m.isArray(b)){for(d=Ib(a),e=b.length;e>g;g++)f[b[g]]=m.css(a,b[g],!1,d);return f}return void 0!==c?m.style(a,b,c):m.css(a,b)},a,b,arguments.length>1)},show:function(){return Vb(this,!0)},hide:function(){return Vb(this)},toggle:function(a){return"boolean"==typeof a?a?this.show():this.hide():this.each(function(){U(this)?m(this).show():m(this).hide()})}});function Zb(a,b,c,d,e){return new Zb.prototype.init(a,b,c,d,e)}m.Tween=Zb,Zb.prototype={constructor:Zb,init:function(a,b,c,d,e,f){this.elem=a,this.prop=c,this.easing=e||"swing",this.options=b,this.start=this.now=this.cur(),this.end=d,this.unit=f||(m.cssNumber[c]?"":"px")
},cur:function(){var a=Zb.propHooks[this.prop];return a&&a.get?a.get(this):Zb.propHooks._default.get(this)},run:function(a){var b,c=Zb.propHooks[this.prop];return this.pos=b=this.options.duration?m.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):Zb.propHooks._default.set(this),this}},Zb.prototype.init.prototype=Zb.prototype,Zb.propHooks={_default:{get:function(a){var b;return null==a.elem[a.prop]||a.elem.style&&null!=a.elem.style[a.prop]?(b=m.css(a.elem,a.prop,""),b&&"auto"!==b?b:0):a.elem[a.prop]},set:function(a){m.fx.step[a.prop]?m.fx.step[a.prop](a):a.elem.style&&(null!=a.elem.style[m.cssProps[a.prop]]||m.cssHooks[a.prop])?m.style(a.elem,a.prop,a.now+a.unit):a.elem[a.prop]=a.now}}},Zb.propHooks.scrollTop=Zb.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}},m.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2}},m.fx=Zb.prototype.init,m.fx.step={};var $b,_b,ac=/^(?:toggle|show|hide)$/,bc=new RegExp("^(?:([+-])=|)("+S+")([a-z%]*)$","i"),cc=/queueHooks$/,dc=[ic],ec={"*":[function(a,b){var c=this.createTween(a,b),d=c.cur(),e=bc.exec(b),f=e&&e[3]||(m.cssNumber[a]?"":"px"),g=(m.cssNumber[a]||"px"!==f&&+d)&&bc.exec(m.css(c.elem,a)),h=1,i=20;if(g&&g[3]!==f){f=f||g[3],e=e||[],g=+d||1;do h=h||".5",g/=h,m.style(c.elem,a,g+f);while(h!==(h=c.cur()/d)&&1!==h&&--i)}return e&&(g=c.start=+g||+d||0,c.unit=f,c.end=e[1]?g+(e[1]+1)*e[2]:+e[2]),c}]};function fc(){return setTimeout(function(){$b=void 0}),$b=m.now()}function gc(a,b){var c,d={height:a},e=0;for(b=b?1:0;4>e;e+=2-b)c=T[e],d["margin"+c]=d["padding"+c]=a;return b&&(d.opacity=d.width=a),d}function hc(a,b,c){for(var d,e=(ec[b]||[]).concat(ec["*"]),f=0,g=e.length;g>f;f++)if(d=e[f].call(c,b,a))return d}function ic(a,b,c){var d,e,f,g,h,i,j,l,n=this,o={},p=a.style,q=a.nodeType&&U(a),r=m._data(a,"fxshow");c.queue||(h=m._queueHooks(a,"fx"),null==h.unqueued&&(h.unqueued=0,i=h.empty.fire,h.empty.fire=function(){h.unqueued||i()}),h.unqueued++,n.always(function(){n.always(function(){h.unqueued--,m.queue(a,"fx").length||h.empty.fire()})})),1===a.nodeType&&("height"in b||"width"in b)&&(c.overflow=[p.overflow,p.overflowX,p.overflowY],j=m.css(a,"display"),l="none"===j?m._data(a,"olddisplay")||Fb(a.nodeName):j,"inline"===l&&"none"===m.css(a,"float")&&(k.inlineBlockNeedsLayout&&"inline"!==Fb(a.nodeName)?p.zoom=1:p.display="inline-block")),c.overflow&&(p.overflow="hidden",k.shrinkWrapBlocks()||n.always(function(){p.overflow=c.overflow[0],p.overflowX=c.overflow[1],p.overflowY=c.overflow[2]}));for(d in b)if(e=b[d],ac.exec(e)){if(delete b[d],f=f||"toggle"===e,e===(q?"hide":"show")){if("show"!==e||!r||void 0===r[d])continue;q=!0}o[d]=r&&r[d]||m.style(a,d)}else j=void 0;if(m.isEmptyObject(o))"inline"===("none"===j?Fb(a.nodeName):j)&&(p.display=j);else{r?"hidden"in r&&(q=r.hidden):r=m._data(a,"fxshow",{}),f&&(r.hidden=!q),q?m(a).show():n.done(function(){m(a).hide()}),n.done(function(){var b;m._removeData(a,"fxshow");for(b in o)m.style(a,b,o[b])});for(d in o)g=hc(q?r[d]:0,d,n),d in r||(r[d]=g.start,q&&(g.end=g.start,g.start="width"===d||"height"===d?1:0))}}function jc(a,b){var c,d,e,f,g;for(c in a)if(d=m.camelCase(c),e=b[d],f=a[c],m.isArray(f)&&(e=f[1],f=a[c]=f[0]),c!==d&&(a[d]=f,delete a[c]),g=m.cssHooks[d],g&&"expand"in g){f=g.expand(f),delete a[d];for(c in f)c in a||(a[c]=f[c],b[c]=e)}else b[d]=e}function kc(a,b,c){var d,e,f=0,g=dc.length,h=m.Deferred().always(function(){delete i.elem}),i=function(){if(e)return!1;for(var b=$b||fc(),c=Math.max(0,j.startTime+j.duration-b),d=c/j.duration||0,f=1-d,g=0,i=j.tweens.length;i>g;g++)j.tweens[g].run(f);return h.notifyWith(a,[j,f,c]),1>f&&i?c:(h.resolveWith(a,[j]),!1)},j=h.promise({elem:a,props:m.extend({},b),opts:m.extend(!0,{specialEasing:{}},c),originalProperties:b,originalOptions:c,startTime:$b||fc(),duration:c.duration,tweens:[],createTween:function(b,c){var d=m.Tween(a,j.opts,b,c,j.opts.specialEasing[b]||j.opts.easing);return j.tweens.push(d),d},stop:function(b){var c=0,d=b?j.tweens.length:0;if(e)return this;for(e=!0;d>c;c++)j.tweens[c].run(1);return b?h.resolveWith(a,[j,b]):h.rejectWith(a,[j,b]),this}}),k=j.props;for(jc(k,j.opts.specialEasing);g>f;f++)if(d=dc[f].call(j,a,k,j.opts))return d;return m.map(k,hc,j),m.isFunction(j.opts.start)&&j.opts.start.call(a,j),m.fx.timer(m.extend(i,{elem:a,anim:j,queue:j.opts.queue})),j.progress(j.opts.progress).done(j.opts.done,j.opts.complete).fail(j.opts.fail).always(j.opts.always)}m.Animation=m.extend(kc,{tweener:function(a,b){m.isFunction(a)?(b=a,a=["*"]):a=a.split(" ");for(var c,d=0,e=a.length;e>d;d++)c=a[d],ec[c]=ec[c]||[],ec[c].unshift(b)},prefilter:function(a,b){b?dc.unshift(a):dc.push(a)}}),m.speed=function(a,b,c){var d=a&&"object"==typeof a?m.extend({},a):{complete:c||!c&&b||m.isFunction(a)&&a,duration:a,easing:c&&b||b&&!m.isFunction(b)&&b};return d.duration=m.fx.off?0:"number"==typeof d.duration?d.duration:d.duration in m.fx.speeds?m.fx.speeds[d.duration]:m.fx.speeds._default,(null==d.queue||d.queue===!0)&&(d.queue="fx"),d.old=d.complete,d.complete=function(){m.isFunction(d.old)&&d.old.call(this),d.queue&&m.dequeue(this,d.queue)},d},m.fn.extend({fadeTo:function(a,b,c,d){return this.filter(U).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=m.isEmptyObject(a),f=m.speed(b,c,d),g=function(){var b=kc(this,m.extend({},a),f);(e||m._data(this,"finish"))&&b.stop(!0)};return g.finish=g,e||f.queue===!1?this.each(g):this.queue(f.queue,g)},stop:function(a,b,c){var d=function(a){var b=a.stop;delete a.stop,b(c)};return"string"!=typeof a&&(c=b,b=a,a=void 0),b&&a!==!1&&this.queue(a||"fx",[]),this.each(function(){var b=!0,e=null!=a&&a+"queueHooks",f=m.timers,g=m._data(this);if(e)g[e]&&g[e].stop&&d(g[e]);else for(e in g)g[e]&&g[e].stop&&cc.test(e)&&d(g[e]);for(e=f.length;e--;)f[e].elem!==this||null!=a&&f[e].queue!==a||(f[e].anim.stop(c),b=!1,f.splice(e,1));(b||!c)&&m.dequeue(this,a)})},finish:function(a){return a!==!1&&(a=a||"fx"),this.each(function(){var b,c=m._data(this),d=c[a+"queue"],e=c[a+"queueHooks"],f=m.timers,g=d?d.length:0;for(c.finish=!0,m.queue(this,a,[]),e&&e.stop&&e.stop.call(this,!0),b=f.length;b--;)f[b].elem===this&&f[b].queue===a&&(f[b].anim.stop(!0),f.splice(b,1));for(b=0;g>b;b++)d[b]&&d[b].finish&&d[b].finish.call(this);delete c.finish})}}),m.each(["toggle","show","hide"],function(a,b){var c=m.fn[b];m.fn[b]=function(a,d,e){return null==a||"boolean"==typeof a?c.apply(this,arguments):this.animate(gc(b,!0),a,d,e)}}),m.each({slideDown:gc("show"),slideUp:gc("hide"),slideToggle:gc("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){m.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),m.timers=[],m.fx.tick=function(){var a,b=m.timers,c=0;for($b=m.now();c<b.length;c++)a=b[c],a()||b[c]!==a||b.splice(c--,1);b.length||m.fx.stop(),$b=void 0},m.fx.timer=function(a){m.timers.push(a),a()?m.fx.start():m.timers.pop()},m.fx.interval=13,m.fx.start=function(){_b||(_b=setInterval(m.fx.tick,m.fx.interval))},m.fx.stop=function(){clearInterval(_b),_b=null},m.fx.speeds={slow:600,fast:200,_default:400},m.fn.delay=function(a,b){return a=m.fx?m.fx.speeds[a]||a:a,b=b||"fx",this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},function(){var a,b,c,d,e;b=y.createElement("div"),b.setAttribute("className","t"),b.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",d=b.getElementsByTagName("a")[0],c=y.createElement("select"),e=c.appendChild(y.createElement("option")),a=b.getElementsByTagName("input")[0],d.style.cssText="top:1px",k.getSetAttribute="t"!==b.className,k.style=/top/.test(d.getAttribute("style")),k.hrefNormalized="/a"===d.getAttribute("href"),k.checkOn=!!a.value,k.optSelected=e.selected,k.enctype=!!y.createElement("form").enctype,c.disabled=!0,k.optDisabled=!e.disabled,a=y.createElement("input"),a.setAttribute("value",""),k.input=""===a.getAttribute("value"),a.value="t",a.setAttribute("type","radio"),k.radioValue="t"===a.value}();var lc=/\r/g;m.fn.extend({val:function(a){var b,c,d,e=this[0];{if(arguments.length)return d=m.isFunction(a),this.each(function(c){var e;1===this.nodeType&&(e=d?a.call(this,c,m(this).val()):a,null==e?e="":"number"==typeof e?e+="":m.isArray(e)&&(e=m.map(e,function(a){return null==a?"":a+""})),b=m.valHooks[this.type]||m.valHooks[this.nodeName.toLowerCase()],b&&"set"in b&&void 0!==b.set(this,e,"value")||(this.value=e))});if(e)return b=m.valHooks[e.type]||m.valHooks[e.nodeName.toLowerCase()],b&&"get"in b&&void 0!==(c=b.get(e,"value"))?c:(c=e.value,"string"==typeof c?c.replace(lc,""):null==c?"":c)}}}),m.extend({valHooks:{option:{get:function(a){var b=m.find.attr(a,"value");return null!=b?b:m.trim(m.text(a))}},select:{get:function(a){for(var b,c,d=a.options,e=a.selectedIndex,f="select-one"===a.type||0>e,g=f?null:[],h=f?e+1:d.length,i=0>e?h:f?e:0;h>i;i++)if(c=d[i],!(!c.selected&&i!==e||(k.optDisabled?c.disabled:null!==c.getAttribute("disabled"))||c.parentNode.disabled&&m.nodeName(c.parentNode,"optgroup"))){if(b=m(c).val(),f)return b;g.push(b)}return g},set:function(a,b){var c,d,e=a.options,f=m.makeArray(b),g=e.length;while(g--)if(d=e[g],m.inArray(m.valHooks.option.get(d),f)>=0)try{d.selected=c=!0}catch(h){d.scrollHeight}else d.selected=!1;return c||(a.selectedIndex=-1),e}}}}),m.each(["radio","checkbox"],function(){m.valHooks[this]={set:function(a,b){return m.isArray(b)?a.checked=m.inArray(m(a).val(),b)>=0:void 0}},k.checkOn||(m.valHooks[this].get=function(a){return null===a.getAttribute("value")?"on":a.value})});var mc,nc,oc=m.expr.attrHandle,pc=/^(?:checked|selected)$/i,qc=k.getSetAttribute,rc=k.input;m.fn.extend({attr:function(a,b){return V(this,m.attr,a,b,arguments.length>1)},removeAttr:function(a){return this.each(function(){m.removeAttr(this,a)})}}),m.extend({attr:function(a,b,c){var d,e,f=a.nodeType;if(a&&3!==f&&8!==f&&2!==f)return typeof a.getAttribute===K?m.prop(a,b,c):(1===f&&m.isXMLDoc(a)||(b=b.toLowerCase(),d=m.attrHooks[b]||(m.expr.match.bool.test(b)?nc:mc)),void 0===c?d&&"get"in d&&null!==(e=d.get(a,b))?e:(e=m.find.attr(a,b),null==e?void 0:e):null!==c?d&&"set"in d&&void 0!==(e=d.set(a,c,b))?e:(a.setAttribute(b,c+""),c):void m.removeAttr(a,b))},removeAttr:function(a,b){var c,d,e=0,f=b&&b.match(E);if(f&&1===a.nodeType)while(c=f[e++])d=m.propFix[c]||c,m.expr.match.bool.test(c)?rc&&qc||!pc.test(c)?a[d]=!1:a[m.camelCase("default-"+c)]=a[d]=!1:m.attr(a,c,""),a.removeAttribute(qc?c:d)},attrHooks:{type:{set:function(a,b){if(!k.radioValue&&"radio"===b&&m.nodeName(a,"input")){var c=a.value;return a.setAttribute("type",b),c&&(a.value=c),b}}}}}),nc={set:function(a,b,c){return b===!1?m.removeAttr(a,c):rc&&qc||!pc.test(c)?a.setAttribute(!qc&&m.propFix[c]||c,c):a[m.camelCase("default-"+c)]=a[c]=!0,c}},m.each(m.expr.match.bool.source.match(/\w+/g),function(a,b){var c=oc[b]||m.find.attr;oc[b]=rc&&qc||!pc.test(b)?function(a,b,d){var e,f;return d||(f=oc[b],oc[b]=e,e=null!=c(a,b,d)?b.toLowerCase():null,oc[b]=f),e}:function(a,b,c){return c?void 0:a[m.camelCase("default-"+b)]?b.toLowerCase():null}}),rc&&qc||(m.attrHooks.value={set:function(a,b,c){return m.nodeName(a,"input")?void(a.defaultValue=b):mc&&mc.set(a,b,c)}}),qc||(mc={set:function(a,b,c){var d=a.getAttributeNode(c);return d||a.setAttributeNode(d=a.ownerDocument.createAttribute(c)),d.value=b+="","value"===c||b===a.getAttribute(c)?b:void 0}},oc.id=oc.name=oc.coords=function(a,b,c){var d;return c?void 0:(d=a.getAttributeNode(b))&&""!==d.value?d.value:null},m.valHooks.button={get:function(a,b){var c=a.getAttributeNode(b);return c&&c.specified?c.value:void 0},set:mc.set},m.attrHooks.contenteditable={set:function(a,b,c){mc.set(a,""===b?!1:b,c)}},m.each(["width","height"],function(a,b){m.attrHooks[b]={set:function(a,c){return""===c?(a.setAttribute(b,"auto"),c):void 0}}})),k.style||(m.attrHooks.style={get:function(a){return a.style.cssText||void 0},set:function(a,b){return a.style.cssText=b+""}});var sc=/^(?:input|select|textarea|button|object)$/i,tc=/^(?:a|area)$/i;m.fn.extend({prop:function(a,b){return V(this,m.prop,a,b,arguments.length>1)},removeProp:function(a){return a=m.propFix[a]||a,this.each(function(){try{this[a]=void 0,delete this[a]}catch(b){}})}}),m.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(a,b,c){var d,e,f,g=a.nodeType;if(a&&3!==g&&8!==g&&2!==g)return f=1!==g||!m.isXMLDoc(a),f&&(b=m.propFix[b]||b,e=m.propHooks[b]),void 0!==c?e&&"set"in e&&void 0!==(d=e.set(a,c,b))?d:a[b]=c:e&&"get"in e&&null!==(d=e.get(a,b))?d:a[b]},propHooks:{tabIndex:{get:function(a){var b=m.find.attr(a,"tabindex");return b?parseInt(b,10):sc.test(a.nodeName)||tc.test(a.nodeName)&&a.href?0:-1}}}}),k.hrefNormalized||m.each(["href","src"],function(a,b){m.propHooks[b]={get:function(a){return a.getAttribute(b,4)}}}),k.optSelected||(m.propHooks.selected={get:function(a){var b=a.parentNode;return b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex),null}}),m.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){m.propFix[this.toLowerCase()]=this}),k.enctype||(m.propFix.enctype="encoding");var uc=/[\t\r\n\f]/g;m.fn.extend({addClass:function(a){var b,c,d,e,f,g,h=0,i=this.length,j="string"==typeof a&&a;if(m.isFunction(a))return this.each(function(b){m(this).addClass(a.call(this,b,this.className))});if(j)for(b=(a||"").match(E)||[];i>h;h++)if(c=this[h],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(uc," "):" ")){f=0;while(e=b[f++])d.indexOf(" "+e+" ")<0&&(d+=e+" ");g=m.trim(d),c.className!==g&&(c.className=g)}return this},removeClass:function(a){var b,c,d,e,f,g,h=0,i=this.length,j=0===arguments.length||"string"==typeof a&&a;if(m.isFunction(a))return this.each(function(b){m(this).removeClass(a.call(this,b,this.className))});if(j)for(b=(a||"").match(E)||[];i>h;h++)if(c=this[h],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(uc," "):"")){f=0;while(e=b[f++])while(d.indexOf(" "+e+" ")>=0)d=d.replace(" "+e+" "," ");g=a?m.trim(d):"",c.className!==g&&(c.className=g)}return this},toggleClass:function(a,b){var c=typeof a;return"boolean"==typeof b&&"string"===c?b?this.addClass(a):this.removeClass(a):this.each(m.isFunction(a)?function(c){m(this).toggleClass(a.call(this,c,this.className,b),b)}:function(){if("string"===c){var b,d=0,e=m(this),f=a.match(E)||[];while(b=f[d++])e.hasClass(b)?e.removeClass(b):e.addClass(b)}else(c===K||"boolean"===c)&&(this.className&&m._data(this,"__className__",this.className),this.className=this.className||a===!1?"":m._data(this,"__className__")||"")})},hasClass:function(a){for(var b=" "+a+" ",c=0,d=this.length;d>c;c++)if(1===this[c].nodeType&&(" "+this[c].className+" ").replace(uc," ").indexOf(b)>=0)return!0;return!1}}),m.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){m.fn[b]=function(a,c){return arguments.length>0?this.on(b,null,a,c):this.trigger(b)}}),m.fn.extend({hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1===arguments.length?this.off(a,"**"):this.off(b,a||"**",c)}});var vc=m.now(),wc=/\?/,xc=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;m.parseJSON=function(b){if(a.JSON&&a.JSON.parse)return a.JSON.parse(b+"");var c,d=null,e=m.trim(b+"");return e&&!m.trim(e.replace(xc,function(a,b,e,f){return c&&b&&(d=0),0===d?a:(c=e||b,d+=!f-!e,"")}))?Function("return "+e)():m.error("Invalid JSON: "+b)},m.parseXML=function(b){var c,d;if(!b||"string"!=typeof b)return null;try{a.DOMParser?(d=new DOMParser,c=d.parseFromString(b,"text/xml")):(c=new ActiveXObject("Microsoft.XMLDOM"),c.async="false",c.loadXML(b))}catch(e){c=void 0}return c&&c.documentElement&&!c.getElementsByTagName("parsererror").length||m.error("Invalid XML: "+b),c};var yc,zc,Ac=/#.*$/,Bc=/([?&])_=[^&]*/,Cc=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Dc=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Ec=/^(?:GET|HEAD)$/,Fc=/^\/\//,Gc=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,Hc={},Ic={},Jc="*/".concat("*");try{zc=location.href}catch(Kc){zc=y.createElement("a"),zc.href="",zc=zc.href}yc=Gc.exec(zc.toLowerCase())||[];function Lc(a){return function(b,c){"string"!=typeof b&&(c=b,b="*");var d,e=0,f=b.toLowerCase().match(E)||[];if(m.isFunction(c))while(d=f[e++])"+"===d.charAt(0)?(d=d.slice(1)||"*",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c)}}function Mc(a,b,c,d){var e={},f=a===Ic;function g(h){var i;return e[h]=!0,m.each(a[h]||[],function(a,h){var j=h(b,c,d);return"string"!=typeof j||f||e[j]?f?!(i=j):void 0:(b.dataTypes.unshift(j),g(j),!1)}),i}return g(b.dataTypes[0])||!e["*"]&&g("*")}function Nc(a,b){var c,d,e=m.ajaxSettings.flatOptions||{};for(d in b)void 0!==b[d]&&((e[d]?a:c||(c={}))[d]=b[d]);return c&&m.extend(!0,a,c),a}function Oc(a,b,c){var d,e,f,g,h=a.contents,i=a.dataTypes;while("*"===i[0])i.shift(),void 0===e&&(e=a.mimeType||b.getResponseHeader("Content-Type"));if(e)for(g in h)if(h[g]&&h[g].test(e)){i.unshift(g);break}if(i[0]in c)f=i[0];else{for(g in c){if(!i[0]||a.converters[g+" "+i[0]]){f=g;break}d||(d=g)}f=f||d}return f?(f!==i[0]&&i.unshift(f),c[f]):void 0}function Pc(a,b,c,d){var e,f,g,h,i,j={},k=a.dataTypes.slice();if(k[1])for(g in a.converters)j[g.toLowerCase()]=a.converters[g];f=k.shift();while(f)if(a.responseFields[f]&&(c[a.responseFields[f]]=b),!i&&d&&a.dataFilter&&(b=a.dataFilter(b,a.dataType)),i=f,f=k.shift())if("*"===f)f=i;else if("*"!==i&&i!==f){if(g=j[i+" "+f]||j["* "+f],!g)for(e in j)if(h=e.split(" "),h[1]===f&&(g=j[i+" "+h[0]]||j["* "+h[0]])){g===!0?g=j[e]:j[e]!==!0&&(f=h[0],k.unshift(h[1]));break}if(g!==!0)if(g&&a["throws"])b=g(b);else try{b=g(b)}catch(l){return{state:"parsererror",error:g?l:"No conversion from "+i+" to "+f}}}return{state:"success",data:b}}m.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:zc,type:"GET",isLocal:Dc.test(yc[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Jc,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":m.parseJSON,"text xml":m.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(a,b){return b?Nc(Nc(a,m.ajaxSettings),b):Nc(m.ajaxSettings,a)},ajaxPrefilter:Lc(Hc),ajaxTransport:Lc(Ic),ajax:function(a,b){"object"==typeof a&&(b=a,a=void 0),b=b||{};var c,d,e,f,g,h,i,j,k=m.ajaxSetup({},b),l=k.context||k,n=k.context&&(l.nodeType||l.jquery)?m(l):m.event,o=m.Deferred(),p=m.Callbacks("once memory"),q=k.statusCode||{},r={},s={},t=0,u="canceled",v={readyState:0,getResponseHeader:function(a){var b;if(2===t){if(!j){j={};while(b=Cc.exec(f))j[b[1].toLowerCase()]=b[2]}b=j[a.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return 2===t?f:null},setRequestHeader:function(a,b){var c=a.toLowerCase();return t||(a=s[c]=s[c]||a,r[a]=b),this},overrideMimeType:function(a){return t||(k.mimeType=a),this},statusCode:function(a){var b;if(a)if(2>t)for(b in a)q[b]=[q[b],a[b]];else v.always(a[v.status]);return this},abort:function(a){var b=a||u;return i&&i.abort(b),x(0,b),this}};if(o.promise(v).complete=p.add,v.success=v.done,v.error=v.fail,k.url=((a||k.url||zc)+"").replace(Ac,"").replace(Fc,yc[1]+"//"),k.type=b.method||b.type||k.method||k.type,k.dataTypes=m.trim(k.dataType||"*").toLowerCase().match(E)||[""],null==k.crossDomain&&(c=Gc.exec(k.url.toLowerCase()),k.crossDomain=!(!c||c[1]===yc[1]&&c[2]===yc[2]&&(c[3]||("http:"===c[1]?"80":"443"))===(yc[3]||("http:"===yc[1]?"80":"443")))),k.data&&k.processData&&"string"!=typeof k.data&&(k.data=m.param(k.data,k.traditional)),Mc(Hc,k,b,v),2===t)return v;h=k.global,h&&0===m.active++&&m.event.trigger("ajaxStart"),k.type=k.type.toUpperCase(),k.hasContent=!Ec.test(k.type),e=k.url,k.hasContent||(k.data&&(e=k.url+=(wc.test(e)?"&":"?")+k.data,delete k.data),k.cache===!1&&(k.url=Bc.test(e)?e.replace(Bc,"$1_="+vc++):e+(wc.test(e)?"&":"?")+"_="+vc++)),k.ifModified&&(m.lastModified[e]&&v.setRequestHeader("If-Modified-Since",m.lastModified[e]),m.etag[e]&&v.setRequestHeader("If-None-Match",m.etag[e])),(k.data&&k.hasContent&&k.contentType!==!1||b.contentType)&&v.setRequestHeader("Content-Type",k.contentType),v.setRequestHeader("Accept",k.dataTypes[0]&&k.accepts[k.dataTypes[0]]?k.accepts[k.dataTypes[0]]+("*"!==k.dataTypes[0]?", "+Jc+"; q=0.01":""):k.accepts["*"]);for(d in k.headers)v.setRequestHeader(d,k.headers[d]);if(k.beforeSend&&(k.beforeSend.call(l,v,k)===!1||2===t))return v.abort();u="abort";for(d in{success:1,error:1,complete:1})v[d](k[d]);if(i=Mc(Ic,k,b,v)){v.readyState=1,h&&n.trigger("ajaxSend",[v,k]),k.async&&k.timeout>0&&(g=setTimeout(function(){v.abort("timeout")},k.timeout));try{t=1,i.send(r,x)}catch(w){if(!(2>t))throw w;x(-1,w)}}else x(-1,"No Transport");function x(a,b,c,d){var j,r,s,u,w,x=b;2!==t&&(t=2,g&&clearTimeout(g),i=void 0,f=d||"",v.readyState=a>0?4:0,j=a>=200&&300>a||304===a,c&&(u=Oc(k,v,c)),u=Pc(k,u,v,j),j?(k.ifModified&&(w=v.getResponseHeader("Last-Modified"),w&&(m.lastModified[e]=w),w=v.getResponseHeader("etag"),w&&(m.etag[e]=w)),204===a||"HEAD"===k.type?x="nocontent":304===a?x="notmodified":(x=u.state,r=u.data,s=u.error,j=!s)):(s=x,(a||!x)&&(x="error",0>a&&(a=0))),v.status=a,v.statusText=(b||x)+"",j?o.resolveWith(l,[r,x,v]):o.rejectWith(l,[v,x,s]),v.statusCode(q),q=void 0,h&&n.trigger(j?"ajaxSuccess":"ajaxError",[v,k,j?r:s]),p.fireWith(l,[v,x]),h&&(n.trigger("ajaxComplete",[v,k]),--m.active||m.event.trigger("ajaxStop")))}return v},getJSON:function(a,b,c){return m.get(a,b,c,"json")},getScript:function(a,b){return m.get(a,void 0,b,"script")}}),m.each(["get","post"],function(a,b){m[b]=function(a,c,d,e){return m.isFunction(c)&&(e=e||d,d=c,c=void 0),m.ajax({url:a,type:b,dataType:e,data:c,success:d})}}),m.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(a,b){m.fn[b]=function(a){return this.on(b,a)}}),m._evalUrl=function(a){return m.ajax({url:a,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},m.fn.extend({wrapAll:function(a){if(m.isFunction(a))return this.each(function(b){m(this).wrapAll(a.call(this,b))});if(this[0]){var b=m(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){var a=this;while(a.firstChild&&1===a.firstChild.nodeType)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(a){return this.each(m.isFunction(a)?function(b){m(this).wrapInner(a.call(this,b))}:function(){var b=m(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=m.isFunction(a);return this.each(function(c){m(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){m.nodeName(this,"body")||m(this).replaceWith(this.childNodes)}).end()}}),m.expr.filters.hidden=function(a){return a.offsetWidth<=0&&a.offsetHeight<=0||!k.reliableHiddenOffsets()&&"none"===(a.style&&a.style.display||m.css(a,"display"))},m.expr.filters.visible=function(a){return!m.expr.filters.hidden(a)};var Qc=/%20/g,Rc=/\[\]$/,Sc=/\r?\n/g,Tc=/^(?:submit|button|image|reset|file)$/i,Uc=/^(?:input|select|textarea|keygen)/i;function Vc(a,b,c,d){var e;if(m.isArray(b))m.each(b,function(b,e){c||Rc.test(a)?d(a,e):Vc(a+"["+("object"==typeof e?b:"")+"]",e,c,d)});else if(c||"object"!==m.type(b))d(a,b);else for(e in b)Vc(a+"["+e+"]",b[e],c,d)}m.param=function(a,b){var c,d=[],e=function(a,b){b=m.isFunction(b)?b():null==b?"":b,d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};if(void 0===b&&(b=m.ajaxSettings&&m.ajaxSettings.traditional),m.isArray(a)||a.jquery&&!m.isPlainObject(a))m.each(a,function(){e(this.name,this.value)});else for(c in a)Vc(c,a[c],b,e);return d.join("&").replace(Qc,"+")},m.fn.extend({serialize:function(){return m.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var a=m.prop(this,"elements");return a?m.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!m(this).is(":disabled")&&Uc.test(this.nodeName)&&!Tc.test(a)&&(this.checked||!W.test(a))}).map(function(a,b){var c=m(this).val();return null==c?null:m.isArray(c)?m.map(c,function(a){return{name:b.name,value:a.replace(Sc,"\r\n")}}):{name:b.name,value:c.replace(Sc,"\r\n")}}).get()}}),m.ajaxSettings.xhr=void 0!==a.ActiveXObject?function(){return!this.isLocal&&/^(get|post|head|put|delete|options)$/i.test(this.type)&&Zc()||$c()}:Zc;var Wc=0,Xc={},Yc=m.ajaxSettings.xhr();a.ActiveXObject&&m(a).on("unload",function(){for(var a in Xc)Xc[a](void 0,!0)}),k.cors=!!Yc&&"withCredentials"in Yc,Yc=k.ajax=!!Yc,Yc&&m.ajaxTransport(function(a){if(!a.crossDomain||k.cors){var b;return{send:function(c,d){var e,f=a.xhr(),g=++Wc;if(f.open(a.type,a.url,a.async,a.username,a.password),a.xhrFields)for(e in a.xhrFields)f[e]=a.xhrFields[e];a.mimeType&&f.overrideMimeType&&f.overrideMimeType(a.mimeType),a.crossDomain||c["X-Requested-With"]||(c["X-Requested-With"]="XMLHttpRequest");for(e in c)void 0!==c[e]&&f.setRequestHeader(e,c[e]+"");f.send(a.hasContent&&a.data||null),b=function(c,e){var h,i,j;if(b&&(e||4===f.readyState))if(delete Xc[g],b=void 0,f.onreadystatechange=m.noop,e)4!==f.readyState&&f.abort();else{j={},h=f.status,"string"==typeof f.responseText&&(j.text=f.responseText);try{i=f.statusText}catch(k){i=""}h||!a.isLocal||a.crossDomain?1223===h&&(h=204):h=j.text?200:404}j&&d(h,i,j,f.getAllResponseHeaders())},a.async?4===f.readyState?setTimeout(b):f.onreadystatechange=Xc[g]=b:b()},abort:function(){b&&b(void 0,!0)}}}});function Zc(){try{return new a.XMLHttpRequest}catch(b){}}function $c(){try{return new a.ActiveXObject("Microsoft.XMLHTTP")}catch(b){}}m.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(a){return m.globalEval(a),a}}}),m.ajaxPrefilter("script",function(a){void 0===a.cache&&(a.cache=!1),a.crossDomain&&(a.type="GET",a.global=!1)}),m.ajaxTransport("script",function(a){if(a.crossDomain){var b,c=y.head||m("head")[0]||y.documentElement;return{send:function(d,e){b=y.createElement("script"),b.async=!0,a.scriptCharset&&(b.charset=a.scriptCharset),b.src=a.url,b.onload=b.onreadystatechange=function(a,c){(c||!b.readyState||/loaded|complete/.test(b.readyState))&&(b.onload=b.onreadystatechange=null,b.parentNode&&b.parentNode.removeChild(b),b=null,c||e(200,"success"))},c.insertBefore(b,c.firstChild)},abort:function(){b&&b.onload(void 0,!0)}}}});var _c=[],ad=/(=)\?(?=&|$)|\?\?/;m.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=_c.pop()||m.expando+"_"+vc++;return this[a]=!0,a}}),m.ajaxPrefilter("json jsonp",function(b,c,d){var e,f,g,h=b.jsonp!==!1&&(ad.test(b.url)?"url":"string"==typeof b.data&&!(b.contentType||"").indexOf("application/x-www-form-urlencoded")&&ad.test(b.data)&&"data");return h||"jsonp"===b.dataTypes[0]?(e=b.jsonpCallback=m.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,h?b[h]=b[h].replace(ad,"$1"+e):b.jsonp!==!1&&(b.url+=(wc.test(b.url)?"&":"?")+b.jsonp+"="+e),b.converters["script json"]=function(){return g||m.error(e+" was not called"),g[0]},b.dataTypes[0]="json",f=a[e],a[e]=function(){g=arguments},d.always(function(){a[e]=f,b[e]&&(b.jsonpCallback=c.jsonpCallback,_c.push(e)),g&&m.isFunction(f)&&f(g[0]),g=f=void 0}),"script"):void 0}),m.parseHTML=function(a,b,c){if(!a||"string"!=typeof a)return null;"boolean"==typeof b&&(c=b,b=!1),b=b||y;var d=u.exec(a),e=!c&&[];return d?[b.createElement(d[1])]:(d=m.buildFragment([a],b,e),e&&e.length&&m(e).remove(),m.merge([],d.childNodes))};var bd=m.fn.load;m.fn.load=function(a,b,c){if("string"!=typeof a&&bd)return bd.apply(this,arguments);var d,e,f,g=this,h=a.indexOf(" ");return h>=0&&(d=m.trim(a.slice(h,a.length)),a=a.slice(0,h)),m.isFunction(b)?(c=b,b=void 0):b&&"object"==typeof b&&(f="POST"),g.length>0&&m.ajax({url:a,type:f,dataType:"html",data:b}).done(function(a){e=arguments,g.html(d?m("<div>").append(m.parseHTML(a)).find(d):a)}).complete(c&&function(a,b){g.each(c,e||[a.responseText,b,a])}),this},m.expr.filters.animated=function(a){return m.grep(m.timers,function(b){return a===b.elem}).length};var cd=a.document.documentElement;function dd(a){return m.isWindow(a)?a:9===a.nodeType?a.defaultView||a.parentWindow:!1}m.offset={setOffset:function(a,b,c){var d,e,f,g,h,i,j,k=m.css(a,"position"),l=m(a),n={};"static"===k&&(a.style.position="relative"),h=l.offset(),f=m.css(a,"top"),i=m.css(a,"left"),j=("absolute"===k||"fixed"===k)&&m.inArray("auto",[f,i])>-1,j?(d=l.position(),g=d.top,e=d.left):(g=parseFloat(f)||0,e=parseFloat(i)||0),m.isFunction(b)&&(b=b.call(a,c,h)),null!=b.top&&(n.top=b.top-h.top+g),null!=b.left&&(n.left=b.left-h.left+e),"using"in b?b.using.call(a,n):l.css(n)}},m.fn.extend({offset:function(a){if(arguments.length)return void 0===a?this:this.each(function(b){m.offset.setOffset(this,a,b)});var b,c,d={top:0,left:0},e=this[0],f=e&&e.ownerDocument;if(f)return b=f.documentElement,m.contains(b,e)?(typeof e.getBoundingClientRect!==K&&(d=e.getBoundingClientRect()),c=dd(f),{top:d.top+(c.pageYOffset||b.scrollTop)-(b.clientTop||0),left:d.left+(c.pageXOffset||b.scrollLeft)-(b.clientLeft||0)}):d},position:function(){if(this[0]){var a,b,c={top:0,left:0},d=this[0];return"fixed"===m.css(d,"position")?b=d.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),m.nodeName(a[0],"html")||(c=a.offset()),c.top+=m.css(a[0],"borderTopWidth",!0),c.left+=m.css(a[0],"borderLeftWidth",!0)),{top:b.top-c.top-m.css(d,"marginTop",!0),left:b.left-c.left-m.css(d,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var a=this.offsetParent||cd;while(a&&!m.nodeName(a,"html")&&"static"===m.css(a,"position"))a=a.offsetParent;return a||cd})}}),m.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,b){var c=/Y/.test(b);m.fn[a]=function(d){return V(this,function(a,d,e){var f=dd(a);return void 0===e?f?b in f?f[b]:f.document.documentElement[d]:a[d]:void(f?f.scrollTo(c?m(f).scrollLeft():e,c?e:m(f).scrollTop()):a[d]=e)},a,d,arguments.length,null)}}),m.each(["top","left"],function(a,b){m.cssHooks[b]=Lb(k.pixelPosition,function(a,c){return c?(c=Jb(a,b),Hb.test(c)?m(a).position()[b]+"px":c):void 0})}),m.each({Height:"height",Width:"width"},function(a,b){m.each({padding:"inner"+a,content:b,"":"outer"+a},function(c,d){m.fn[d]=function(d,e){var f=arguments.length&&(c||"boolean"!=typeof d),g=c||(d===!0||e===!0?"margin":"border");return V(this,function(b,c,d){var e;return m.isWindow(b)?b.document.documentElement["client"+a]:9===b.nodeType?(e=b.documentElement,Math.max(b.body["scroll"+a],e["scroll"+a],b.body["offset"+a],e["offset"+a],e["client"+a])):void 0===d?m.css(b,c,g):m.style(b,c,d,g)},b,f?d:void 0,f,null)}})}),m.fn.size=function(){return this.length},m.fn.andSelf=m.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return m});var ed=a.jQuery,fd=a.$;return m.noConflict=function(b){return a.$===m&&(a.$=fd),b&&a.jQuery===m&&(a.jQuery=ed),m},typeof b===K&&(a.jQuery=a.$=m),m});
(function($){var Node,Tree,methods;Node=(function(){function Node(row,tree,settings){var parentId;this.row=row;this.tree=tree;this.settings=settings;this.id=this.row.data(this.settings.nodeIdAttr);parentId=this.row.data(this.settings.parentIdAttr);if(parentId!=null&&parentId!=="")this.parentId=parentId;this.treeCell=$(this.row.children(this.settings.columnElType)[this.settings.column]);this.expander=$(this.settings.expanderTemplate);this.indenter=$(this.settings.indenterTemplate);this.children=[];this.initialized=false;this.treeCell.prepend(this.indenter);}Node.prototype.addChild=function(child){return this.children.push(child);};Node.prototype.ancestors=function(){var ancestors,node;node=this;ancestors=[];while(node=node.parentNode())ancestors.push(node);return ancestors;};Node.prototype.collapse=function(){if(this.collapsed())return this;this.row.removeClass("expanded").addClass("collapsed");this._hideChildren();this.expander.attr("title",this.settings.stringExpand);if(this.initialized&&this.settings.onNodeCollapse!=null)this.settings.onNodeCollapse.apply(this);return this;};Node.prototype.collapsed=function(){return this.row.hasClass("collapsed");};Node.prototype.expand=function(){if(this.expanded())return this;this.row.removeClass("collapsed").addClass("expanded");if(this.initialized&&this.settings.onNodeExpand!=null)this.settings.onNodeExpand.apply(this);if($(this.row).is(":visible"))this._showChildren();this.expander.attr("title",this.settings.stringCollapse);return this;};Node.prototype.expanded=function(){return this.row.hasClass("expanded");};Node.prototype.hide=function(){this._hideChildren();this.row.hide();return this;};Node.prototype.isBranchNode=function(){if(this.children.length>0||this.row.data(this.settings.branchAttr)===true)return true;else return false;};Node.prototype.updateBranchLeafClass=function(){this.row.removeClass('branch');this.row.removeClass('leaf');this.row.addClass(this.isBranchNode()?'branch':'leaf');};Node.prototype.level=function(){return this.ancestors().length;};Node.prototype.parentNode=function(){if(this.parentId!=null)return this.tree[this.parentId];else return null;};Node.prototype.removeChild=function(child){var i=$.inArray(child,this.children);return this.children.splice(i,1);};Node.prototype.render=function(){var handler,settings=this.settings,target;if(settings.expandable===true&&this.isBranchNode()){handler=function(e){$(this).parents("table").treetable("node",$(this).parents("tr").data(settings.nodeIdAttr)).toggle();return e.preventDefault();};this.indenter.html(this.expander);target=settings.clickableNodeNames===true?this.treeCell:this.expander;target.off("click.treetable").on("click.treetable",handler);target.off("keydown.treetable").on("keydown.treetable",function(e){if(e.keyCode==13)handler.apply(this,[e]);});}this.indenter[0].style.paddingLeft=""+(this.level()*settings.indent)+"px";return this;};Node.prototype.reveal=function(){if(this.parentId!=null)this.parentNode().reveal();return this.expand();};Node.prototype.setParent=function(node){if(this.parentId!=null)this.tree[this.parentId].removeChild(this);this.parentId=node.id;this.row.data(this.settings.parentIdAttr,node.id);return node.addChild(this);};Node.prototype.show=function(){if(!this.initialized)this._initialize();this.row.show();if(this.expanded())this._showChildren();return this;};Node.prototype.toggle=function(){if(this.expanded())this.collapse();else this.expand();return this;};Node.prototype._hideChildren=function(){var child,_i,_len,_ref,_results;_ref=this.children;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){child=_ref[_i];_results.push(child.hide());}return _results;};Node.prototype._initialize=function(){var settings=this.settings;this.render();if(settings.expandable===true&&settings.initialState==="collapsed")this.collapse();else this.expand();if(settings.onNodeInitialized!=null)settings.onNodeInitialized.apply(this);return this.initialized=true;};Node.prototype._showChildren=function(){var child,_i,_len,_ref,_results;_ref=this.children;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){child=_ref[_i];_results.push(child.show());}return _results;};return Node;})();Tree=(function(){function Tree(table,settings){this.table=table;this.settings=settings;this.tree={};this.nodes=[];this.roots=[];}Tree.prototype.collapseAll=function(){var node,_i,_len,_ref,_results;_ref=this.nodes;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){node=_ref[_i];_results.push(node.collapse());}return _results;};Tree.prototype.expandAll=function(){var node,_i,_len,_ref,_results;_ref=this.nodes;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){node=_ref[_i];_results.push(node.expand());}return _results;};Tree.prototype.findLastNode=function(node){if(node.children.length>0)return this.findLastNode(node.children[node.children.length-1]);else return node;};Tree.prototype.loadRows=function(rows){var node,row,i;if(rows!=null)for(i=0;i<rows.length;i++){row=$(rows[i]);if(row.data(this.settings.nodeIdAttr)!=null){node=new Node(row,this.tree,this.settings);this.nodes.push(node);this.tree[node.id]=node;if(node.parentId!=null&&this.tree[node.parentId])this.tree[node.parentId].addChild(node);else this.roots.push(node);}}for(i=0;i<this.nodes.length;i++)node=this.nodes[i].updateBranchLeafClass();return this;};Tree.prototype.move=function(node,destination){var nodeParent=node.parentNode();if(node!==destination&&destination.id!==node.parentId&&$.inArray(node,destination.ancestors())===-1){node.setParent(destination);this._moveRows(node,destination);if(node.parentNode().children.length===1)node.parentNode().render();}if(nodeParent)nodeParent.updateBranchLeafClass();if(node.parentNode())node.parentNode().updateBranchLeafClass();node.updateBranchLeafClass();return this;};Tree.prototype.removeNode=function(node){this.unloadBranch(node);node.row.remove();if(node.parentId!=null)node.parentNode().removeChild(node);delete this.tree[node.id];this.nodes.splice($.inArray(node,this.nodes),1);return this;};Tree.prototype.render=function(){var root,_i,_len,_ref;_ref=this.roots;for(_i=0,_len=_ref.length;_i<_len;_i++){root=_ref[_i];root.show();}return this;};Tree.prototype.sortBranch=function(node,sortFun){node.children.sort(sortFun);this._sortChildRows(node);return this;};Tree.prototype.unloadBranch=function(node){var children=node.children.slice(0),i;for(i=0;i<children.length;i++)this.removeNode(children[i]);node.children=[];node.updateBranchLeafClass();return this;};Tree.prototype._moveRows=function(node,destination){var children=node.children,i;node.row.insertAfter(destination.row);node.render();for(i=children.length-1;i>=0;i--)this._moveRows(children[i],node);};Tree.prototype._sortChildRows=function(parentNode){return this._moveRows(parentNode,parentNode);};return Tree;})();methods={init:function(options,force){var settings;settings=$.extend({branchAttr:"ttBranch",clickableNodeNames:false,column:0,columnElType:"td",expandable:false,expanderTemplate:"<a href='#'>&nbsp;</a>",indent:19,indenterTemplate:"<span class='indenter'></span>",initialState:"collapsed",nodeIdAttr:"ttId",parentIdAttr:"ttParentId",stringExpand:"Expand",stringCollapse:"Collapse",onInitialized:null,onNodeCollapse:null,onNodeExpand:null,onNodeInitialized:null},options);return this.each(function(){var el=$(this),tree;if(force||el.data("treetable")===undefined){tree=new Tree(this,settings);tree.loadRows(this.rows).render();el.addClass("treetable").data("treetable",tree);if(settings.onInitialized!=null)settings.onInitialized.apply(tree);}return el;});},destroy:function(){return this.each(function(){return $(this).removeData("treetable").removeClass("treetable");});},collapseAll:function(){this.data("treetable").collapseAll();return this;},collapseNode:function(id){var node=this.data("treetable").tree[id];if(node)node.collapse();else throw new Error("Unknown node '"+id+"'");return this;},expandAll:function(){this.data("treetable").expandAll();return this;},expandNode:function(id){var node=this.data("treetable").tree[id];if(node){if(!node.initialized)node._initialize();node.expand();}else throw new Error("Unknown node '"+id+"'");return this;},loadBranch:function(node,rows){var settings=this.data("treetable").settings,tree=this.data("treetable").tree;rows=$(rows);if(node==null)this.append(rows);else{var lastNode=this.data("treetable").findLastNode(node);rows.insertAfter(lastNode.row);}this.data("treetable").loadRows(rows);rows.filter("tr").each(function(){tree[$(this).data(settings.nodeIdAttr)].show();});if(node!=null)node.render().expand();return this;},move:function(nodeId,destinationId){var destination,node;node=this.data("treetable").tree[nodeId];destination=this.data("treetable").tree[destinationId];this.data("treetable").move(node,destination);return this;},node:function(id){return this.data("treetable").tree[id];},removeNode:function(id){var node=this.data("treetable").tree[id];if(node)this.data("treetable").removeNode(node);else throw new Error("Unknown node '"+id+"'");return this;},reveal:function(id){var node=this.data("treetable").tree[id];if(node)node.reveal();else throw new Error("Unknown node '"+id+"'");return this;},sortBranch:function(node,columnOrFunction){var settings=this.data("treetable").settings,prepValue,sortFun;columnOrFunction=columnOrFunction||settings.column;sortFun=columnOrFunction;if($.isNumeric(columnOrFunction))sortFun=function(a,b){var extractValue,valA,valB;extractValue=function(node){var val=node.row.find("td:eq("+columnOrFunction+")").text();return $.trim(val).toUpperCase();};valA=extractValue(a);valB=extractValue(b);if(valA<valB)return -1;if(valA>valB)return 1;return 0;};this.data("treetable").sortBranch(node,sortFun);return this;},unloadBranch:function(node){this.data("treetable").unloadBranch(node);return this;}};$.fn.treetable=function(method){if(methods[method])return methods[method].apply(this,Array.prototype.slice.call(arguments,1));else if(typeof method==='object'||!method)return methods.init.apply(this,arguments);else return $.error("Method "+method+" does not exist on jQuery.treetable");};this.TreeTable||(this.TreeTable={});this.TreeTable.Node=Node;this.TreeTable.Tree=Tree;})(jQuery);if("undefined"==typeof jQuery)throw new Error("Bootstrap's JavaScript requires jQuery");+function(t){"use strict";function e(e){return this.each(function(){var n=t(this),o=n.data("bs.alert");o||n.data("bs.alert",o=new i(this)),"string"==typeof e&&o[e].call(n);});}var n='[data-dismiss="alert"]',i=function(e){t(e).on("click",n,this.close);};i.VERSION="3.2.0",i.prototype.close=function(e){function n(){s.detach().trigger("closed.bs.alert").remove();}var i=t(this),o=i.attr("data-target");o||(o=i.attr("href"),o=o&&o.replace(/.*(?=#[^\s]*$)/,""));var s=t(o);e&&e.preventDefault(),s.length||(s=i.hasClass("alert")?i:i.parent()),s.trigger(e=t.Event("close.bs.alert")),e.isDefaultPrevented()||(s.removeClass("in"),t.support.transition&&s.hasClass("fade")?s.one("bsTransitionEnd",n).emulateTransitionEnd(150):n());};var o=t.fn.alert;t.fn.alert=e,t.fn.alert.Constructor=i,t.fn.alert.noConflict=function(){return t.fn.alert=o,this;},t(document).on("click.bs.alert.data-api",n,i.prototype.close);}(jQuery),+function(t){"use strict";function e(e){e&&3===e.which||(t(o).remove(),t(s).each(function(){var i=n(t(this)),o={relatedTarget:this};i.hasClass("open")&&(i.trigger(e=t.Event("hide.bs.dropdown",o)),e.isDefaultPrevented()||i.removeClass("open").trigger("hidden.bs.dropdown",o));}));}function n(e){var n=e.attr("data-target");n||(n=e.attr("href"),n=n&&/#[A-Za-z]/.test(n)&&n.replace(/.*(?=#[^\s]*$)/,""));var i=n&&t(n);return i&&i.length?i:e.parent();}function i(e){return this.each(function(){var n=t(this),i=n.data("bs.dropdown");i||n.data("bs.dropdown",i=new a(this)),"string"==typeof e&&i[e].call(n);});}var o=".dropdown-backdrop",s='[data-toggle="dropdown"]',a=function(e){t(e).on("click.bs.dropdown",this.toggle);};a.VERSION="3.2.0",a.prototype.toggle=function(i){var o=t(this);if(!o.is(".disabled, :disabled")){var s=n(o),a=s.hasClass("open");if(e(),!a){"ontouchstart" in document.documentElement&&!s.closest(".navbar-nav").length&&t('<div class="dropdown-backdrop"/>').insertAfter(t(this)).on("click",e);var r={relatedTarget:this};if(s.trigger(i=t.Event("show.bs.dropdown",r)),i.isDefaultPrevented())return;o.trigger("focus"),s.toggleClass("open").trigger("shown.bs.dropdown",r);}return !1;}},a.prototype.keydown=function(e){if(/(38|40|27)/.test(e.keyCode)){var i=t(this);if(e.preventDefault(),e.stopPropagation(),!i.is(".disabled, :disabled")){var o=n(i),a=o.hasClass("open");if(!a||a&&27==e.keyCode)return 27==e.which&&o.find(s).trigger("focus"),i.trigger("click");var r=" li:not(.divider):visible a",l=o.find('[role="menu"]'+r+', [role="listbox"]'+r);if(l.length){var d=l.index(l.filter(":focus"));38==e.keyCode&&d>0&&d--,40==e.keyCode&&d<l.length-1&&d++,~d||(d=0),l.eq(d).trigger("focus");}}}};var r=t.fn.dropdown;t.fn.dropdown=i,t.fn.dropdown.Constructor=a,t.fn.dropdown.noConflict=function(){return t.fn.dropdown=r,this;},t(document).on("click.bs.dropdown.data-api",e).on("click.bs.dropdown.data-api",".dropdown form",function(t){t.stopPropagation();}).on("click.bs.dropdown.data-api",s,a.prototype.toggle).on("keydown.bs.dropdown.data-api",s+', [role="menu"], [role="listbox"]',a.prototype.keydown);}(jQuery),+function(t){"use strict";function e(e,i){return this.each(function(){var o=t(this),s=o.data("bs.modal"),a=t.extend({},n.DEFAULTS,o.data(),"object"==typeof e&&e);s||o.data("bs.modal",s=new n(this,a)),"string"==typeof e?s[e](i):a.show&&s.show(i);});}var n=function(e,n){this.options=n,this.$body=t(document.body),this.$element=t(e),this.$backdrop=this.isShown=null,this.scrollbarWidth=0,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,t.proxy(function(){this.$element.trigger("loaded.bs.modal");},this));};n.VERSION="3.2.0",n.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},n.prototype.toggle=function(t){return this.isShown?this.hide():this.show(t);},n.prototype.show=function(e){var n=this,i=t.Event("show.bs.modal",{relatedTarget:e});this.$element.trigger(i),this.isShown||i.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.$body.addClass("modal-open"),this.setScrollbar(),this.escape(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',t.proxy(this.hide,this)),this.backdrop(function(){var i=t.support.transition&&n.$element.hasClass("fade");n.$element.parent().length||n.$element.appendTo(n.$body),n.$element.show().scrollTop(0),i&&n.$element[0].offsetWidth,n.$element.addClass("in").attr("aria-hidden",!1),n.enforceFocus();var o=t.Event("shown.bs.modal",{relatedTarget:e});i?n.$element.find(".modal-dialog").one("bsTransitionEnd",function(){n.$element.trigger("focus").trigger(o);}).emulateTransitionEnd(300):n.$element.trigger("focus").trigger(o);}));},n.prototype.hide=function(e){e&&e.preventDefault(),e=t.Event("hide.bs.modal"),this.$element.trigger(e),this.isShown&&!e.isDefaultPrevented()&&(this.isShown=!1,this.$body.removeClass("modal-open"),this.resetScrollbar(),this.escape(),t(document).off("focusin.bs.modal"),this.$element.removeClass("in").attr("aria-hidden",!0).off("click.dismiss.bs.modal"),t.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",t.proxy(this.hideModal,this)).emulateTransitionEnd(300):this.hideModal());},n.prototype.enforceFocus=function(){t(document).off("focusin.bs.modal").on("focusin.bs.modal",t.proxy(function(t){this.$element[0]===t.target||this.$element.has(t.target).length||this.$element.trigger("focus");},this));},n.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.bs.modal",t.proxy(function(t){27==t.which&&this.hide();},this)):this.isShown||this.$element.off("keyup.dismiss.bs.modal");},n.prototype.hideModal=function(){var t=this;this.$element.hide(),this.backdrop(function(){t.$element.trigger("hidden.bs.modal");});},n.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null;},n.prototype.backdrop=function(e){var n=this,i=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var o=t.support.transition&&i;if(this.$backdrop=t('<div class="modal-backdrop '+i+'" />').appendTo(this.$body),this.$element.on("click.dismiss.bs.modal",t.proxy(function(t){t.target===t.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus.call(this.$element[0]):this.hide.call(this));},this)),o&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!e)return;o?this.$backdrop.one("bsTransitionEnd",e).emulateTransitionEnd(150):e();}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var s=function(){n.removeBackdrop(),e&&e();};t.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",s).emulateTransitionEnd(150):s();}else e&&e();},n.prototype.checkScrollbar=function(){document.body.clientWidth>=window.innerWidth||(this.scrollbarWidth=this.scrollbarWidth||this.measureScrollbar());},n.prototype.setScrollbar=function(){var t=parseInt(this.$body.css("padding-right")||0,10);this.scrollbarWidth&&this.$body.css("padding-right",t+this.scrollbarWidth);},n.prototype.resetScrollbar=function(){this.$body.css("padding-right","");},n.prototype.measureScrollbar=function(){var t=document.createElement("div");t.className="modal-scrollbar-measure",this.$body.append(t);var e=t.offsetWidth-t.clientWidth;return this.$body[0].removeChild(t),e;};var i=t.fn.modal;t.fn.modal=e,t.fn.modal.Constructor=n,t.fn.modal.noConflict=function(){return t.fn.modal=i,this;},t(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(n){var i=t(this),o=i.attr("href"),s=t(i.attr("data-target")||o&&o.replace(/.*(?=#[^\s]+$)/,"")),a=s.data("bs.modal")?"toggle":t.extend({remote:!/#/.test(o)&&o},s.data(),i.data());i.is("a")&&n.preventDefault(),s.one("show.bs.modal",function(t){t.isDefaultPrevented()||s.one("hidden.bs.modal",function(){i.is(":visible")&&i.trigger("focus");});}),e.call(s,a,this);});}(jQuery),+function(t){"use strict";function e(e){return this.each(function(){var i=t(this),o=i.data("bs.collapse"),s=t.extend({},n.DEFAULTS,i.data(),"object"==typeof e&&e);!o&&s.toggle&&"show"==e&&(e=!e),o||i.data("bs.collapse",o=new n(this,s)),"string"==typeof e&&o[e]();});}var n=function(e,i){this.$element=t(e),this.options=t.extend({},n.DEFAULTS,i),this.transitioning=null,this.options.parent&&(this.$parent=t(this.options.parent)),this.options.toggle&&this.toggle();};n.VERSION="3.2.0",n.DEFAULTS={toggle:!0},n.prototype.dimension=function(){var t=this.$element.hasClass("width");return t?"width":"height";},n.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var n=t.Event("show.bs.collapse");if(this.$element.trigger(n),!n.isDefaultPrevented()){var i=this.$parent&&this.$parent.find("> .panel > .in");if(i&&i.length){var o=i.data("bs.collapse");if(o&&o.transitioning)return;e.call(i,"hide"),o||i.data("bs.collapse",null);}var s=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[s](0),this.transitioning=1;var a=function(){this.$element.removeClass("collapsing").addClass("collapse in")[s](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse");};if(!t.support.transition)return a.call(this);var r=t.camelCase(["scroll",s].join("-"));this.$element.one("bsTransitionEnd",t.proxy(a,this)).emulateTransitionEnd(350)[s](this.$element[0][r]);}}},n.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var e=t.Event("hide.bs.collapse");if(this.$element.trigger(e),!e.isDefaultPrevented()){var n=this.dimension();this.$element[n](this.$element[n]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse").removeClass("in"),this.transitioning=1;var i=function(){this.transitioning=0,this.$element.trigger("hidden.bs.collapse").removeClass("collapsing").addClass("collapse");};return t.support.transition?void this.$element[n](0).one("bsTransitionEnd",t.proxy(i,this)).emulateTransitionEnd(350):i.call(this);}}},n.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]();};var i=t.fn.collapse;t.fn.collapse=e,t.fn.collapse.Constructor=n,t.fn.collapse.noConflict=function(){return t.fn.collapse=i,this;},t(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(n){var i,o=t(this),s=o.attr("data-target")||n.preventDefault()||(i=o.attr("href"))&&i.replace(/.*(?=#[^\s]+$)/,""),a=t(s),r=a.data("bs.collapse"),l=r?"toggle":o.data(),d=o.attr("data-parent"),h=d&&t(d);r&&r.transitioning||(h&&h.find('[data-toggle="collapse"][data-parent="'+d+'"]').not(o).addClass("collapsed"),o[a.hasClass("in")?"addClass":"removeClass"]("collapsed")),e.call(a,l);});}(jQuery),+function(t){"use strict";function e(){var t=document.createElement("bootstrap"),e={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var n in e)if(void 0!==t.style[n])return{end:e[n]};return !1;}t.fn.emulateTransitionEnd=function(e){var n=!1,i=this;t(this).one("bsTransitionEnd",function(){n=!0;});var o=function(){n||t(i).trigger(t.support.transition.end);};return setTimeout(o,e),this;},t(function(){t.support.transition=e(),t.support.transition&&(t.event.special.bsTransitionEnd={bindType:t.support.transition.end,delegateType:t.support.transition.end,handle:function(e){return t(e.target).is(this)?e.handleObj.handler.apply(this,arguments):void 0;}});});}(jQuery);function openRuleDetailsDialog(rule_result_id){$("#detail-modal").remove();var closebutton=$('<button type="button" class="close btn btn-sm btn-default" data-dismiss="modal" aria-hidden="true" title="Close">&#x274c;</button>');var modal=$('<div id="detail-modal" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true"><div id="detail-modal-body" class="modal-body"></div></div>');$("body").prepend(modal);var clone=$("#rule-detail-"+rule_result_id).clone();clone.attr("id","");clone.children(".panel-heading").append(closebutton);closebutton.css({"float":"right"});closebutton.css({"margin-top":"-=23px"});$("#detail-modal-body").append(clone);$("#detail-modal").modal();return false;}function toggleRuleDisplay(checkbox){var result=checkbox.value;if(checkbox.checked){$(".rule-overview-leaf-"+result).removeClass("rule-result-filtered");$(".rule-detail-"+result).removeClass("rule-result-filtered");}else{$(".rule-overview-leaf-"+result).addClass("rule-result-filtered");$(".rule-detail-"+result).addClass("rule-result-filtered");}stripeTreeTable();}function toggleResultDetails(button){var result_details=$("#result-details");if(result_details.is(":visible")){result_details.hide();$(button).html("Show all result details");}else{result_details.show();$(button).html("Hide all result details");}return false;}function ruleSearchMatches(detail_leaf,keywords){if(keywords.length==0)return true;var match=true;var checked_keywords=detail_leaf.children(".keywords").text().toLowerCase();var index;for(index=0;index<keywords.length;++index)if(checked_keywords.indexOf(keywords[index].toLowerCase())<0){match=false;break;}return match;}function ruleSearch(){var search_input=$("#search-input").val();var keywords=search_input.split(/[\s,\.;]+/);var matches=0;$(".rule-detail").each(function(){var rrid=$(this).attr("id").substring(12);var overview_leaf=$("#rule-overview-leaf-"+rrid);var detail_leaf=$(this);if(ruleSearchMatches(detail_leaf,keywords)){overview_leaf.removeClass("search-no-match");detail_leaf.removeClass("search-no-match");++matches;}else{overview_leaf.addClass("search-no-match");detail_leaf.addClass("search-no-match");}});if(!search_input)$("#search-matches").html("");else if(matches>0)$("#search-matches").html(matches.toString()+" rules match.");else $("#search-matches").html("No rules match your search criteria!");}var is_original=true;var original_treetable=null;$(document).ready(function(){$("#result-details").hide();$(".js-only").show();$(".form-group select").val("default");$(".toggle-rule-display").each(function(){toggleRuleDisplay(this);});original_treetable=$(".treetable").clone();$(".treetable").treetable({column:0,expandable:true,clickableNodeNames:true,initialState:"expanded",indent:0});is_original=true;stripeTreeTable();});function resetTreetable(){if(!is_original){$(".treetable").remove();$("#rule-overview").append(original_treetable.clone());$(".treetable").treetable({column:0,expandable:true,clickableNodeNames:true,initialState:"expanded",indent:0});$(".toggle-rule-display").each(function(){toggleRuleDisplay(this);});is_original=true;}}function newGroupLine(group_name){return "<tr class=\"rule-overview-inner-node\" data-tt-id=\""+group_name+"\">"+"<td colspan=\"3\"><strong>"+group_name+"</strong></td></tr>";}var KeysEnum={DEFAULT:"default",SEVERITY:"severity",RESULT:"result",NIST:"NIST SP 800-53 ID",DISA:"DISA ID",PCI_DSS:"PCI DSS Requirement",CIS:"CIS Recommendation"};function getTargetGroupsList(rule,key){switch(key){case KeysEnum.SEVERITY:var severity=rule.children(".rule-severity").text();return [severity];case KeysEnum.RESULT:var result=rule.children(".rule-result").text();return [result];default:try{var references=JSON.parse(rule.attr("data-references"));}catch(err){return ["unknown"];}if(!references.hasOwnProperty(key))return ["unknown"];return references[key];}}function sortGroups(groups,key){switch(key){case KeysEnum.SEVERITY:return ["high","medium","low"];case KeysEnum.RESULT:return groups.sort();default:return groups.sort(function(a,b){var a_parts=a.split(/[.()-]/);var b_parts=b.split(/[.()-]/);var result=0;var min_length=Math.min(a_parts.length,b_parts.length);var number=/^[1-9][0-9]*$/;for(i=0;i<min_length&&result==0;i++)if(a_parts[i].match(number)==null||a_parts[i].match(number)==null)result=a_parts[i].localeCompare(b_parts[i]);else result=parseInt(a_parts[i])-parseInt(b_parts[i]);if(result==0)result=a_parts.length-b_parts.length;return result;});}}function groupRulesBy(key){resetTreetable();if(key==KeysEnum.DEFAULT)return;var lines={};$(".rule-overview-leaf").each(function(){$(this).children("td:first").css("padding-left","0px");var id=$(this).attr("data-tt-id");var target_groups=getTargetGroupsList($(this),key);for(i=0;i<target_groups.length;i++){var target_group=target_groups[i];if(!lines.hasOwnProperty(target_group))lines[target_group]=[newGroupLine(target_group)];var clone=$(this).clone();clone.attr("data-tt-id",id+"copy"+i);clone.attr("data-tt-parent-id",target_group);var new_line=clone.wrap("<div>").parent().html();lines[target_group].push(new_line);}});$(".treetable").remove();var groups=sortGroups(Object.keys(lines),key);var html_text="";for(i=0;i<groups.length;i++)html_text+=lines[groups[i]].join("\n");new_table="<table class=\"treetable table table-bordered\"><thead><tr><th>Group</th> <th style=\"width: 120px; text-align: center\">Severity</th><th style=\"width: 120px; text-align: center\">Result</th></tr></thead><tbody>"+html_text+"</tbody></table>";$("#rule-overview").append(new_table);is_original=false;$(".treetable").treetable({column:0,expandable:true,clickableNodeNames:true,initialState:"expanded",indent:0});stripeTreeTable();}function stripeTreeTable(){var rows=$(".rule-overview-leaf:not(.rule-result-filtered)");var even=false;$(rows).each(function(){$(this).css("background-color",even?"#F9F9F9":"inherit");even=!even;});}</script></head><body><nav class="navbar navbar-default" role="navigation"><div class="navbar-header" style="float: none"><a class="navbar-brand" href="#"><svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="52" height="52" id="svg2"><g transform="matrix(0.75266991,0,0,0.75266991,-17.752968,-104.57468)" id="g32"><path d="m 24.7,173.5 c 0,-9 3.5,-17.5 9.9,-23.9 6.8,-6.8 15.7,-10.4 25,-10 8.6,0.3 16.9,3.9 22.9,9.8 6.4,6.4 9.9,14.9 10,23.8 0.1,9.1 -3.5,17.8 -10,24.3 -13.2,13.2 -34.7,13.1 -48,-0.1 -1.5,-1.5 -1.9,-4.2 0.2,-6.2 l 9,-9 c -2,-3.6 -4.9,-13.1 2.6,-20.7 7.6,-7.6 18.6,-6 24.4,-0.2 3.3,3.3 5.1,7.6 5.1,12.1 0.1,4.6 -1.8,9.1 -5.3,12.5 -4.2,4.2 -10.2,5.8 -16.1,4.4 -1.5,-0.4 -2.4,-1.9 -2.1,-3.4 0.4,-1.5 1.9,-2.4 3.4,-2.1 4.1,1 8,-0.1 10.9,-2.9 2.3,-2.3 3.6,-5.3 3.6,-8.4 0,0 0,-0.1 0,-0.1 0,-3 -1.3,-5.9 -3.5,-8.2 -3.9,-3.9 -11.3,-4.9 -16.5,0.2 -6.3,6.3 -1.6,14.1 -1.6,14.2 1.5,2.4 0.7,5 -0.9,6.3 l -8.4,8.4 c 9.9,8.9 27.2,11.2 39.1,-0.8 5.4,-5.4 8.4,-12.5 8.4,-20 0,-0.1 0,-0.2 0,-0.3 -0.1,-7.5 -3,-14.6 -8.4,-19.9 -5,-5 -11.9,-8 -19.1,-8.2 -7.8,-0.3 -15.2,2.7 -20.9,8.4 -8.7,8.7 -8.7,19 -7.9,24.3 0.3,2.4 1.1,4.9 2.2,7.3 0.6,1.4 0,3.1 -1.4,3.7 -1.4,0.6 -3.1,0 -3.7,-1.4 -1.3,-2.9 -2.2,-5.8 -2.6,-8.7 -0.3,-1.7 -0.4,-3.5 -0.4,-5.2 z" id="path34" style="fill:#12497f"></path></g></svg></a><div><h1>OpenSCAP Security Guide</h1></div></div></nav><div class="container"><div id="content"><div id="introduction"><div class="row"><div class="col-md-8 well well-lg"><h2>Guide to the Secure Configuration of Red Hat Enterprise Linux 6</h2><blockquote>with profile <mark>PCI-DSS v3 Control Baseline for Red Hat Enterprise Linux 6</mark><div class="col-md-12 well well-lg horizontal-scroll"><div class="description"><small>This is a *draft* profile for PCI-DSS v3</small></div></div></blockquote><div class="col-md-12 well well-lg horizontal-scroll"><div class="front-matter">
        <p>
          <ns12:svg xmlns:ns12="http://www.w3.org/2000/svg" enable-background="new 30 100 330 150" height="140px" id="Layer_1" version="1.1" viewBox="30 100 330 150" width="350px" x="0px" y="0px" xml:space="preserve">
        <ns12:g fill="#3A3B3B">
          <ns12:path d="m197.1 150.3s-10.1-1.2-14.4-1.2c-7.2 0-11.0 2.6-11.0 8.3 0 6.6 3.5 7.7 12.3 9.6 10.1 2.3 14.5 4.7 14.5 13.6 0 11.2-6.1 15.6-16.1 15.6-6.0 0-16.0-1.6-16.0-1.6l0.6-4.7s9.9 1.3 15.1 1.3c7.2 0 10.8-3.1 10.8-10.2 0-5.7-3.0-7.3-11.2-8.9-10.4-2.3-15.7-4.7-15.7-14.4 0-9.8 6.4-13.6 16.3-13.6 6.0 0 15.3 1.5 15.3 1.5l-0.5 4.8z"></ns12:path>
          <ns12:path d="m238.7 194.6c-3.6 0.7-9.1 1.5-13.9 1.5-15.1 0-18.5-9.2-18.5-25.9 0-17.1 3.3-26.1 18.5-26.1 5.2 0 10.7 1.0 13.9 1.6l-0.2 4.7c-3.3-0.6-9.2-1.3-13.1-1.3-11.2 0-13.2 6.7-13.2 21.1 0 14.1 1.8 20.8 13.4 20.8 4.1 0 9.5-0.7 13.0-1.3l0.2 4.8z"></ns12:path>
          <ns12:path d="m257.5 144.9h12.3l13.9 50.5h-5.6l-3.7-13.0h-21.6l-3.7 13.0h-5.5l13.9-50.5zm-3.4 32.5h19.1l-7.7-27.7h-3.8l-7.7 27.7z"></ns12:path>
          <ns12:path d="m297.2 178.4v17.0h-5.6v-50.5h18.5c11.0 0 16.1 5.3 16.1 16.3 0 11.0-5.1 17.2-16.1 17.2h-12.9zm12.8-5.0c7.4 0 10.4-4.5 10.4-12.3 0-7.7-3.1-11.3-10.4-11.3h-12.8v23.6h12.8z"></ns12:path>
        </ns12:g>
        <ns12:g fill="#676767">
          <ns12:path d="m176.8 211.2s-2.8-0.3-4.0-0.3c-1.5 0-2.2 0.5-2.2 1.4 0 0.9 0.5 1.2 2.8 1.9 2.9 0.9 3.8 1.8 3.8 4.0 0 3.0-2.0 4.3-4.7 4.3-1.9 0-4.5-0.6-4.5-0.6l0.3-2.1s2.7 0.4 4.1 0.4c1.5 0 2.1-0.7 2.1-1.8 0-0.8-0.5-1.2-2.4-1.8-3.1-0.9-4.2-1.9-4.2-4.1 0-2.8 1.9-4.0 4.6-4.0 1.8 0 4.5 0.5 4.5 0.5l-0.2 2.2z"></ns12:path>
          <ns12:path d="m180.6 208.7h8.8v2.4h-6.0v3.2h4.8v2.4h-4.9v3.3h6.0v2.4h-8.8v-13.6z"></ns12:path>
          <ns12:path d="m201.2 222.1c-0.9 0.2-2.7 0.5-4.0 0.5-4.2 0-5.2-2.3-5.2-7.0 0-5.2 1.2-7.0 5.2-7.0 1.4 0 3.1 0.3 4.0 0.5l-0.1 2.2c-0.9-0.1-2.6-0.3-3.5-0.3-2.1 0-2.8 0.7-2.8 4.6 0 3.7 0.5 4.6 2.8 4.6 0.9 0 2.6-0.2 3.4-0.3l0.1 2.3z"></ns12:path>
          <ns12:path d="m209.5 220.2c1.6 0 2.4-0.8 2.4-2.4v-9.1h2.8v9.0c0 3.4-1.8 4.8-5.2 4.8-3.4 0-5.2-1.4-5.2-4.8v-9.0h2.8v9.1c0 1.6 0.8 2.4 2.4 2.4z"></ns12:path>
          <ns12:path d="m221.3 217.8v4.6h-2.8v-13.6h5.3c3.1 0 4.8 1.4 4.8 4.5 0 1.9-0.8 3.1-2.0 3.9l1.9 5.2h-3.0l-1.6-4.6h-2.7zm2.5-6.7h-2.5v4.3h2.6c1.4 0 1.9-1.0 1.9-2.2 0-1.3-0.7-2.2-2.0-2.2z"></ns12:path>
          <ns12:path d="m231.9 208.7h2.8v13.6h-2.8v-13.6z"></ns12:path>
          <ns12:path d="m237.4 208.7h10.0v2.4h-3.6v11.2h-2.8v-11.2h-3.6v-2.4z"></ns12:path>
          <ns12:path d="m255.7 222.3h-2.8v-5.5l-4.2-8.1h3.1l2.5 5.4 2.5-5.4h3.1l-4.2 8.1v5.5z"></ns12:path>
          <ns12:path d="m273.4 215.1h4.0v7.1s-2.9 0.5-4.6 0.5c-4.4 0-5.6-2.5-5.6-7.0 0-5.0 1.4-7.0 5.5-7.0 2.1 0 4.7 0.6 4.7 0.6l-0.1 2.1s-2.4-0.3-4.2-0.3c-2.4 0-3.1 0.8-3.1 4.6 0 3.6 0.5 4.6 3.0 4.6 0.8 0 1.7-0.1 1.7-0.1v-2.6h-1.2v-2.4z"></ns12:path>
          <ns12:path d="m286 220.2c1.6 0 2.4-0.8 2.4-2.4v-9.1h2.8v9.0c0 3.4-1.8 4.8-5.2 4.8s-5.2-1.4-5.2-4.8v-9.0h2.8v9.1c0 1.6 0.8 2.4 2.4 2.4z"></ns12:path>
          <ns12:path d="m295.0 208.7h2.8v13.6h-2.8v-13.6z"></ns12:path>
          <ns12:path d="m301.8 222.3v-13.6h4.6c4.7 0 5.8 2.0 5.6 6.5 0 4.6-0.9 7.1-5.8 7.1h-4.6zm4.6-11.2h-1.8v8.8h1.8c2.7 0 2.9-1.6 2.9-4.7 0-3.0-0.3-4.1-3.0-4.1z"></ns12:path>
          <ns12:path d="m315.5 208.7h8.8v2.4h-6.0v3.2h4.8v2.4h-4.8v3.3h6.0v2.4h-8.8v-13.6z"></ns12:path>
        </ns12:g>
        <ns12:path d="m116.0 204.9h-2.8c-1.5 0-2.8 1.2-2.8 2.7v19.2c0 1.5 1.3 2.7 2.8 2.7h27.9c1.5 0 2.8-1.2 2.8-2.7v-19.2c0-1.5-1.3-2.7-2.8-2.7h-2.8v-8.2c0-6.1-5.0-11.0-11.2-11.0-6.2 0-11.2 4.9-11.2 11.0v8.2zm5.6-8.2c0-3.0 2.5-5.5 5.6-5.4 3.1 0 5.6 2.4 5.6 5.5v8.2h-11.2v-8.2z" fill="#6D0B2B"></ns12:path>
        <ns12:g fill="#AD1D3F">
          <ns12:path d="m106.4 214.7c-16.4 11.4-37.5 7.8-50.0-3.4l11.9-11.7c2.3-1.9 3.4-5.4 1.2-8.8-0.1-0.1-6.7-11.0 2.3-19.8 7.3-7.2 17.8-5.8 23.3-0.3 3.2 3.1 4.9 7.1 4.9 11.4v0.1c0 4.3-1.8 8.5-5.1 11.7-4.0 3.9-9.6 5.4-15.4 4.1-2.1-0.5-4.3 0.8-4.8 2.9-0.5 2.1 0.8 4.2 2.9 4.7 8.4 2.0 16.9-0.3 22.8-6.1 4.9-4.8 7.5-10.9 7.4-17.4-0.0-6.3-2.6-12.3-7.3-16.8-8.2-8.1-23.8-10.3-34.5 0.3-10.7 10.5-6.6 23.8-3.7 28.8l-12.8 12.6c-2.9 2.9-2.3 6.6-0.2 8.7 15.4 15.2 38.7 17.9 56.9 8.2l-0.0-9.1z"></ns12:path>
          <ns12:path d="m43.9 188.4c-1.1-7.5-1.1-21.8 11.2-33.9 8.0-7.9 18.5-12.0 29.5-11.7 10.2 0.3 20.1 4.5 27.1 11.4 7.6 7.4 11.8 17.3 11.9 27.8v0.1c1.16-0.3 2.4-0.4 3.6-0.4 1.5 0 2.9 0.2 4.3 0.6 0-0.1 0.0-0.2 0.0-0.3-0.1-12.5-5.2-24.3-14.2-33.2-8.4-8.3-20.2-13.3-32.4-13.7-13.2-0.5-25.8 4.5-35.4 14.0-9.1 8.9-14.0 20.8-14.0 33.3 0 2.4 0.2 4.8 0.5 7.2 0.6 4.0 1.8 8.1 3.7 12.2 0.9 2.0 3.2 2.8 5.2 1.9 2.0-0.9 2.9-3.1 2.0-5.1-1.5-3.3-2.6-6.8-3.1-10.1z"></ns12:path>
        </ns12:g>
        <ns12:circle cx="127.26" cy="218.49" fill="#fff" r="3.233"></ns12:circle>
      </ns12:svg>
        </p>
      </div><div class="description">This guide presents a catalog of security-relevant
configuration settings for Red Hat Enterprise Linux 6. It is a rendering of
content structured in the eXtensible Configuration Checklist Description Format (XCCDF)
in order to support security automation.  The SCAP content is
is available in the <code>scap-security-guide</code> package which is developed at
<a href="https://www.open-scap.org/security-policies/scap-security-guide">https://www.open-scap.org/security-policies/scap-security-guide</a>.
<br>
<br>
Providing system administrators with such guidance informs them how to securely
configure systems under their control in a variety of network roles. Policy
makers and baseline creators can use this catalog of settings, with its
associated references to higher-level security control catalogs, in order to
assist them in security baseline creation. This guide is a <i>catalog, not a
checklist,</i> and satisfaction of every item is not likely to be possible or
sensible in many operational scenarios. However, the XCCDF format enables
granular selection and adjustment of settings, and their association with OVAL
and OCIL content provides an automated checking capability. Transformations of
this document, and its associated automated checking content, are capable of
providing baselines that meet a diverse set of policy objectives. Some example
XCCDF <i>Profiles</i>, which are selections of items that form checklists and
can be used as baselines, are available with this guide. They can be
processed, in an automated fashion, with tools that support the Security
Content Automation Protocol (SCAP). The DISA STIG for Red Hat Enterprise Linux 6,
which provides required settings for US Department of Defense systems, is
one example of a baseline created from this guidance.
</div><div class="top-spacer-10"><div class="alert alert-info"><div>
<p>This benchmark is a direct port of a <i>SCAP Security Guide </i> benchmark developed for <i>Red Hat Enterprise Linux</i>. It has been modified through an automated process to remove specific dependencies on <i>Red Hat Enterprise Linux</i> and to function with <i>Scientifc Linux</i>. The result is a generally useful <i>SCAP Security Guide</i> benchmark with the following caveats:</p>
<ul>
<li><i>Scientifc Linux</i> is not an exact copy of <i>Red Hat Enterprise Linux</i>. Scientific Linux is a Linux distribution produced by <i>Fermi National Accelerator Laboratory</i>. It is a free and open source operating system based on <i>Red Hat Enterprise Linux</i> and aims to be "as close to the commercial enterprise distribution as we can get it." There may be configuration differences that produce false positives and/or false negatives. If this occurs please file a bug report.</li>

<li><i>Scientifc Linux</i> is derived from the free and open source software made available by Red Hat, but it is not produced, maintained or supported by <i>Red Hat</i>. <i>Scientifc Linux</i> has its own build system, compiler options, patchsets, and is a community supported, non-commercial operating system. <i>Scientifc Linux</i> does not inherit certifications or evaluations from <i>Red Hat Enterprise Linux</i>. As such, some configuration rules (such as those requiring <i>FIPS 140-2</i> encryption) will continue to fail on <i>Scientifc Linux</i>.</li>
</ul>

<p>Members of the <i>Scientifc Linux</i> community are invited to participate in <a href="http://open-scap.org">OpenSCAP</a> and <a href="https://github.com/OpenSCAP/scap-security-guide">SCAP Security Guide</a> development. Bug reports and patches can be sent to GitHub: <a href="https://github.com/OpenSCAP/scap-security-guide">https://github.com/OpenSCAP/scap-security-guide</a>. The mailing list is at <a href="https://fedorahosted.org/mailman/listinfo/scap-security-guide">https://fedorahosted.org/mailman/listinfo/scap-security-guide</a>.</p></div></div><div class="alert alert-info">Do not attempt to implement any of the settings in
this guide without first testing them in a non-operational environment. The
creators of this guidance assume no responsibility whatsoever for its use by
other parties, and makes no guarantees, expressed or implied, about its
quality, reliability, or any other characteristic.</div></div></div><table class="table table-bordered"><tr><th>Profile Title</th><td>PCI-DSS v3 Control Baseline for Red Hat Enterprise Linux 6</td></tr><tr><th>Profile ID</th><td>xccdf_org.ssgproject.content_profile_pci-dss_centric</td></tr></table></div><div class="col-md-4"><h2>Revision History</h2><p>Current version: <strong>0.1.31</strong></p><ul><li><strong>draft</strong>
                            (as of 2017-03-07)
                        </li></ul><h2>Platforms</h2><ul class="list-group"><li class="list-group-item"><span class="label label-default">cpe:/o:redhat:enterprise_linux:6</span></li><li class="list-group-item"><span class="label label-default">cpe:/o:scientificlinux:scientificlinux:6</span></li><li class="list-group-item"><span class="label label-default">cpe:/o:redhat:enterprise_linux:6::client</span></li><li class="list-group-item"><span class="label label-default">cpe:/o:redhat:enterprise_linux:6::computenode</span></li></ul></div></div></div><h2>Table of Contents</h2><ol><li><a href="#xccdf_org.ssgproject.content_group_pcidss-req-2.">2.</a></li><ol><li><a href="#xccdf_org.ssgproject.content_group_pcidss-req-2.1">2.1</a></li><li><a href="#xccdf_org.ssgproject.content_group_pcidss-req-2.2">2.2</a></li><li><a href="#xccdf_org.ssgproject.content_group_pcidss-req-2.3">2.3</a></li><li><a href="#xccdf_org.ssgproject.content_group_pcidss-req-2.4">2.4</a></li><li><a href="#xccdf_org.ssgproject.content_group_pcidss-req-2.5">2.5</a></li><li><a href="#xccdf_org.ssgproject.content_group_pcidss-req-2.6">2.6</a></li></ol><li><a href="#xccdf_org.ssgproject.content_group_pcidss-req-3.">3.</a></li><ol><li><a href="#xccdf_org.ssgproject.content_group_pcidss-req-3.1">3.1</a></li><li><a href="#xccdf_org.ssgproject.content_group_pcidss-req-3.2">3.2</a></li><li><a href="#xccdf_org.ssgproject.content_group_pcidss-req-3.3">3.3</a></li><li><a href="#xccdf_org.ssgproject.content_group_pcidss-req-3.4">3.4</a></li><li><a href="#xccdf_org.ssgproject.content_group_pcidss-req-3.5">3.5</a></li><li><a href="#xccdf_org.ssgproject.content_group_pcidss-req-3.6">3.6</a></li><li><a href="#xccdf_org.ssgproject.content_group_pcidss-req-3.7">3.7</a></li></ol><li><a href="#xccdf_org.ssgproject.content_group_pcidss-req-4.">4.</a></li><ol><li><a href="#xccdf_org.ssgproject.content_group_pcidss-req-4.1">4.1</a></li><li><a href="#xccdf_org.ssgproject.content_group_pcidss-req-4.2">4.2</a></li><li><a href="#xccdf_org.ssgproject.content_group_pcidss-req-4.3">4.3</a></li></ol><li><a href="#xccdf_org.ssgproject.content_group_pcidss-req-5.">5.</a></li><ol><li><a href="#xccdf_org.ssgproject.content_group_pcidss-req-5.1">5.1</a></li><li><a href="#xccdf_org.ssgproject.content_group_pcidss-req-5.2">5.2</a></li><li><a href="#xccdf_org.ssgproject.content_group_pcidss-req-5.3">5.3</a></li><li><a href="#xccdf_org.ssgproject.content_group_pcidss-req-5.4">5.4</a></li></ol><li><a href="#xccdf_org.ssgproject.content_group_pcidss-req-6.">6.</a></li><ol><li><a href="#xccdf_org.ssgproject.content_group_pcidss-req-6.1">6.1</a></li><li><a href="#xccdf_org.ssgproject.content_group_pcidss-req-6.2">6.2</a></li><li><a href="#xccdf_org.ssgproject.content_group_pcidss-req-6.3">6.3</a></li><li><a href="#xccdf_org.ssgproject.content_group_pcidss-req-6.4">6.4</a></li><li><a href="#xccdf_org.ssgproject.content_group_pcidss-req-6.5">6.5</a></li><li><a href="#xccdf_org.ssgproject.content_group_pcidss-req-6.6">6.6</a></li><li><a href="#xccdf_org.ssgproject.content_group_pcidss-req-6.7">6.7</a></li></ol><li><a href="#xccdf_org.ssgproject.content_group_pcidss-req-7.">7.</a></li><ol><li><a href="#xccdf_org.ssgproject.content_group_pcidss-req-7.1">7.1</a></li><li><a href="#xccdf_org.ssgproject.content_group_pcidss-req-7.2">7.2</a></li><li><a href="#xccdf_org.ssgproject.content_group_pcidss-req-7.3">7.3</a></li></ol><li><a href="#xccdf_org.ssgproject.content_group_pcidss-req-8.">8.</a></li><ol><li><a href="#xccdf_org.ssgproject.content_group_pcidss-req-8.1">8.1</a></li><li><a href="#xccdf_org.ssgproject.content_group_pcidss-req-8.2">8.2</a></li><li><a href="#xccdf_org.ssgproject.content_group_pcidss-req-8.3">8.3</a></li><li><a href="#xccdf_org.ssgproject.content_group_pcidss-req-8.4">8.4</a></li><li><a href="#xccdf_org.ssgproject.content_group_pcidss-req-8.5">8.5</a></li><li><a href="#xccdf_org.ssgproject.content_group_pcidss-req-8.6">8.6</a></li><li><a href="#xccdf_org.ssgproject.content_group_pcidss-req-8.7">8.7</a></li><li><a href="#xccdf_org.ssgproject.content_group_pcidss-req-8.8">8.8</a></li></ol><li><a href="#xccdf_org.ssgproject.content_group_pcidss-req-10.">10.</a></li><ol><li><a href="#xccdf_org.ssgproject.content_group_pcidss-req-10.1">10.1</a></li><li><a href="#xccdf_org.ssgproject.content_group_pcidss-req-10.2">10.2</a></li><li><a href="#xccdf_org.ssgproject.content_group_pcidss-req-10.3">10.3</a></li><li><a href="#xccdf_org.ssgproject.content_group_pcidss-req-10.4">10.4</a></li><li><a href="#xccdf_org.ssgproject.content_group_pcidss-req-10.5">10.5</a></li><li><a href="#xccdf_org.ssgproject.content_group_pcidss-req-10.6">10.6</a></li><li><a href="#xccdf_org.ssgproject.content_group_pcidss-req-10.7">10.7</a></li><li><a href="#xccdf_org.ssgproject.content_group_pcidss-req-10.8">10.8</a></li></ol><li><a href="#xccdf_org.ssgproject.content_group_pcidss-req-11.">11.</a></li><ol><li><a href="#xccdf_org.ssgproject.content_group_pcidss-req-11.1">11.1</a></li><li><a href="#xccdf_org.ssgproject.content_group_pcidss-req-11.2">11.2</a></li><li><a href="#xccdf_org.ssgproject.content_group_pcidss-req-11.3">11.3</a></li><li><a href="#xccdf_org.ssgproject.content_group_pcidss-req-11.4">11.4</a></li><li><a href="#xccdf_org.ssgproject.content_group_pcidss-req-11.5">11.5</a></li><li><a href="#xccdf_org.ssgproject.content_group_pcidss-req-11.6">11.6</a></li></ol><li><a href="#xccdf_org.ssgproject.content_group_values">Values</a></li><li><a href="#xccdf_org.ssgproject.content_group_non-pci-dss">Non PCI-DSS</a></li></ol><div id="guide-tree"><h2>Checklist</h2><table class="treetable table table-bordered"><tbody><tr data-tt-id="children-xccdf_org.ssgproject.content_benchmark_PCIDSS-RHEL-6"><td style="padding-left: 0px"><small>contains 94 rules</small></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-2." class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-2." data-tt-parent-id="children-xccdf_org.ssgproject.content_benchmark_PCIDSS-RHEL-6"><td style="padding-left: 19px"><h3 id="xccdf_org.ssgproject.content_group_pcidss-req-2.">2.<span class="label label-default pull-right">group</span></h3><p>Do not use vendor-supplied defaults for system passwords and other</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2." data-tt-parent-id="children-xccdf_org.ssgproject.content_benchmark_PCIDSS-RHEL-6"><td style="padding-left: 19px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-2.1" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-2.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2."><td style="padding-left: 38px"><h3 id="xccdf_org.ssgproject.content_group_pcidss-req-2.1">2.1<span class="label label-default pull-right">group</span></h3><p>Always change vendor-supplied</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2."><td style="padding-left: 38px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-2.1.1" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-2.1.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.1"><td style="padding-left: 57px"><h3>2.1.1<span class="label label-default pull-right">group</span></h3><p>For wireless environments</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.1.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.1"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-2.1.1.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-2.1.1.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.1.1"><td style="padding-left: 76px"><h3>2.1.1.a<span class="label label-default pull-right">group</span></h3><p>Interview responsible personnel and examine</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.1.1.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.1.1"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-2.1.1.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-2.1.1.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.1.1"><td style="padding-left: 76px"><h3>2.1.1.b<span class="label label-default pull-right">group</span></h3><p>Interview personnel and examine policies and</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.1.1.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.1.1"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-2.1.1.c" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-2.1.1.c" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.1.1"><td style="padding-left: 76px"><h3>2.1.1.c<span class="label label-default pull-right">group</span></h3><p>Examine vendor documentation and login to</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.1.1.c" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.1.1"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-2.1.1.d" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-2.1.1.d" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.1.1"><td style="padding-left: 76px"><h3>2.1.1.d<span class="label label-default pull-right">group</span></h3><p>Examine vendor documentation and observe</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.1.1.d" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.1.1"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-2.1.1.e" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-2.1.1.e" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.1.1"><td style="padding-left: 76px"><h3>2.1.1.e<span class="label label-default pull-right">group</span></h3><p>Examine vendor documentation and observe</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.1.1.e" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.1.1"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-2.1.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-2.1.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.1"><td style="padding-left: 57px"><h3>2.1.a<span class="label label-default pull-right">group</span></h3><p>Choose a sample of system components, and attempt</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.1.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.1"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-2.1.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-2.1.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.1"><td style="padding-left: 57px"><h3>2.1.b<span class="label label-default pull-right">group</span></h3><p>For the sample of system components, verify that all</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.1.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.1"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-2.1.c" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-2.1.c" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.1"><td style="padding-left: 57px"><h3>2.1.c<span class="label label-default pull-right">group</span></h3><p>Interview personnel and examine supporting</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.1.c" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.1"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-2.2" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-2.2" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2."><td style="padding-left: 38px"><h3 id="xccdf_org.ssgproject.content_group_pcidss-req-2.2">2.2<span class="label label-default pull-right">group</span></h3><p>Develop configuration standards for</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.2" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2."><td style="padding-left: 38px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-2.2.1" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-2.2.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.2"><td style="padding-left: 57px"><h3>2.2.1<span class="label label-default pull-right">group</span></h3><p>Implement only one primary</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.2.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.2"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-2.2.1.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-2.2.1.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.2.1"><td style="padding-left: 76px"><h3>2.2.1.a<span class="label label-default pull-right">group</span></h3><p>Select a sample of system components and</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.2.1.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.2.1"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-2.2.1.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-2.2.1.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.2.1"><td style="padding-left: 76px"><h3>2.2.1.b<span class="label label-default pull-right">group</span></h3><p>If virtualization technologies are used, inspect the</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.2.1.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.2.1"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-2.2.2" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-2.2.2" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.2"><td style="padding-left: 57px"><h3>2.2.2<span class="label label-default pull-right">group</span></h3><p>Enable only necessary services,</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.2.2" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.2"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-2.2.2.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-2.2.2.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.2.2"><td style="padding-left: 76px"><h3>2.2.2.a<span class="label label-default pull-right">group</span></h3><p>Select a sample of system components and</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.2.2.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.2.2"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-2.2.2.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-2.2.2.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.2.2"><td style="padding-left: 76px"><h3>2.2.2.b<span class="label label-default pull-right">group</span></h3><p>Identify any enabled insecure services, daemons,</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.2.2.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.2.2"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-2.2.3" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-2.2.3" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.2"><td style="padding-left: 57px"><h3>2.2.3<span class="label label-default pull-right">group</span></h3><p>Implement additional security</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.2.3" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.2"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-2.2.3.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-2.2.3.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.2.3"><td style="padding-left: 76px"><h3>2.2.3.a<span class="label label-default pull-right">group</span></h3><p>Inspect configuration settings to verify that security</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.2.3.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.2.3"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-2.2.4" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-2.2.4" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.2"><td style="padding-left: 57px"><h3>2.2.4<span class="label label-default pull-right">group</span></h3><p>Configure system security</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.2.4" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.2"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-2.2.4.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-2.2.4.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.2.4"><td style="padding-left: 76px"><h3>2.2.4.a<span class="label label-default pull-right">group</span></h3><p>Interview system administrators and/or security</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.2.4.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.2.4"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-2.2.4.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-2.2.4.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.2.4"><td style="padding-left: 76px"><h3>2.2.4.b<span class="label label-default pull-right">group</span></h3><p>Examine the system configuration standards to</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.2.4.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.2.4"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-2.2.4.c" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-2.2.4.c" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.2.4"><td style="padding-left: 76px"><h3>2.2.4.c<span class="label label-default pull-right">group</span></h3><p>Select a sample of system components and</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.2.4.c" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.2.4"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-2.2.5" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-2.2.5" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.2"><td style="padding-left: 57px"><h3>2.2.5<span class="label label-default pull-right">group</span></h3><p>Remove all unnecessary</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.2.5" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.2"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-2.2.5.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-2.2.5.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.2.5"><td style="padding-left: 76px"><h3>2.2.5.a<span class="label label-default pull-right">group</span></h3><p>Select a sample of system components and</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.2.5.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.2.5"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-2.2.5.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-2.2.5.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.2.5"><td style="padding-left: 76px"><h3>2.2.5.b<span class="label label-default pull-right">group</span></h3><p>. Examine the documentation and security</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.2.5.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.2.5"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-2.2.5.c" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-2.2.5.c" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.2.5"><td style="padding-left: 76px"><h3>2.2.5.c<span class="label label-default pull-right">group</span></h3><p>. Examine the documentation and security</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.2.5.c" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.2.5"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-2.2.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-2.2.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.2"><td style="padding-left: 57px"><h3>2.2.a<span class="label label-default pull-right">group</span></h3><p></p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.2.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.2"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-2.2.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-2.2.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.2"><td style="padding-left: 57px"><h3>2.2.b<span class="label label-default pull-right">group</span></h3><p>Examine policies and interview personnel to</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.2.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.2"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-2.2.c" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-2.2.c" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.2"><td style="padding-left: 57px"><h3>2.2.c<span class="label label-default pull-right">group</span></h3><p>Examine policies and interview personnel to</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.2.c" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.2"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-2.2.d" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-2.2.d" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.2"><td style="padding-left: 57px"><h3>2.2.d<span class="label label-default pull-right">group</span></h3><p>Verify that system configuration standards include the</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.2.d" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.2"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-2.3" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-2.3" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2."><td style="padding-left: 38px"><h3 id="xccdf_org.ssgproject.content_group_pcidss-req-2.3">2.3<span class="label label-default pull-right">group</span></h3><p>Encrypt all non-console</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.3" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2."><td style="padding-left: 38px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-2.3.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-2.3.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.3"><td style="padding-left: 57px"><h3>2.3.a<span class="label label-default pull-right">group</span></h3><p>Observe an administrator log on to each system and</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.3.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.3"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-2.3.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-2.3.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.3"><td style="padding-left: 57px"><h3>2.3.b<span class="label label-default pull-right">group</span></h3><p>Review services and parameter files on systems to</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.3.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.3"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-2.3.c" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-2.3.c" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.3"><td style="padding-left: 57px"><h3>2.3.c<span class="label label-default pull-right">group</span></h3><p>Observe an administrator log on to each system to</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.3.c" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.3"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-2.3.d" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-2.3.d" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.3"><td style="padding-left: 57px"><h3>2.3.d<span class="label label-default pull-right">group</span></h3><p>Examine vendor documentation and interview</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.3.d" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.3"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-2.4" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-2.4" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2."><td style="padding-left: 38px"><h3 id="xccdf_org.ssgproject.content_group_pcidss-req-2.4">2.4<span class="label label-default pull-right">group</span></h3><p>Maintain an inventory of system</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.4" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2."><td style="padding-left: 38px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-2.4.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-2.4.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.4"><td style="padding-left: 57px"><h3>2.4.a<span class="label label-default pull-right">group</span></h3><p>Examine system inventory to verify that a list of</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.4.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.4"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-2.4.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-2.4.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.4"><td style="padding-left: 57px"><h3>2.4.b<span class="label label-default pull-right">group</span></h3><p>Interview personnel to verify the documented inventory</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.4.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.4"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-2.5" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-2.5" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2."><td style="padding-left: 38px"><h3 id="xccdf_org.ssgproject.content_group_pcidss-req-2.5">2.5<span class="label label-default pull-right">group</span></h3><p>Ensure that security policies and</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.5" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2."><td style="padding-left: 38px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-2.6" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-2.6" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2."><td style="padding-left: 38px"><h3 id="xccdf_org.ssgproject.content_group_pcidss-req-2.6">2.6<span class="label label-default pull-right">group</span></h3><p>Shared hosting providers must</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2.6" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-2."><td style="padding-left: 38px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-3." class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-3." data-tt-parent-id="children-xccdf_org.ssgproject.content_benchmark_PCIDSS-RHEL-6"><td style="padding-left: 19px"><h3 id="xccdf_org.ssgproject.content_group_pcidss-req-3.">3.<span class="label label-default pull-right">group</span></h3><p>Protect stored cardholder data</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3." data-tt-parent-id="children-xccdf_org.ssgproject.content_benchmark_PCIDSS-RHEL-6"><td style="padding-left: 19px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-3.1" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-3.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3."><td style="padding-left: 38px"><h3 id="xccdf_org.ssgproject.content_group_pcidss-req-3.1">3.1<span class="label label-default pull-right">group</span></h3><p>Keep cardholder data storage to a</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3."><td style="padding-left: 38px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-3.1.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-3.1.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.1"><td style="padding-left: 57px"><h3>3.1.a<span class="label label-default pull-right">group</span></h3><p>Examine the data retention and disposal policies,</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.1.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.1"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-3.1.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-3.1.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.1"><td style="padding-left: 57px"><h3>3.1.b<span class="label label-default pull-right">group</span></h3><p>Interview personnel to verify that:</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.1.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.1"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-3.1.c" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-3.1.c" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.1"><td style="padding-left: 57px"><h3>3.1.c<span class="label label-default pull-right">group</span></h3><p>For a sample of system components that store cardholder</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.1.c" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.1"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-3.2" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-3.2" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3."><td style="padding-left: 38px"><h3 id="xccdf_org.ssgproject.content_group_pcidss-req-3.2">3.2<span class="label label-default pull-right">group</span></h3><p>Do not store sensitive authentication</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.2" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3."><td style="padding-left: 38px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-3.2.1" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-3.2.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.2"><td style="padding-left: 57px"><h3>3.2.1<span class="label label-default pull-right">group</span></h3><p>Do not store the full contents of</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.2.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.2"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-3.2.2" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-3.2.2" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.2"><td style="padding-left: 57px"><h3>3.2.2<span class="label label-default pull-right">group</span></h3><p>Do not store the card verification</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.2.2" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.2"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-3.2.3" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-3.2.3" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.2"><td style="padding-left: 57px"><h3>3.2.3<span class="label label-default pull-right">group</span></h3><p>Do not store the personal</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.2.3" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.2"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-3.2.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-3.2.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.2"><td style="padding-left: 57px"><h3>3.2.a<span class="label label-default pull-right">group</span></h3><p>For issuers and/or companies that support issuing</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.2.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.2"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-3.2.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-3.2.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.2"><td style="padding-left: 57px"><h3>3.2.b<span class="label label-default pull-right">group</span></h3><p>For issuers and/or companies that support issuing</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.2.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.2"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-3.2.c" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-3.2.c" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.2"><td style="padding-left: 57px"><h3>3.2.c<span class="label label-default pull-right">group</span></h3><p>For all other entities, if sensitive authentication data is</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.2.c" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.2"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-3.2.d" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-3.2.d" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.2"><td style="padding-left: 57px"><h3>3.2.d<span class="label label-default pull-right">group</span></h3><p>For all other entities, if sensitive authentication data is</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.2.d" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.2"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-3.3" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-3.3" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3."><td style="padding-left: 38px"><h3 id="xccdf_org.ssgproject.content_group_pcidss-req-3.3">3.3<span class="label label-default pull-right">group</span></h3><p>Mask PAN when displayed (the first</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.3" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3."><td style="padding-left: 38px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-3.3.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-3.3.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.3"><td style="padding-left: 57px"><h3>3.3.a<span class="label label-default pull-right">group</span></h3><p>Examine written policies and procedures for masking the</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.3.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.3"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-3.3.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-3.3.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.3"><td style="padding-left: 57px"><h3>3.3.b<span class="label label-default pull-right">group</span></h3><p>Examine system configurations to verify that full PAN is</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.3.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.3"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-3.3.c" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-3.3.c" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.3"><td style="padding-left: 57px"><h3>3.3.c<span class="label label-default pull-right">group</span></h3><p>Examine displays of PAN (for example, on screen, on</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.3.c" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.3"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-3.4" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-3.4" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3."><td style="padding-left: 38px"><h3 id="xccdf_org.ssgproject.content_group_pcidss-req-3.4">3.4<span class="label label-default pull-right">group</span></h3><p>Render PAN unreadable anywhere it</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.4" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3."><td style="padding-left: 38px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-3.4.1" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-3.4.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.4"><td style="padding-left: 57px"><h3>3.4.1<span class="label label-default pull-right">group</span></h3><p>If disk encryption is used (rather</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.4.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.4"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-3.4.1.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-3.4.1.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.4.1"><td style="padding-left: 76px"><h3>3.4.1.a<span class="label label-default pull-right">group</span></h3><p>If disk encryption is used, inspect the configuration</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.4.1.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.4.1"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-3.4.1.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-3.4.1.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.4.1"><td style="padding-left: 76px"><h3>3.4.1.b<span class="label label-default pull-right">group</span></h3><p>Observe processes and interview personnel to verify</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.4.1.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.4.1"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-3.4.1.c" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-3.4.1.c" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.4.1"><td style="padding-left: 76px"><h3>3.4.1.c<span class="label label-default pull-right">group</span></h3><p>Examine the configurations and observe the</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.4.1.c" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.4.1"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-3.4.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-3.4.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.4"><td style="padding-left: 57px"><h3>3.4.a<span class="label label-default pull-right">group</span></h3><p>Examine documentation about the system used to protect</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.4.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.4"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-3.4.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-3.4.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.4"><td style="padding-left: 57px"><h3>3.4.b<span class="label label-default pull-right">group</span></h3><p>Examine several tables or files from a sample of data</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.4.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.4"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-3.4.c" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-3.4.c" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.4"><td style="padding-left: 57px"><h3>3.4.c<span class="label label-default pull-right">group</span></h3><p>Examine a sample of removable media (for example,</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.4.c" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.4"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-3.4.d" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-3.4.d" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.4"><td style="padding-left: 57px"><h3>3.4.d<span class="label label-default pull-right">group</span></h3><p>Examine a sample of audit logs to confirm that the PAN is</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.4.d" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.4"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-3.4.e" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-3.4.e" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.4"><td style="padding-left: 57px"><h3>3.4.e<span class="label label-default pull-right">group</span></h3><p>If</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.4.e" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.4"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-3.5" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-3.5" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3."><td style="padding-left: 38px"><h3 id="xccdf_org.ssgproject.content_group_pcidss-req-3.5">3.5<span class="label label-default pull-right">group</span></h3><p>Document and implement</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.5" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3."><td style="padding-left: 38px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-3.5.1" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-3.5.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.5"><td style="padding-left: 57px"><h3>3.5.1<span class="label label-default pull-right">group</span></h3><p>Restrict access to cryptographic</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.5.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.5"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-3.5.2" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-3.5.2" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.5"><td style="padding-left: 57px"><h3>3.5.2<span class="label label-default pull-right">group</span></h3><p>Store secret and private keys</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.5.2" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.5"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-3.5.2.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-3.5.2.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.5.2"><td style="padding-left: 76px"><h3>3.5.2.a<span class="label label-default pull-right">group</span></h3><p>Examine documented procedures to verify that</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.5.2.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.5.2"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-3.5.2.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-3.5.2.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.5.2"><td style="padding-left: 76px"><h3>3.5.2.b<span class="label label-default pull-right">group</span></h3><p>Examine system configurations and key storage</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.5.2.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.5.2"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-3.5.2.c" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-3.5.2.c" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.5.2"><td style="padding-left: 76px"><h3>3.5.2.c<span class="label label-default pull-right">group</span></h3><p>Wherever key-encrypting keys are used, examine</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.5.2.c" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.5.2"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-3.5.3" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-3.5.3" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.5"><td style="padding-left: 57px"><h3>3.5.3<span class="label label-default pull-right">group</span></h3><p>Store cryptographic keys in the</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.5.3" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.5"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-3.6" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-3.6" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3."><td style="padding-left: 38px"><h3 id="xccdf_org.ssgproject.content_group_pcidss-req-3.6">3.6<span class="label label-default pull-right">group</span></h3><p>Fully document and implement all</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3."><td style="padding-left: 38px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-3.6.1" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-3.6.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6"><td style="padding-left: 57px"><h3>3.6.1<span class="label label-default pull-right">group</span></h3><p>Generation of strong</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-3.6.1.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-3.6.1.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6.1"><td style="padding-left: 76px"><h3>3.6.1.a<span class="label label-default pull-right">group</span></h3><p>Verify that key-management procedures specify how</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6.1.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6.1"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-3.6.1.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-3.6.1.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6.1"><td style="padding-left: 76px"><h3>3.6.1.b<span class="label label-default pull-right">group</span></h3><p>Observe the method for generating keys to verify that</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6.1.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6.1"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-3.6.2" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-3.6.2" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6"><td style="padding-left: 57px"><h3>3.6.2<span class="label label-default pull-right">group</span></h3><p>Secure cryptographic key</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6.2" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-3.6.2.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-3.6.2.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6.2"><td style="padding-left: 76px"><h3>3.6.2.a<span class="label label-default pull-right">group</span></h3><p>Verify that key-management procedures specify how</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6.2.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6.2"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-3.6.2.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-3.6.2.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6.2"><td style="padding-left: 76px"><h3>3.6.2.b<span class="label label-default pull-right">group</span></h3><p>Observe the method for distributing keys to verify that</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6.2.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6.2"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-3.6.3" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-3.6.3" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6"><td style="padding-left: 57px"><h3>3.6.3<span class="label label-default pull-right">group</span></h3><p>Secure cryptographic key storage</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6.3" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-3.6.3.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-3.6.3.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6.3"><td style="padding-left: 76px"><h3>3.6.3.a<span class="label label-default pull-right">group</span></h3><p>Verify that key-management procedures specify how</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6.3.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6.3"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-3.6.3.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-3.6.3.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6.3"><td style="padding-left: 76px"><h3>3.6.3.b<span class="label label-default pull-right">group</span></h3><p>Observe the method for storing keys to verify that</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6.3.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6.3"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-3.6.4" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-3.6.4" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6"><td style="padding-left: 57px"><h3>3.6.4<span class="label label-default pull-right">group</span></h3><p>Cryptographic key changes for</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6.4" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-3.6.4.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-3.6.4.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6.4"><td style="padding-left: 76px"><h3>3.6.4.a<span class="label label-default pull-right">group</span></h3><p>Verify that key-management procedures include a</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6.4.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6.4"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-3.6.4.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-3.6.4.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6.4"><td style="padding-left: 76px"><h3>3.6.4.b<span class="label label-default pull-right">group</span></h3><p>Interview personnel to verify that keys are changed at</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6.4.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6.4"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-3.6.5" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-3.6.5" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6"><td style="padding-left: 57px"><h3>3.6.5<span class="label label-default pull-right">group</span></h3><p>Retirement or replacement (for</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6.5" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-3.6.5.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-3.6.5.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6.5"><td style="padding-left: 76px"><h3>3.6.5.a<span class="label label-default pull-right">group</span></h3><p>Verify that key-management procedures specify</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6.5.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6.5"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-3.6.5.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-3.6.5.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6.5"><td style="padding-left: 76px"><h3>3.6.5.b<span class="label label-default pull-right">group</span></h3><p>Interview personnel to verify the following processes</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6.5.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6.5"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-3.6.6" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-3.6.6" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6"><td style="padding-left: 57px"><h3>3.6.6<span class="label label-default pull-right">group</span></h3><p>If manual clear-text cryptographic</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6.6" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-3.6.6.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-3.6.6.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6.6"><td style="padding-left: 76px"><h3>3.6.6.a<span class="label label-default pull-right">group</span></h3><p>Verify that manual clear-text key-management</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6.6.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6.6"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-3.6.7" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-3.6.7" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6"><td style="padding-left: 57px"><h3>3.6.7<span class="label label-default pull-right">group</span></h3><p>Prevention of unauthorized</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6.7" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-3.6.7.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-3.6.7.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6.7"><td style="padding-left: 76px"><h3>3.6.7.a<span class="label label-default pull-right">group</span></h3><p>Verify that key-management procedures specify</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6.7.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6.7"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-3.6.7.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-3.6.7.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6.7"><td style="padding-left: 76px"><h3>3.6.7.b<span class="label label-default pull-right">group</span></h3><p>Interview personnel and/or observe processes to</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6.7.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6.7"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-3.6.8" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-3.6.8" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6"><td style="padding-left: 57px"><h3>3.6.8<span class="label label-default pull-right">group</span></h3><p>Requirement for cryptographic</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6.8" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-3.6.8.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-3.6.8.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6.8"><td style="padding-left: 76px"><h3>3.6.8.a<span class="label label-default pull-right">group</span></h3><p>Verify that key-management procedures specify</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6.8.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6.8"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-3.6.8.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-3.6.8.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6.8"><td style="padding-left: 76px"><h3>3.6.8.b<span class="label label-default pull-right">group</span></h3><p>Observe documentation or other evidence showing</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6.8.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6.8"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-3.6.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-3.6.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6"><td style="padding-left: 57px"><h3>3.6.b<span class="label label-default pull-right">group</span></h3><p>Examine the key-management procedures and processes</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.6"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-3.7" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-3.7" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3."><td style="padding-left: 38px"><h3 id="xccdf_org.ssgproject.content_group_pcidss-req-3.7">3.7<span class="label label-default pull-right">group</span></h3><p>Ensure that security policies and</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3.7" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-3."><td style="padding-left: 38px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-4." class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-4." data-tt-parent-id="children-xccdf_org.ssgproject.content_benchmark_PCIDSS-RHEL-6"><td style="padding-left: 19px"><h3 id="xccdf_org.ssgproject.content_group_pcidss-req-4.">4.<span class="label label-default pull-right">group</span></h3><p>Encrypt transmission of cardholder data across open, public networks</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-4." data-tt-parent-id="children-xccdf_org.ssgproject.content_benchmark_PCIDSS-RHEL-6"><td style="padding-left: 19px"><small>contains 1 rule</small></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-4.1" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-4.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-4."><td style="padding-left: 38px"><h3 id="xccdf_org.ssgproject.content_group_pcidss-req-4.1">4.1<span class="label label-default pull-right">group</span></h3><p>Use strong cryptography and security</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-4.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-4."><td style="padding-left: 38px"><small>contains 1 rule</small></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-4.1.1" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-4.1.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-4.1"><td style="padding-left: 57px"><h3>4.1.1<span class="label label-default pull-right">group</span></h3><p>Ensure wireless networks transmitting</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-4.1.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-4.1"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-4.1.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-4.1.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-4.1"><td style="padding-left: 57px"><h3>4.1.a<span class="label label-default pull-right">group</span></h3><p>Identify all locations where cardholder data is</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-4.1.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-4.1"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-4.1.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-4.1.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-4.1"><td style="padding-left: 57px"><h3>4.1.b<span class="label label-default pull-right">group</span></h3><p>Review documented policies and procedures to verify</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-4.1.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-4.1"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-4.1.c" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-4.1.c" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-4.1"><td style="padding-left: 57px"><h3>4.1.c<span class="label label-default pull-right">group</span></h3><p>Select and observe a sample of inbound and outbound</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-4.1.c" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-4.1"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-4.1.d" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-4.1.d" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-4.1"><td style="padding-left: 57px"><h3>4.1.d<span class="label label-default pull-right">group</span></h3><p>Examine keys and certificates to verify that only</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-4.1.d" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-4.1"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-4.1.e" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-4.1.e" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-4.1"><td style="padding-left: 57px"><h3>4.1.e<span class="label label-default pull-right">group</span></h3><p>Examine system configurations to verify that the</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-4.1.e" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-4.1"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-4.1.f" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-4.1.f" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-4.1"><td style="padding-left: 57px"><h3>4.1.f<span class="label label-default pull-right">group</span></h3><p>Examine system configurations to verify that the proper</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-4.1.f" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-4.1"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-4.1.g" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-4.1.g" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-4.1"><td style="padding-left: 57px"><h3>4.1.g<span class="label label-default pull-right">group</span></h3><p>For TLS implementations, examine system</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-4.1.g" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-4.1"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_package_openswan_installed" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_package_openswan_installed" id="guide-tree-leaf-idm45561209944560" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-4.1"><td style="padding-left: 57px"><h4>Install openswan or libreswan Package<span class="label label-default pull-right">rule</span></h4><p>The openswan and libreswan packages provide an implementation of
IPsec and IKE, which permits the creation of secure tunnels over untrusted
networks.

        The <code>openswan</code> package can be installed with the following command:
        <pre>$ sudo yum install openswan</pre>

        The <code>libreswan</code> package can be installed with the following command:
        <pre>$ sudo yum install libreswan</pre>
</p><span class="label label-primary">Rationale:</span><p>Providing the ability for remote users or systems
to initiate a secure VPN connection protects information when it is
transmitted over a wide area network.
</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-17</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">MA-4</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">SC-8</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">1130</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">1131</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-4.1</a></p></div><span class="label label-success">Remediation script:</span><pre><code>
function package_command {

# Load function arguments into local variables
local package_operation=$1
local package=$2

# Check sanity of the input
if [ $# -ne "2" ]
then
  echo "Usage: package_command 'install/uninstall' 'rpm_package_name"
  echo "Aborting."
  exit 1
fi

# If dnf is installed, use dnf; otherwise, use yum
if [ -f "/usr/bin/dnf" ] ; then
  install_util="/usr/bin/dnf"
else
  install_util="/usr/bin/yum"
fi

if [ "$package_operation" != 'remove' ] ; then
  # If the rpm is not installed, install the rpm
  if ! /bin/rpm -q --quiet $package; then
    $install_util -y $package_operation $package
  fi
else
  # If the rpm is installed, uninstall the rpm
  if /bin/rpm -q --quiet $package; then
    $install_util -y $package_operation $package
  fi
fi

}

package_command install openswan
</code></pre><span class="label label-success">Remediation script:</span><pre><code>- name: Ensure openswan is installed
  package:
    name="{{item}}"
    state=present
  with_items:
    - openswan
</code></pre><span class="label label-success">Remediation script:</span><pre><code>include install_openswan

class install_openswan {
  package { 'openswan':
    ensure =&gt; 'installed',
  }
}
</code></pre><span class="label label-success">Remediation script:</span><pre><code>
package -add=openswan
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-4.2" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-4.2" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-4."><td style="padding-left: 38px"><h3 id="xccdf_org.ssgproject.content_group_pcidss-req-4.2">4.2<span class="label label-default pull-right">group</span></h3><p>Never send unprotected PANs by end-</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-4.2" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-4."><td style="padding-left: 38px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-4.2.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-4.2.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-4.2"><td style="padding-left: 57px"><h3>4.2.a<span class="label label-default pull-right">group</span></h3><p>If end-user messaging technologies are used to send</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-4.2.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-4.2"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-4.2.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-4.2.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-4.2"><td style="padding-left: 57px"><h3>4.2.b<span class="label label-default pull-right">group</span></h3><p>Review written policies to verify the existence of a</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-4.2.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-4.2"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-4.3" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-4.3" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-4."><td style="padding-left: 38px"><h3 id="xccdf_org.ssgproject.content_group_pcidss-req-4.3">4.3<span class="label label-default pull-right">group</span></h3><p>Ensure that security policies and</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-4.3" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-4."><td style="padding-left: 38px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-5." class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-5." data-tt-parent-id="children-xccdf_org.ssgproject.content_benchmark_PCIDSS-RHEL-6"><td style="padding-left: 19px"><h3 id="xccdf_org.ssgproject.content_group_pcidss-req-5.">5.<span class="label label-default pull-right">group</span></h3><p>Protect all systems against malware and regularly update anti-virus</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-5." data-tt-parent-id="children-xccdf_org.ssgproject.content_benchmark_PCIDSS-RHEL-6"><td style="padding-left: 19px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-5.1" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-5.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-5."><td style="padding-left: 38px"><h3 id="xccdf_org.ssgproject.content_group_pcidss-req-5.1">5.1<span class="label label-default pull-right">group</span></h3><p>Deploy anti-virus software on all</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-5.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-5."><td style="padding-left: 38px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-5.1.1" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-5.1.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-5.1"><td style="padding-left: 57px"><h3>5.1.1<span class="label label-default pull-right">group</span></h3><p>Ensure that anti-virus programs</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-5.1.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-5.1"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-5.1.2" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-5.1.2" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-5.1"><td style="padding-left: 57px"><h3>5.1.2<span class="label label-default pull-right">group</span></h3><p>For systems considered to be not</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-5.1.2" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-5.1"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-5.2" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-5.2" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-5."><td style="padding-left: 38px"><h3 id="xccdf_org.ssgproject.content_group_pcidss-req-5.2">5.2<span class="label label-default pull-right">group</span></h3><p>Ensure that all anti-virus mechanisms</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-5.2" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-5."><td style="padding-left: 38px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-5.2.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-5.2.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-5.2"><td style="padding-left: 57px"><h3>5.2.a<span class="label label-default pull-right">group</span></h3><p>Examine policies and procedures to verify that anti-virus</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-5.2.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-5.2"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-5.2.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-5.2.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-5.2"><td style="padding-left: 57px"><h3>5.2.b<span class="label label-default pull-right">group</span></h3><p>Examine anti-virus configurations, including the master</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-5.2.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-5.2"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-5.2.c" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-5.2.c" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-5.2"><td style="padding-left: 57px"><h3>5.2.c<span class="label label-default pull-right">group</span></h3><p>Examine a sample of system components, including all</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-5.2.c" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-5.2"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-5.2.d" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-5.2.d" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-5.2"><td style="padding-left: 57px"><h3>5.2.d<span class="label label-default pull-right">group</span></h3><p>Examine anti-virus configurations, including the master</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-5.2.d" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-5.2"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-5.3" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-5.3" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-5."><td style="padding-left: 38px"><h3 id="xccdf_org.ssgproject.content_group_pcidss-req-5.3">5.3<span class="label label-default pull-right">group</span></h3><p>Ensure that anti-virus mechanisms</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-5.3" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-5."><td style="padding-left: 38px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-5.3.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-5.3.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-5.3"><td style="padding-left: 57px"><h3>5.3.a<span class="label label-default pull-right">group</span></h3><p>Examine anti-virus configurations, including the master</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-5.3.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-5.3"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-5.3.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-5.3.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-5.3"><td style="padding-left: 57px"><h3>5.3.b<span class="label label-default pull-right">group</span></h3><p>Examine anti-virus configurations, including the master</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-5.3.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-5.3"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-5.3.c" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-5.3.c" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-5.3"><td style="padding-left: 57px"><h3>5.3.c<span class="label label-default pull-right">group</span></h3><p>Interview responsible personnel and observe processes to</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-5.3.c" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-5.3"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-5.4" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-5.4" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-5."><td style="padding-left: 38px"><h3 id="xccdf_org.ssgproject.content_group_pcidss-req-5.4">5.4<span class="label label-default pull-right">group</span></h3><p>Ensure that security policies and</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-5.4" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-5."><td style="padding-left: 38px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-6." class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-6." data-tt-parent-id="children-xccdf_org.ssgproject.content_benchmark_PCIDSS-RHEL-6"><td style="padding-left: 19px"><h3 id="xccdf_org.ssgproject.content_group_pcidss-req-6.">6.<span class="label label-default pull-right">group</span></h3><p>Develop and maintain secure systems and applications</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6." data-tt-parent-id="children-xccdf_org.ssgproject.content_benchmark_PCIDSS-RHEL-6"><td style="padding-left: 19px"><small>contains 4 rules</small></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-6.1" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-6.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6."><td style="padding-left: 38px"><h3 id="xccdf_org.ssgproject.content_group_pcidss-req-6.1">6.1<span class="label label-default pull-right">group</span></h3><p>Establish a process to identify security</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6."><td style="padding-left: 38px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-6.1.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-6.1.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.1"><td style="padding-left: 57px"><h3>6.1.a<span class="label label-default pull-right">group</span></h3><p>Examine policies and procedures to verify that</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.1.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.1"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-6.1.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-6.1.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.1"><td style="padding-left: 57px"><h3>6.1.b<span class="label label-default pull-right">group</span></h3><p>Interview responsible personnel and observe</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.1.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.1"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-6.2" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-6.2" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6."><td style="padding-left: 38px"><h3 id="xccdf_org.ssgproject.content_group_pcidss-req-6.2">6.2<span class="label label-default pull-right">group</span></h3><p>Ensure that all system components and</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.2" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6."><td style="padding-left: 38px"><small>contains 4 rules</small></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-6.2.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-6.2.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.2"><td style="padding-left: 57px"><h3>6.2.a<span class="label label-default pull-right">group</span></h3><p>Examine policies and procedures related to security-</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.2.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.2"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-6.2.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-6.2.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.2"><td style="padding-left: 57px"><h3>6.2.b<span class="label label-default pull-right">group</span></h3><p>For a sample of system components and related</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.2.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.2"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_ensure_redhat_gpgkey_installed" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_ensure_redhat_gpgkey_installed" id="guide-tree-leaf-idm45561209867296" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.2"><td style="padding-left: 57px"><h4>Ensure Red Hat GPG Key Installed<span class="label label-default pull-right">rule</span></h4><p>
To ensure the system can cryptographically verify base software
packages come from Red Hat (and to connect to the Red Hat Network to
receive them), the Red Hat GPG key must properly be installed.  
To install the Red Hat GPG key, run:
<pre>$ sudo rhn_register</pre>
If the system is not connected to the Internet or an RHN Satellite,
then install the Red Hat GPG key from trusted media such as
the Red Hat installation CD-ROM or DVD. Assuming the disc is mounted
in <code>/media/cdrom</code>, use the following command as the root user to import
it into the keyring:
<pre>$ sudo rpm --import /media/cdrom/RPM-GPG-KEY</pre>
</p><span class="label label-primary">Rationale:</span><p>
The Red Hat GPG key is necessary to cryptographically verify packages
are from Red Hat.
</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">SI-7</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">MA-1(b)</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">351</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-6.2</a></p></div><span class="label label-success">Remediation script:</span><pre><code># The two fingerprints below are retrieved from https://access.redhat.com/security/team/key
readonly REDHAT_RELEASE_2_FINGERPRINT="567E 347A D004 4ADE 55BA 8A5F 199E 2F91 FD43 1D51"
readonly REDHAT_AUXILIARY_FINGERPRINT="43A6 E49C 4A38 F4BE 9ABF 2A53 4568 9C88 2FA6 58E0"
# Location of the key we would like to import (once it's integrity verified)
readonly REDHAT_RELEASE_KEY="/etc/pki/rpm-gpg/RPM-GPG-KEY-redhat-release"

RPM_GPG_DIR_PERMS=$(stat -c %a "$(dirname "$REDHAT_RELEASE_KEY")")

# Verify /etc/pki/rpm-gpg directory permissions are safe
if [ "${RPM_GPG_DIR_PERMS}" -le "755" ]
then
  # If they are safe, try to obtain fingerprints from the key file
  # (to ensure there won't be e.g. CRC error).
  IFS=$'\n' GPG_OUT=($(gpg --with-fingerprint "${REDHAT_RELEASE_KEY}" | grep 'Key fingerprint ='))
  GPG_RESULT=$?
  # No CRC error, safe to proceed
  if [ "${GPG_RESULT}" -eq "0" ]
  then
    tr -s ' ' &lt;&lt;&lt; "${GPG_RESULT}" | grep -vE "${REDHAT_RELEASE_2_FINGERPRINT}|${REDHAT_AUXILIARY_FINGERPRINT}" || {
      # If file doesn't contains any keys with unknown fingerprint, import it
      rpm --import "${REDHAT_RELEASE_KEY}"
    }
  fi
fi
</code></pre><span class="label label-success">Remediation script:</span><pre><code>
- name: "Read permission of GPG key directory"
  stat:
    path: /etc/pki/rpm-gpg/
  register: gpg_key_directory_permission

  # It should fail, if it doesn't find any fingerprints in file - maybe file was not parsed well.
- name: "Read signatures in GPG key"
  shell: "gpg --with-fingerprint '/etc/pki/rpm-gpg/RPM-GPG-KEY-redhat-release' | grep 'Key fingerprint =' | tr -s ' ' | sed 's;.*= ;;g'"
  changed_when: False
  register: gpg_fingerprints

- name: "Set Fact: Valid fingerprints"
  set_fact:
     gpg_valid_fingerprints: ("567E 347A D004 4ADE 55BA 8A5F 199E 2F91 FD43 1D51" "43A6 E49C 4A38 F4BE 9ABF 2A53 4568 9C88 2FA6 58E0")
  
- name: "Import RedHat GPG key"
  rpm_key:
    state: present
    key: /etc/pki/rpm-gpg/RPM-GPG-KEY-redhat-release
  when:
    (gpg_key_directory_permission.stat.mode &lt;= '0755')
    and ({{ gpg_fingerprints.stdout_lines | difference(gpg_valid_fingerprints) }} | length == 0)
    and (gpg_fingerprints.stdout_lines | length &gt; 0)
    and (ansible_distribution == "RedHat")
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_ensure_gpgcheck_globally_activated" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_ensure_gpgcheck_globally_activated" id="guide-tree-leaf-idm45561209849088" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.2"><td style="padding-left: 57px"><h4>Ensure gpgcheck Enabled In Main Yum Configuration<span class="label label-default pull-right">rule</span></h4><p>The <code>gpgcheck</code> option controls whether
RPM packages' signatures are always checked prior to installation.
To configure yum to check package signatures before installing
them, ensure the following line appears in <code>/etc/yum.conf</code> in
the <code>[main]</code> section:
<pre>gpgcheck=1</pre>
</p><span class="label label-primary">Rationale:</span><p>
Ensuring the validity of packages' cryptographic signatures prior to
installation ensures the authenticity of the software and
protects against malicious tampering.
</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">SI-7</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">MA-1(b)</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">352</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">663</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-6.2</a></p></div><span class="label label-success">Remediation script:</span><pre><code>sed -i 's/gpgcheck=.*/gpgcheck=1/g' /etc/yum.conf
</code></pre><span class="label label-success">Remediation script:</span><pre><code>
- name: "Check existence of yum on Fedora"
  stat:
    path: /etc/yum.conf
  register: yum_config_file
  when: ansible_distribution == "Fedora"

# We can have yum also in Fedora, but probably not forever
- name: Ensure GPG check is globally activated (yum)
  ini_file:
    dest: "{{item}}"
    section: main
    option: gpgcheck
    value: 1
    create: False
  with_items: "/etc/yum.conf"
  when: ansible_distribution == "RedHat" or yum_config_file.stat.exists

- name: Ensure GPG check is globally activated (dnf)
  ini_file:
    dest: "{{item}}"
    section: main
    option: gpgcheck
    value: 1
    create: False
  with_items: "/etc/dnf/dnf.conf"
  when: ansible_distribution == "Fedora"
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_ensure_gpgcheck_never_disabled" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_ensure_gpgcheck_never_disabled" id="guide-tree-leaf-idm45561209833008" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.2"><td style="padding-left: 57px"><h4>Ensure gpgcheck Enabled For All Yum Package Repositories<span class="label label-default pull-right">rule</span></h4><p>To ensure signature checking is not disabled for
any repos, remove any lines from files in <code>/etc/yum.repos.d</code> of the form:
<pre>gpgcheck=0</pre>
</p><span class="label label-primary">Rationale:</span><p>
Ensuring all packages' cryptographic signatures are valid prior to
installation ensures the authenticity of the software and
protects against malicious tampering.
</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">SI-7</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">MA-1(b)</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">352</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">663</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-6.2</a></p></div><span class="label label-success">Remediation script:</span><pre><code>sed -i 's/gpgcheck=.*/gpgcheck=1/g' /etc/yum.repos.d/*
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_security_patches_up_to_date" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_security_patches_up_to_date" id="guide-tree-leaf-idm45561209820112" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.2"><td style="padding-left: 57px"><h4>Ensure Software Patches Installed<span class="label label-default pull-right">rule</span></h4><p>If the system is joined to the Red Hat Network, a Red Hat Satellite Server,
or a yum server, run the following command to install updates:
<pre>$ sudo yum update</pre>
If the system is not configured to use one of these sources, updates (in the form of RPM packages)
can be manually downloaded from the Red Hat Network and installed using <code>rpm</code>.
</p><span class="label label-primary">Rationale:</span><p>
Installing software updates is a fundamental mitigation against
the exploitation of publicly-known vulnerabilities.
</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">SI-2</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">MA-1(b)</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">1227</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">1233</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-6.2</a></p></div><span class="label label-success">Remediation script:</span><pre><code>yum -y update
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-6.3" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-6.3" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6."><td style="padding-left: 38px"><h3 id="xccdf_org.ssgproject.content_group_pcidss-req-6.3">6.3<span class="label label-default pull-right">group</span></h3><p>Develop internal and external software</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.3" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6."><td style="padding-left: 38px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-6.3.1" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-6.3.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.3"><td style="padding-left: 57px"><h3>6.3.1<span class="label label-default pull-right">group</span></h3><p>Remove development, test and/or</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.3.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.3"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-6.3.2" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-6.3.2" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.3"><td style="padding-left: 57px"><h3>6.3.2<span class="label label-default pull-right">group</span></h3><p>Review custom code prior to release</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.3.2" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.3"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-6.3.2.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-6.3.2.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.3.2"><td style="padding-left: 76px"><h3>6.3.2.a<span class="label label-default pull-right">group</span></h3><p>Examine written software-development procedures</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.3.2.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.3.2"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-6.3.2.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-6.3.2.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.3.2"><td style="padding-left: 76px"><h3>6.3.2.b<span class="label label-default pull-right">group</span></h3><p>Select a sample of recent custom application</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.3.2.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.3.2"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-6.3.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-6.3.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.3"><td style="padding-left: 57px"><h3>6.3.a<span class="label label-default pull-right">group</span></h3><p>Examine written software-development processes to</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.3.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.3"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-6.3.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-6.3.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.3"><td style="padding-left: 57px"><h3>6.3.b<span class="label label-default pull-right">group</span></h3><p>Examine written software-development processes to</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.3.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.3"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-6.3.c" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-6.3.c" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.3"><td style="padding-left: 57px"><h3>6.3.c<span class="label label-default pull-right">group</span></h3><p>Examine written software-development processes to</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.3.c" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.3"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-6.3.d" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-6.3.d" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.3"><td style="padding-left: 57px"><h3>6.3.d<span class="label label-default pull-right">group</span></h3><p>Interview software developers to verify that written</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.3.d" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.3"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-6.4" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-6.4" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6."><td style="padding-left: 38px"><h3 id="xccdf_org.ssgproject.content_group_pcidss-req-6.4">6.4<span class="label label-default pull-right">group</span></h3><p>Follow change control processes and</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.4" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6."><td style="padding-left: 38px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-6.4.1" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-6.4.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.4"><td style="padding-left: 57px"><h3>6.4.1<span class="label label-default pull-right">group</span></h3><p>Separate development/test</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.4.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.4"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-6.4.1.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-6.4.1.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.4.1"><td style="padding-left: 76px"><h3>6.4.1.a<span class="label label-default pull-right">group</span></h3><p>Examine network documentation and network</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.4.1.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.4.1"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-6.4.1.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-6.4.1.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.4.1"><td style="padding-left: 76px"><h3>6.4.1.b<span class="label label-default pull-right">group</span></h3><p>Examine access controls settings to verify that</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.4.1.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.4.1"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-6.4.2" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-6.4.2" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.4"><td style="padding-left: 57px"><h3>6.4.2<span class="label label-default pull-right">group</span></h3><p>Separation of duties between</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.4.2" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.4"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-6.4.3" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-6.4.3" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.4"><td style="padding-left: 57px"><h3>6.4.3<span class="label label-default pull-right">group</span></h3><p>Production data (live PANs) are not</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.4.3" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.4"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-6.4.3.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-6.4.3.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.4.3"><td style="padding-left: 76px"><h3>6.4.3.a<span class="label label-default pull-right">group</span></h3><p>Observe testing processes and interview</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.4.3.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.4.3"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-6.4.3.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-6.4.3.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.4.3"><td style="padding-left: 76px"><h3>6.4.3.b<span class="label label-default pull-right">group</span></h3><p>Examine a sample of test data to verify production</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.4.3.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.4.3"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-6.4.4" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-6.4.4" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.4"><td style="padding-left: 57px"><h3>6.4.4<span class="label label-default pull-right">group</span></h3><p>Removal of test data and accounts</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.4.4" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.4"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-6.4.4.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-6.4.4.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.4.4"><td style="padding-left: 76px"><h3>6.4.4.a<span class="label label-default pull-right">group</span></h3><p>Observe testing processes and interview</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.4.4.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.4.4"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-6.4.4.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-6.4.4.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.4.4"><td style="padding-left: 76px"><h3>6.4.4.b<span class="label label-default pull-right">group</span></h3><p>Examine a sample of data and accounts from</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.4.4.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.4.4"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-6.4.5" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-6.4.5" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.4"><td style="padding-left: 57px"><h3>6.4.5<span class="label label-default pull-right">group</span></h3><p>Change control procedures for the</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.4.5" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.4"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-6.4.5.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-6.4.5.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.4.5"><td style="padding-left: 76px"><h3>6.4.5.a<span class="label label-default pull-right">group</span></h3><p>Examine documented change control procedures</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.4.5.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.4.5"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-6.4.5.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-6.4.5.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.4.5"><td style="padding-left: 76px"><h3>6.4.5.b<span class="label label-default pull-right">group</span></h3><p>For a sample of system components, interview</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.4.5.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.4.5"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-6.5" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-6.5" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6."><td style="padding-left: 38px"><h3 id="xccdf_org.ssgproject.content_group_pcidss-req-6.5">6.5<span class="label label-default pull-right">group</span></h3><p>Address common coding vulnerabilities in</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.5" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6."><td style="padding-left: 38px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-6.5.1" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-6.5.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.5"><td style="padding-left: 57px"><h3>6.5.1<span class="label label-default pull-right">group</span></h3><p>Injection flaws, particularly SQL</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.5.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.5"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-6.5.10" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-6.5.10" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.5"><td style="padding-left: 57px"><h3>6.5.10<span class="label label-default pull-right">group</span></h3><p>Broken authentication and session</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.5.10" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.5"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-6.5.2" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-6.5.2" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.5"><td style="padding-left: 57px"><h3>6.5.2<span class="label label-default pull-right">group</span></h3><p>Buffer overflows</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.5.2" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.5"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-6.5.3" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-6.5.3" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.5"><td style="padding-left: 57px"><h3>6.5.3<span class="label label-default pull-right">group</span></h3><p>Insecure cryptographic storage</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.5.3" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.5"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-6.5.4" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-6.5.4" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.5"><td style="padding-left: 57px"><h3>6.5.4<span class="label label-default pull-right">group</span></h3><p>Insecure communications</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.5.4" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.5"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-6.5.5" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-6.5.5" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.5"><td style="padding-left: 57px"><h3>6.5.5<span class="label label-default pull-right">group</span></h3><p>Improper error handling</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.5.5" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.5"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-6.5.6" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-6.5.6" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.5"><td style="padding-left: 57px"><h3>6.5.6<span class="label label-default pull-right">group</span></h3><p>Examine software-development policies and</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.5.6" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.5"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-6.5.7" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-6.5.7" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.5"><td style="padding-left: 57px"><h3>6.5.7<span class="label label-default pull-right">group</span></h3><p>Cross-site scripting (XSS)</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.5.7" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.5"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-6.5.8" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-6.5.8" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.5"><td style="padding-left: 57px"><h3>6.5.8<span class="label label-default pull-right">group</span></h3><p>Improper access control (such as</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.5.8" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.5"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-6.5.9" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-6.5.9" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.5"><td style="padding-left: 57px"><h3>6.5.9<span class="label label-default pull-right">group</span></h3><p>Cross-site request forgery (CSRF)</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.5.9" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.5"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-6.5.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-6.5.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.5"><td style="padding-left: 57px"><h3>6.5.a<span class="label label-default pull-right">group</span></h3><p>Examine software-development policies and</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.5.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.5"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-6.5.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-6.5.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.5"><td style="padding-left: 57px"><h3>6.5.b<span class="label label-default pull-right">group</span></h3><p>Interview a sample of developers to verify that they are</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.5.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.5"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-6.5.c" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-6.5.c" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.5"><td style="padding-left: 57px"><h3>6.5.c<span class="label label-default pull-right">group</span></h3><p>Examine records of training to verify that software</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.5.c" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.5"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-6.6" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-6.6" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6."><td style="padding-left: 38px"><h3 id="xccdf_org.ssgproject.content_group_pcidss-req-6.6">6.6<span class="label label-default pull-right">group</span></h3><p>For public-facing web applications,</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.6" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6."><td style="padding-left: 38px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-6.7" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-6.7" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6."><td style="padding-left: 38px"><h3 id="xccdf_org.ssgproject.content_group_pcidss-req-6.7">6.7<span class="label label-default pull-right">group</span></h3><p>Ensure that security policies and</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6.7" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-6."><td style="padding-left: 38px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-7." class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-7." data-tt-parent-id="children-xccdf_org.ssgproject.content_benchmark_PCIDSS-RHEL-6"><td style="padding-left: 19px"><h3 id="xccdf_org.ssgproject.content_group_pcidss-req-7.">7.<span class="label label-default pull-right">group</span></h3><p>Restrict access to cardholder data by business need to know</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-7." data-tt-parent-id="children-xccdf_org.ssgproject.content_benchmark_PCIDSS-RHEL-6"><td style="padding-left: 19px"><small>contains 2 rules</small></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-7.1" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-7.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-7."><td style="padding-left: 38px"><h3 id="xccdf_org.ssgproject.content_group_pcidss-req-7.1">7.1<span class="label label-default pull-right">group</span></h3><p>Limit access to system</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-7.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-7."><td style="padding-left: 38px"><small>contains 2 rules</small></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-7.1.1" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-7.1.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-7.1"><td style="padding-left: 57px"><h3>7.1.1<span class="label label-default pull-right">group</span></h3><p>Define access needs for</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-7.1.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-7.1"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-7.1.2" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-7.1.2" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-7.1"><td style="padding-left: 57px"><h3>7.1.2<span class="label label-default pull-right">group</span></h3><p>Restrict access to privileged</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-7.1.2" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-7.1"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-7.1.2.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-7.1.2.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-7.1.2"><td style="padding-left: 76px"><h3>7.1.2.a<span class="label label-default pull-right">group</span></h3><p>Interview personnel responsible for assigning access to</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-7.1.2.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-7.1.2"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-7.1.2.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-7.1.2.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-7.1.2"><td style="padding-left: 76px"><h3>7.1.2.b<span class="label label-default pull-right">group</span></h3><p>Select a sample of user IDs with privileged access and</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-7.1.2.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-7.1.2"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-7.1.3" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-7.1.3" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-7.1"><td style="padding-left: 57px"><h3>7.1.3<span class="label label-default pull-right">group</span></h3><p>Assign access based on</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-7.1.3" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-7.1"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-7.1.4" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-7.1.4" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-7.1"><td style="padding-left: 57px"><h3>7.1.4<span class="label label-default pull-right">group</span></h3><p>Require documented</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-7.1.4" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-7.1"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_file_user_owner_grub_conf" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_file_user_owner_grub_conf" id="guide-tree-leaf-idm45561209729344" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-7.1"><td style="padding-left: 57px"><h4>Verify /etc/grub.conf User Ownership<span class="label label-default pull-right">rule</span></h4><p>The file <code>/etc/grub.conf</code> should 
be owned by the <code>root</code> user to prevent destruction 
or modification of the file.

    To properly set the owner of <code>/etc/grub.conf</code>, run the command:
    <pre xml:space="preserve">$ sudo chown root /etc/grub.conf</pre>
</p><span class="label label-primary">Rationale:</span><p>
Only root should be able to modify important boot parameters.
</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-6(7)</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">225</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-7.1</a></p></div><span class="label label-success">Remediation script:</span><pre><code>chown root /etc/grub.conf
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_file_group_owner_grub_conf" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_file_group_owner_grub_conf" id="guide-tree-leaf-idm45561209716352" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-7.1"><td style="padding-left: 57px"><h4>Verify /etc/grub.conf Group Ownership<span class="label label-default pull-right">rule</span></h4><p>The file <code>/etc/grub.conf</code> should 
be group-owned by the <code>root</code> group to prevent 
destruction or modification of the file.

    To properly set the group owner of <code>/etc/grub.conf</code>, run the command:
    <pre xml:space="preserve">$ sudo chgrp root /etc/grub.conf</pre>
</p><span class="label label-primary">Rationale:</span><p>
The <code>root</code> group is a highly-privileged group. Furthermore, the group-owner of this
file should not have any access privileges anyway.
</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-6(7)</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">225</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-7.1</a></p></div><span class="label label-success">Remediation script:</span><pre><code>chgrp root /etc/grub.conf
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-7.2" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-7.2" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-7."><td style="padding-left: 38px"><h3 id="xccdf_org.ssgproject.content_group_pcidss-req-7.2">7.2<span class="label label-default pull-right">group</span></h3><p>Establish an access control</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-7.2" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-7."><td style="padding-left: 38px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-7.2.1" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-7.2.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-7.2"><td style="padding-left: 57px"><h3>7.2.1<span class="label label-default pull-right">group</span></h3><p>Coverage of all system</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-7.2.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-7.2"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-7.2.2" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-7.2.2" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-7.2"><td style="padding-left: 57px"><h3>7.2.2<span class="label label-default pull-right">group</span></h3><p>Assignment of privileges to</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-7.2.2" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-7.2"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-7.2.3" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-7.2.3" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-7.2"><td style="padding-left: 57px"><h3>7.2.3<span class="label label-default pull-right">group</span></h3><p></p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-7.2.3" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-7.2"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-7.3" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-7.3" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-7."><td style="padding-left: 38px"><h3 id="xccdf_org.ssgproject.content_group_pcidss-req-7.3">7.3<span class="label label-default pull-right">group</span></h3><p>Ensure that security policies and</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-7.3" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-7."><td style="padding-left: 38px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-8." class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-8." data-tt-parent-id="children-xccdf_org.ssgproject.content_benchmark_PCIDSS-RHEL-6"><td style="padding-left: 19px"><h3 id="xccdf_org.ssgproject.content_group_pcidss-req-8.">8.<span class="label label-default pull-right">group</span></h3><p>Identify and authenticate access to system components</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8." data-tt-parent-id="children-xccdf_org.ssgproject.content_benchmark_PCIDSS-RHEL-6"><td style="padding-left: 19px"><small>contains 30 rules</small></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-8.1" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-8.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8."><td style="padding-left: 38px"><h3 id="xccdf_org.ssgproject.content_group_pcidss-req-8.1">8.1<span class="label label-default pull-right">group</span></h3><p>Define and implement policies and</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8."><td style="padding-left: 38px"><small>contains 8 rules</small></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-8.1.1" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-8.1.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.1"><td style="padding-left: 57px"><h3>8.1.1<span class="label label-default pull-right">group</span></h3><p>Assign all users a unique ID</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.1.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.1"><td style="padding-left: 57px"><small>contains 1 rule</small></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_account_unique_name" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_account_unique_name" id="guide-tree-leaf-idm45561209677824" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.1.1"><td style="padding-left: 76px"><h4>Ensure All Accounts on the System Have Unique Names<span class="label label-default pull-right">rule</span></h4><p>
Change usernames, or delete accounts, so each has a unique name.
</p><span class="label label-primary">Rationale:</span><p>
Unique usernames allow for accountability on the system.
</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">770</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">804</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-8.1.1</a></p></div></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-8.1.2" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-8.1.2" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.1"><td style="padding-left: 57px"><h3>8.1.2<span class="label label-default pull-right">group</span></h3><p>Control addition, deletion, and</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.1.2" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.1"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-8.1.3" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-8.1.3" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.1"><td style="padding-left: 57px"><h3>8.1.3<span class="label label-default pull-right">group</span></h3><p>Immediately revoke access for</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.1.3" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.1"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-8.1.3.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-8.1.3.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.1.3"><td style="padding-left: 76px"><h3>8.1.3.a<span class="label label-default pull-right">group</span></h3><p>Select a sample of users terminated in the past six</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.1.3.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.1.3"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-8.1.3.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-8.1.3.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.1.3"><td style="padding-left: 76px"><h3>8.1.3.b<span class="label label-default pull-right">group</span></h3><p>Verify all physical authentication methods</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.1.3.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.1.3"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-8.1.4" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-8.1.4" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.1"><td style="padding-left: 57px"><h3>8.1.4<span class="label label-default pull-right">group</span></h3><p>Remove/disable inactive user</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.1.4" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.1"><td style="padding-left: 57px"><small>contains 1 rule</small></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_account_disable_post_pw_expiration" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_account_disable_post_pw_expiration" id="guide-tree-leaf-idm45561209660240" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.1.4"><td style="padding-left: 76px"><h4>Set Account Expiration Following Inactivity<span class="label label-default pull-right">rule</span></h4><p>To specify the number of days after a password expires (which
signifies inactivity) until an account is permanently disabled, add or correct
the following lines in <code>/etc/default/useradd</code>, substituting
<code><i>NUM_DAYS</i></code> appropriately:
<pre>INACTIVE=<i><abbr title="Substitution failed: xccdf_org.ssgproject.content_rule_account_disable_post_pw_expiration">(N/A)</abbr></i></pre>
A value of 35 is recommended.  
If a password is currently on the
verge of expiration, then 35 days remain until the account is automatically
disabled. However, if the password will not expire for another 60 days, then 95
days could elapse until the account would be automatically disabled. See the
<code>useradd</code> man page for more information.  Determining the inactivity
timeout must be done with careful consideration of the length of a "normal"
period of inactivity for users in the particular environment. Setting
the timeout too low incurs support costs and also has the potential to impact
availability of the system to legitimate users.
</p><span class="label label-primary">Rationale:</span><p>
Disabling inactive accounts ensures that accounts which may not
have been responsibly removed are not available to attackers
who may have compromised their credentials.
</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-2(2)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-2(3)</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-8.1.4</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">16</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">17</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">795</a></p></div><span class="label label-success">Remediation script:</span><pre><code>
var_account_disable_post_pw_expiration="<abbr title="from Profile/refine-value: xccdf_org.ssgproject.content_value_var_account_disable_post_pw_expiration">90</abbr>"

grep -q ^INACTIVE /etc/default/useradd &amp;&amp; \
  sed -i "s/INACTIVE.*/INACTIVE=$var_account_disable_post_pw_expiration/g" /etc/default/useradd
if ! [ $? -eq 0 ]; then
    echo "INACTIVE=$var_account_disable_post_pw_expiration" &gt;&gt; /etc/default/useradd
fi
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-8.1.5" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-8.1.5" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.1"><td style="padding-left: 57px"><h3>8.1.5<span class="label label-default pull-right">group</span></h3><p>Manage IDs used by vendors to</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.1.5" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.1"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-8.1.5.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-8.1.5.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.1.5"><td style="padding-left: 76px"><h3>8.1.5.a<span class="label label-default pull-right">group</span></h3><p>Interview personnel and observe processes for</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.1.5.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.1.5"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-8.1.5.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-8.1.5.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.1.5"><td style="padding-left: 76px"><h3>8.1.5.b<span class="label label-default pull-right">group</span></h3><p>Interview personnel and observe processes to verify</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.1.5.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.1.5"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-8.1.6" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-8.1.6" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.1"><td style="padding-left: 57px"><h3>8.1.6<span class="label label-default pull-right">group</span></h3><p>Limit repeated access attempts</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.1.6" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.1"><td style="padding-left: 57px"><small>contains 1 rule</small></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-8.1.6.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-8.1.6.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.1.6"><td style="padding-left: 76px"><h3>8.1.6.a<span class="label label-default pull-right">group</span></h3><p>For a sample of system components, inspect system</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.1.6.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.1.6"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-8.1.6.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-8.1.6.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.1.6"><td style="padding-left: 76px"><h3>8.1.6.b<span class="label label-default pull-right">group</span></h3><p></p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.1.6.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.1.6"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_accounts_passwords_pam_faillock_deny" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_accounts_passwords_pam_faillock_deny" id="guide-tree-leaf-idm45561209634560" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.1.6"><td style="padding-left: 76px"><h4>Set Deny For Failed Password Attempts<span class="label label-default pull-right">rule</span></h4><p>
To configure the system to lock out accounts after a number of incorrect login
attempts using <code>pam_faillock.so</code>, modify the content of both
<code>/etc/pam.d/system-auth</code> and <code>/etc/pam.d/password-auth</code> as follows:
<br><br>
<ul><li> Add the following line immediately <code>before</code> the <code>pam_unix.so</code> statement in the <code>AUTH</code> section:
<pre>auth required pam_faillock.so preauth silent deny=<abbr title="from Profile/refine-value: xccdf_org.ssgproject.content_value_var_accounts_passwords_pam_faillock_deny">6</abbr> unlock_time=<abbr title="from Profile/refine-value: xccdf_org.ssgproject.content_value_var_accounts_passwords_pam_faillock_unlock_time">1800</abbr> fail_interval=<abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_var_accounts_passwords_pam_faillock_fail_interval">900</abbr></pre></li><li> Add the following line immediately <code>after</code> the <code>pam_unix.so</code> statement in the <code>AUTH</code> section:
<pre>auth [default=die] pam_faillock.so authfail deny=<abbr title="from Profile/refine-value: xccdf_org.ssgproject.content_value_var_accounts_passwords_pam_faillock_deny">6</abbr> unlock_time=<abbr title="from Profile/refine-value: xccdf_org.ssgproject.content_value_var_accounts_passwords_pam_faillock_unlock_time">1800</abbr> fail_interval=<abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_var_accounts_passwords_pam_faillock_fail_interval">900</abbr></pre></li><li> Add the following line immediately <code>before</code> the <code>pam_unix.so</code> statement in the <code>ACCOUNT</code> section:
<pre>account required pam_faillock.so</pre></li></ul>
</p><span class="label label-primary">Rationale:</span><p>
Locking out user accounts after a number of incorrect attempts
prevents direct password guessing attacks.
</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-7(a)</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">44</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-8.1.6</a></p></div><span class="label label-success">Remediation script:</span><pre><code>
var_accounts_passwords_pam_faillock_deny="<abbr title="from Profile/refine-value: xccdf_org.ssgproject.content_value_var_accounts_passwords_pam_faillock_deny">6</abbr>"

AUTH_FILES[0]="/etc/pam.d/system-auth"
AUTH_FILES[1]="/etc/pam.d/password-auth"

for pamFile in "${AUTH_FILES[@]}"
do
	
	# pam_faillock.so already present?
	if grep -q "^auth.*pam_faillock.so.*" $pamFile; then

		# pam_faillock.so present, deny directive present?
		if grep -q "^auth.*[default=die].*pam_faillock.so.*authfail.*deny=" $pamFile; then

			# both pam_faillock.so &amp; deny present, just correct deny directive value
			sed -i --follow-symlinks "s/\(^auth.*required.*pam_faillock.so.*preauth.*silent.*\)\(deny *= *\).*/\1\2$var_accounts_passwords_pam_faillock_deny/" $pamFile
			sed -i --follow-symlinks "s/\(^auth.*[default=die].*pam_faillock.so.*authfail.*\)\(deny *= *\).*/\1\2$var_accounts_passwords_pam_faillock_deny/" $pamFile

		# pam_faillock.so present, but deny directive not yet
		else

			# append correct deny value to appropriate places
			sed -i --follow-symlinks "/^auth.*required.*pam_faillock.so.*preauth.*silent.*/ s/$/ deny=$var_accounts_passwords_pam_faillock_deny/" $pamFile
			sed -i --follow-symlinks "/^auth.*[default=die].*pam_faillock.so.*authfail.*/ s/$/ deny=$var_accounts_passwords_pam_faillock_deny/" $pamFile
		fi

	# pam_faillock.so not present yet
	else

		# insert pam_faillock.so preauth &amp; authfail rows with proper value of the 'deny' option
		sed -i --follow-symlinks "/^auth.*sufficient.*pam_unix.so.*/i auth        required      pam_faillock.so preauth silent deny=$var_accounts_passwords_pam_faillock_deny" $pamFile
		sed -i --follow-symlinks "/^auth.*sufficient.*pam_unix.so.*/a auth        [default=die] pam_faillock.so authfail deny=$var_accounts_passwords_pam_faillock_deny" $pamFile
		sed -i --follow-symlinks "/^account.*required.*pam_unix.so/i account     required      pam_faillock.so" $pamFile
	fi
done
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-8.1.7" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-8.1.7" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.1"><td style="padding-left: 57px"><h3>8.1.7<span class="label label-default pull-right">group</span></h3><p>Set the lockout duration to a</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.1.7" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.1"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-8.1.8" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-8.1.8" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.1"><td style="padding-left: 57px"><h3>8.1.8<span class="label label-default pull-right">group</span></h3><p>If a session has been idle for</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.1.8" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.1"><td style="padding-left: 57px"><small>contains 5 rules</small></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_gconf_gnome_screensaver_idle_delay" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_gconf_gnome_screensaver_idle_delay" id="guide-tree-leaf-idm45561209599040" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.1.8"><td style="padding-left: 76px"><h4>Set GNOME Login Inactivity Timeout<span class="label label-default pull-right">rule</span></h4><p>
Run the following command to set the idle time-out value for
inactivity in the GNOME desktop to <abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_inactivity_timeout_value">900</abbr> minutes:
<pre>$ sudo gconftool-2 \
  --direct \
  --config-source xml:readwrite:/etc/gconf/gconf.xml.mandatory \
  --type int \
  --set /desktop/gnome/session/idle_delay <abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_inactivity_timeout_value">900</abbr></pre>
</p><span class="label label-primary">Rationale:</span><p>
Setting the idle delay controls when the
screensaver will start, and can be combined with
screen locking to prevent access from passersby.
</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-11(a)</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">57</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-8.1.8</a></p></div><span class="label label-success">Remediation script:</span><pre><code>
inactivity_timeout_value="<abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_inactivity_timeout_value">900</abbr>"

# Install GConf2 package if not installed
if ! rpm -q GConf2; then
  yum -y install GConf2
fi

# Set the idle time-out value for inactivity in the GNOME desktop to meet the
# requirement
gconftool-2 --direct \
            --config-source "xml:readwrite:/etc/gconf/gconf.xml.mandatory" \
            --type int \
            --set /desktop/gnome/session/idle_delay ${inactivity_timeout_value}
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_gconf_gnome_screensaver_idle_activation_enabled" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_gconf_gnome_screensaver_idle_activation_enabled" id="guide-tree-leaf-idm45561209583728" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.1.8"><td style="padding-left: 76px"><h4>GNOME Desktop Screensaver Mandatory Use<span class="label label-default pull-right">rule</span></h4><p>
Run the following command to activate the screensaver
in the GNOME desktop after a period of inactivity:
<pre>$ sudo gconftool-2 --direct \
  --config-source xml:readwrite:/etc/gconf/gconf.xml.mandatory \
  --type bool \
  --set /apps/gnome-screensaver/idle_activation_enabled true</pre>
</p><span class="label label-primary">Rationale:</span><p>
Enabling idle activation of the screensaver ensures the screensaver will
be activated after the idle delay.  Applications requiring continuous,
real-time screen display (such as network management products) require the
login session does not have administrator rights and the display station is located in a
controlled-access area.
</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-11(a)</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">57</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-8.1.8</a></p></div><span class="label label-success">Remediation script:</span><pre><code># Install GConf2 package if not installed
if ! rpm -q GConf2; then
  yum -y install GConf2
fi

# Set the screensaver activation in the GNOME desktop after a period of inactivity
gconftool-2 --direct \
            --config-source "xml:readwrite:/etc/gconf/gconf.xml.mandatory" \
            --type bool \
            --set /apps/gnome-screensaver/idle_activation_enabled true
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_gconf_gnome_screensaver_lock_enabled" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_gconf_gnome_screensaver_lock_enabled" id="guide-tree-leaf-idm45561209571520" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.1.8"><td style="padding-left: 76px"><h4>Enable Screen Lock Activation After Idle Period<span class="label label-default pull-right">rule</span></h4><p>
Run the following command to activate locking of the screensaver
in the GNOME desktop when it is activated:
<pre>$ sudo gconftool-2 --direct \
  --config-source xml:readwrite:/etc/gconf/gconf.xml.mandatory \
  --type bool \
  --set /apps/gnome-screensaver/lock_enabled true</pre>
</p><span class="label label-primary">Rationale:</span><p>
Enabling the activation of the screen lock after an idle period
ensures password entry will be required in order to
access the system, preventing access by passersby.
</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-11(a)</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">57</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-8.1.8</a></p></div><span class="label label-success">Remediation script:</span><pre><code># Install GConf2 package if not installed
if ! rpm -q GConf2; then
  yum -y install GConf2
fi

# Set the screensaver locking activation in the GNOME desktop when the
# screensaver is activated
gconftool-2 --direct \
            --config-source "xml:readwrite:/etc/gconf/gconf.xml.mandatory" \
            --type bool \
            --set /apps/gnome-screensaver/lock_enabled true
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_gconf_gnome_screensaver_mode_blank" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_gconf_gnome_screensaver_mode_blank" id="guide-tree-leaf-idm45561209559520" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.1.8"><td style="padding-left: 76px"><h4>Implement Blank Screensaver<span class="label label-default pull-right">rule</span></h4><p>
Run the following command to set the screensaver mode
in the GNOME desktop to a blank screen:
<pre>$ sudo gconftool-2 --direct \
  --config-source xml:readwrite:/etc/gconf/gconf.xml.mandatory \
  --type string \
  --set /apps/gnome-screensaver/mode blank-only</pre>
</p><span class="label label-primary">Rationale:</span><p>
Setting the screensaver mode to blank-only conceals the
contents of the display from passersby.
</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-11(b)</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">60</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-8.1.8</a></p></div><span class="label label-success">Remediation script:</span><pre><code># Install GConf2 package if not installed
if ! rpm -q GConf2; then
  yum -y install GConf2
fi

# Set the screensaver mode in the GNOME desktop to a blank screen
gconftool-2 --direct \
            --config-source "xml:readwrite:/etc/gconf/gconf.xml.mandatory" \
            --type string \
            --set /apps/gnome-screensaver/mode blank-only
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_sshd_set_idle_timeout" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_sshd_set_idle_timeout" id="guide-tree-leaf-idm45561209547696" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.1.8"><td style="padding-left: 76px"><h4>Set SSH Idle Timeout Interval<span class="label label-default pull-right">rule</span></h4><p>SSH allows administrators to set an idle timeout
interval.
After this interval has passed, the idle user will be
automatically logged out.
<br><br>
To set an idle timeout interval, edit the following line in <code>/etc/ssh/sshd_config</code> as
follows:
<pre>ClientAliveInterval <b><abbr title="from Profile/refine-value: xccdf_org.ssgproject.content_value_sshd_idle_timeout_value">900</abbr></b></pre>
The timeout <b>interval</b> is given in seconds. To have a timeout
of 15 minutes, set <b>interval</b> to 900.
<br><br>
If a shorter timeout has already been set for the login
shell, that value will preempt any SSH
setting made here. Keep in mind that some processes may stop SSH
from correctly detecting that the user is idle.
</p><span class="label label-primary">Rationale:</span><p>
Causing idle users to be automatically logged out
guards against compromises one system leading trivially
to compromises on another.
</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-2(5)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">SA-8</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-8.1.8</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">879</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">1133</a></p></div><span class="label label-success">Remediation script:</span><pre><code>
sshd_idle_timeout_value="<abbr title="from Profile/refine-value: xccdf_org.ssgproject.content_value_sshd_idle_timeout_value">900</abbr>"

grep -q ^ClientAliveInterval /etc/ssh/sshd_config &amp;&amp; \
  sed -i "s/ClientAliveInterval.*/ClientAliveInterval $sshd_idle_timeout_value/g" /etc/ssh/sshd_config
if ! [ $? -eq 0 ]; then
    echo "ClientAliveInterval $sshd_idle_timeout_value" &gt;&gt; /etc/ssh/sshd_config
fi
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-8.1.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-8.1.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.1"><td style="padding-left: 57px"><h3>8.1.a<span class="label label-default pull-right">group</span></h3><p>Review procedures and confirm they define processes for</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.1.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.1"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-8.1.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-8.1.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.1"><td style="padding-left: 57px"><h3>8.1.b<span class="label label-default pull-right">group</span></h3><p>Verify that procedures are implemented for user</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.1.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.1"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-8.2" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-8.2" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8."><td style="padding-left: 38px"><h3 id="xccdf_org.ssgproject.content_group_pcidss-req-8.2">8.2<span class="label label-default pull-right">group</span></h3><p>In addition to assigning a unique ID,</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.2" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8."><td style="padding-left: 38px"><small>contains 11 rules</small></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-8.2.1" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-8.2.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.2"><td style="padding-left: 57px"><h3>8.2.1<span class="label label-default pull-right">group</span></h3><p>Using strong cryptography,</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.2.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.2"><td style="padding-left: 57px"><small>contains 4 rules</small></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-8.2.1.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-8.2.1.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.2.1"><td style="padding-left: 76px"><h3>8.2.1.a<span class="label label-default pull-right">group</span></h3><p>Examine vendor documentation and system</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.2.1.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.2.1"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-8.2.1.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-8.2.1.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.2.1"><td style="padding-left: 76px"><h3>8.2.1.b<span class="label label-default pull-right">group</span></h3><p>For a sample of system components, examine</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.2.1.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.2.1"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-8.2.1.c" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-8.2.1.c" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.2.1"><td style="padding-left: 76px"><h3>8.2.1.c<span class="label label-default pull-right">group</span></h3><p>For a sample of system components, examine data</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.2.1.c" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.2.1"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-8.2.1.d" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-8.2.1.d" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.2.1"><td style="padding-left: 76px"><h3>8.2.1.d<span class="label label-default pull-right">group</span></h3><p></p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.2.1.d" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.2.1"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_accounts_password_all_shadowed" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_accounts_password_all_shadowed" id="guide-tree-leaf-idm45561209522416" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.2.1"><td style="padding-left: 76px"><h4>Verify All Account Password Hashes are Shadowed<span class="label label-default pull-right">rule</span></h4><p>
If any password hashes are stored in <code>/etc/passwd</code> (in the second field,
instead of an <code>x</code>), the cause of this misconfiguration should be
investigated.  The account should have its password reset and the hash should be
properly stored, or the account should be deleted entirely.
</p><span class="label label-primary">Rationale:</span><p>
The hashes for all user account passwords should be stored in
the file <code>/etc/shadow</code> and never in <code>/etc/passwd</code>,
which is readable by all users.
</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IA-5(h)</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">201</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-8.2.1</a></p></div></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_set_password_hashing_algorithm_systemauth" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_set_password_hashing_algorithm_systemauth" id="guide-tree-leaf-idm45561209511808" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.2.1"><td style="padding-left: 76px"><h4>Set Password Hashing Algorithm in /etc/pam.d/system-auth<span class="label label-default pull-right">rule</span></h4><p>
In <code>/etc/pam.d/system-auth</code>, the <code>password</code> section of
the file controls which PAM modules execute during a password change.
Set the <code>pam_unix.so</code> module in the
<code>password</code> section to include the argument <code>sha512</code>, as shown below:
<pre>password    sufficient    pam_unix.so sha512 <i>other arguments...</i></pre>
This will help ensure when local users change their passwords, hashes for the new
passwords will be generated using the SHA-512 algorithm.
This is the default.
</p><span class="label label-primary">Rationale:</span><p>
Using a stronger hashing algorithm makes password cracking attacks more difficult.
</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IA-5(b)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IA-5(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IA-5(1)(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IA-7</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">803</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-8.2.1</a></p></div><span class="label label-success">Remediation script:</span><pre><code>if ! grep -q "^password.*sufficient.*pam_unix.so.*sha512" /etc/pam.d/system-auth; then   
	sed -i --follow-symlinks "/^password.*sufficient.*pam_unix.so/ s/$/ sha512/" /etc/pam.d/system-auth
fi
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_set_password_hashing_algorithm_logindefs" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_set_password_hashing_algorithm_logindefs" id="guide-tree-leaf-idm45561209495648" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.2.1"><td style="padding-left: 76px"><h4>Set Password Hashing Algorithm in /etc/login.defs<span class="label label-default pull-right">rule</span></h4><p>
In <code>/etc/login.defs</code>, add or correct the following line to ensure
the system will use SHA-512 as the hashing algorithm:
<pre>ENCRYPT_METHOD SHA512</pre>
</p><span class="label label-primary">Rationale:</span><p>
Using a stronger hashing algorithm makes password cracking attacks more difficult.
</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IA-5(b)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IA-5(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IA-5(1)(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IA-7</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">803</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-8.2.1</a></p></div><span class="label label-success">Remediation script:</span><pre><code>if grep --silent ^ENCRYPT_METHOD /etc/login.defs ; then
	sed -i 's/^ENCRYPT_METHOD.*/ENCRYPT_METHOD SHA512/g' /etc/login.defs
else
	echo "" &gt;&gt; /etc/login.defs
	echo "ENCRYPT_METHOD SHA512" &gt;&gt; /etc/login.defs
fi
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_set_password_hashing_algorithm_libuserconf" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_set_password_hashing_algorithm_libuserconf" id="guide-tree-leaf-idm45561209481728" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.2.1"><td style="padding-left: 76px"><h4>Set Password Hashing Algorithm in /etc/libuser.conf<span class="label label-default pull-right">rule</span></h4><p>
In <code>/etc/libuser.conf</code>, add or correct the following line in its
<code>[defaults]</code> section to ensure the system will use the SHA-512
algorithm for password hashing:
<pre>crypt_style = sha512</pre>
</p><span class="label label-primary">Rationale:</span><p>
Using a stronger hashing algorithm makes password cracking attacks more difficult.
</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IA-5(b)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IA-5(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IA-5(1)(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IA-7</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">803</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-8.2.1</a></p></div></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-8.2.2" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-8.2.2" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.2"><td style="padding-left: 57px"><h3>8.2.2<span class="label label-default pull-right">group</span></h3><p>Verify user identity before</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.2.2" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.2"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-8.2.3" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-8.2.3" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.2"><td style="padding-left: 57px"><h3>8.2.3<span class="label label-default pull-right">group</span></h3><p>Passwords/phrases must meet</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.2.3" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.2"><td style="padding-left: 57px"><small>contains 5 rules</small></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-8.2.3.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-8.2.3.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.2.3"><td style="padding-left: 76px"><h3>8.2.3.a<span class="label label-default pull-right">group</span></h3><p>For a sample of system components, inspect system</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.2.3.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.2.3"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-8.2.3.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-8.2.3.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.2.3"><td style="padding-left: 76px"><h3>8.2.3.b<span class="label label-default pull-right">group</span></h3><p></p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.2.3.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.2.3"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_no_empty_passwords" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_no_empty_passwords" id="guide-tree-leaf-idm45561209458688" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.2.3"><td style="padding-left: 76px"><h4>Prevent Log In to Accounts With Empty Password<span class="label label-default pull-right">rule</span></h4><p>If an account is configured for password authentication
but does not have an assigned password, it may be possible to log
onto the account without authentication. Remove any instances of the <code>nullok</code>
option in <code>/etc/pam.d/system-auth</code> to
prevent logins with empty passwords.
</p><span class="label label-primary">Rationale:</span><p>
If an account has an empty password, anyone could log in and
run commands with the privileges of that account. Accounts with
empty passwords should never be used in operational
environments.
</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IA-5(b)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IA-5(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IA-5(1)(a)</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-8.2.3</a></p></div><span class="label label-success">Remediation script:</span><pre><code>sed --follow-symlinks -i 's/\&lt;nullok\&gt;//g' /etc/pam.d/system-auth
</code></pre><span class="label label-success">Remediation script:</span><pre><code>
- name: "Prevent Log In to Accounts With Empty Password"
  replace:
    dest: /etc/pam.d/system-auth
    regexp: 'nullok\s*'
    replace: ''
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_accounts_password_pam_dcredit" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_accounts_password_pam_dcredit" id="guide-tree-leaf-idm45561209444256" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.2.3"><td style="padding-left: 76px"><h4>Set Password Strength Minimum Digit Characters<span class="label label-default pull-right">rule</span></h4><p>The pam_cracklib module's <code>dcredit</code> parameter controls requirements for
usage of digits in a password. When set to a negative number, any password will be required to
contain that many digits. When set to a positive number, pam_cracklib will grant +1 additional
length credit for each digit.  
Add <code>dcredit=-1</code> after pam_cracklib.so to require use of a digit in passwords.
</p><span class="label label-primary">Rationale:</span><p>
Requiring digits makes password guessing attacks more difficult by ensuring a larger
search space.
</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IA-5(b)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IA-5(c)</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">194</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-8.2.3</a></p></div><span class="label label-success">Remediation script:</span><pre><code>
var_password_pam_dcredit="<abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_var_password_pam_dcredit">-1</abbr>"

if grep -q "dcredit=" /etc/pam.d/system-auth; then
	sed -i --follow-symlinks "s/\(dcredit *= *\).*/\1$var_password_pam_dcredit/" /etc/pam.d/system-auth
else
	sed -i --follow-symlinks "/pam_cracklib.so/ s/$/ dcredit=$var_password_pam_dcredit/" /etc/pam.d/system-auth
fi
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_accounts_password_pam_minlen" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_accounts_password_pam_minlen" id="guide-tree-leaf-idm45561209429952" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.2.3"><td style="padding-left: 76px"><h4>Set Password Minimum Length<span class="label label-default pull-right">rule</span></h4><p>The pam_cracklib module's <code>minlen</code> parameter controls requirements for
minimum characters required in a password. Add <code>minlen=<abbr title="from Profile/refine-value: xccdf_org.ssgproject.content_value_var_password_pam_minlen">7</abbr></code>
after pam_pwquality to set minimum password length requirements.
</p><span class="label label-primary">Rationale:</span><p>
Password length is one factor of several that helps to determine
strength and how long it takes to crack a password. Use of more characters in
a password helps to exponentially increase the time and/or resources
required to compromise the password.
</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IA-5(1)(a)</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">205</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-8.2.3</a></p></div><span class="label label-success">Remediation script:</span><pre><code>
var_password_pam_minlen="<abbr title="from Profile/refine-value: xccdf_org.ssgproject.content_value_var_password_pam_minlen">7</abbr>"

if grep -q "minlen=" /etc/pam.d/system-auth
then
	sed -i --follow-symlinks "s/\(minlen *= *\).*/\1$var_password_pam_minlen/" /etc/pam.d/system-auth
else
	sed -i --follow-symlinks "/pam_cracklib.so/ s/$/ minlen=$var_password_pam_minlen/" /etc/pam.d/system-auth
fi
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_accounts_password_pam_ucredit" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_accounts_password_pam_ucredit" id="guide-tree-leaf-idm45561209415712" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.2.3"><td style="padding-left: 76px"><h4>Set Password Strength Minimum Uppercase Characters<span class="label label-default pull-right">rule</span></h4><p>The pam_cracklib module's <code>ucredit=</code> parameter controls requirements for
usage of uppercase letters in a password. When set to a negative number, any password will be required to
contain that many uppercase characters. When set to a positive number, pam_cracklib will grant +1 additional
length credit for each uppercase character.
Add <code>ucredit=-1</code> after pam_cracklib.so to require use of an upper case character in passwords.
</p><span class="label label-primary">Rationale:</span><p>
Requiring a minimum number of uppercase characters makes password guessing attacks
more difficult by ensuring a larger search space.
</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IA-5(b)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IA-5(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IA-5(1)(a)</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">192</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf">3.5.7</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-8.2.3</a></p></div><span class="label label-success">Remediation script:</span><pre><code>
var_password_pam_ucredit="<abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_var_password_pam_ucredit">-1</abbr>"

if grep -q "ucredit=" /etc/pam.d/system-auth; then   
	sed -i --follow-symlinks "s/\(ucredit *= *\).*/\1$var_password_pam_ucredit/" /etc/pam.d/system-auth
else
	sed -i --follow-symlinks "/pam_cracklib.so/ s/$/ ucredit=$var_password_pam_ucredit/" /etc/pam.d/system-auth
fi
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_accounts_password_pam_lcredit" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_accounts_password_pam_lcredit" id="guide-tree-leaf-idm45561209399808" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.2.3"><td style="padding-left: 76px"><h4>Set Password Strength Minimum Lowercase Characters<span class="label label-default pull-right">rule</span></h4><p>The pam_cracklib module's <code>lcredit=</code> parameter controls requirements for
usage of lowercase letters in a password. When set to a negative number, any password will be required to
contain that many lowercase characters. When set to a positive number, pam_cracklib will grant +1 additional
length credit for each lowercase character.
Add <code>lcredit=-1</code> after pam_cracklib.so to require use of a lowercase character in passwords.
</p><span class="label label-primary">Rationale:</span><p>
Requiring a minimum number of lowercase characters makes password guessing attacks
more difficult by ensuring a larger search space.
</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IA-5(b)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IA-5(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IA-5(1)(a)</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">193</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-8.2.3</a></p></div><span class="label label-success">Remediation script:</span><pre><code>
var_password_pam_lcredit="<abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_var_password_pam_lcredit">-1</abbr>"

if grep -q "lcredit=" /etc/pam.d/system-auth; then   
	sed -i --follow-symlinks "s/\(lcredit *= *\).*/\1$var_password_pam_lcredit/" /etc/pam.d/system-auth
else
	sed -i --follow-symlinks "/pam_cracklib.so/ s/$/ lcredit=$var_password_pam_lcredit/" /etc/pam.d/system-auth
fi
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-8.2.4" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-8.2.4" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.2"><td style="padding-left: 57px"><h3>8.2.4<span class="label label-default pull-right">group</span></h3><p>Change user</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.2.4" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.2"><td style="padding-left: 57px"><small>contains 1 rule</small></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-8.2.4.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-8.2.4.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.2.4"><td style="padding-left: 76px"><h3>8.2.4.a<span class="label label-default pull-right">group</span></h3><p>For a sample of system components, inspect system</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.2.4.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.2.4"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-8.2.4.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-8.2.4.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.2.4"><td style="padding-left: 76px"><h3>8.2.4.b<span class="label label-default pull-right">group</span></h3><p></p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.2.4.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.2.4"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_accounts_maximum_age_login_defs" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_accounts_maximum_age_login_defs" id="guide-tree-leaf-idm45561209379408" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.2.4"><td style="padding-left: 76px"><h4>Set Password Maximum Age<span class="label label-default pull-right">rule</span></h4><p>To specify password maximum age for new accounts,
edit the file <code>/etc/login.defs</code>
and add or correct the following line:
<pre>PASS_MAX_DAYS <i><abbr title="from Profile/refine-value: xccdf_org.ssgproject.content_value_var_accounts_maximum_age_login_defs">90</abbr></i></pre>
A value of 180 days is sufficient for many environments. 
The DoD requirement is 60.
</p><span class="label label-primary">Rationale:</span><p>
Setting the password maximum age ensures users are required to
periodically change their passwords. This could possibly decrease
the utility of a stolen password. Requiring shorter password lifetimes
increases the risk of users writing down the password in a convenient
location subject to physical compromise.</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IA-5(f)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IA-5(g)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IA-5(1)(d)</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">180</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">199</a>, <a href="">76</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-8.2.4</a></p></div><span class="label label-success">Remediation script:</span><pre><code>
var_accounts_maximum_age_login_defs="<abbr title="from Profile/refine-value: xccdf_org.ssgproject.content_value_var_accounts_maximum_age_login_defs">90</abbr>"

grep -q ^PASS_MAX_DAYS /etc/login.defs &amp;&amp; \
  sed -i "s/PASS_MAX_DAYS.*/PASS_MAX_DAYS     $var_accounts_maximum_age_login_defs/g" /etc/login.defs
if ! [ $? -eq 0 ]; then
    echo "PASS_MAX_DAYS      $var_accounts_maximum_age_login_defs" &gt;&gt; /etc/login.defs
fi
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-8.2.5" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-8.2.5" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.2"><td style="padding-left: 57px"><h3>8.2.5<span class="label label-default pull-right">group</span></h3><p>Do not allow an individual to</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.2.5" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.2"><td style="padding-left: 57px"><small>contains 1 rule</small></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-8.2.5.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-8.2.5.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.2.5"><td style="padding-left: 76px"><h3>8.2.5.a<span class="label label-default pull-right">group</span></h3><p>For a sample of system components, obtain and</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.2.5.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.2.5"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-8.2.5.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-8.2.5.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.2.5"><td style="padding-left: 76px"><h3>8.2.5.b<span class="label label-default pull-right">group</span></h3><p></p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.2.5.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.2.5"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_accounts_password_pam_unix_remember" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_accounts_password_pam_unix_remember" id="guide-tree-leaf-idm45561209356560" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.2.5"><td style="padding-left: 76px"><h4>Limit Password Reuse<span class="label label-default pull-right">rule</span></h4><p>Do not allow users to reuse recent passwords. This can be
accomplished by using the <code>remember</code> option for the <code>pam_unix</code>
or <code>pam_pwhistory</code> PAM modules. In the file
<code>/etc/pam.d/system-auth</code>, append <code>remember=<abbr title="from Profile/refine-value: xccdf_org.ssgproject.content_value_var_password_pam_unix_remember">4</abbr></code>
to the line which refers to the <code>pam_unix.so</code> or
<code>pam_pwhistory.so</code>module, as shown below:
<ul><li>for the <code>pam_unix.so</code> case:
<pre>password sufficient pam_unix.so <i>existing_options</i> remember=<abbr title="from Profile/refine-value: xccdf_org.ssgproject.content_value_var_password_pam_unix_remember">4</abbr></pre>
</li><li>for the <code>pam_pwhistory.so</code> case:
<pre>password requisite pam_pwhistory.so <i>existing_options</i> remember=<abbr title="from Profile/refine-value: xccdf_org.ssgproject.content_value_var_password_pam_unix_remember">4</abbr></pre>
</li></ul>
The DoD STIG requirement is 5 passwords.</p><span class="label label-primary">Rationale:</span><p>
Preventing re-use of previous passwords helps ensure that a compromised password is not re-used by a user.
</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IA-5(f)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IA-5(1)(e)</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">200</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-8.2.5</a></p></div><span class="label label-success">Remediation script:</span><pre><code>
var_password_pam_unix_remember="<abbr title="from Profile/refine-value: xccdf_org.ssgproject.content_value_var_password_pam_unix_remember">4</abbr>"

if grep -q "remember=" /etc/pam.d/system-auth; then   
	sed -i --follow-symlinks "s/\(^password.*sufficient.*pam_unix.so.*\)\(\(remember *= *\)[^ $]*\)/\1remember=$var_password_pam_unix_remember/" /etc/pam.d/system-auth
else
	sed -i --follow-symlinks "/^password[[:space:]]\+sufficient[[:space:]]\+pam_unix.so/ s/$/ remember=$var_password_pam_unix_remember/" /etc/pam.d/system-auth
fi
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-8.2.6" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-8.2.6" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.2"><td style="padding-left: 57px"><h3>8.2.6<span class="label label-default pull-right">group</span></h3><p>Set passwords/phrases for first-</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.2.6" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.2"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-8.3" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-8.3" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8."><td style="padding-left: 38px"><h3 id="xccdf_org.ssgproject.content_group_pcidss-req-8.3">8.3<span class="label label-default pull-right">group</span></h3><p>Incorporate two-factor authentication</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.3" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8."><td style="padding-left: 38px"><small>contains 1 rule</small></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-8.3.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-8.3.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.3"><td style="padding-left: 57px"><h3>8.3.a<span class="label label-default pull-right">group</span></h3><p>Examine system configurations for remote access servers</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.3.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.3"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-8.3.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-8.3.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.3"><td style="padding-left: 57px"><h3>8.3.b<span class="label label-default pull-right">group</span></h3><p>Observe a sample of personnel (for example, users and</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.3.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.3"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_smartcard_auth" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_smartcard_auth" id="guide-tree-leaf-idm45561209327120" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.3"><td style="padding-left: 57px"><h4>Enable Smart Card Login<span class="label label-default pull-right">rule</span></h4><p>
To enable smart card authentication, consult the documentation at:
<ul><li><b><a href="https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Managing_Smart_Cards/enabling-smart-card-login.html">https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Managing_Smart_Cards/enabling-smart-card-login.html</a></b></li></ul>
For guidance on enabling SSH to authenticate against a Common Access Card (CAC), consult documentation at:
<ul><li><b><a href="https://access.redhat.com/solutions/82273">https://access.redhat.com/solutions/82273</a></b></li></ul>
</p><span class="label label-primary">Rationale:</span><p>Smart card login provides two-factor authentication stronger than
that provided by a username and password combination. Smart cards leverage PKI
(public key infrastructure) in order to provide and verify credentials.
</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">765</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">766</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">767</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">768</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">771</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">772</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">884</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-8.3</a></p></div><span class="label label-success">Remediation script:</span><pre><code>

# Install required packages
yum -y install esc
yum -y install pam_pkcs11

# Enable pcscd service

function service_command {

# Load function arguments into local variables
local service_state=$1
local service=$2
local xinetd=$(echo $3 | cut -d'=' -f2)

# Check sanity of the input
if [ $# -lt "2" ]
then
  echo "Usage: service_command 'enable/disable' 'service_name.service'"
  echo
  echo "To enable or disable xinetd services add \'xinetd=service_name\'"
  echo "as the last argument"
  echo "Aborting."
  exit 1
fi

# If systemctl is installed, use systemctl command; otherwise, use the service/chkconfig commands
if [ -f "/usr/bin/systemctl" ] ; then
  service_util="/usr/bin/systemctl"
else
  service_util="/sbin/service"
  chkconfig_util="/sbin/chkconfig"
fi

# If disable is not specified in arg1, set variables to enable services.
# Otherwise, variables are to be set to disable services.
if [ "$service_state" != 'disable' ] ; then
  service_state="enable"
  service_operation="start"
  chkconfig_state="on"
else
  service_state="disable"
  service_operation="stop"
  chkconfig_state="off"
fi

# If chkconfig_util is not empty, use chkconfig/service commands.
if ! [ "x$chkconfig_util" = x ] ; then
  $service_util $service $service_operation
  $chkconfig_util --level 0123456 $service $chkconfig_state
else
  $service_util $service_operation $service
  $service_util $service_state $service
fi

# Test if local variable xinetd is empty using non-bashism.
# If empty, then xinetd is not being used.
if ! [ "x$xinetd" = x ] ; then
  grep -qi disable /etc/xinetd.d/$xinetd &amp;&amp; \

  if ! [ "$service_operation" != 'disable' ] ; then
    sed -i "s/disable.*/disable         = no/gI" /etc/xinetd.d/$xinetd
  else
    sed -i "s/disable.*/disable         = yes/gI" /etc/xinetd.d/$xinetd
  fi
fi

}

service_command enable pcscd

# Configure the expected /etc/pam.d/system-auth{,-ac} settings directly
#
# The code below will configure system authentication in the way smart card
# logins will be enabled, but also user login(s) via other method to be allowed
#
# NOTE: In contrast to Red Hat Enterprise Linux 7 version of this remediation
#       script (based on the testing) it does NOT seem to be possible to use
#       the 'authconfig' command to perform the remediation for us. Because:
#
#       * calling '/usr/sbin/authconfig --enablesmartcard --update'
#	  does not update all the necessary files, while
#
#	* calling '/usr/sbin/authconfig --enablesmartcard --updateall'
#	  discards the necessary changes on /etc/pam_pkcs11/pam_pkcs11.conf
#	  performed subsequently below
#
#	Therefore we configure /etc/pam.d/system-auth{,-ac} settings directly.
#

# Define system-auth config location
SYSTEM_AUTH_CONF="/etc/pam.d/system-auth"
# Define expected 'pam_env.so' row in $SYSTEM_AUTH_CONF
PAM_ENV_SO="auth.*required.*pam_env.so"

# Define 'pam_succeed_if.so' row to be appended past $PAM_ENV_SO row into $SYSTEM_AUTH_CONF
SYSTEM_AUTH_PAM_SUCCEED="\
auth        \[success=1 default=ignore\] pam_succeed_if.so service notin \
login:gdm:xdm:kdm:xscreensaver:gnome-screensaver:kscreensaver quiet use_uid"
# Define 'pam_pkcs11.so' row to be appended past $SYSTEM_AUTH_PAM_SUCCEED
# row into SYSTEM_AUTH_CONF file
SYSTEM_AUTH_PAM_PKCS11="\
auth        \[success=done authinfo_unavail=ignore ignore=ignore default=die\] \
pam_pkcs11.so card_only"

# Define smartcard-auth config location
SMARTCARD_AUTH_CONF="/etc/pam.d/smartcard-auth"
# Define 'pam_pkcs11.so' auth section to be appended past $PAM_ENV_SO into $SMARTCARD_AUTH_CONF
SMARTCARD_AUTH_SECTION="\
auth        [success=done ignore=ignore default=die] pam_pkcs11.so wait_for_card card_only"
# Define expected 'pam_permit.so' row in $SMARTCARD_AUTH_CONF
PAM_PERMIT_SO="account.*required.*pam_permit.so"
# Define 'pam_pkcs11.so' password section
SMARTCARD_PASSWORD_SECTION="\
password    required      pam_pkcs11.so"

# First Correct the SYSTEM_AUTH_CONF configuration
if ! grep -q 'pam_pkcs11.so' "$SYSTEM_AUTH_CONF"
then
	# Append (expected) pam_succeed_if.so row past the pam_env.so into SYSTEM_AUTH_CONF file
	sed -i --follow-symlinks -e '/^'"$PAM_ENV_SO"'/a '"$SYSTEM_AUTH_PAM_SUCCEED" "$SYSTEM_AUTH_CONF"
	# Append (expected) pam_pkcs11.so row past the pam_succeed_if.so into SYSTEM_AUTH_CONF file
	sed -i --follow-symlinks -e '/^'"$SYSTEM_AUTH_PAM_SUCCEED"'/a '"$SYSTEM_AUTH_PAM_PKCS11" "$SYSTEM_AUTH_CONF"
fi

# Then also correct the SMARTCARD_AUTH_CONF
if ! grep -q 'pam_pkcs11.so' "$SMARTCARD_AUTH_CONF"
then
	# Append (expected) SMARTCARD_AUTH_SECTION row past the pam_env.so into SMARTCARD_AUTH_CONF file
	sed -i --follow-symlinks -e '/^'"$PAM_ENV_SO"'/a '"$SMARTCARD_AUTH_SECTION" "$SMARTCARD_AUTH_CONF"
	# Append (expected) SMARTCARD_PASSWORD_SECTION row past the pam_permit.so into SMARTCARD_AUTH_CONF file
	sed -i --follow-symlinks -e '/^'"$PAM_PERMIT_SO"'/a '"$SMARTCARD_PASSWORD_SECTION" "$SMARTCARD_AUTH_CONF"
fi

# Perform /etc/pam_pkcs11/pam_pkcs11.conf settings below
# Define selected constants for later reuse
SP="[:space:]"
PAM_PKCS11_CONF="/etc/pam_pkcs11/pam_pkcs11.conf"

# Ensure OCSP is turned on in $PAM_PKCS11_CONF
# 1) First replace any occurrence of 'none' value of 'cert_policy' key setting with the correct configuration
# On Red Hat Enterprise Linux 6 a space isn't required between 'cert_policy' key and value assignment !!!
sed -i "s/^[$SP]*cert_policy=none;/    cert_policy=ca, ocsp_on, signature;/g" "$PAM_PKCS11_CONF"

# 2) Then append 'ocsp_on' value setting to each 'cert_policy' key in $PAM_PKCS11_CONF configuration line,
# which does not contain it yet
# On Red Hat Enterprise Linux 6 a space isn't required between 'cert_policy' key and value assignment !!!
sed -i "/ocsp_on/! s/^[$SP]*cert_policy=\(.*\);/    cert_policy=\1, ocsp_on;/" "$PAM_PKCS11_CONF"
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-8.4" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-8.4" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8."><td style="padding-left: 38px"><h3 id="xccdf_org.ssgproject.content_group_pcidss-req-8.4">8.4<span class="label label-default pull-right">group</span></h3><p>Document and communicate</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.4" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8."><td style="padding-left: 38px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-8.4.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-8.4.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.4"><td style="padding-left: 57px"><h3>8.4.a<span class="label label-default pull-right">group</span></h3><p>Examine</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.4.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.4"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-8.4.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-8.4.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.4"><td style="padding-left: 57px"><h3>8.4.b<span class="label label-default pull-right">group</span></h3><p>Review authentication policies and procedures that are</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.4.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.4"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-8.4.c" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-8.4.c" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.4"><td style="padding-left: 57px"><h3>8.4.c<span class="label label-default pull-right">group</span></h3><p>Interview a sample of users to verify that they are familiar</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.4.c" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.4"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-8.5" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-8.5" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8."><td style="padding-left: 38px"><h3 id="xccdf_org.ssgproject.content_group_pcidss-req-8.5">8.5<span class="label label-default pull-right">group</span></h3><p>Do not use group, shared, or generic</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.5" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8."><td style="padding-left: 38px"><small>contains 1 rule</small></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-8.5.1" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-8.5.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.5"><td style="padding-left: 57px"><h3>8.5.1<span class="label label-default pull-right">group</span></h3><p></p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.5.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.5"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-8.5.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-8.5.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.5"><td style="padding-left: 57px"><h3>8.5.a<span class="label label-default pull-right">group</span></h3><p>For a sample of system components, examine user ID lists</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.5.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.5"><td style="padding-left: 57px"><small>contains 1 rule</small></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_gid_passwd_group_same" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_gid_passwd_group_same" id="guide-tree-leaf-idm45561209285856" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.5.a"><td style="padding-left: 76px"><h4>All GIDs referenced in /etc/passwd must be defined in /etc/group<span class="label label-default pull-right">rule</span></h4><p>
Add a group to the system for each GID referenced without a corresponding group.
</p><span class="label label-primary">Rationale:</span><p>
Inconsistency in GIDs between <code>/etc/passwd</code> and <code>/etc/group</code> could lead to a user having unintended rights.
</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">366</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-8.5.a</a></p></div></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-8.5.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-8.5.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.5"><td style="padding-left: 57px"><h3>8.5.b<span class="label label-default pull-right">group</span></h3><p>Examine authentication policies and procedures to verify</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.5.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.5"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-8.5.c" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-8.5.c" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.5"><td style="padding-left: 57px"><h3>8.5.c<span class="label label-default pull-right">group</span></h3><p>Interview system administrators to verify that group and</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.5.c" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.5"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-8.6" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-8.6" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8."><td style="padding-left: 38px"><h3 id="xccdf_org.ssgproject.content_group_pcidss-req-8.6">8.6<span class="label label-default pull-right">group</span></h3><p>Where other authentication</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.6" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8."><td style="padding-left: 38px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-8.6.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-8.6.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.6"><td style="padding-left: 57px"><h3>8.6.a<span class="label label-default pull-right">group</span></h3><p>Examine authentication policies and procedures to verify</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.6.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.6"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-8.6.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-8.6.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.6"><td style="padding-left: 57px"><h3>8.6.b<span class="label label-default pull-right">group</span></h3><p>Interview security personnel to verify authentication</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.6.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.6"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-8.6.c" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-8.6.c" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.6"><td style="padding-left: 57px"><h3>8.6.c<span class="label label-default pull-right">group</span></h3><p>Examine system configuration settings and/or physical</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.6.c" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.6"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-8.7" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-8.7" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8."><td style="padding-left: 38px"><h3 id="xccdf_org.ssgproject.content_group_pcidss-req-8.7">8.7<span class="label label-default pull-right">group</span></h3><p>All access to any database</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.7" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8."><td style="padding-left: 38px"><small>contains 9 rules</small></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-8.7.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-8.7.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.7"><td style="padding-left: 57px"><h3>8.7.a<span class="label label-default pull-right">group</span></h3><p>Review database and application configuration settings</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.7.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.7"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-8.7.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-8.7.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.7"><td style="padding-left: 57px"><h3>8.7.b<span class="label label-default pull-right">group</span></h3><p>Examine database and application configuration settings to</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.7.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.7"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-8.7.c" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-8.7.c" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.7"><td style="padding-left: 57px"><h3>8.7.c<span class="label label-default pull-right">group</span></h3><p>Examine database access control settings and database</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.7.c" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.7"><td style="padding-left: 57px"><small>contains 9 rules</small></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_userowner_shadow_file" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_userowner_shadow_file" id="guide-tree-leaf-idm45561209258848" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.7.c"><td style="padding-left: 76px"><h4>Verify User Who Owns shadow File<span class="label label-default pull-right">rule</span></h4><p>
              
    To properly set the owner of <code>/etc/shadow</code>, run the command:
    <pre xml:space="preserve">$ sudo chown root /etc/shadow</pre>
            </p><span class="label label-primary">Rationale:</span><p>The <code>/etc/shadow</code> file contains the list of local
system accounts and stores password hashes. Protection of this file is
critical for system security. Failure to give ownership of this file
to root provides the designated owner with access to sensitive information
which could weaken the system security posture.</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-6</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">225</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-8.7.c</a></p></div><span class="label label-success">Remediation script:</span><pre><code>chown root /etc/shadow
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_groupowner_shadow_file" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_groupowner_shadow_file" id="guide-tree-leaf-idm45561209246736" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.7.c"><td style="padding-left: 76px"><h4>Verify Group Who Owns shadow File<span class="label label-default pull-right">rule</span></h4><p>
              
    To properly set the group owner of <code>/etc/shadow</code>, run the command:
    <pre xml:space="preserve">$ sudo chgrp root /etc/shadow</pre>
            </p><span class="label label-primary">Rationale:</span><p>The <code>/etc/shadow</code> file stores password hashes. Protection of this file is
critical for system security.</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-6</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">225</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-8.7.c</a></p></div><span class="label label-success">Remediation script:</span><pre><code>chgrp root /etc/shadow
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_file_permissions_etc_shadow" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_file_permissions_etc_shadow" id="guide-tree-leaf-idm45561209234816" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.7.c"><td style="padding-left: 76px"><h4>Verify Permissions on shadow File<span class="label label-default pull-right">rule</span></h4><p>
              
    To properly set the permissions of <code>/etc/shadow</code>, run the command:
    <pre xml:space="preserve">$ sudo chmod 0000 /etc/shadow</pre>
            </p><span class="label label-primary">Rationale:</span><p>The <code>/etc/shadow</code> file contains the list of local
system accounts and stores password hashes. Protection of this file is
critical for system security. Failure to give ownership of this file
to root provides the designated owner with access to sensitive information
which could weaken the system security posture.</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-6</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">225</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-8.7.c</a></p></div><span class="label label-success">Remediation script:</span><pre><code>chmod 0000 /etc/shadow
</code></pre><span class="label label-success">Remediation script:</span><pre><code>- name: Ensure permission 0000 on /etc/shadow
  file:
    path="{{item}}"
    mode=0000
  with_items:
    - /etc/shadow
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_file_owner_etc_group" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_file_owner_etc_group" id="guide-tree-leaf-idm45561209220784" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.7.c"><td style="padding-left: 76px"><h4>Verify User Who Owns group File<span class="label label-default pull-right">rule</span></h4><p>
              
    To properly set the owner of <code>/etc/group</code>, run the command:
    <pre xml:space="preserve">$ sudo chown root /etc/group</pre>
            </p><span class="label label-primary">Rationale:</span><p>The <code>/etc/group</code> file contains information regarding groups that are configured
on the system. Protection of this file is important for system security.</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-6</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-8.7.c</a></p></div><span class="label label-success">Remediation script:</span><pre><code>chown root /etc/group
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_file_groupowner_etc_group" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_file_groupowner_etc_group" id="guide-tree-leaf-idm45561209209440" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.7.c"><td style="padding-left: 76px"><h4>Verify Group Who Owns group File<span class="label label-default pull-right">rule</span></h4><p>
              
    To properly set the group owner of <code>/etc/group</code>, run the command:
    <pre xml:space="preserve">$ sudo chgrp root /etc/group</pre>
            </p><span class="label label-primary">Rationale:</span><p>The <code>/etc/group</code> file contains information regarding groups that are configured
on the system. Protection of this file is important for system security.</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-6</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">225</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-8.7.c</a></p></div><span class="label label-success">Remediation script:</span><pre><code>chgrp root /etc/group
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_file_permissions_etc_group" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_file_permissions_etc_group" id="guide-tree-leaf-idm45561209197360" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.7.c"><td style="padding-left: 76px"><h4>Verify Permissions on group File<span class="label label-default pull-right">rule</span></h4><p>
              
    To properly set the permissions of <code>/etc/group</code>, run the command:
    <pre xml:space="preserve">$ sudo chmod 644 /etc/group</pre>
            </p><span class="label label-primary">Rationale:</span><p>The <code>/etc/group</code> file contains information regarding groups that are configured
on the system. Protection of this file is important for system security.</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-6</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">225</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-8.7.c</a></p></div><span class="label label-success">Remediation script:</span><pre><code>chmod 644 /etc/group
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_file_owner_etc_passwd" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_file_owner_etc_passwd" id="guide-tree-leaf-idm45561209185264" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.7.c"><td style="padding-left: 76px"><h4>Verify User Who Owns passwd File<span class="label label-default pull-right">rule</span></h4><p>
              
    To properly set the owner of <code>/etc/passwd</code>, run the command:
    <pre xml:space="preserve">$ sudo chown root /etc/passwd</pre>
            </p><span class="label label-primary">Rationale:</span><p>The <code>/etc/passwd</code> file contains information about the users that are configured on
the system. Protection of this file is critical for system security.</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-6</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">225</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-8.7.c</a></p></div><span class="label label-success">Remediation script:</span><pre><code>chown root /etc/passwd
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_file_groupowner_etc_passwd" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_file_groupowner_etc_passwd" id="guide-tree-leaf-idm45561209173248" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.7.c"><td style="padding-left: 76px"><h4>Verify Group Who Owns passwd File<span class="label label-default pull-right">rule</span></h4><p>
              
    To properly set the group owner of <code>/etc/passwd</code>, run the command:
    <pre xml:space="preserve">$ sudo chgrp root /etc/passwd</pre>
            </p><span class="label label-primary">Rationale:</span><p>The <code>/etc/passwd</code> file contains information about the users that are configured on
the system. Protection of this file is critical for system security.</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-6</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">225</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-8.7.c</a></p></div><span class="label label-success">Remediation script:</span><pre><code>chgrp root /etc/passwd
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_file_permissions_etc_passwd" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_file_permissions_etc_passwd" id="guide-tree-leaf-idm45561209161168" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.7.c"><td style="padding-left: 76px"><h4>Verify Permissions on passwd File<span class="label label-default pull-right">rule</span></h4><p>
              
    To properly set the permissions of <code>/etc/passwd</code>, run the command:
    <pre xml:space="preserve">$ sudo chmod 0644 /etc/passwd</pre>
            </p><span class="label label-primary">Rationale:</span><p>If the <code>/etc/passwd</code> file is writable by a group-owner or the
world the risk of its compromise is increased. The file contains the list of
accounts on the system and associated information, and protection of this file
is critical for system security.</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-6</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">225</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-8.7.c</a></p></div><span class="label label-success">Remediation script:</span><pre><code>chmod 0644 /etc/passwd
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-8.7.d" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-8.7.d" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.7"><td style="padding-left: 57px"><h3>8.7.d<span class="label label-default pull-right">group</span></h3><p>Examine database access control settings, database</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.7.d" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.7"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-8.8" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-8.8" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8."><td style="padding-left: 38px"><h3 id="xccdf_org.ssgproject.content_group_pcidss-req-8.8">8.8<span class="label label-default pull-right">group</span></h3><p>Ensure that security policies and</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8.8" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-8."><td style="padding-left: 38px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-10." class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-10." data-tt-parent-id="children-xccdf_org.ssgproject.content_benchmark_PCIDSS-RHEL-6"><td style="padding-left: 19px"><h3 id="xccdf_org.ssgproject.content_group_pcidss-req-10.">10.<span class="label label-default pull-right">group</span></h3><p>Track and monitor all access to network resources and cardholder data</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10." data-tt-parent-id="children-xccdf_org.ssgproject.content_benchmark_PCIDSS-RHEL-6"><td style="padding-left: 19px"><small>contains 47 rules</small></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-10.1" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-10.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10."><td style="padding-left: 38px"><h3 id="xccdf_org.ssgproject.content_group_pcidss-req-10.1">10.1<span class="label label-default pull-right">group</span></h3><p>Implement audit trails to link all</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10."><td style="padding-left: 38px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-10.2" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-10.2" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10."><td style="padding-left: 38px"><h3 id="xccdf_org.ssgproject.content_group_pcidss-req-10.2">10.2<span class="label label-default pull-right">group</span></h3><p>Implement automated audit trails for</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.2" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10."><td style="padding-left: 38px"><small>contains 9 rules</small></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-10.2.1" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-10.2.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.2"><td style="padding-left: 57px"><h3>10.2.1<span class="label label-default pull-right">group</span></h3><p>All individual user accesses to</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.2.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.2"><td style="padding-left: 57px"><small>contains 1 rule</small></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_audit_rules_unsuccessful_file_modification" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_audit_rules_unsuccessful_file_modification" id="guide-tree-leaf-idm45561209138112" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.2.1"><td style="padding-left: 76px"><h4>Ensure auditd Collects Unauthorized Access Attempts to Files (unsuccessful)<span class="label label-default pull-right">rule</span></h4><p>At a minimum the audit system should collect
unauthorized file accesses for all users and root. Add the following
to <code>/etc/audit/audit.rules</code>:
<pre>-a always,exit -F arch=b32 -S creat -S open -S openat -S open_by_handle_at -S truncate -S ftruncate -F exit=-EACCES -F auid&gt;=500 -F auid!=4294967295 -k access
-a always,exit -F arch=b32 -S creat -S open -S openat -S open_by_handle_at -S truncate -S ftruncate -F exit=-EPERM -F auid&gt;=500 -F auid!=4294967295 -k access</pre>
If the system is 64 bit then also add the following:
<pre>
-a always,exit -F arch=b64 -S creat -S open -S openat -S open_by_handle_at -S truncate -S ftruncate -F exit=-EACCES -F auid&gt;=500 -F auid!=4294967295 -k access
-a always,exit -F arch=b64 -S creat -S open -S openat -S open_by_handle_at -S truncate -S ftruncate -F exit=-EPERM -F auid&gt;=500 -F auid!=4294967295 -k access</pre>
</p><span class="label label-primary">Rationale:</span><p>Unsuccessful attempts to access files could be an indicator of malicious activity on a system. Auditing
these events could serve as evidence of potential system compromise.</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-3(10)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-1(b)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(a)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(d)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12(a)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IR-5</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">126</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-10.2.4</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-10.2.1</a></p></div><span class="label label-success">Remediation script:</span><pre><code>

# Perform the remediation of the syscall rule
# Retrieve hardware architecture of the underlying system
[ $(getconf LONG_BIT) = "32" ] &amp;&amp; RULE_ARCHS=("b32") || RULE_ARCHS=("b32" "b64")

for ARCH in "${RULE_ARCHS[@]}"
do

	# First fix the -EACCES requirement
	PATTERN="-a always,exit -F arch=$ARCH -S .* -F exit=-EACCES -F auid&gt;=500 -F auid!=4294967295 -k *"
	# Use escaped BRE regex to specify rule group
	GROUP="\(creat\|open\|truncate\)"
	FULL_RULE="-a always,exit -F arch=$ARCH -S creat -S open -S openat -S open_by_handle_at -S truncate -S ftruncate -F exit=-EACCES -F auid&gt;=500 -F auid!=4294967295 -k access"

function fix_audit_syscall_rule {

# Load function arguments into local variables
local tool="$1"
local pattern="$2"
local group="$3"
local arch="$4"
local full_rule="$5"

# Check sanity of the input
if [ $# -ne "5" ]
then
        echo "Usage: fix_audit_syscall_rule 'tool' 'pattern' 'group' 'arch' 'full rule'"
        echo "Aborting."
        exit 1
fi

# Create a list of audit *.rules files that should be inspected for presence and correctness
# of a particular audit rule. The scheme is as follows:
#
# -----------------------------------------------------------------------------------------
#  Tool used to load audit rules | Rule already defined  |  Audit rules file to inspect    |
# -----------------------------------------------------------------------------------------
#        auditctl                |     Doesn't matter    |  /etc/audit/audit.rules         |
# -----------------------------------------------------------------------------------------
#        augenrules              |          Yes          |  /etc/audit/rules.d/*.rules     |
#        augenrules              |          No           |  /etc/audit/rules.d/$key.rules  |
# -----------------------------------------------------------------------------------------
#
declare -a files_to_inspect

# First check sanity of the specified audit tool
if [ "$tool" != 'auditctl' ] &amp;&amp; [ "$tool" != 'augenrules' ]
then
        echo "Unknown audit rules loading tool: $1. Aborting."
        echo "Use either 'auditctl' or 'augenrules'!"
        exit 1
# If audit tool is 'auditctl', then add '/etc/audit/audit.rules'
# file to the list of files to be inspected
elif [ "$tool" == 'auditctl' ]
then
        files_to_inspect=("${files_to_inspect[@]}" '/etc/audit/audit.rules' )
# If audit tool is 'augenrules', then check if the audit rule is defined
# If rule is defined, add '/etc/audit/rules.d/*.rules' to the list for inspection
# If rule isn't defined yet, add '/etc/audit/rules.d/$key.rules' to the list for inspection
elif [ "$tool" == 'augenrules' ]
then
        # Extract audit $key from audit rule so we can use it later
        key=$(expr "$full_rule" : '.*-k[[:space:]]\([^[:space:]]\+\)')
        # Check if particular audit rule is already defined
        IFS=$'\n' matches=($(sed -s -n -e "/${pattern}/!d" -e "/${arch}/!d" -e "/${group}/!d;F" /etc/audit/rules.d/*.rules))
        # Reset IFS back to default
        unset $IFS
        for match in "${matches[@]}"
        do
                files_to_inspect=("${files_to_inspect[@]}" "${match}")
        done
        # Case when particular rule isn't defined in /etc/audit/rules.d/*.rules yet
        if [ ${#files_to_inspect[@]} -eq "0" ]
        then
                files_to_inspect="/etc/audit/rules.d/$key.rules"
                if [ ! -e "$files_to_inspect" ]
                then
                        touch "$files_to_inspect"
                        chmod 0640 "$files_to_inspect"
                fi
        fi
fi

#
# Indicator that we want to append $full_rule into $audit_file by default
local append_expected_rule=0

for audit_file in "${files_to_inspect[@]}"
do

        # Filter existing $audit_file rules' definitions to select those that:
        # * follow the rule pattern, and
        # * meet the hardware architecture requirement, and
        # * are current syscall group specific
        IFS=$'\n' existing_rules=($(sed -e "/${pattern}/!d" -e "/${arch}/!d" -e "/${group}/!d"  "$audit_file"))
        # Reset IFS back to default
        unset $IFS

        # Process rules found case-by-case
        for rule in "${existing_rules[@]}"
        do
                # Found rule is for same arch &amp; key, but differs (e.g. in count of -S arguments)
                if [ "${rule}" != "${full_rule}" ]
                then
                        # If so, isolate just '(-S \w)+' substring of that rule
                        rule_syscalls=$(echo $rule | grep -o -P '(-S \w+ )+')
                        # Check if list of '-S syscall' arguments of that rule is subset
                        # of '-S syscall' list of expected $full_rule
                        if grep -q -- "$rule_syscalls" &lt;&lt;&lt; "$full_rule"
                        then
                                # Rule is covered (i.e. the list of -S syscalls for this rule is
                                # subset of -S syscalls of $full_rule =&gt; existing rule can be deleted
                                # Thus delete the rule from audit.rules &amp; our array
                                sed -i -e "/$rule/d" "$audit_file"
                                existing_rules=("${existing_rules[@]//$rule/}")
                        else
                                # Rule isn't covered by $full_rule - it besides -S syscall arguments
                                # for this group contains also -S syscall arguments for other syscall
                                # group. Example: '-S lchown -S fchmod -S fchownat' =&gt; group='chown'
                                # since 'lchown' &amp; 'fchownat' share 'chown' substring
                                # Therefore:
                                # * 1) delete the original rule from audit.rules
                                # (original '-S lchown -S fchmod -S fchownat' rule would be deleted)
                                # * 2) delete the -S syscall arguments for this syscall group, but
                                # keep those not belonging to this syscall group
                                # (original '-S lchown -S fchmod -S fchownat' would become '-S fchmod'
                                # * 3) append the modified (filtered) rule again into audit.rules
                                # if the same rule not already present
                                #
                                # 1) Delete the original rule
                                sed -i -e "/$rule/d" "$audit_file"
                                # 2) Delete syscalls for this group, but keep those from other groups
                                # Convert current rule syscall's string into array splitting by '-S' delimiter
                                IFS=$'-S' read -a rule_syscalls_as_array &lt;&lt;&lt; "$rule_syscalls"
                                # Reset IFS back to default
                                unset $IFS
                                # Declare new empty string to hold '-S syscall' arguments from other groups
                                new_syscalls_for_rule=''
                                # Walk through existing '-S syscall' arguments
                                for syscall_arg in "${rule_syscalls_as_array[@]}"
                                do
                                        # Skip empty $syscall_arg values
                                        if [ "$syscall_arg" == '' ]
                                        then
                                                continue
                                        fi
                                        # If the '-S syscall' doesn't belong to current group add it to the new list
                                        # (together with adding '-S' delimiter back for each of such item found)
                                        if grep -q -v -- "$group" &lt;&lt;&lt; "$syscall_arg"
                                        then
                                                new_syscalls_for_rule="$new_syscalls_for_rule -S $syscall_arg"
                                        fi
                                done
                                # Replace original '-S syscall' list with the new one for this rule
                                updated_rule=${rule//$rule_syscalls/$new_syscalls_for_rule}
                                # Squeeze repeated whitespace characters in rule definition (if any) into one
                                updated_rule=$(echo "$updated_rule" | tr -s '[:space:]')
                                # 3) Append the modified / filtered rule again into audit.rules
                                #    (but only in case it's not present yet to prevent duplicate definitions)
                                if ! grep -q -- "$updated_rule" "$audit_file"
                                then
                                        echo "$updated_rule" &gt;&gt; "$audit_file"
                                fi
                        fi
                else
                        # $audit_file already contains the expected rule form for this
                        # architecture &amp; key =&gt; don't insert it second time
                        append_expected_rule=1
                fi
        done

        # We deleted all rules that were subset of the expected one for this arch &amp; key.
        # Also isolated rules containing system calls not from this system calls group.
        # Now append the expected rule if it's not present in $audit_file yet
        if [[ ${append_expected_rule} -eq "0" ]]
        then
                echo "$full_rule" &gt;&gt; "$audit_file"
        fi
done

}

	fix_audit_syscall_rule "auditctl" "$PATTERN" "$GROUP" "$ARCH" "$FULL_RULE"

	# Then fix the -EPERM requirement
	PATTERN="-a always,exit -F arch=$ARCH -S .* -F exit=-EPERM -F auid&gt;=500 -F auid!=4294967295 -k *"
	# No need to change content of $GROUP variable - it's the same as for -EACCES case above
	FULL_RULE="-a always,exit -F arch=$ARCH -S creat -S open -S openat -S open_by_handle_at -S truncate -S ftruncate -F exit=-EPERM -F auid&gt;=500 -F auid!=4294967295 -k access"

function fix_audit_syscall_rule {

# Load function arguments into local variables
local tool="$1"
local pattern="$2"
local group="$3"
local arch="$4"
local full_rule="$5"

# Check sanity of the input
if [ $# -ne "5" ]
then
        echo "Usage: fix_audit_syscall_rule 'tool' 'pattern' 'group' 'arch' 'full rule'"
        echo "Aborting."
        exit 1
fi

# Create a list of audit *.rules files that should be inspected for presence and correctness
# of a particular audit rule. The scheme is as follows:
#
# -----------------------------------------------------------------------------------------
#  Tool used to load audit rules | Rule already defined  |  Audit rules file to inspect    |
# -----------------------------------------------------------------------------------------
#        auditctl                |     Doesn't matter    |  /etc/audit/audit.rules         |
# -----------------------------------------------------------------------------------------
#        augenrules              |          Yes          |  /etc/audit/rules.d/*.rules     |
#        augenrules              |          No           |  /etc/audit/rules.d/$key.rules  |
# -----------------------------------------------------------------------------------------
#
declare -a files_to_inspect

# First check sanity of the specified audit tool
if [ "$tool" != 'auditctl' ] &amp;&amp; [ "$tool" != 'augenrules' ]
then
        echo "Unknown audit rules loading tool: $1. Aborting."
        echo "Use either 'auditctl' or 'augenrules'!"
        exit 1
# If audit tool is 'auditctl', then add '/etc/audit/audit.rules'
# file to the list of files to be inspected
elif [ "$tool" == 'auditctl' ]
then
        files_to_inspect=("${files_to_inspect[@]}" '/etc/audit/audit.rules' )
# If audit tool is 'augenrules', then check if the audit rule is defined
# If rule is defined, add '/etc/audit/rules.d/*.rules' to the list for inspection
# If rule isn't defined yet, add '/etc/audit/rules.d/$key.rules' to the list for inspection
elif [ "$tool" == 'augenrules' ]
then
        # Extract audit $key from audit rule so we can use it later
        key=$(expr "$full_rule" : '.*-k[[:space:]]\([^[:space:]]\+\)')
        # Check if particular audit rule is already defined
        IFS=$'\n' matches=($(sed -s -n -e "/${pattern}/!d" -e "/${arch}/!d" -e "/${group}/!d;F" /etc/audit/rules.d/*.rules))
        # Reset IFS back to default
        unset $IFS
        for match in "${matches[@]}"
        do
                files_to_inspect=("${files_to_inspect[@]}" "${match}")
        done
        # Case when particular rule isn't defined in /etc/audit/rules.d/*.rules yet
        if [ ${#files_to_inspect[@]} -eq "0" ]
        then
                files_to_inspect="/etc/audit/rules.d/$key.rules"
                if [ ! -e "$files_to_inspect" ]
                then
                        touch "$files_to_inspect"
                        chmod 0640 "$files_to_inspect"
                fi
        fi
fi

#
# Indicator that we want to append $full_rule into $audit_file by default
local append_expected_rule=0

for audit_file in "${files_to_inspect[@]}"
do

        # Filter existing $audit_file rules' definitions to select those that:
        # * follow the rule pattern, and
        # * meet the hardware architecture requirement, and
        # * are current syscall group specific
        IFS=$'\n' existing_rules=($(sed -e "/${pattern}/!d" -e "/${arch}/!d" -e "/${group}/!d"  "$audit_file"))
        # Reset IFS back to default
        unset $IFS

        # Process rules found case-by-case
        for rule in "${existing_rules[@]}"
        do
                # Found rule is for same arch &amp; key, but differs (e.g. in count of -S arguments)
                if [ "${rule}" != "${full_rule}" ]
                then
                        # If so, isolate just '(-S \w)+' substring of that rule
                        rule_syscalls=$(echo $rule | grep -o -P '(-S \w+ )+')
                        # Check if list of '-S syscall' arguments of that rule is subset
                        # of '-S syscall' list of expected $full_rule
                        if grep -q -- "$rule_syscalls" &lt;&lt;&lt; "$full_rule"
                        then
                                # Rule is covered (i.e. the list of -S syscalls for this rule is
                                # subset of -S syscalls of $full_rule =&gt; existing rule can be deleted
                                # Thus delete the rule from audit.rules &amp; our array
                                sed -i -e "/$rule/d" "$audit_file"
                                existing_rules=("${existing_rules[@]//$rule/}")
                        else
                                # Rule isn't covered by $full_rule - it besides -S syscall arguments
                                # for this group contains also -S syscall arguments for other syscall
                                # group. Example: '-S lchown -S fchmod -S fchownat' =&gt; group='chown'
                                # since 'lchown' &amp; 'fchownat' share 'chown' substring
                                # Therefore:
                                # * 1) delete the original rule from audit.rules
                                # (original '-S lchown -S fchmod -S fchownat' rule would be deleted)
                                # * 2) delete the -S syscall arguments for this syscall group, but
                                # keep those not belonging to this syscall group
                                # (original '-S lchown -S fchmod -S fchownat' would become '-S fchmod'
                                # * 3) append the modified (filtered) rule again into audit.rules
                                # if the same rule not already present
                                #
                                # 1) Delete the original rule
                                sed -i -e "/$rule/d" "$audit_file"
                                # 2) Delete syscalls for this group, but keep those from other groups
                                # Convert current rule syscall's string into array splitting by '-S' delimiter
                                IFS=$'-S' read -a rule_syscalls_as_array &lt;&lt;&lt; "$rule_syscalls"
                                # Reset IFS back to default
                                unset $IFS
                                # Declare new empty string to hold '-S syscall' arguments from other groups
                                new_syscalls_for_rule=''
                                # Walk through existing '-S syscall' arguments
                                for syscall_arg in "${rule_syscalls_as_array[@]}"
                                do
                                        # Skip empty $syscall_arg values
                                        if [ "$syscall_arg" == '' ]
                                        then
                                                continue
                                        fi
                                        # If the '-S syscall' doesn't belong to current group add it to the new list
                                        # (together with adding '-S' delimiter back for each of such item found)
                                        if grep -q -v -- "$group" &lt;&lt;&lt; "$syscall_arg"
                                        then
                                                new_syscalls_for_rule="$new_syscalls_for_rule -S $syscall_arg"
                                        fi
                                done
                                # Replace original '-S syscall' list with the new one for this rule
                                updated_rule=${rule//$rule_syscalls/$new_syscalls_for_rule}
                                # Squeeze repeated whitespace characters in rule definition (if any) into one
                                updated_rule=$(echo "$updated_rule" | tr -s '[:space:]')
                                # 3) Append the modified / filtered rule again into audit.rules
                                #    (but only in case it's not present yet to prevent duplicate definitions)
                                if ! grep -q -- "$updated_rule" "$audit_file"
                                then
                                        echo "$updated_rule" &gt;&gt; "$audit_file"
                                fi
                        fi
                else
                        # $audit_file already contains the expected rule form for this
                        # architecture &amp; key =&gt; don't insert it second time
                        append_expected_rule=1
                fi
        done

        # We deleted all rules that were subset of the expected one for this arch &amp; key.
        # Also isolated rules containing system calls not from this system calls group.
        # Now append the expected rule if it's not present in $audit_file yet
        if [[ ${append_expected_rule} -eq "0" ]]
        then
                echo "$full_rule" &gt;&gt; "$audit_file"
        fi
done

}

	fix_audit_syscall_rule "auditctl" "$PATTERN" "$GROUP" "$ARCH" "$FULL_RULE"

done
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-10.2.2" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-10.2.2" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.2"><td style="padding-left: 57px"><h3>10.2.2<span class="label label-default pull-right">group</span></h3><p>All actions taken by any</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.2.2" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.2"><td style="padding-left: 57px"><small>contains 3 rules</small></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands" id="guide-tree-leaf-idm45561209112288" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.2.2"><td style="padding-left: 76px"><h4>Ensure auditd Collects Information on the Use of Privileged Commands<span class="label label-default pull-right">rule</span></h4><p>At a minimum the audit system should collect the
execution of privileged commands for all users and root.
To find the relevant setuid / setgid programs, run the following command
for each local partition <i>PART</i>:
<pre>$ sudo find <i>PART</i> -xdev -type f -perm -4000 -o -type f -perm -2000 2&gt;/dev/null</pre>
Then, for each setuid / setgid program on the system, add a line of the
following form to <code>/etc/audit/audit.rules</code>, where
<i>SETUID_PROG_PATH</i> is the full path to each setuid / setgid program
in the list:
<pre>-a always,exit -F path=<i>SETUID_PROG_PATH</i> -F perm=x -F auid&gt;=500 -F auid!=4294967295 -k privileged</pre>
</p><span class="label label-primary">Rationale:</span><p>Privileged programs are subject to escalation-of-privilege attacks,
which attempt to subvert their normal role of providing some necessary but
limited capability. As such, motivation exists to monitor these programs for
unusual activity.
</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-3(10))</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-1(b)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(a)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(d)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-6(9)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12(a)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IR-5</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">40</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-10.2.2</a></p></div><span class="label label-success">Remediation script:</span><pre><code>

# Perform the remediation

function perform_audit_rules_privileged_commands_remediation {
#
# Load function arguments into local variables
local tool="$1"
local min_auid="$2"

# Check sanity of the input
if [ $# -ne "2" ]
then
        echo "Usage: perform_audit_rules_privileged_commands_remediation 'auditctl | augenrules' '500 | 1000'"
        echo "Aborting."
        exit 1
fi

declare -a files_to_inspect=()

# Check sanity of the specified audit tool
if [ "$tool" != 'auditctl' ] &amp;&amp; [ "$tool" != 'augenrules' ]
then
        echo "Unknown audit rules loading tool: $1. Aborting."
        echo "Use either 'auditctl' or 'augenrules'!"
        exit 1
# If the audit tool is 'auditctl', then:
# * add '/etc/audit/audit.rules'to the list of files to be inspected,
# * specify '/etc/audit/audit.rules' as the output audit file, where
#   missing rules should be inserted
elif [ "$tool" == 'auditctl' ]
then
        files_to_inspect=("/etc/audit/audit.rules")
        output_audit_file="/etc/audit/audit.rules"
#
# If the audit tool is 'augenrules', then:
# * add '/etc/audit/rules.d/*.rules' to the list of files to be inspected
#   (split by newline),
# * specify /etc/audit/rules.d/privileged.rules' as the output file, where
#   missing rules should be inserted
elif [ "$tool" == 'augenrules' ]
then
        IFS=$'\n' files_to_inspect=($(find /etc/audit/rules.d -maxdepth 1 -type f -name *.rules -print))
        output_audit_file="/etc/audit/rules.d/privileged.rules"
fi

# Obtain the list of SUID/SGID binaries on the particular system (split by newline)
# into privileged_binaries array
IFS=$'\n' privileged_binaries=($(find / -xdev -type f -perm -4000 -o -type f -perm -2000 2&gt;/dev/null))

# Keep list of SUID/SGID binaries that have been already handled within some previous iteration
declare -a sbinaries_to_skip=()

# For each found sbinary in privileged_binaries list
for sbinary in "${privileged_binaries[@]}"
do

        # Replace possible slash '/' character in sbinary definition so we could use it in sed expressions below
        sbinary_esc=${sbinary//$'/'/$'\/'}
        # Check if this sbinary wasn't already handled in some of the previous iterations
        # Return match only if whole sbinary definition matched (not in the case just prefix matched!!!)
        if [[ $(sed -ne "/${sbinary_esc}$/p" &lt;&lt;&lt; ${sbinaries_to_skip[@]}) ]]
        then
                # If so, don't process it second time &amp; go to process next sbinary
                continue
        fi

        # Reset the counter of inspected files when starting to check
        # presence of existing audit rule for new sbinary
        local count_of_inspected_files=0

        # For each audit rules file from the list of files to be inspected
        for afile in "${files_to_inspect[@]}"
        do

                # Search current audit rules file's content for match. Match criteria:
                # * existing rule is for the same SUID/SGID binary we are currently processing (but
                #   can contain multiple -F path= elements covering multiple SUID/SGID binaries)
                # * existing rule contains all arguments from expected rule form (though can contain
                #   them in arbitrary order)

                base_search=$(sed -e "/-a always,exit/!d" -e "/-F path=${sbinary_esc}$/!d"   \
                                  -e "/-F path=[^[:space:]]\+/!d" -e "/-F perm=.*/!d"       \
                                  -e "/-F auid&gt;=${min_auid}/!d" -e "/-F auid!=4294967295/!d"  \
                                  -e "/-k privileged/!d" $afile)

                # Increase the count of inspected files for this sbinary
                count_of_inspected_files=$((count_of_inspected_files + 1))

                # Define expected rule form for this binary
                expected_rule="-a always,exit -F path=${sbinary} -F perm=x -F auid&gt;=${min_auid} -F auid!=4294967295 -k privileged"

                # Require execute access type to be set for existing audit rule
                exec_access='x'

                # Search current audit rules file's content for presence of rule pattern for this sbinary
                if [[ $base_search ]]
                then

                        # Current audit rules file already contains rule for this binary =&gt;
                        # Store the exact form of found rule for this binary for further processing
                        concrete_rule=$base_search

                        # Select all other SUID/SGID binaries possibly also present in the found rule
                        IFS=$'\n' handled_sbinaries=($(grep -o -e "-F path=[^[:space:]]\+" &lt;&lt;&lt; $concrete_rule))
                        IFS=$' ' handled_sbinaries=(${handled_sbinaries[@]//-F path=/})

                        # Merge the list of such SUID/SGID binaries found in this iteration with global list ignoring duplicates
                        sbinaries_to_skip=($(for i in "${sbinaries_to_skip[@]}" "${handled_sbinaries[@]}"; do echo $i; done | sort -du))

                        # Separate concrete_rule into three sections using hash '#'
                        # sign as a delimiter around rule's permission section borders
                        concrete_rule=$(echo $concrete_rule | sed -n "s/\(.*\)\+\(-F perm=[rwax]\+\)\+/\1#\2#/p")

                        # Split concrete_rule into head, perm, and tail sections using hash '#' delimiter
                        IFS=$'#' read rule_head rule_perm rule_tail &lt;&lt;&lt;  "$concrete_rule"

                        # Extract already present exact access type [r|w|x|a] from rule's permission section
                        access_type=${rule_perm//-F perm=/}

                        # Verify current permission access type(s) for rule contain 'x' (execute) permission
                        if ! grep -q "$exec_access" &lt;&lt;&lt; "$access_type"
                        then

                                # If not, append the 'x' (execute) permission to the existing access type bits
                                access_type="$access_type$exec_access"
                                # Reconstruct the permissions section for the rule
                                new_rule_perm="-F perm=$access_type"
                                # Update existing rule in current audit rules file with the new permission section
                                sed -i "s#${rule_head}\(.*\)${rule_tail}#${rule_head}${new_rule_perm}${rule_tail}#" $afile

                        fi

                # If the required audit rule for particular sbinary wasn't found yet, insert it under following conditions:
                #
                # * in the "auditctl" mode of operation insert particular rule each time
                #   (because in this mode there's only one file -- /etc/audit/audit.rules to be inspected for presence of this rule),
                #
                # * in the "augenrules" mode of operation insert particular rule only once and only in case we have already
                #   searched all of the files from /etc/audit/rules.d/*.rules location (since that audit rule can be defined
                #   in any of those files and if not, we want it to be inserted only once into /etc/audit/rules.d/privileged.rules file)
                #
                elif [ "$tool" == "auditctl" ] || [[ "$tool" == "augenrules" &amp;&amp; $count_of_inspected_files -eq "${#files_to_inspect[@]}" ]]
                then

                        # Current audit rules file's content doesn't contain expected rule for this
                        # SUID/SGID binary yet =&gt; append it
                        echo $expected_rule &gt;&gt; $output_audit_file
                fi

        done

done

}

perform_audit_rules_privileged_commands_remediation "auditctl" "500"
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_audit_rules_file_deletion_events" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_audit_rules_file_deletion_events" id="guide-tree-leaf-idm45561209090640" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.2.2"><td style="padding-left: 76px"><h4>Ensure auditd Collects File Deletion Events by User<span class="label label-default pull-right">rule</span></h4><p>At a minimum the audit system should collect file
deletion events for all users and root. Add the following to
<code>/etc/audit/audit.rules</code>, setting ARCH to either b32 or b64 as
appropriate for your system:
<pre>-a always,exit -F arch=ARCH -S rmdir -S unlink -S unlinkat -S rename -S renameat -F auid&gt;=500 -F auid!=4294967295 -k delete</pre>
</p><span class="label label-primary">Rationale:</span><p>Auditing file deletions will create an audit trail for files that are removed
from the system. The audit trail could aid in system troubleshooting, as well as, detecting
malicious processes that attempt to delete log files to conceal their presence.</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-3(10)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-1(b)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(a)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(d)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12(a)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IR-5</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">126</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-10.2.2</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-10.2.5.b</a></p></div><span class="label label-success">Remediation script:</span><pre><code>

# Perform the remediation for the syscall rule
# Retrieve hardware architecture of the underlying system
[ $(getconf LONG_BIT) = "32" ] &amp;&amp; RULE_ARCHS=("b32") || RULE_ARCHS=("b32" "b64")

for ARCH in ${RULE_ARCHS[@]}
do
	PATTERN="-a always,exit -F arch=$ARCH -S .* -F auid&gt;=500 -F auid!=4294967295 -k delete"
	# Use escaped BRE regex to specify rule group
	GROUP="\(rmdir\|unlink\|rename\)"
	FULL_RULE="-a always,exit -F arch=$ARCH -S rmdir -S unlink -S unlinkat -S rename -S renameat -F auid&gt;=500 -F auid!=4294967295 -k delete"

function fix_audit_syscall_rule {

# Load function arguments into local variables
local tool="$1"
local pattern="$2"
local group="$3"
local arch="$4"
local full_rule="$5"

# Check sanity of the input
if [ $# -ne "5" ]
then
        echo "Usage: fix_audit_syscall_rule 'tool' 'pattern' 'group' 'arch' 'full rule'"
        echo "Aborting."
        exit 1
fi

# Create a list of audit *.rules files that should be inspected for presence and correctness
# of a particular audit rule. The scheme is as follows:
#
# -----------------------------------------------------------------------------------------
#  Tool used to load audit rules | Rule already defined  |  Audit rules file to inspect    |
# -----------------------------------------------------------------------------------------
#        auditctl                |     Doesn't matter    |  /etc/audit/audit.rules         |
# -----------------------------------------------------------------------------------------
#        augenrules              |          Yes          |  /etc/audit/rules.d/*.rules     |
#        augenrules              |          No           |  /etc/audit/rules.d/$key.rules  |
# -----------------------------------------------------------------------------------------
#
declare -a files_to_inspect

# First check sanity of the specified audit tool
if [ "$tool" != 'auditctl' ] &amp;&amp; [ "$tool" != 'augenrules' ]
then
        echo "Unknown audit rules loading tool: $1. Aborting."
        echo "Use either 'auditctl' or 'augenrules'!"
        exit 1
# If audit tool is 'auditctl', then add '/etc/audit/audit.rules'
# file to the list of files to be inspected
elif [ "$tool" == 'auditctl' ]
then
        files_to_inspect=("${files_to_inspect[@]}" '/etc/audit/audit.rules' )
# If audit tool is 'augenrules', then check if the audit rule is defined
# If rule is defined, add '/etc/audit/rules.d/*.rules' to the list for inspection
# If rule isn't defined yet, add '/etc/audit/rules.d/$key.rules' to the list for inspection
elif [ "$tool" == 'augenrules' ]
then
        # Extract audit $key from audit rule so we can use it later
        key=$(expr "$full_rule" : '.*-k[[:space:]]\([^[:space:]]\+\)')
        # Check if particular audit rule is already defined
        IFS=$'\n' matches=($(sed -s -n -e "/${pattern}/!d" -e "/${arch}/!d" -e "/${group}/!d;F" /etc/audit/rules.d/*.rules))
        # Reset IFS back to default
        unset $IFS
        for match in "${matches[@]}"
        do
                files_to_inspect=("${files_to_inspect[@]}" "${match}")
        done
        # Case when particular rule isn't defined in /etc/audit/rules.d/*.rules yet
        if [ ${#files_to_inspect[@]} -eq "0" ]
        then
                files_to_inspect="/etc/audit/rules.d/$key.rules"
                if [ ! -e "$files_to_inspect" ]
                then
                        touch "$files_to_inspect"
                        chmod 0640 "$files_to_inspect"
                fi
        fi
fi

#
# Indicator that we want to append $full_rule into $audit_file by default
local append_expected_rule=0

for audit_file in "${files_to_inspect[@]}"
do

        # Filter existing $audit_file rules' definitions to select those that:
        # * follow the rule pattern, and
        # * meet the hardware architecture requirement, and
        # * are current syscall group specific
        IFS=$'\n' existing_rules=($(sed -e "/${pattern}/!d" -e "/${arch}/!d" -e "/${group}/!d"  "$audit_file"))
        # Reset IFS back to default
        unset $IFS

        # Process rules found case-by-case
        for rule in "${existing_rules[@]}"
        do
                # Found rule is for same arch &amp; key, but differs (e.g. in count of -S arguments)
                if [ "${rule}" != "${full_rule}" ]
                then
                        # If so, isolate just '(-S \w)+' substring of that rule
                        rule_syscalls=$(echo $rule | grep -o -P '(-S \w+ )+')
                        # Check if list of '-S syscall' arguments of that rule is subset
                        # of '-S syscall' list of expected $full_rule
                        if grep -q -- "$rule_syscalls" &lt;&lt;&lt; "$full_rule"
                        then
                                # Rule is covered (i.e. the list of -S syscalls for this rule is
                                # subset of -S syscalls of $full_rule =&gt; existing rule can be deleted
                                # Thus delete the rule from audit.rules &amp; our array
                                sed -i -e "/$rule/d" "$audit_file"
                                existing_rules=("${existing_rules[@]//$rule/}")
                        else
                                # Rule isn't covered by $full_rule - it besides -S syscall arguments
                                # for this group contains also -S syscall arguments for other syscall
                                # group. Example: '-S lchown -S fchmod -S fchownat' =&gt; group='chown'
                                # since 'lchown' &amp; 'fchownat' share 'chown' substring
                                # Therefore:
                                # * 1) delete the original rule from audit.rules
                                # (original '-S lchown -S fchmod -S fchownat' rule would be deleted)
                                # * 2) delete the -S syscall arguments for this syscall group, but
                                # keep those not belonging to this syscall group
                                # (original '-S lchown -S fchmod -S fchownat' would become '-S fchmod'
                                # * 3) append the modified (filtered) rule again into audit.rules
                                # if the same rule not already present
                                #
                                # 1) Delete the original rule
                                sed -i -e "/$rule/d" "$audit_file"
                                # 2) Delete syscalls for this group, but keep those from other groups
                                # Convert current rule syscall's string into array splitting by '-S' delimiter
                                IFS=$'-S' read -a rule_syscalls_as_array &lt;&lt;&lt; "$rule_syscalls"
                                # Reset IFS back to default
                                unset $IFS
                                # Declare new empty string to hold '-S syscall' arguments from other groups
                                new_syscalls_for_rule=''
                                # Walk through existing '-S syscall' arguments
                                for syscall_arg in "${rule_syscalls_as_array[@]}"
                                do
                                        # Skip empty $syscall_arg values
                                        if [ "$syscall_arg" == '' ]
                                        then
                                                continue
                                        fi
                                        # If the '-S syscall' doesn't belong to current group add it to the new list
                                        # (together with adding '-S' delimiter back for each of such item found)
                                        if grep -q -v -- "$group" &lt;&lt;&lt; "$syscall_arg"
                                        then
                                                new_syscalls_for_rule="$new_syscalls_for_rule -S $syscall_arg"
                                        fi
                                done
                                # Replace original '-S syscall' list with the new one for this rule
                                updated_rule=${rule//$rule_syscalls/$new_syscalls_for_rule}
                                # Squeeze repeated whitespace characters in rule definition (if any) into one
                                updated_rule=$(echo "$updated_rule" | tr -s '[:space:]')
                                # 3) Append the modified / filtered rule again into audit.rules
                                #    (but only in case it's not present yet to prevent duplicate definitions)
                                if ! grep -q -- "$updated_rule" "$audit_file"
                                then
                                        echo "$updated_rule" &gt;&gt; "$audit_file"
                                fi
                        fi
                else
                        # $audit_file already contains the expected rule form for this
                        # architecture &amp; key =&gt; don't insert it second time
                        append_expected_rule=1
                fi
        done

        # We deleted all rules that were subset of the expected one for this arch &amp; key.
        # Also isolated rules containing system calls not from this system calls group.
        # Now append the expected rule if it's not present in $audit_file yet
        if [[ ${append_expected_rule} -eq "0" ]]
        then
                echo "$full_rule" &gt;&gt; "$audit_file"
        fi
done

}

	fix_audit_syscall_rule "auditctl" "$PATTERN" "$GROUP" "$ARCH" "$FULL_RULE"
done
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_audit_rules_sysadmin_actions" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_audit_rules_sysadmin_actions" id="guide-tree-leaf-idm45561209070528" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.2.2"><td style="padding-left: 76px"><h4>Ensure auditd Collects System Administrator Actions<span class="label label-default pull-right">rule</span></h4><p>At a minimum the audit system should collect
administrator actions for all users and root. Add the following to
<code>/etc/audit/audit.rules</code>:
<pre>-w /etc/sudoers -p wa -k actions</pre>
</p><span class="label label-primary">Rationale:</span><p>The actions taken by system administrators should be audited to keep a record
of what was executed on the system, as well as, for accountability purposes.</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-2(7)(b)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-3(10)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-1(b)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(a)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(d)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12(a)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IR-5</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">126</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-10.2.2</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-10.2.5.b</a></p></div><span class="label label-success">Remediation script:</span><pre><code>

# Perform the remediation

function fix_audit_watch_rule {

# Load function arguments into local variables
local tool="$1"
local path="$2"
local required_access_bits="$3"
local key="$4"

# Check sanity of the input
if [ $# -ne "4" ]
then
        echo "Usage: fix_audit_watch_rule 'tool' 'path' 'bits' 'key'"
        echo "Aborting."
        exit 1
fi

# Create a list of audit *.rules files that should be inspected for presence and correctness
# of a particular audit rule. The scheme is as follows:
#
# -----------------------------------------------------------------------------------------
# Tool used to load audit rules | Rule already defined  |  Audit rules file to inspect    |
# -----------------------------------------------------------------------------------------
#       auditctl                |     Doesn't matter    |  /etc/audit/audit.rules         |
# -----------------------------------------------------------------------------------------
#       augenrules              |          Yes          |  /etc/audit/rules.d/*.rules     |
#       augenrules              |          No           |  /etc/audit/rules.d/$key.rules  |
# -----------------------------------------------------------------------------------------
declare -a files_to_inspect

# Check sanity of the specified audit tool
if [ "$tool" != 'auditctl' ] &amp;&amp; [ "$tool" != 'augenrules' ]
then
        echo "Unknown audit rules loading tool: $1. Aborting."
        echo "Use either 'auditctl' or 'augenrules'!"
        exit 1
# If the audit tool is 'auditctl', then add '/etc/audit/audit.rules'
# into the list of files to be inspected
elif [ "$tool" == 'auditctl' ]
then
        files_to_inspect=("${files_to_inspect[@]}" '/etc/audit/audit.rules')
# If the audit is 'augenrules', then check if rule is already defined
# If rule is defined, add '/etc/audit/rules.d/*.rules' to list of files for inspection.
# If rule isn't defined, add '/etc/audit/rules.d/$key.rules' to list of files for inspection.
elif [ "$tool" == 'augenrules' ]
then
        # Case when particular audit rule is already defined in some of /etc/audit/rules.d/*.rules file
        # Get pair -- filepath : matching_row into @matches array
        IFS=$'\n' matches=($(grep -P "[\s]*-w[\s]+$path" /etc/audit/rules.d/*.rules))
        # Reset IFS back to default
        unset $IFS
        # For each of the matched entries
        for match in "${matches[@]}"
        do
                # Extract filepath from the match
                rulesd_audit_file=$(echo $match | cut -f1 -d ':')
                # Append that path into list of files for inspection
                files_to_inspect=("${files_to_inspect[@]}" "$rulesd_audit_file")
        done
        # Case when particular audit rule isn't defined yet
        if [ ${#files_to_inspect[@]} -eq "0" ]
        then
                # Append '/etc/audit/rules.d/$key.rules' into list of files for inspection
                files_to_inspect="/etc/audit/rules.d/$key.rules"
                # If the $key.rules file doesn't exist yet, create it with correct permissions
                if [ ! -e "$files_to_inspect" ]
                then
                        touch "$files_to_inspect"
                        chmod 0640 "$files_to_inspect"
                fi
        fi
fi

# Finally perform the inspection and possible subsequent audit rule
# correction for each of the files previously identified for inspection
for audit_rules_file in "${files_to_inspect[@]}"
do

        # Check if audit watch file system object rule for given path already present
        if grep -q -P -- "[\s]*-w[\s]+$path" "$audit_rules_file"
        then
                # Rule is found =&gt; verify yet if existing rule definition contains
                # all of the required access type bits

                # Escape slashes in path for use in sed pattern below
                local esc_path=${path//$'/'/$'\/'}
                # Define BRE whitespace class shortcut
                local sp="[[:space:]]"
                # Extract current permission access types (e.g. -p [r|w|x|a] values) from audit rule
                current_access_bits=$(sed -ne "s/$sp*-w$sp\+$esc_path$sp\+-p$sp\+\([rxwa]\{1,4\}\).*/\1/p" "$audit_rules_file")
                # Split required access bits string into characters array
                # (to check bit's presence for one bit at a time)
                for access_bit in $(echo "$required_access_bits" | grep -o .)
                do
                        # For each from the required access bits (e.g. 'w', 'a') check
                        # if they are already present in current access bits for rule.
                        # If not, append that bit at the end
                        if ! grep -q "$access_bit" &lt;&lt;&lt; "$current_access_bits"
                        then
                                # Concatenate the existing mask with the missing bit
                                current_access_bits="$current_access_bits$access_bit"
                        fi
                done
                # Propagate the updated rule's access bits (original + the required
                # ones) back into the /etc/audit/audit.rules file for that rule
                sed -i "s/\($sp*-w$sp\+$esc_path$sp\+-p$sp\+\)\([rxwa]\{1,4\}\)\(.*\)/\1$current_access_bits\3/" "$audit_rules_file"
        else
                # Rule isn't present yet. Append it at the end of $audit_rules_file file
                # with proper key

                echo "-w $path -p $required_access_bits -k $key" &gt;&gt; "$audit_rules_file"
        fi
done
}

fix_audit_watch_rule "auditctl" "/etc/sudoers" "wa" "actions"
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-10.2.3" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-10.2.3" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.2"><td style="padding-left: 57px"><h3>10.2.3<span class="label label-default pull-right">group</span></h3><p>Access to all audit trails</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.2.3" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.2"><td style="padding-left: 57px"><small>contains 1 rule</small></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_audit_rules_session_events" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_audit_rules_session_events" id="guide-tree-leaf-idm45561209049152" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.2.3"><td style="padding-left: 76px"><h4>Record Attempts to Alter Process and Session Initiation Information<span class="label label-default pull-right">rule</span></h4><p> The audit system already collects process information for all
users and root. To watch for attempted manual edits of files involved in
storing such process information, add the following to
<code>/etc/audit/audit.rules</code>:
<pre>-w /var/run/utmp -p wa -k session
-w /var/log/btmp -p wa -k session
-w /var/log/wtmp -p wa -k session</pre>
</p><span class="label label-primary">Rationale:</span><p>Manual editing of these files may indicate nefarious activity, such
as an attacker attempting to remove evidence of an intrusion.</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-3(10)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-1(b)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(a)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(d)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12(a)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IR-5</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-10.2.3</a></p></div><span class="label label-success">Remediation script:</span><pre><code>

# Perform the remediation

function fix_audit_watch_rule {

# Load function arguments into local variables
local tool="$1"
local path="$2"
local required_access_bits="$3"
local key="$4"

# Check sanity of the input
if [ $# -ne "4" ]
then
        echo "Usage: fix_audit_watch_rule 'tool' 'path' 'bits' 'key'"
        echo "Aborting."
        exit 1
fi

# Create a list of audit *.rules files that should be inspected for presence and correctness
# of a particular audit rule. The scheme is as follows:
#
# -----------------------------------------------------------------------------------------
# Tool used to load audit rules | Rule already defined  |  Audit rules file to inspect    |
# -----------------------------------------------------------------------------------------
#       auditctl                |     Doesn't matter    |  /etc/audit/audit.rules         |
# -----------------------------------------------------------------------------------------
#       augenrules              |          Yes          |  /etc/audit/rules.d/*.rules     |
#       augenrules              |          No           |  /etc/audit/rules.d/$key.rules  |
# -----------------------------------------------------------------------------------------
declare -a files_to_inspect

# Check sanity of the specified audit tool
if [ "$tool" != 'auditctl' ] &amp;&amp; [ "$tool" != 'augenrules' ]
then
        echo "Unknown audit rules loading tool: $1. Aborting."
        echo "Use either 'auditctl' or 'augenrules'!"
        exit 1
# If the audit tool is 'auditctl', then add '/etc/audit/audit.rules'
# into the list of files to be inspected
elif [ "$tool" == 'auditctl' ]
then
        files_to_inspect=("${files_to_inspect[@]}" '/etc/audit/audit.rules')
# If the audit is 'augenrules', then check if rule is already defined
# If rule is defined, add '/etc/audit/rules.d/*.rules' to list of files for inspection.
# If rule isn't defined, add '/etc/audit/rules.d/$key.rules' to list of files for inspection.
elif [ "$tool" == 'augenrules' ]
then
        # Case when particular audit rule is already defined in some of /etc/audit/rules.d/*.rules file
        # Get pair -- filepath : matching_row into @matches array
        IFS=$'\n' matches=($(grep -P "[\s]*-w[\s]+$path" /etc/audit/rules.d/*.rules))
        # Reset IFS back to default
        unset $IFS
        # For each of the matched entries
        for match in "${matches[@]}"
        do
                # Extract filepath from the match
                rulesd_audit_file=$(echo $match | cut -f1 -d ':')
                # Append that path into list of files for inspection
                files_to_inspect=("${files_to_inspect[@]}" "$rulesd_audit_file")
        done
        # Case when particular audit rule isn't defined yet
        if [ ${#files_to_inspect[@]} -eq "0" ]
        then
                # Append '/etc/audit/rules.d/$key.rules' into list of files for inspection
                files_to_inspect="/etc/audit/rules.d/$key.rules"
                # If the $key.rules file doesn't exist yet, create it with correct permissions
                if [ ! -e "$files_to_inspect" ]
                then
                        touch "$files_to_inspect"
                        chmod 0640 "$files_to_inspect"
                fi
        fi
fi

# Finally perform the inspection and possible subsequent audit rule
# correction for each of the files previously identified for inspection
for audit_rules_file in "${files_to_inspect[@]}"
do

        # Check if audit watch file system object rule for given path already present
        if grep -q -P -- "[\s]*-w[\s]+$path" "$audit_rules_file"
        then
                # Rule is found =&gt; verify yet if existing rule definition contains
                # all of the required access type bits

                # Escape slashes in path for use in sed pattern below
                local esc_path=${path//$'/'/$'\/'}
                # Define BRE whitespace class shortcut
                local sp="[[:space:]]"
                # Extract current permission access types (e.g. -p [r|w|x|a] values) from audit rule
                current_access_bits=$(sed -ne "s/$sp*-w$sp\+$esc_path$sp\+-p$sp\+\([rxwa]\{1,4\}\).*/\1/p" "$audit_rules_file")
                # Split required access bits string into characters array
                # (to check bit's presence for one bit at a time)
                for access_bit in $(echo "$required_access_bits" | grep -o .)
                do
                        # For each from the required access bits (e.g. 'w', 'a') check
                        # if they are already present in current access bits for rule.
                        # If not, append that bit at the end
                        if ! grep -q "$access_bit" &lt;&lt;&lt; "$current_access_bits"
                        then
                                # Concatenate the existing mask with the missing bit
                                current_access_bits="$current_access_bits$access_bit"
                        fi
                done
                # Propagate the updated rule's access bits (original + the required
                # ones) back into the /etc/audit/audit.rules file for that rule
                sed -i "s/\($sp*-w$sp\+$esc_path$sp\+-p$sp\+\)\([rxwa]\{1,4\}\)\(.*\)/\1$current_access_bits\3/" "$audit_rules_file"
        else
                # Rule isn't present yet. Append it at the end of $audit_rules_file file
                # with proper key

                echo "-w $path -p $required_access_bits -k $key" &gt;&gt; "$audit_rules_file"
        fi
done
}

fix_audit_watch_rule "auditctl" "/var/run/utmp" "wa" "session"
fix_audit_watch_rule "auditctl" "/var/log/btmp" "wa" "session"

function fix_audit_watch_rule {

# Load function arguments into local variables
local tool="$1"
local path="$2"
local required_access_bits="$3"
local key="$4"

# Check sanity of the input
if [ $# -ne "4" ]
then
        echo "Usage: fix_audit_watch_rule 'tool' 'path' 'bits' 'key'"
        echo "Aborting."
        exit 1
fi

# Create a list of audit *.rules files that should be inspected for presence and correctness
# of a particular audit rule. The scheme is as follows:
#
# -----------------------------------------------------------------------------------------
# Tool used to load audit rules | Rule already defined  |  Audit rules file to inspect    |
# -----------------------------------------------------------------------------------------
#       auditctl                |     Doesn't matter    |  /etc/audit/audit.rules         |
# -----------------------------------------------------------------------------------------
#       augenrules              |          Yes          |  /etc/audit/rules.d/*.rules     |
#       augenrules              |          No           |  /etc/audit/rules.d/$key.rules  |
# -----------------------------------------------------------------------------------------
declare -a files_to_inspect

# Check sanity of the specified audit tool
if [ "$tool" != 'auditctl' ] &amp;&amp; [ "$tool" != 'augenrules' ]
then
        echo "Unknown audit rules loading tool: $1. Aborting."
        echo "Use either 'auditctl' or 'augenrules'!"
        exit 1
# If the audit tool is 'auditctl', then add '/etc/audit/audit.rules'
# into the list of files to be inspected
elif [ "$tool" == 'auditctl' ]
then
        files_to_inspect=("${files_to_inspect[@]}" '/etc/audit/audit.rules')
# If the audit is 'augenrules', then check if rule is already defined
# If rule is defined, add '/etc/audit/rules.d/*.rules' to list of files for inspection.
# If rule isn't defined, add '/etc/audit/rules.d/$key.rules' to list of files for inspection.
elif [ "$tool" == 'augenrules' ]
then
        # Case when particular audit rule is already defined in some of /etc/audit/rules.d/*.rules file
        # Get pair -- filepath : matching_row into @matches array
        IFS=$'\n' matches=($(grep -P "[\s]*-w[\s]+$path" /etc/audit/rules.d/*.rules))
        # Reset IFS back to default
        unset $IFS
        # For each of the matched entries
        for match in "${matches[@]}"
        do
                # Extract filepath from the match
                rulesd_audit_file=$(echo $match | cut -f1 -d ':')
                # Append that path into list of files for inspection
                files_to_inspect=("${files_to_inspect[@]}" "$rulesd_audit_file")
        done
        # Case when particular audit rule isn't defined yet
        if [ ${#files_to_inspect[@]} -eq "0" ]
        then
                # Append '/etc/audit/rules.d/$key.rules' into list of files for inspection
                files_to_inspect="/etc/audit/rules.d/$key.rules"
                # If the $key.rules file doesn't exist yet, create it with correct permissions
                if [ ! -e "$files_to_inspect" ]
                then
                        touch "$files_to_inspect"
                        chmod 0640 "$files_to_inspect"
                fi
        fi
fi

# Finally perform the inspection and possible subsequent audit rule
# correction for each of the files previously identified for inspection
for audit_rules_file in "${files_to_inspect[@]}"
do

        # Check if audit watch file system object rule for given path already present
        if grep -q -P -- "[\s]*-w[\s]+$path" "$audit_rules_file"
        then
                # Rule is found =&gt; verify yet if existing rule definition contains
                # all of the required access type bits

                # Escape slashes in path for use in sed pattern below
                local esc_path=${path//$'/'/$'\/'}
                # Define BRE whitespace class shortcut
                local sp="[[:space:]]"
                # Extract current permission access types (e.g. -p [r|w|x|a] values) from audit rule
                current_access_bits=$(sed -ne "s/$sp*-w$sp\+$esc_path$sp\+-p$sp\+\([rxwa]\{1,4\}\).*/\1/p" "$audit_rules_file")
                # Split required access bits string into characters array
                # (to check bit's presence for one bit at a time)
                for access_bit in $(echo "$required_access_bits" | grep -o .)
                do
                        # For each from the required access bits (e.g. 'w', 'a') check
                        # if they are already present in current access bits for rule.
                        # If not, append that bit at the end
                        if ! grep -q "$access_bit" &lt;&lt;&lt; "$current_access_bits"
                        then
                                # Concatenate the existing mask with the missing bit
                                current_access_bits="$current_access_bits$access_bit"
                        fi
                done
                # Propagate the updated rule's access bits (original + the required
                # ones) back into the /etc/audit/audit.rules file for that rule
                sed -i "s/\($sp*-w$sp\+$esc_path$sp\+-p$sp\+\)\([rxwa]\{1,4\}\)\(.*\)/\1$current_access_bits\3/" "$audit_rules_file"
        else
                # Rule isn't present yet. Append it at the end of $audit_rules_file file
                # with proper key

                echo "-w $path -p $required_access_bits -k $key" &gt;&gt; "$audit_rules_file"
        fi
done
}

fix_audit_watch_rule "auditctl" "/var/log/wtmp" "wa" "session"
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-10.2.4" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-10.2.4" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.2"><td style="padding-left: 57px"><h3>10.2.4<span class="label label-default pull-right">group</span></h3><p>Invalid logical access attempts</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.2.4" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.2"><td style="padding-left: 57px"><small>contains 1 rule</small></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_display_login_attempts" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_display_login_attempts" id="guide-tree-leaf-idm45561209030352" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.2.4"><td style="padding-left: 76px"><h4>Set Last Login/Access Notification<span class="label label-default pull-right">rule</span></h4><p>To configure the system to notify users of last login/access
using <code>pam_lastlog</code>, add the following line immediately after <code>session  required  pam_limits.so</code>:
<pre>session       required     pam_lastlog.so showfailed</pre>
</p><span class="label label-primary">Rationale:</span><p>
Users need to be aware of activity that occurs regarding
their account. Providing users with information regarding the number
of unsuccessful attempts that were made to login to their account
allows the user to determine if any unauthorized activity has occurred
and gives them an opportunity to notify administrators.
</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">366</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-10.2.4</a></p></div><span class="label label-success">Remediation script:</span><pre><code>sed -i --follow-symlinks '/pam_limits.so/a session\t    required\t  pam_lastlog.so showfailed' /etc/pam.d/system-auth
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-10.2.5" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-10.2.5" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.2"><td style="padding-left: 57px"><h3>10.2.5<span class="label label-default pull-right">group</span></h3><p>Use of and changes to</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.2.5" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.2"><td style="padding-left: 57px"><small>contains 1 rule</small></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-10.2.5.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-10.2.5.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.2.5"><td style="padding-left: 76px"><h3>10.2.5.a<span class="label label-default pull-right">group</span></h3><p>Verify use of identification and authentication</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.2.5.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.2.5"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-10.2.5.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-10.2.5.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.2.5"><td style="padding-left: 76px"><h3>10.2.5.b<span class="label label-default pull-right">group</span></h3><p>Verify all elevation of privileges is logged.</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.2.5.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.2.5"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-10.2.5.c" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-10.2.5.c" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.2.5"><td style="padding-left: 76px"><h3>10.2.5.c<span class="label label-default pull-right">group</span></h3><p>Verify all changes, additions, or deletions to any account</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.2.5.c" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.2.5"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_audit_rules_usergroup_modification" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_audit_rules_usergroup_modification" id="guide-tree-leaf-idm45561208993296" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.2.5"><td style="padding-left: 76px"><h4>Record Events that Modify User/Group Information<span class="label label-default pull-right">rule</span></h4><p>Add the following to <code>/etc/audit/audit.rules</code>, in order
to capture events that modify account changes:
<pre># audit_rules_usergroup_modification
-w /etc/group -p wa -k audit_rules_usergroup_modification
-w /etc/passwd -p wa -k audit_rules_usergroup_modification
-w /etc/gshadow -p wa -k audit_rules_usergroup_modification
-w /etc/shadow -p wa -k audit_rules_usergroup_modification
-w /etc/security/opasswd -p wa -k audit_rules_usergroup_modification</pre>
</p><span class="label label-primary">Rationale:</span><p>In addition to auditing new user and group accounts, these watches
will alert the system administrator(s) to any modifications. Any
unexpected users, groups, or modifications should be investigated for
legitimacy.</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-2(4)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-3(10)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-1(b)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(a)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(d)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12(a)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IR-5</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">18</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">1403</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">1404</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">1405</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">1684</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">1683</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">1685</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">1686</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-10.2.5</a></p></div><span class="label label-success">Remediation script:</span><pre><code>

# Perform the remediation

function fix_audit_watch_rule {

# Load function arguments into local variables
local tool="$1"
local path="$2"
local required_access_bits="$3"
local key="$4"

# Check sanity of the input
if [ $# -ne "4" ]
then
        echo "Usage: fix_audit_watch_rule 'tool' 'path' 'bits' 'key'"
        echo "Aborting."
        exit 1
fi

# Create a list of audit *.rules files that should be inspected for presence and correctness
# of a particular audit rule. The scheme is as follows:
#
# -----------------------------------------------------------------------------------------
# Tool used to load audit rules | Rule already defined  |  Audit rules file to inspect    |
# -----------------------------------------------------------------------------------------
#       auditctl                |     Doesn't matter    |  /etc/audit/audit.rules         |
# -----------------------------------------------------------------------------------------
#       augenrules              |          Yes          |  /etc/audit/rules.d/*.rules     |
#       augenrules              |          No           |  /etc/audit/rules.d/$key.rules  |
# -----------------------------------------------------------------------------------------
declare -a files_to_inspect

# Check sanity of the specified audit tool
if [ "$tool" != 'auditctl' ] &amp;&amp; [ "$tool" != 'augenrules' ]
then
        echo "Unknown audit rules loading tool: $1. Aborting."
        echo "Use either 'auditctl' or 'augenrules'!"
        exit 1
# If the audit tool is 'auditctl', then add '/etc/audit/audit.rules'
# into the list of files to be inspected
elif [ "$tool" == 'auditctl' ]
then
        files_to_inspect=("${files_to_inspect[@]}" '/etc/audit/audit.rules')
# If the audit is 'augenrules', then check if rule is already defined
# If rule is defined, add '/etc/audit/rules.d/*.rules' to list of files for inspection.
# If rule isn't defined, add '/etc/audit/rules.d/$key.rules' to list of files for inspection.
elif [ "$tool" == 'augenrules' ]
then
        # Case when particular audit rule is already defined in some of /etc/audit/rules.d/*.rules file
        # Get pair -- filepath : matching_row into @matches array
        IFS=$'\n' matches=($(grep -P "[\s]*-w[\s]+$path" /etc/audit/rules.d/*.rules))
        # Reset IFS back to default
        unset $IFS
        # For each of the matched entries
        for match in "${matches[@]}"
        do
                # Extract filepath from the match
                rulesd_audit_file=$(echo $match | cut -f1 -d ':')
                # Append that path into list of files for inspection
                files_to_inspect=("${files_to_inspect[@]}" "$rulesd_audit_file")
        done
        # Case when particular audit rule isn't defined yet
        if [ ${#files_to_inspect[@]} -eq "0" ]
        then
                # Append '/etc/audit/rules.d/$key.rules' into list of files for inspection
                files_to_inspect="/etc/audit/rules.d/$key.rules"
                # If the $key.rules file doesn't exist yet, create it with correct permissions
                if [ ! -e "$files_to_inspect" ]
                then
                        touch "$files_to_inspect"
                        chmod 0640 "$files_to_inspect"
                fi
        fi
fi

# Finally perform the inspection and possible subsequent audit rule
# correction for each of the files previously identified for inspection
for audit_rules_file in "${files_to_inspect[@]}"
do

        # Check if audit watch file system object rule for given path already present
        if grep -q -P -- "[\s]*-w[\s]+$path" "$audit_rules_file"
        then
                # Rule is found =&gt; verify yet if existing rule definition contains
                # all of the required access type bits

                # Escape slashes in path for use in sed pattern below
                local esc_path=${path//$'/'/$'\/'}
                # Define BRE whitespace class shortcut
                local sp="[[:space:]]"
                # Extract current permission access types (e.g. -p [r|w|x|a] values) from audit rule
                current_access_bits=$(sed -ne "s/$sp*-w$sp\+$esc_path$sp\+-p$sp\+\([rxwa]\{1,4\}\).*/\1/p" "$audit_rules_file")
                # Split required access bits string into characters array
                # (to check bit's presence for one bit at a time)
                for access_bit in $(echo "$required_access_bits" | grep -o .)
                do
                        # For each from the required access bits (e.g. 'w', 'a') check
                        # if they are already present in current access bits for rule.
                        # If not, append that bit at the end
                        if ! grep -q "$access_bit" &lt;&lt;&lt; "$current_access_bits"
                        then
                                # Concatenate the existing mask with the missing bit
                                current_access_bits="$current_access_bits$access_bit"
                        fi
                done
                # Propagate the updated rule's access bits (original + the required
                # ones) back into the /etc/audit/audit.rules file for that rule
                sed -i "s/\($sp*-w$sp\+$esc_path$sp\+-p$sp\+\)\([rxwa]\{1,4\}\)\(.*\)/\1$current_access_bits\3/" "$audit_rules_file"
        else
                # Rule isn't present yet. Append it at the end of $audit_rules_file file
                # with proper key

                echo "-w $path -p $required_access_bits -k $key" &gt;&gt; "$audit_rules_file"
        fi
done
}

fix_audit_watch_rule "auditctl" "/etc/group" "wa" "audit_rules_usergroup_modification"
fix_audit_watch_rule "auditctl" "/etc/passwd" "wa" "audit_rules_usergroup_modification"

function fix_audit_watch_rule {

# Load function arguments into local variables
local tool="$1"
local path="$2"
local required_access_bits="$3"
local key="$4"

# Check sanity of the input
if [ $# -ne "4" ]
then
        echo "Usage: fix_audit_watch_rule 'tool' 'path' 'bits' 'key'"
        echo "Aborting."
        exit 1
fi

# Create a list of audit *.rules files that should be inspected for presence and correctness
# of a particular audit rule. The scheme is as follows:
#
# -----------------------------------------------------------------------------------------
# Tool used to load audit rules | Rule already defined  |  Audit rules file to inspect    |
# -----------------------------------------------------------------------------------------
#       auditctl                |     Doesn't matter    |  /etc/audit/audit.rules         |
# -----------------------------------------------------------------------------------------
#       augenrules              |          Yes          |  /etc/audit/rules.d/*.rules     |
#       augenrules              |          No           |  /etc/audit/rules.d/$key.rules  |
# -----------------------------------------------------------------------------------------
declare -a files_to_inspect

# Check sanity of the specified audit tool
if [ "$tool" != 'auditctl' ] &amp;&amp; [ "$tool" != 'augenrules' ]
then
        echo "Unknown audit rules loading tool: $1. Aborting."
        echo "Use either 'auditctl' or 'augenrules'!"
        exit 1
# If the audit tool is 'auditctl', then add '/etc/audit/audit.rules'
# into the list of files to be inspected
elif [ "$tool" == 'auditctl' ]
then
        files_to_inspect=("${files_to_inspect[@]}" '/etc/audit/audit.rules')
# If the audit is 'augenrules', then check if rule is already defined
# If rule is defined, add '/etc/audit/rules.d/*.rules' to list of files for inspection.
# If rule isn't defined, add '/etc/audit/rules.d/$key.rules' to list of files for inspection.
elif [ "$tool" == 'augenrules' ]
then
        # Case when particular audit rule is already defined in some of /etc/audit/rules.d/*.rules file
        # Get pair -- filepath : matching_row into @matches array
        IFS=$'\n' matches=($(grep -P "[\s]*-w[\s]+$path" /etc/audit/rules.d/*.rules))
        # Reset IFS back to default
        unset $IFS
        # For each of the matched entries
        for match in "${matches[@]}"
        do
                # Extract filepath from the match
                rulesd_audit_file=$(echo $match | cut -f1 -d ':')
                # Append that path into list of files for inspection
                files_to_inspect=("${files_to_inspect[@]}" "$rulesd_audit_file")
        done
        # Case when particular audit rule isn't defined yet
        if [ ${#files_to_inspect[@]} -eq "0" ]
        then
                # Append '/etc/audit/rules.d/$key.rules' into list of files for inspection
                files_to_inspect="/etc/audit/rules.d/$key.rules"
                # If the $key.rules file doesn't exist yet, create it with correct permissions
                if [ ! -e "$files_to_inspect" ]
                then
                        touch "$files_to_inspect"
                        chmod 0640 "$files_to_inspect"
                fi
        fi
fi

# Finally perform the inspection and possible subsequent audit rule
# correction for each of the files previously identified for inspection
for audit_rules_file in "${files_to_inspect[@]}"
do

        # Check if audit watch file system object rule for given path already present
        if grep -q -P -- "[\s]*-w[\s]+$path" "$audit_rules_file"
        then
                # Rule is found =&gt; verify yet if existing rule definition contains
                # all of the required access type bits

                # Escape slashes in path for use in sed pattern below
                local esc_path=${path//$'/'/$'\/'}
                # Define BRE whitespace class shortcut
                local sp="[[:space:]]"
                # Extract current permission access types (e.g. -p [r|w|x|a] values) from audit rule
                current_access_bits=$(sed -ne "s/$sp*-w$sp\+$esc_path$sp\+-p$sp\+\([rxwa]\{1,4\}\).*/\1/p" "$audit_rules_file")
                # Split required access bits string into characters array
                # (to check bit's presence for one bit at a time)
                for access_bit in $(echo "$required_access_bits" | grep -o .)
                do
                        # For each from the required access bits (e.g. 'w', 'a') check
                        # if they are already present in current access bits for rule.
                        # If not, append that bit at the end
                        if ! grep -q "$access_bit" &lt;&lt;&lt; "$current_access_bits"
                        then
                                # Concatenate the existing mask with the missing bit
                                current_access_bits="$current_access_bits$access_bit"
                        fi
                done
                # Propagate the updated rule's access bits (original + the required
                # ones) back into the /etc/audit/audit.rules file for that rule
                sed -i "s/\($sp*-w$sp\+$esc_path$sp\+-p$sp\+\)\([rxwa]\{1,4\}\)\(.*\)/\1$current_access_bits\3/" "$audit_rules_file"
        else
                # Rule isn't present yet. Append it at the end of $audit_rules_file file
                # with proper key

                echo "-w $path -p $required_access_bits -k $key" &gt;&gt; "$audit_rules_file"
        fi
done
}

fix_audit_watch_rule "auditctl" "/etc/gshadow" "wa" "audit_rules_usergroup_modification"
fix_audit_watch_rule "auditctl" "/etc/shadow" "wa" "audit_rules_usergroup_modification"

function fix_audit_watch_rule {

# Load function arguments into local variables
local tool="$1"
local path="$2"
local required_access_bits="$3"
local key="$4"

# Check sanity of the input
if [ $# -ne "4" ]
then
        echo "Usage: fix_audit_watch_rule 'tool' 'path' 'bits' 'key'"
        echo "Aborting."
        exit 1
fi

# Create a list of audit *.rules files that should be inspected for presence and correctness
# of a particular audit rule. The scheme is as follows:
#
# -----------------------------------------------------------------------------------------
# Tool used to load audit rules | Rule already defined  |  Audit rules file to inspect    |
# -----------------------------------------------------------------------------------------
#       auditctl                |     Doesn't matter    |  /etc/audit/audit.rules         |
# -----------------------------------------------------------------------------------------
#       augenrules              |          Yes          |  /etc/audit/rules.d/*.rules     |
#       augenrules              |          No           |  /etc/audit/rules.d/$key.rules  |
# -----------------------------------------------------------------------------------------
declare -a files_to_inspect

# Check sanity of the specified audit tool
if [ "$tool" != 'auditctl' ] &amp;&amp; [ "$tool" != 'augenrules' ]
then
        echo "Unknown audit rules loading tool: $1. Aborting."
        echo "Use either 'auditctl' or 'augenrules'!"
        exit 1
# If the audit tool is 'auditctl', then add '/etc/audit/audit.rules'
# into the list of files to be inspected
elif [ "$tool" == 'auditctl' ]
then
        files_to_inspect=("${files_to_inspect[@]}" '/etc/audit/audit.rules')
# If the audit is 'augenrules', then check if rule is already defined
# If rule is defined, add '/etc/audit/rules.d/*.rules' to list of files for inspection.
# If rule isn't defined, add '/etc/audit/rules.d/$key.rules' to list of files for inspection.
elif [ "$tool" == 'augenrules' ]
then
        # Case when particular audit rule is already defined in some of /etc/audit/rules.d/*.rules file
        # Get pair -- filepath : matching_row into @matches array
        IFS=$'\n' matches=($(grep -P "[\s]*-w[\s]+$path" /etc/audit/rules.d/*.rules))
        # Reset IFS back to default
        unset $IFS
        # For each of the matched entries
        for match in "${matches[@]}"
        do
                # Extract filepath from the match
                rulesd_audit_file=$(echo $match | cut -f1 -d ':')
                # Append that path into list of files for inspection
                files_to_inspect=("${files_to_inspect[@]}" "$rulesd_audit_file")
        done
        # Case when particular audit rule isn't defined yet
        if [ ${#files_to_inspect[@]} -eq "0" ]
        then
                # Append '/etc/audit/rules.d/$key.rules' into list of files for inspection
                files_to_inspect="/etc/audit/rules.d/$key.rules"
                # If the $key.rules file doesn't exist yet, create it with correct permissions
                if [ ! -e "$files_to_inspect" ]
                then
                        touch "$files_to_inspect"
                        chmod 0640 "$files_to_inspect"
                fi
        fi
fi

# Finally perform the inspection and possible subsequent audit rule
# correction for each of the files previously identified for inspection
for audit_rules_file in "${files_to_inspect[@]}"
do

        # Check if audit watch file system object rule for given path already present
        if grep -q -P -- "[\s]*-w[\s]+$path" "$audit_rules_file"
        then
                # Rule is found =&gt; verify yet if existing rule definition contains
                # all of the required access type bits

                # Escape slashes in path for use in sed pattern below
                local esc_path=${path//$'/'/$'\/'}
                # Define BRE whitespace class shortcut
                local sp="[[:space:]]"
                # Extract current permission access types (e.g. -p [r|w|x|a] values) from audit rule
                current_access_bits=$(sed -ne "s/$sp*-w$sp\+$esc_path$sp\+-p$sp\+\([rxwa]\{1,4\}\).*/\1/p" "$audit_rules_file")
                # Split required access bits string into characters array
                # (to check bit's presence for one bit at a time)
                for access_bit in $(echo "$required_access_bits" | grep -o .)
                do
                        # For each from the required access bits (e.g. 'w', 'a') check
                        # if they are already present in current access bits for rule.
                        # If not, append that bit at the end
                        if ! grep -q "$access_bit" &lt;&lt;&lt; "$current_access_bits"
                        then
                                # Concatenate the existing mask with the missing bit
                                current_access_bits="$current_access_bits$access_bit"
                        fi
                done
                # Propagate the updated rule's access bits (original + the required
                # ones) back into the /etc/audit/audit.rules file for that rule
                sed -i "s/\($sp*-w$sp\+$esc_path$sp\+-p$sp\+\)\([rxwa]\{1,4\}\)\(.*\)/\1$current_access_bits\3/" "$audit_rules_file"
        else
                # Rule isn't present yet. Append it at the end of $audit_rules_file file
                # with proper key

                echo "-w $path -p $required_access_bits -k $key" &gt;&gt; "$audit_rules_file"
        fi
done
}

fix_audit_watch_rule "auditctl" "/etc/security/opasswd" "wa" "audit_rules_usergroup_modification"
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-10.2.6" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-10.2.6" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.2"><td style="padding-left: 57px"><h3>10.2.6<span class="label label-default pull-right">group</span></h3><p>Initialization, stopping, or</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.2.6" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.2"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-10.2.7" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-10.2.7" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.2"><td style="padding-left: 57px"><h3>10.2.7<span class="label label-default pull-right">group</span></h3><p>Creation and deletion of system-</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.2.7" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.2"><td style="padding-left: 57px"><small>contains 2 rules</small></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_audit_rules_media_export" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_audit_rules_media_export" id="guide-tree-leaf-idm45561208918192" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.2.7"><td style="padding-left: 76px"><h4>Ensure auditd Collects Information on Exporting to Media (successful)<span class="label label-default pull-right">rule</span></h4><p>At a minimum the audit system should collect media
exportation events for all users and root. Add the following to
<code>/etc/audit/audit.rules</code>, setting ARCH to either b32 or b64 as
appropriate for your system:
<pre>-a always,exit -F arch=ARCH -S mount -F auid&gt;=500 -F auid!=4294967295 -k export</pre>
</p><span class="label label-primary">Rationale:</span><p>The unauthorized exportation of data to external media could result in an information leak
where classified information, Privacy Act information, and intellectual property could be lost. An audit
trail should be created each time a filesystem is mounted to help identify and guard against information
loss.</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-3(10)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-1(b)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(a)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(d)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12(a)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IR-5</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">126</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-10.2.7</a></p></div><span class="label label-success">Remediation script:</span><pre><code>

# Perform the remediation of the syscall rule
# Retrieve hardware architecture of the underlying system
[ $(getconf LONG_BIT) = "32" ] &amp;&amp; RULE_ARCHS=("b32") || RULE_ARCHS=("b32" "b64")

for ARCH in "${RULE_ARCHS[@]}"
do
	PATTERN="-a always,exit -F arch=$ARCH -S .* -F auid&gt;=500 -F auid!=4294967295 -k *"
	GROUP="mount"
	FULL_RULE="-a always,exit -F arch=$ARCH -S mount -F auid&gt;=500 -F auid!=4294967295 -k export"

function fix_audit_syscall_rule {

# Load function arguments into local variables
local tool="$1"
local pattern="$2"
local group="$3"
local arch="$4"
local full_rule="$5"

# Check sanity of the input
if [ $# -ne "5" ]
then
        echo "Usage: fix_audit_syscall_rule 'tool' 'pattern' 'group' 'arch' 'full rule'"
        echo "Aborting."
        exit 1
fi

# Create a list of audit *.rules files that should be inspected for presence and correctness
# of a particular audit rule. The scheme is as follows:
#
# -----------------------------------------------------------------------------------------
#  Tool used to load audit rules | Rule already defined  |  Audit rules file to inspect    |
# -----------------------------------------------------------------------------------------
#        auditctl                |     Doesn't matter    |  /etc/audit/audit.rules         |
# -----------------------------------------------------------------------------------------
#        augenrules              |          Yes          |  /etc/audit/rules.d/*.rules     |
#        augenrules              |          No           |  /etc/audit/rules.d/$key.rules  |
# -----------------------------------------------------------------------------------------
#
declare -a files_to_inspect

# First check sanity of the specified audit tool
if [ "$tool" != 'auditctl' ] &amp;&amp; [ "$tool" != 'augenrules' ]
then
        echo "Unknown audit rules loading tool: $1. Aborting."
        echo "Use either 'auditctl' or 'augenrules'!"
        exit 1
# If audit tool is 'auditctl', then add '/etc/audit/audit.rules'
# file to the list of files to be inspected
elif [ "$tool" == 'auditctl' ]
then
        files_to_inspect=("${files_to_inspect[@]}" '/etc/audit/audit.rules' )
# If audit tool is 'augenrules', then check if the audit rule is defined
# If rule is defined, add '/etc/audit/rules.d/*.rules' to the list for inspection
# If rule isn't defined yet, add '/etc/audit/rules.d/$key.rules' to the list for inspection
elif [ "$tool" == 'augenrules' ]
then
        # Extract audit $key from audit rule so we can use it later
        key=$(expr "$full_rule" : '.*-k[[:space:]]\([^[:space:]]\+\)')
        # Check if particular audit rule is already defined
        IFS=$'\n' matches=($(sed -s -n -e "/${pattern}/!d" -e "/${arch}/!d" -e "/${group}/!d;F" /etc/audit/rules.d/*.rules))
        # Reset IFS back to default
        unset $IFS
        for match in "${matches[@]}"
        do
                files_to_inspect=("${files_to_inspect[@]}" "${match}")
        done
        # Case when particular rule isn't defined in /etc/audit/rules.d/*.rules yet
        if [ ${#files_to_inspect[@]} -eq "0" ]
        then
                files_to_inspect="/etc/audit/rules.d/$key.rules"
                if [ ! -e "$files_to_inspect" ]
                then
                        touch "$files_to_inspect"
                        chmod 0640 "$files_to_inspect"
                fi
        fi
fi

#
# Indicator that we want to append $full_rule into $audit_file by default
local append_expected_rule=0

for audit_file in "${files_to_inspect[@]}"
do

        # Filter existing $audit_file rules' definitions to select those that:
        # * follow the rule pattern, and
        # * meet the hardware architecture requirement, and
        # * are current syscall group specific
        IFS=$'\n' existing_rules=($(sed -e "/${pattern}/!d" -e "/${arch}/!d" -e "/${group}/!d"  "$audit_file"))
        # Reset IFS back to default
        unset $IFS

        # Process rules found case-by-case
        for rule in "${existing_rules[@]}"
        do
                # Found rule is for same arch &amp; key, but differs (e.g. in count of -S arguments)
                if [ "${rule}" != "${full_rule}" ]
                then
                        # If so, isolate just '(-S \w)+' substring of that rule
                        rule_syscalls=$(echo $rule | grep -o -P '(-S \w+ )+')
                        # Check if list of '-S syscall' arguments of that rule is subset
                        # of '-S syscall' list of expected $full_rule
                        if grep -q -- "$rule_syscalls" &lt;&lt;&lt; "$full_rule"
                        then
                                # Rule is covered (i.e. the list of -S syscalls for this rule is
                                # subset of -S syscalls of $full_rule =&gt; existing rule can be deleted
                                # Thus delete the rule from audit.rules &amp; our array
                                sed -i -e "/$rule/d" "$audit_file"
                                existing_rules=("${existing_rules[@]//$rule/}")
                        else
                                # Rule isn't covered by $full_rule - it besides -S syscall arguments
                                # for this group contains also -S syscall arguments for other syscall
                                # group. Example: '-S lchown -S fchmod -S fchownat' =&gt; group='chown'
                                # since 'lchown' &amp; 'fchownat' share 'chown' substring
                                # Therefore:
                                # * 1) delete the original rule from audit.rules
                                # (original '-S lchown -S fchmod -S fchownat' rule would be deleted)
                                # * 2) delete the -S syscall arguments for this syscall group, but
                                # keep those not belonging to this syscall group
                                # (original '-S lchown -S fchmod -S fchownat' would become '-S fchmod'
                                # * 3) append the modified (filtered) rule again into audit.rules
                                # if the same rule not already present
                                #
                                # 1) Delete the original rule
                                sed -i -e "/$rule/d" "$audit_file"
                                # 2) Delete syscalls for this group, but keep those from other groups
                                # Convert current rule syscall's string into array splitting by '-S' delimiter
                                IFS=$'-S' read -a rule_syscalls_as_array &lt;&lt;&lt; "$rule_syscalls"
                                # Reset IFS back to default
                                unset $IFS
                                # Declare new empty string to hold '-S syscall' arguments from other groups
                                new_syscalls_for_rule=''
                                # Walk through existing '-S syscall' arguments
                                for syscall_arg in "${rule_syscalls_as_array[@]}"
                                do
                                        # Skip empty $syscall_arg values
                                        if [ "$syscall_arg" == '' ]
                                        then
                                                continue
                                        fi
                                        # If the '-S syscall' doesn't belong to current group add it to the new list
                                        # (together with adding '-S' delimiter back for each of such item found)
                                        if grep -q -v -- "$group" &lt;&lt;&lt; "$syscall_arg"
                                        then
                                                new_syscalls_for_rule="$new_syscalls_for_rule -S $syscall_arg"
                                        fi
                                done
                                # Replace original '-S syscall' list with the new one for this rule
                                updated_rule=${rule//$rule_syscalls/$new_syscalls_for_rule}
                                # Squeeze repeated whitespace characters in rule definition (if any) into one
                                updated_rule=$(echo "$updated_rule" | tr -s '[:space:]')
                                # 3) Append the modified / filtered rule again into audit.rules
                                #    (but only in case it's not present yet to prevent duplicate definitions)
                                if ! grep -q -- "$updated_rule" "$audit_file"
                                then
                                        echo "$updated_rule" &gt;&gt; "$audit_file"
                                fi
                        fi
                else
                        # $audit_file already contains the expected rule form for this
                        # architecture &amp; key =&gt; don't insert it second time
                        append_expected_rule=1
                fi
        done

        # We deleted all rules that were subset of the expected one for this arch &amp; key.
        # Also isolated rules containing system calls not from this system calls group.
        # Now append the expected rule if it's not present in $audit_file yet
        if [[ ${append_expected_rule} -eq "0" ]]
        then
                echo "$full_rule" &gt;&gt; "$audit_file"
        fi
done

}

	fix_audit_syscall_rule "auditctl" "$PATTERN" "$GROUP" "$ARCH" "$FULL_RULE"
done
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_audit_rules_kernel_module_loading" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_audit_rules_kernel_module_loading" id="guide-tree-leaf-idm45561208899088" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.2.7"><td style="padding-left: 76px"><h4>Ensure auditd Collects Information on Kernel Module Loading and Unloading<span class="label label-default pull-right">rule</span></h4><p>Add the following to <code>/etc/audit/audit.rules</code> in order
to capture kernel module loading and unloading events, setting ARCH to either b32 or b64 as appropriate for your system:
<pre>-w /sbin/insmod -p x -k modules
-w /sbin/rmmod -p x -k modules
-w /sbin/modprobe -p x -k modules
-a always,exit -F arch=<i>ARCH</i> -S init_module -S delete_module -k modules</pre>
</p><span class="label label-primary">Rationale:</span><p>The addition/removal of kernel modules can be used to alter the behavior of
the kernel and potentially introduce malicious code into kernel space. It is important
to have an audit trail of modules that have been introduced into the kernel.</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-3(10)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-1(b)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(a)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(d)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12(a)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IR-5</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">126</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-10.2.7</a></p></div><span class="label label-success">Remediation script:</span><pre><code>

# First perform the remediation of the syscall rule
# Retrieve hardware architecture of the underlying system
# Note: 32-bit kernel modules can't be loaded / unloaded on 64-bit kernel =&gt;
#       it's not required on a 64-bit system to check also for the presence
#       of 32-bit's equivalent of the corresponding rule. Therefore for
#       each system it's enought to check presence of system's native rule form.
[ $(getconf LONG_BIT) = "32" ] &amp;&amp; RULE_ARCHS=("b32") || RULE_ARCHS=("b64")

for ARCH in "${RULE_ARCHS[@]}"
do
	PATTERN="-a always,exit -F arch=$ARCH -S .* -k *"
	# Use escaped BRE regex to specify rule group
	GROUP="\(init\|delete\)_module"
	FULL_RULE="-a always,exit -F arch=$ARCH -S init_module -S delete_module -k modules"

function fix_audit_syscall_rule {

# Load function arguments into local variables
local tool="$1"
local pattern="$2"
local group="$3"
local arch="$4"
local full_rule="$5"

# Check sanity of the input
if [ $# -ne "5" ]
then
        echo "Usage: fix_audit_syscall_rule 'tool' 'pattern' 'group' 'arch' 'full rule'"
        echo "Aborting."
        exit 1
fi

# Create a list of audit *.rules files that should be inspected for presence and correctness
# of a particular audit rule. The scheme is as follows:
#
# -----------------------------------------------------------------------------------------
#  Tool used to load audit rules | Rule already defined  |  Audit rules file to inspect    |
# -----------------------------------------------------------------------------------------
#        auditctl                |     Doesn't matter    |  /etc/audit/audit.rules         |
# -----------------------------------------------------------------------------------------
#        augenrules              |          Yes          |  /etc/audit/rules.d/*.rules     |
#        augenrules              |          No           |  /etc/audit/rules.d/$key.rules  |
# -----------------------------------------------------------------------------------------
#
declare -a files_to_inspect

# First check sanity of the specified audit tool
if [ "$tool" != 'auditctl' ] &amp;&amp; [ "$tool" != 'augenrules' ]
then
        echo "Unknown audit rules loading tool: $1. Aborting."
        echo "Use either 'auditctl' or 'augenrules'!"
        exit 1
# If audit tool is 'auditctl', then add '/etc/audit/audit.rules'
# file to the list of files to be inspected
elif [ "$tool" == 'auditctl' ]
then
        files_to_inspect=("${files_to_inspect[@]}" '/etc/audit/audit.rules' )
# If audit tool is 'augenrules', then check if the audit rule is defined
# If rule is defined, add '/etc/audit/rules.d/*.rules' to the list for inspection
# If rule isn't defined yet, add '/etc/audit/rules.d/$key.rules' to the list for inspection
elif [ "$tool" == 'augenrules' ]
then
        # Extract audit $key from audit rule so we can use it later
        key=$(expr "$full_rule" : '.*-k[[:space:]]\([^[:space:]]\+\)')
        # Check if particular audit rule is already defined
        IFS=$'\n' matches=($(sed -s -n -e "/${pattern}/!d" -e "/${arch}/!d" -e "/${group}/!d;F" /etc/audit/rules.d/*.rules))
        # Reset IFS back to default
        unset $IFS
        for match in "${matches[@]}"
        do
                files_to_inspect=("${files_to_inspect[@]}" "${match}")
        done
        # Case when particular rule isn't defined in /etc/audit/rules.d/*.rules yet
        if [ ${#files_to_inspect[@]} -eq "0" ]
        then
                files_to_inspect="/etc/audit/rules.d/$key.rules"
                if [ ! -e "$files_to_inspect" ]
                then
                        touch "$files_to_inspect"
                        chmod 0640 "$files_to_inspect"
                fi
        fi
fi

#
# Indicator that we want to append $full_rule into $audit_file by default
local append_expected_rule=0

for audit_file in "${files_to_inspect[@]}"
do

        # Filter existing $audit_file rules' definitions to select those that:
        # * follow the rule pattern, and
        # * meet the hardware architecture requirement, and
        # * are current syscall group specific
        IFS=$'\n' existing_rules=($(sed -e "/${pattern}/!d" -e "/${arch}/!d" -e "/${group}/!d"  "$audit_file"))
        # Reset IFS back to default
        unset $IFS

        # Process rules found case-by-case
        for rule in "${existing_rules[@]}"
        do
                # Found rule is for same arch &amp; key, but differs (e.g. in count of -S arguments)
                if [ "${rule}" != "${full_rule}" ]
                then
                        # If so, isolate just '(-S \w)+' substring of that rule
                        rule_syscalls=$(echo $rule | grep -o -P '(-S \w+ )+')
                        # Check if list of '-S syscall' arguments of that rule is subset
                        # of '-S syscall' list of expected $full_rule
                        if grep -q -- "$rule_syscalls" &lt;&lt;&lt; "$full_rule"
                        then
                                # Rule is covered (i.e. the list of -S syscalls for this rule is
                                # subset of -S syscalls of $full_rule =&gt; existing rule can be deleted
                                # Thus delete the rule from audit.rules &amp; our array
                                sed -i -e "/$rule/d" "$audit_file"
                                existing_rules=("${existing_rules[@]//$rule/}")
                        else
                                # Rule isn't covered by $full_rule - it besides -S syscall arguments
                                # for this group contains also -S syscall arguments for other syscall
                                # group. Example: '-S lchown -S fchmod -S fchownat' =&gt; group='chown'
                                # since 'lchown' &amp; 'fchownat' share 'chown' substring
                                # Therefore:
                                # * 1) delete the original rule from audit.rules
                                # (original '-S lchown -S fchmod -S fchownat' rule would be deleted)
                                # * 2) delete the -S syscall arguments for this syscall group, but
                                # keep those not belonging to this syscall group
                                # (original '-S lchown -S fchmod -S fchownat' would become '-S fchmod'
                                # * 3) append the modified (filtered) rule again into audit.rules
                                # if the same rule not already present
                                #
                                # 1) Delete the original rule
                                sed -i -e "/$rule/d" "$audit_file"
                                # 2) Delete syscalls for this group, but keep those from other groups
                                # Convert current rule syscall's string into array splitting by '-S' delimiter
                                IFS=$'-S' read -a rule_syscalls_as_array &lt;&lt;&lt; "$rule_syscalls"
                                # Reset IFS back to default
                                unset $IFS
                                # Declare new empty string to hold '-S syscall' arguments from other groups
                                new_syscalls_for_rule=''
                                # Walk through existing '-S syscall' arguments
                                for syscall_arg in "${rule_syscalls_as_array[@]}"
                                do
                                        # Skip empty $syscall_arg values
                                        if [ "$syscall_arg" == '' ]
                                        then
                                                continue
                                        fi
                                        # If the '-S syscall' doesn't belong to current group add it to the new list
                                        # (together with adding '-S' delimiter back for each of such item found)
                                        if grep -q -v -- "$group" &lt;&lt;&lt; "$syscall_arg"
                                        then
                                                new_syscalls_for_rule="$new_syscalls_for_rule -S $syscall_arg"
                                        fi
                                done
                                # Replace original '-S syscall' list with the new one for this rule
                                updated_rule=${rule//$rule_syscalls/$new_syscalls_for_rule}
                                # Squeeze repeated whitespace characters in rule definition (if any) into one
                                updated_rule=$(echo "$updated_rule" | tr -s '[:space:]')
                                # 3) Append the modified / filtered rule again into audit.rules
                                #    (but only in case it's not present yet to prevent duplicate definitions)
                                if ! grep -q -- "$updated_rule" "$audit_file"
                                then
                                        echo "$updated_rule" &gt;&gt; "$audit_file"
                                fi
                        fi
                else
                        # $audit_file already contains the expected rule form for this
                        # architecture &amp; key =&gt; don't insert it second time
                        append_expected_rule=1
                fi
        done

        # We deleted all rules that were subset of the expected one for this arch &amp; key.
        # Also isolated rules containing system calls not from this system calls group.
        # Now append the expected rule if it's not present in $audit_file yet
        if [[ ${append_expected_rule} -eq "0" ]]
        then
                echo "$full_rule" &gt;&gt; "$audit_file"
        fi
done

}

	fix_audit_syscall_rule "auditctl" "$PATTERN" "$GROUP" "$ARCH" "$FULL_RULE"
done

# Then perform the remediations for the watch rules

function fix_audit_watch_rule {

# Load function arguments into local variables
local tool="$1"
local path="$2"
local required_access_bits="$3"
local key="$4"

# Check sanity of the input
if [ $# -ne "4" ]
then
        echo "Usage: fix_audit_watch_rule 'tool' 'path' 'bits' 'key'"
        echo "Aborting."
        exit 1
fi

# Create a list of audit *.rules files that should be inspected for presence and correctness
# of a particular audit rule. The scheme is as follows:
#
# -----------------------------------------------------------------------------------------
# Tool used to load audit rules | Rule already defined  |  Audit rules file to inspect    |
# -----------------------------------------------------------------------------------------
#       auditctl                |     Doesn't matter    |  /etc/audit/audit.rules         |
# -----------------------------------------------------------------------------------------
#       augenrules              |          Yes          |  /etc/audit/rules.d/*.rules     |
#       augenrules              |          No           |  /etc/audit/rules.d/$key.rules  |
# -----------------------------------------------------------------------------------------
declare -a files_to_inspect

# Check sanity of the specified audit tool
if [ "$tool" != 'auditctl' ] &amp;&amp; [ "$tool" != 'augenrules' ]
then
        echo "Unknown audit rules loading tool: $1. Aborting."
        echo "Use either 'auditctl' or 'augenrules'!"
        exit 1
# If the audit tool is 'auditctl', then add '/etc/audit/audit.rules'
# into the list of files to be inspected
elif [ "$tool" == 'auditctl' ]
then
        files_to_inspect=("${files_to_inspect[@]}" '/etc/audit/audit.rules')
# If the audit is 'augenrules', then check if rule is already defined
# If rule is defined, add '/etc/audit/rules.d/*.rules' to list of files for inspection.
# If rule isn't defined, add '/etc/audit/rules.d/$key.rules' to list of files for inspection.
elif [ "$tool" == 'augenrules' ]
then
        # Case when particular audit rule is already defined in some of /etc/audit/rules.d/*.rules file
        # Get pair -- filepath : matching_row into @matches array
        IFS=$'\n' matches=($(grep -P "[\s]*-w[\s]+$path" /etc/audit/rules.d/*.rules))
        # Reset IFS back to default
        unset $IFS
        # For each of the matched entries
        for match in "${matches[@]}"
        do
                # Extract filepath from the match
                rulesd_audit_file=$(echo $match | cut -f1 -d ':')
                # Append that path into list of files for inspection
                files_to_inspect=("${files_to_inspect[@]}" "$rulesd_audit_file")
        done
        # Case when particular audit rule isn't defined yet
        if [ ${#files_to_inspect[@]} -eq "0" ]
        then
                # Append '/etc/audit/rules.d/$key.rules' into list of files for inspection
                files_to_inspect="/etc/audit/rules.d/$key.rules"
                # If the $key.rules file doesn't exist yet, create it with correct permissions
                if [ ! -e "$files_to_inspect" ]
                then
                        touch "$files_to_inspect"
                        chmod 0640 "$files_to_inspect"
                fi
        fi
fi

# Finally perform the inspection and possible subsequent audit rule
# correction for each of the files previously identified for inspection
for audit_rules_file in "${files_to_inspect[@]}"
do

        # Check if audit watch file system object rule for given path already present
        if grep -q -P -- "[\s]*-w[\s]+$path" "$audit_rules_file"
        then
                # Rule is found =&gt; verify yet if existing rule definition contains
                # all of the required access type bits

                # Escape slashes in path for use in sed pattern below
                local esc_path=${path//$'/'/$'\/'}
                # Define BRE whitespace class shortcut
                local sp="[[:space:]]"
                # Extract current permission access types (e.g. -p [r|w|x|a] values) from audit rule
                current_access_bits=$(sed -ne "s/$sp*-w$sp\+$esc_path$sp\+-p$sp\+\([rxwa]\{1,4\}\).*/\1/p" "$audit_rules_file")
                # Split required access bits string into characters array
                # (to check bit's presence for one bit at a time)
                for access_bit in $(echo "$required_access_bits" | grep -o .)
                do
                        # For each from the required access bits (e.g. 'w', 'a') check
                        # if they are already present in current access bits for rule.
                        # If not, append that bit at the end
                        if ! grep -q "$access_bit" &lt;&lt;&lt; "$current_access_bits"
                        then
                                # Concatenate the existing mask with the missing bit
                                current_access_bits="$current_access_bits$access_bit"
                        fi
                done
                # Propagate the updated rule's access bits (original + the required
                # ones) back into the /etc/audit/audit.rules file for that rule
                sed -i "s/\($sp*-w$sp\+$esc_path$sp\+-p$sp\+\)\([rxwa]\{1,4\}\)\(.*\)/\1$current_access_bits\3/" "$audit_rules_file"
        else
                # Rule isn't present yet. Append it at the end of $audit_rules_file file
                # with proper key

                echo "-w $path -p $required_access_bits -k $key" &gt;&gt; "$audit_rules_file"
        fi
done
}

fix_audit_watch_rule "auditctl" "/sbin/insmod" "x" "modules"
fix_audit_watch_rule "auditctl" "/sbin/rmmod" "x" "modules"

function fix_audit_watch_rule {

# Load function arguments into local variables
local tool="$1"
local path="$2"
local required_access_bits="$3"
local key="$4"

# Check sanity of the input
if [ $# -ne "4" ]
then
        echo "Usage: fix_audit_watch_rule 'tool' 'path' 'bits' 'key'"
        echo "Aborting."
        exit 1
fi

# Create a list of audit *.rules files that should be inspected for presence and correctness
# of a particular audit rule. The scheme is as follows:
#
# -----------------------------------------------------------------------------------------
# Tool used to load audit rules | Rule already defined  |  Audit rules file to inspect    |
# -----------------------------------------------------------------------------------------
#       auditctl                |     Doesn't matter    |  /etc/audit/audit.rules         |
# -----------------------------------------------------------------------------------------
#       augenrules              |          Yes          |  /etc/audit/rules.d/*.rules     |
#       augenrules              |          No           |  /etc/audit/rules.d/$key.rules  |
# -----------------------------------------------------------------------------------------
declare -a files_to_inspect

# Check sanity of the specified audit tool
if [ "$tool" != 'auditctl' ] &amp;&amp; [ "$tool" != 'augenrules' ]
then
        echo "Unknown audit rules loading tool: $1. Aborting."
        echo "Use either 'auditctl' or 'augenrules'!"
        exit 1
# If the audit tool is 'auditctl', then add '/etc/audit/audit.rules'
# into the list of files to be inspected
elif [ "$tool" == 'auditctl' ]
then
        files_to_inspect=("${files_to_inspect[@]}" '/etc/audit/audit.rules')
# If the audit is 'augenrules', then check if rule is already defined
# If rule is defined, add '/etc/audit/rules.d/*.rules' to list of files for inspection.
# If rule isn't defined, add '/etc/audit/rules.d/$key.rules' to list of files for inspection.
elif [ "$tool" == 'augenrules' ]
then
        # Case when particular audit rule is already defined in some of /etc/audit/rules.d/*.rules file
        # Get pair -- filepath : matching_row into @matches array
        IFS=$'\n' matches=($(grep -P "[\s]*-w[\s]+$path" /etc/audit/rules.d/*.rules))
        # Reset IFS back to default
        unset $IFS
        # For each of the matched entries
        for match in "${matches[@]}"
        do
                # Extract filepath from the match
                rulesd_audit_file=$(echo $match | cut -f1 -d ':')
                # Append that path into list of files for inspection
                files_to_inspect=("${files_to_inspect[@]}" "$rulesd_audit_file")
        done
        # Case when particular audit rule isn't defined yet
        if [ ${#files_to_inspect[@]} -eq "0" ]
        then
                # Append '/etc/audit/rules.d/$key.rules' into list of files for inspection
                files_to_inspect="/etc/audit/rules.d/$key.rules"
                # If the $key.rules file doesn't exist yet, create it with correct permissions
                if [ ! -e "$files_to_inspect" ]
                then
                        touch "$files_to_inspect"
                        chmod 0640 "$files_to_inspect"
                fi
        fi
fi

# Finally perform the inspection and possible subsequent audit rule
# correction for each of the files previously identified for inspection
for audit_rules_file in "${files_to_inspect[@]}"
do

        # Check if audit watch file system object rule for given path already present
        if grep -q -P -- "[\s]*-w[\s]+$path" "$audit_rules_file"
        then
                # Rule is found =&gt; verify yet if existing rule definition contains
                # all of the required access type bits

                # Escape slashes in path for use in sed pattern below
                local esc_path=${path//$'/'/$'\/'}
                # Define BRE whitespace class shortcut
                local sp="[[:space:]]"
                # Extract current permission access types (e.g. -p [r|w|x|a] values) from audit rule
                current_access_bits=$(sed -ne "s/$sp*-w$sp\+$esc_path$sp\+-p$sp\+\([rxwa]\{1,4\}\).*/\1/p" "$audit_rules_file")
                # Split required access bits string into characters array
                # (to check bit's presence for one bit at a time)
                for access_bit in $(echo "$required_access_bits" | grep -o .)
                do
                        # For each from the required access bits (e.g. 'w', 'a') check
                        # if they are already present in current access bits for rule.
                        # If not, append that bit at the end
                        if ! grep -q "$access_bit" &lt;&lt;&lt; "$current_access_bits"
                        then
                                # Concatenate the existing mask with the missing bit
                                current_access_bits="$current_access_bits$access_bit"
                        fi
                done
                # Propagate the updated rule's access bits (original + the required
                # ones) back into the /etc/audit/audit.rules file for that rule
                sed -i "s/\($sp*-w$sp\+$esc_path$sp\+-p$sp\+\)\([rxwa]\{1,4\}\)\(.*\)/\1$current_access_bits\3/" "$audit_rules_file"
        else
                # Rule isn't present yet. Append it at the end of $audit_rules_file file
                # with proper key

                echo "-w $path -p $required_access_bits -k $key" &gt;&gt; "$audit_rules_file"
        fi
done
}

fix_audit_watch_rule "auditctl" "/sbin/modprobe" "x" "modules"
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-10.3" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-10.3" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10."><td style="padding-left: 38px"><h3 id="xccdf_org.ssgproject.content_group_pcidss-req-10.3">10.3<span class="label label-default pull-right">group</span></h3><p>Record at least the following audit</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.3" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10."><td style="padding-left: 38px"><small>contains 1 rule</small></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-10.3.1" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-10.3.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.3"><td style="padding-left: 57px"><h3>10.3.1<span class="label label-default pull-right">group</span></h3><p>User identification</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.3.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.3"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-10.3.2" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-10.3.2" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.3"><td style="padding-left: 57px"><h3>10.3.2<span class="label label-default pull-right">group</span></h3><p>Type of event</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.3.2" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.3"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-10.3.3" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-10.3.3" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.3"><td style="padding-left: 57px"><h3>10.3.3<span class="label label-default pull-right">group</span></h3><p>Date and time</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.3.3" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.3"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-10.3.4" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-10.3.4" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.3"><td style="padding-left: 57px"><h3>10.3.4<span class="label label-default pull-right">group</span></h3><p>Success or failure indication</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.3.4" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.3"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-10.3.5" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-10.3.5" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.3"><td style="padding-left: 57px"><h3>10.3.5<span class="label label-default pull-right">group</span></h3><p>Origination of event</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.3.5" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.3"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-10.3.6" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-10.3.6" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.3"><td style="padding-left: 57px"><h3>10.3.6<span class="label label-default pull-right">group</span></h3><p>Identity or name of affected</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.3.6" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.3"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_bootloader_audit_argument" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_bootloader_audit_argument" id="guide-tree-leaf-idm45561208875104" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.3"><td style="padding-left: 57px"><h4>Enable Auditing for Processes Which Start Prior to the Audit Daemon<span class="label label-default pull-right">rule</span></h4><p>To ensure all processes can be audited, even
those which start prior to the audit daemon, add the argument
<code>audit=1</code> to the kernel line in <code>/etc/grub.conf</code>, in the manner below:
<pre>kernel /vmlinuz-version ro vga=ext root=/dev/VolGroup00/LogVol00 rhgb quiet audit=1</pre>
</p><span class="label label-primary">Rationale:</span><p>
Each process on the system carries an "auditable" flag which
indicates whether its activities can be audited. Although <code>auditd</code>
takes care of enabling this for all processes which launch after it
does, adding the kernel argument ensures it is set for every
process during boot.
</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-17(1)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-14(1)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-1(b)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(a)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(d)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-10</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IR-5</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">169</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-10.3</a></p></div><span class="label label-success">Remediation script:</span><pre><code>/sbin/grubby --update-kernel=ALL --args="audit=1"
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-10.4" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-10.4" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10."><td style="padding-left: 38px"><h3 id="xccdf_org.ssgproject.content_group_pcidss-req-10.4">10.4<span class="label label-default pull-right">group</span></h3><p>Using time-synchronization</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.4" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10."><td style="padding-left: 38px"><small>contains 8 rules</small></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-10.4.1" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-10.4.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.4"><td style="padding-left: 57px"><h3>10.4.1<span class="label label-default pull-right">group</span></h3><p>Critical systems have the</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.4.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.4"><td style="padding-left: 57px"><small>contains 1 rule</small></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-10.4.1.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-10.4.1.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.4.1"><td style="padding-left: 76px"><h3>10.4.1.a<span class="label label-default pull-right">group</span></h3><p>Examine the process for acquiring, distributing and</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.4.1.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.4.1"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-10.4.1.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-10.4.1.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.4.1"><td style="padding-left: 76px"><h3>10.4.1.b<span class="label label-default pull-right">group</span></h3><p>Observe the time-related system-parameter settings for</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.4.1.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.4.1"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_ntpd_specify_remote_server" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_ntpd_specify_remote_server" id="guide-tree-leaf-idm45561208825904" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.4.1"><td style="padding-left: 76px"><h4>Specify a Remote NTP Server<span class="label label-default pull-right">rule</span></h4><p>To specify a remote NTP server for time synchronization, edit
the file <code>/etc/ntp.conf</code>. Add or correct the following lines,
substituting the IP or hostname of a remote NTP server for <em>ntpserver</em>:
<pre>server <i>ntpserver</i></pre>
This instructs the NTP software to contact that remote server to obtain time
data.
</p><span class="label label-primary">Rationale:</span><p>Synchronizing with an NTP server makes it possible
to collate system logs from multiple sources or correlate computer events with
real time events.
</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-8(1)</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-10.4.1</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-10.4.3</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">160</a></p></div></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-10.4.2" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-10.4.2" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.4"><td style="padding-left: 57px"><h3>10.4.2<span class="label label-default pull-right">group</span></h3><p>Time data is protected.</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.4.2" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.4"><td style="padding-left: 57px"><small>contains 5 rules</small></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-10.4.2.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-10.4.2.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.4.2"><td style="padding-left: 76px"><h3>10.4.2.a<span class="label label-default pull-right">group</span></h3><p>Examine system configurations and time-</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.4.2.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.4.2"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-10.4.2.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-10.4.2.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.4.2"><td style="padding-left: 76px"><h3>10.4.2.b<span class="label label-default pull-right">group</span></h3><p>Examine system configurations, time synchronization</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.4.2.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.4.2"><td style="padding-left: 76px"><small>contains 5 rules</small></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_audit_rules_time_adjtimex" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_audit_rules_time_adjtimex" id="guide-tree-leaf-idm45561208805760" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.4.2.b"><td style="padding-left: 95px"><h4>Record attempts to alter time through adjtimex<span class="label label-default pull-right">rule</span></h4><p>On a 32-bit system, add the following to <code>/etc/audit/audit.rules</code>:
<pre># audit_time_rules
-a always,exit -F arch=b32 -S adjtimex -k audit_time_rules</pre>
On a 64-bit system, add the following to <code>/etc/audit/audit.rules</code>:
<pre># audit_time_rules
-a always,exit -F arch=b64 -S adjtimex -k audit_time_rules</pre>
The -k option allows for the specification of a key in string form that can 
be used for better reporting capability through ausearch and aureport.
Multiple system calls can be defined on the same line to save space if 
desired, but is not required. See an example of multiple combined syscalls:
<pre>-a always,exit -F arch=b64 -S adjtimex -S settimeofday -k audit_time_rules</pre>
</p><span class="label label-primary">Rationale:</span><p>Arbitrary changes to the system time can be used to obfuscate 
nefarious activities in log files, as well as to confuse network services that 
are highly dependent upon an accurate system time (such as sshd). All changes 
to the system time should be audited.</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-3(10)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-1(b)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(a)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(d)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12(a)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IR-5</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-10.4.2.b</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">1487</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">169</a></p></div><span class="label label-success">Remediation script:</span><pre><code>
function fix_audit_syscall_rule {

# Load function arguments into local variables
local tool="$1"
local pattern="$2"
local group="$3"
local arch="$4"
local full_rule="$5"

# Check sanity of the input
if [ $# -ne "5" ]
then
        echo "Usage: fix_audit_syscall_rule 'tool' 'pattern' 'group' 'arch' 'full rule'"
        echo "Aborting."
        exit 1
fi

# Create a list of audit *.rules files that should be inspected for presence and correctness
# of a particular audit rule. The scheme is as follows:
# 
# -----------------------------------------------------------------------------------------
#  Tool used to load audit rules | Rule already defined  |  Audit rules file to inspect    |
# -----------------------------------------------------------------------------------------
#        auditctl                |     Doesn't matter    |  /etc/audit/audit.rules         |
# -----------------------------------------------------------------------------------------
#        augenrules              |          Yes          |  /etc/audit/rules.d/*.rules     |
#        augenrules              |          No           |  /etc/audit/rules.d/$key.rules  |
# -----------------------------------------------------------------------------------------
#
declare -a files_to_inspect

# First check sanity of the specified audit tool
if [ "$tool" != 'auditctl' ] &amp;&amp; [ "$tool" != 'augenrules' ]
then
        echo "Unknown audit rules loading tool: $1. Aborting."
        echo "Use either 'auditctl' or 'augenrules'!"
        exit 1
# If audit tool is 'auditctl', then add '/etc/audit/audit.rules'
# file to the list of files to be inspected
elif [ "$tool" == 'auditctl' ]
then
        files_to_inspect=("${files_to_inspect[@]}" '/etc/audit/audit.rules' )
# If audit tool is 'augenrules', then check if the audit rule is defined
# If rule is defined, add '/etc/audit/rules.d/*.rules' to the list for inspection
# If rule isn't defined yet, add '/etc/audit/rules.d/$key.rules' to the list for inspection
elif [ "$tool" == 'augenrules' ]
then
        # Extract audit $key from audit rule so we can use it later
        key=$(expr "$full_rule" : '.*-k[[:space:]]\([^[:space:]]\+\)')
        # Check if particular audit rule is already defined
        IFS=$'\n' matches=($(sed -s -n -e "/${pattern}/!d" -e "/${arch}/!d" -e "/${group}/!d;F" /etc/audit/rules.d/*.rules))
        # Reset IFS back to default
        unset $IFS
        for match in "${matches[@]}"
        do
                files_to_inspect=("${files_to_inspect[@]}" "${match}")
        done
        # Case when particular rule isn't defined in /etc/audit/rules.d/*.rules yet
        if [ ${#files_to_inspect[@]} -eq "0" ]
        then
                files_to_inspect="/etc/audit/rules.d/$key.rules"
                if [ ! -e "$files_to_inspect" ]
                then
                        touch "$files_to_inspect"
                        chmod 0640 "$files_to_inspect"
                fi
        fi
fi

#
# Indicator that we want to append $full_rule into $audit_file by default
local append_expected_rule=0

for audit_file in "${files_to_inspect[@]}"
do

        # Filter existing $audit_file rules' definitions to select those that:
        # * follow the rule pattern, and
        # * meet the hardware architecture requirement, and
        # * are current syscall group specific
        IFS=$'\n' existing_rules=($(sed -e "/${pattern}/!d" -e "/${arch}/!d" -e "/${group}/!d"  "$audit_file"))
        # Reset IFS back to default
        unset $IFS

        # Process rules found case-by-case
        for rule in "${existing_rules[@]}"
        do
                # Found rule is for same arch &amp; key, but differs (e.g. in count of -S arguments)
                if [ "${rule}" != "${full_rule}" ]
                then
                        # If so, isolate just '(-S \w)+' substring of that rule
                        rule_syscalls=$(echo $rule | grep -o -P '(-S \w+ )+')
                        # Check if list of '-S syscall' arguments of that rule is subset
                        # of '-S syscall' list of expected $full_rule
                        if grep -q -- "$rule_syscalls" &lt;&lt;&lt; "$full_rule"
                        then
                                # Rule is covered (i.e. the list of -S syscalls for this rule is
                                # subset of -S syscalls of $full_rule =&gt; existing rule can be deleted
                                # Thus delete the rule from audit.rules &amp; our array
                                sed -i -e "/$rule/d" "$audit_file"
                                existing_rules=("${existing_rules[@]//$rule/}")
                        else
                                # Rule isn't covered by $full_rule - it besides -S syscall arguments
                                # for this group contains also -S syscall arguments for other syscall
                                # group. Example: '-S lchown -S fchmod -S fchownat' =&gt; group='chown'
                                # since 'lchown' &amp; 'fchownat' share 'chown' substring
                                # Therefore:
                                # * 1) delete the original rule from audit.rules
                                # (original '-S lchown -S fchmod -S fchownat' rule would be deleted)
                                # * 2) delete the -S syscall arguments for this syscall group, but
                                # keep those not belonging to this syscall group
                                # (original '-S lchown -S fchmod -S fchownat' would become '-S fchmod'
                                # * 3) append the modified (filtered) rule again into audit.rules
                                # if the same rule not already present
                                #
                                # 1) Delete the original rule
                                sed -i -e "/$rule/d" "$audit_file"
                                # 2) Delete syscalls for this group, but keep those from other groups
                                # Convert current rule syscall's string into array splitting by '-S' delimiter
                                IFS=$'-S' read -a rule_syscalls_as_array &lt;&lt;&lt; "$rule_syscalls"
                                # Reset IFS back to default
                                unset $IFS
                                # Declare new empty string to hold '-S syscall' arguments from other groups
                                new_syscalls_for_rule=''
                                # Walk through existing '-S syscall' arguments
                                for syscall_arg in "${rule_syscalls_as_array[@]}"
                                do
                                        # Skip empty $syscall_arg values
                                        if [ "$syscall_arg" == '' ]
                                        then
                                                continue
                                        fi
                                        # If the '-S syscall' doesn't belong to current group add it to the new list
                                        # (together with adding '-S' delimiter back for each of such item found)
                                        if grep -q -v -- "$group" &lt;&lt;&lt; "$syscall_arg"
                                        then
                                                new_syscalls_for_rule="$new_syscalls_for_rule -S $syscall_arg"
                                        fi
                                done
                                # Replace original '-S syscall' list with the new one for this rule
                                updated_rule=${rule//$rule_syscalls/$new_syscalls_for_rule}
                                # Squeeze repeated whitespace characters in rule definition (if any) into one
                                updated_rule=$(echo "$updated_rule" | tr -s '[:space:]')
                                # 3) Append the modified / filtered rule again into audit.rules
                                #    (but only in case it's not present yet to prevent duplicate definitions)
                                if ! grep -q -- "$updated_rule" "$audit_file"
                                then
                                        echo "$updated_rule" &gt;&gt; "$audit_file"
                                fi
                        fi
                else
                        # $audit_file already contains the expected rule form for this
                        # architecture &amp; key =&gt; don't insert it second time
                        append_expected_rule=1
                fi
        done

        # We deleted all rules that were subset of the expected one for this arch &amp; key.
        # Also isolated rules containing system calls not from this system calls group.
        # Now append the expected rule if it's not present in $audit_file yet
        if [[ ${append_expected_rule} -eq "0" ]]
        then
                echo "$full_rule" &gt;&gt; "$audit_file"
        fi
done

}

function rhel6_perform_audit_adjtimex_settimeofday_stime_remediation {

# Perform the remediation for the 'adjtimex', 'settimeofday', and 'stime' audit
# system calls on Red Hat Enterprise Linux 6 OS
#
# Retrieve hardware architecture of the underlying system
[ $(getconf LONG_BIT) = "32" ] &amp;&amp; RULE_ARCHS=("b32") || RULE_ARCHS=("b32" "b64")

for ARCH in "${RULE_ARCHS[@]}"
do
        PATTERN="-a always,exit -F arch=${ARCH} -S .* -k *"
        # Create expected audit group and audit rule form for particular system call &amp; architecture
        if [ ${ARCH} = "b32" ]
        then
                # stime system call is known at 32-bit arch (see e.g "$ ausyscall i386 stime" 's output)
                # so append it to the list of time group system calls to be audited
                GROUP="\(adjtimex\|settimeofday\|stime\)"
                FULL_RULE="-a always,exit -F arch=${ARCH} -S adjtimex -S settimeofday -S stime -k audit_time_rules"
        elif [ ${ARCH} = "b64" ]
        then
                # stime system call isn't known at 64-bit arch (see "$ ausyscall x86_64 stime" 's output)
                # therefore don't add it to the list of time group system calls to be audited
                GROUP="\(adjtimex\|settimeofday\)"
                FULL_RULE="-a always,exit -F arch=${ARCH} -S adjtimex -S settimeofday -k audit_time_rules"
        fi
        # Perform the remediation itself
        fix_audit_syscall_rule "auditctl" "$PATTERN" "$GROUP" "$ARCH" "$FULL_RULE"
done

}

rhel6_perform_audit_adjtimex_settimeofday_stime_remediation
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_audit_rules_time_settimeofday" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_audit_rules_time_settimeofday" id="guide-tree-leaf-idm45561208785280" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.4.2.b"><td style="padding-left: 95px"><h4>Record attempts to alter time through settimeofday<span class="label label-default pull-right">rule</span></h4><p>On a 32-bit system, add the following to <code>/etc/audit/audit.rules</code>:
<pre># audit_time_rules
-a always,exit -F arch=b32 -S settimeofday -k audit_time_rules</pre>
On a 64-bit system, add the following to <code>/etc/audit/audit.rules</code>:
<pre># audit_time_rules
-a always,exit -F arch=b64 -S settimeofday -k audit_time_rules</pre>
The -k option allows for the specification of a key in string form that can 
be used for better reporting capability through ausearch and aureport.
Multiple system calls can be defined on the same line to save space if 
desired, but is not required. See an example of multiple combined syscalls:
<pre>-a always,exit -F arch=b64 -S adjtimex -S settimeofday -k audit_time_rules</pre>
</p><span class="label label-primary">Rationale:</span><p>Arbitrary changes to the system time can be used to obfuscate 
nefarious activities in log files, as well as to confuse network services that 
are highly dependent upon an accurate system time (such as sshd). All changes 
to the system time should be audited.</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-3(10)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-1(b)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(a)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(d)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12(a)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IR-5</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-10.4.2.b</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">1487</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">169</a></p></div><span class="label label-success">Remediation script:</span><pre><code>
function fix_audit_syscall_rule {

# Load function arguments into local variables
local tool="$1"
local pattern="$2"
local group="$3"
local arch="$4"
local full_rule="$5"

# Check sanity of the input
if [ $# -ne "5" ]
then
        echo "Usage: fix_audit_syscall_rule 'tool' 'pattern' 'group' 'arch' 'full rule'"
        echo "Aborting."
        exit 1
fi

# Create a list of audit *.rules files that should be inspected for presence and correctness
# of a particular audit rule. The scheme is as follows:
# 
# -----------------------------------------------------------------------------------------
#  Tool used to load audit rules | Rule already defined  |  Audit rules file to inspect    |
# -----------------------------------------------------------------------------------------
#        auditctl                |     Doesn't matter    |  /etc/audit/audit.rules         |
# -----------------------------------------------------------------------------------------
#        augenrules              |          Yes          |  /etc/audit/rules.d/*.rules     |
#        augenrules              |          No           |  /etc/audit/rules.d/$key.rules  |
# -----------------------------------------------------------------------------------------
#
declare -a files_to_inspect

# First check sanity of the specified audit tool
if [ "$tool" != 'auditctl' ] &amp;&amp; [ "$tool" != 'augenrules' ]
then
        echo "Unknown audit rules loading tool: $1. Aborting."
        echo "Use either 'auditctl' or 'augenrules'!"
        exit 1
# If audit tool is 'auditctl', then add '/etc/audit/audit.rules'
# file to the list of files to be inspected
elif [ "$tool" == 'auditctl' ]
then
        files_to_inspect=("${files_to_inspect[@]}" '/etc/audit/audit.rules' )
# If audit tool is 'augenrules', then check if the audit rule is defined
# If rule is defined, add '/etc/audit/rules.d/*.rules' to the list for inspection
# If rule isn't defined yet, add '/etc/audit/rules.d/$key.rules' to the list for inspection
elif [ "$tool" == 'augenrules' ]
then
        # Extract audit $key from audit rule so we can use it later
        key=$(expr "$full_rule" : '.*-k[[:space:]]\([^[:space:]]\+\)')
        # Check if particular audit rule is already defined
        IFS=$'\n' matches=($(sed -s -n -e "/${pattern}/!d" -e "/${arch}/!d" -e "/${group}/!d;F" /etc/audit/rules.d/*.rules))
        # Reset IFS back to default
        unset $IFS
        for match in "${matches[@]}"
        do
                files_to_inspect=("${files_to_inspect[@]}" "${match}")
        done
        # Case when particular rule isn't defined in /etc/audit/rules.d/*.rules yet
        if [ ${#files_to_inspect[@]} -eq "0" ]
        then
                files_to_inspect="/etc/audit/rules.d/$key.rules"
                if [ ! -e "$files_to_inspect" ]
                then
                        touch "$files_to_inspect"
                        chmod 0640 "$files_to_inspect"
                fi
        fi
fi

#
# Indicator that we want to append $full_rule into $audit_file by default
local append_expected_rule=0

for audit_file in "${files_to_inspect[@]}"
do

        # Filter existing $audit_file rules' definitions to select those that:
        # * follow the rule pattern, and
        # * meet the hardware architecture requirement, and
        # * are current syscall group specific
        IFS=$'\n' existing_rules=($(sed -e "/${pattern}/!d" -e "/${arch}/!d" -e "/${group}/!d"  "$audit_file"))
        # Reset IFS back to default
        unset $IFS

        # Process rules found case-by-case
        for rule in "${existing_rules[@]}"
        do
                # Found rule is for same arch &amp; key, but differs (e.g. in count of -S arguments)
                if [ "${rule}" != "${full_rule}" ]
                then
                        # If so, isolate just '(-S \w)+' substring of that rule
                        rule_syscalls=$(echo $rule | grep -o -P '(-S \w+ )+')
                        # Check if list of '-S syscall' arguments of that rule is subset
                        # of '-S syscall' list of expected $full_rule
                        if grep -q -- "$rule_syscalls" &lt;&lt;&lt; "$full_rule"
                        then
                                # Rule is covered (i.e. the list of -S syscalls for this rule is
                                # subset of -S syscalls of $full_rule =&gt; existing rule can be deleted
                                # Thus delete the rule from audit.rules &amp; our array
                                sed -i -e "/$rule/d" "$audit_file"
                                existing_rules=("${existing_rules[@]//$rule/}")
                        else
                                # Rule isn't covered by $full_rule - it besides -S syscall arguments
                                # for this group contains also -S syscall arguments for other syscall
                                # group. Example: '-S lchown -S fchmod -S fchownat' =&gt; group='chown'
                                # since 'lchown' &amp; 'fchownat' share 'chown' substring
                                # Therefore:
                                # * 1) delete the original rule from audit.rules
                                # (original '-S lchown -S fchmod -S fchownat' rule would be deleted)
                                # * 2) delete the -S syscall arguments for this syscall group, but
                                # keep those not belonging to this syscall group
                                # (original '-S lchown -S fchmod -S fchownat' would become '-S fchmod'
                                # * 3) append the modified (filtered) rule again into audit.rules
                                # if the same rule not already present
                                #
                                # 1) Delete the original rule
                                sed -i -e "/$rule/d" "$audit_file"
                                # 2) Delete syscalls for this group, but keep those from other groups
                                # Convert current rule syscall's string into array splitting by '-S' delimiter
                                IFS=$'-S' read -a rule_syscalls_as_array &lt;&lt;&lt; "$rule_syscalls"
                                # Reset IFS back to default
                                unset $IFS
                                # Declare new empty string to hold '-S syscall' arguments from other groups
                                new_syscalls_for_rule=''
                                # Walk through existing '-S syscall' arguments
                                for syscall_arg in "${rule_syscalls_as_array[@]}"
                                do
                                        # Skip empty $syscall_arg values
                                        if [ "$syscall_arg" == '' ]
                                        then
                                                continue
                                        fi
                                        # If the '-S syscall' doesn't belong to current group add it to the new list
                                        # (together with adding '-S' delimiter back for each of such item found)
                                        if grep -q -v -- "$group" &lt;&lt;&lt; "$syscall_arg"
                                        then
                                                new_syscalls_for_rule="$new_syscalls_for_rule -S $syscall_arg"
                                        fi
                                done
                                # Replace original '-S syscall' list with the new one for this rule
                                updated_rule=${rule//$rule_syscalls/$new_syscalls_for_rule}
                                # Squeeze repeated whitespace characters in rule definition (if any) into one
                                updated_rule=$(echo "$updated_rule" | tr -s '[:space:]')
                                # 3) Append the modified / filtered rule again into audit.rules
                                #    (but only in case it's not present yet to prevent duplicate definitions)
                                if ! grep -q -- "$updated_rule" "$audit_file"
                                then
                                        echo "$updated_rule" &gt;&gt; "$audit_file"
                                fi
                        fi
                else
                        # $audit_file already contains the expected rule form for this
                        # architecture &amp; key =&gt; don't insert it second time
                        append_expected_rule=1
                fi
        done

        # We deleted all rules that were subset of the expected one for this arch &amp; key.
        # Also isolated rules containing system calls not from this system calls group.
        # Now append the expected rule if it's not present in $audit_file yet
        if [[ ${append_expected_rule} -eq "0" ]]
        then
                echo "$full_rule" &gt;&gt; "$audit_file"
        fi
done

}

function rhel6_perform_audit_adjtimex_settimeofday_stime_remediation {

# Perform the remediation for the 'adjtimex', 'settimeofday', and 'stime' audit
# system calls on Red Hat Enterprise Linux 6 OS
#
# Retrieve hardware architecture of the underlying system
[ $(getconf LONG_BIT) = "32" ] &amp;&amp; RULE_ARCHS=("b32") || RULE_ARCHS=("b32" "b64")

for ARCH in "${RULE_ARCHS[@]}"
do
        PATTERN="-a always,exit -F arch=${ARCH} -S .* -k *"
        # Create expected audit group and audit rule form for particular system call &amp; architecture
        if [ ${ARCH} = "b32" ]
        then
                # stime system call is known at 32-bit arch (see e.g "$ ausyscall i386 stime" 's output)
                # so append it to the list of time group system calls to be audited
                GROUP="\(adjtimex\|settimeofday\|stime\)"
                FULL_RULE="-a always,exit -F arch=${ARCH} -S adjtimex -S settimeofday -S stime -k audit_time_rules"
        elif [ ${ARCH} = "b64" ]
        then
                # stime system call isn't known at 64-bit arch (see "$ ausyscall x86_64 stime" 's output)
                # therefore don't add it to the list of time group system calls to be audited
                GROUP="\(adjtimex\|settimeofday\)"
                FULL_RULE="-a always,exit -F arch=${ARCH} -S adjtimex -S settimeofday -k audit_time_rules"
        fi
        # Perform the remediation itself
        fix_audit_syscall_rule "auditctl" "$PATTERN" "$GROUP" "$ARCH" "$FULL_RULE"
done

}

rhel6_perform_audit_adjtimex_settimeofday_stime_remediation
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_audit_rules_time_stime" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_audit_rules_time_stime" id="guide-tree-leaf-idm45561208764784" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.4.2.b"><td style="padding-left: 95px"><h4>Record Attempts to Alter Time Through stime<span class="label label-default pull-right">rule</span></h4><p>Add the following line to <code>/etc/audit/audit.rules</code> for both
32-bit and 64-bit systems:
<pre># audit_time_rules
-a always,exit -F arch=b32 -S stime -k audit_time_rules</pre>
Since the 64-bit version of the "stime" system call is not defined in the audit
lookup table, the corresponding "-F arch=b64" form of this rule is not expected
to be defined on 64-bit systems (the aforementioned "-F arch=b32" stime rule
form itself is sufficient for both 32-bit and 64-bit systems). The -k option
allows for the specification of a key in string form that can be used for
better reporting capability through ausearch and aureport. Multiple system
calls can be defined on the same line to save space if desired, but is not
required. See an example of multiple combined syscalls:
<pre>-a always,exit -F arch=b64 -S adjtimex -S settimeofday -k audit_time_rules</pre>
</p><span class="label label-primary">Rationale:</span><p>Arbitrary changes to the system time can be used to obfuscate
nefarious activities in log files, as well as to confuse network services that
are highly dependent upon an accurate system time (such as sshd). All changes
to the system time should be audited.</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-3(10)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-1(b)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(a)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(d)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12(a)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IR-5</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-10.4.2.b</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">1487</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">169</a></p></div><span class="label label-success">Remediation script:</span><pre><code>
function fix_audit_syscall_rule {

# Load function arguments into local variables
local tool="$1"
local pattern="$2"
local group="$3"
local arch="$4"
local full_rule="$5"

# Check sanity of the input
if [ $# -ne "5" ]
then
        echo "Usage: fix_audit_syscall_rule 'tool' 'pattern' 'group' 'arch' 'full rule'"
        echo "Aborting."
        exit 1
fi

# Create a list of audit *.rules files that should be inspected for presence and correctness
# of a particular audit rule. The scheme is as follows:
# 
# -----------------------------------------------------------------------------------------
#  Tool used to load audit rules | Rule already defined  |  Audit rules file to inspect    |
# -----------------------------------------------------------------------------------------
#        auditctl                |     Doesn't matter    |  /etc/audit/audit.rules         |
# -----------------------------------------------------------------------------------------
#        augenrules              |          Yes          |  /etc/audit/rules.d/*.rules     |
#        augenrules              |          No           |  /etc/audit/rules.d/$key.rules  |
# -----------------------------------------------------------------------------------------
#
declare -a files_to_inspect

# First check sanity of the specified audit tool
if [ "$tool" != 'auditctl' ] &amp;&amp; [ "$tool" != 'augenrules' ]
then
        echo "Unknown audit rules loading tool: $1. Aborting."
        echo "Use either 'auditctl' or 'augenrules'!"
        exit 1
# If audit tool is 'auditctl', then add '/etc/audit/audit.rules'
# file to the list of files to be inspected
elif [ "$tool" == 'auditctl' ]
then
        files_to_inspect=("${files_to_inspect[@]}" '/etc/audit/audit.rules' )
# If audit tool is 'augenrules', then check if the audit rule is defined
# If rule is defined, add '/etc/audit/rules.d/*.rules' to the list for inspection
# If rule isn't defined yet, add '/etc/audit/rules.d/$key.rules' to the list for inspection
elif [ "$tool" == 'augenrules' ]
then
        # Extract audit $key from audit rule so we can use it later
        key=$(expr "$full_rule" : '.*-k[[:space:]]\([^[:space:]]\+\)')
        # Check if particular audit rule is already defined
        IFS=$'\n' matches=($(sed -s -n -e "/${pattern}/!d" -e "/${arch}/!d" -e "/${group}/!d;F" /etc/audit/rules.d/*.rules))
        # Reset IFS back to default
        unset $IFS
        for match in "${matches[@]}"
        do
                files_to_inspect=("${files_to_inspect[@]}" "${match}")
        done
        # Case when particular rule isn't defined in /etc/audit/rules.d/*.rules yet
        if [ ${#files_to_inspect[@]} -eq "0" ]
        then
                files_to_inspect="/etc/audit/rules.d/$key.rules"
                if [ ! -e "$files_to_inspect" ]
                then
                        touch "$files_to_inspect"
                        chmod 0640 "$files_to_inspect"
                fi
        fi
fi

#
# Indicator that we want to append $full_rule into $audit_file by default
local append_expected_rule=0

for audit_file in "${files_to_inspect[@]}"
do

        # Filter existing $audit_file rules' definitions to select those that:
        # * follow the rule pattern, and
        # * meet the hardware architecture requirement, and
        # * are current syscall group specific
        IFS=$'\n' existing_rules=($(sed -e "/${pattern}/!d" -e "/${arch}/!d" -e "/${group}/!d"  "$audit_file"))
        # Reset IFS back to default
        unset $IFS

        # Process rules found case-by-case
        for rule in "${existing_rules[@]}"
        do
                # Found rule is for same arch &amp; key, but differs (e.g. in count of -S arguments)
                if [ "${rule}" != "${full_rule}" ]
                then
                        # If so, isolate just '(-S \w)+' substring of that rule
                        rule_syscalls=$(echo $rule | grep -o -P '(-S \w+ )+')
                        # Check if list of '-S syscall' arguments of that rule is subset
                        # of '-S syscall' list of expected $full_rule
                        if grep -q -- "$rule_syscalls" &lt;&lt;&lt; "$full_rule"
                        then
                                # Rule is covered (i.e. the list of -S syscalls for this rule is
                                # subset of -S syscalls of $full_rule =&gt; existing rule can be deleted
                                # Thus delete the rule from audit.rules &amp; our array
                                sed -i -e "/$rule/d" "$audit_file"
                                existing_rules=("${existing_rules[@]//$rule/}")
                        else
                                # Rule isn't covered by $full_rule - it besides -S syscall arguments
                                # for this group contains also -S syscall arguments for other syscall
                                # group. Example: '-S lchown -S fchmod -S fchownat' =&gt; group='chown'
                                # since 'lchown' &amp; 'fchownat' share 'chown' substring
                                # Therefore:
                                # * 1) delete the original rule from audit.rules
                                # (original '-S lchown -S fchmod -S fchownat' rule would be deleted)
                                # * 2) delete the -S syscall arguments for this syscall group, but
                                # keep those not belonging to this syscall group
                                # (original '-S lchown -S fchmod -S fchownat' would become '-S fchmod'
                                # * 3) append the modified (filtered) rule again into audit.rules
                                # if the same rule not already present
                                #
                                # 1) Delete the original rule
                                sed -i -e "/$rule/d" "$audit_file"
                                # 2) Delete syscalls for this group, but keep those from other groups
                                # Convert current rule syscall's string into array splitting by '-S' delimiter
                                IFS=$'-S' read -a rule_syscalls_as_array &lt;&lt;&lt; "$rule_syscalls"
                                # Reset IFS back to default
                                unset $IFS
                                # Declare new empty string to hold '-S syscall' arguments from other groups
                                new_syscalls_for_rule=''
                                # Walk through existing '-S syscall' arguments
                                for syscall_arg in "${rule_syscalls_as_array[@]}"
                                do
                                        # Skip empty $syscall_arg values
                                        if [ "$syscall_arg" == '' ]
                                        then
                                                continue
                                        fi
                                        # If the '-S syscall' doesn't belong to current group add it to the new list
                                        # (together with adding '-S' delimiter back for each of such item found)
                                        if grep -q -v -- "$group" &lt;&lt;&lt; "$syscall_arg"
                                        then
                                                new_syscalls_for_rule="$new_syscalls_for_rule -S $syscall_arg"
                                        fi
                                done
                                # Replace original '-S syscall' list with the new one for this rule
                                updated_rule=${rule//$rule_syscalls/$new_syscalls_for_rule}
                                # Squeeze repeated whitespace characters in rule definition (if any) into one
                                updated_rule=$(echo "$updated_rule" | tr -s '[:space:]')
                                # 3) Append the modified / filtered rule again into audit.rules
                                #    (but only in case it's not present yet to prevent duplicate definitions)
                                if ! grep -q -- "$updated_rule" "$audit_file"
                                then
                                        echo "$updated_rule" &gt;&gt; "$audit_file"
                                fi
                        fi
                else
                        # $audit_file already contains the expected rule form for this
                        # architecture &amp; key =&gt; don't insert it second time
                        append_expected_rule=1
                fi
        done

        # We deleted all rules that were subset of the expected one for this arch &amp; key.
        # Also isolated rules containing system calls not from this system calls group.
        # Now append the expected rule if it's not present in $audit_file yet
        if [[ ${append_expected_rule} -eq "0" ]]
        then
                echo "$full_rule" &gt;&gt; "$audit_file"
        fi
done

}

function rhel6_perform_audit_adjtimex_settimeofday_stime_remediation {

# Perform the remediation for the 'adjtimex', 'settimeofday', and 'stime' audit
# system calls on Red Hat Enterprise Linux 6 OS
#
# Retrieve hardware architecture of the underlying system
[ $(getconf LONG_BIT) = "32" ] &amp;&amp; RULE_ARCHS=("b32") || RULE_ARCHS=("b32" "b64")

for ARCH in "${RULE_ARCHS[@]}"
do
        PATTERN="-a always,exit -F arch=${ARCH} -S .* -k *"
        # Create expected audit group and audit rule form for particular system call &amp; architecture
        if [ ${ARCH} = "b32" ]
        then
                # stime system call is known at 32-bit arch (see e.g "$ ausyscall i386 stime" 's output)
                # so append it to the list of time group system calls to be audited
                GROUP="\(adjtimex\|settimeofday\|stime\)"
                FULL_RULE="-a always,exit -F arch=${ARCH} -S adjtimex -S settimeofday -S stime -k audit_time_rules"
        elif [ ${ARCH} = "b64" ]
        then
                # stime system call isn't known at 64-bit arch (see "$ ausyscall x86_64 stime" 's output)
                # therefore don't add it to the list of time group system calls to be audited
                GROUP="\(adjtimex\|settimeofday\)"
                FULL_RULE="-a always,exit -F arch=${ARCH} -S adjtimex -S settimeofday -k audit_time_rules"
        fi
        # Perform the remediation itself
        fix_audit_syscall_rule "auditctl" "$PATTERN" "$GROUP" "$ARCH" "$FULL_RULE"
done

}

rhel6_perform_audit_adjtimex_settimeofday_stime_remediation
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_audit_rules_time_clock_settime" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_audit_rules_time_clock_settime" id="guide-tree-leaf-idm45561208744976" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.4.2.b"><td style="padding-left: 95px"><h4>Record Attempts to Alter Time Through clock_settime<span class="label label-default pull-right">rule</span></h4><p>On a 32-bit system, add the following to <code>/etc/audit/audit.rules</code>:
<pre># time-change
-a always,exit -F arch=b32 -S clock_settime -F a0=0x0 -F key=time-change</pre>
On a 64-bit system, add the following to <code>/etc/audit/audit.rules</code>:
<pre># time-change
-a always,exit -F arch=b64 -S clock_settime -F a0=0x0 -F key=time-change</pre>
The -k option allows for the specification of a key in string form that can 
be used for better reporting capability through ausearch and aureport.
Multiple system calls can be defined on the same line to save space if 
desired, but is not required. See an example of multiple combined syscalls:
<pre>-a always,exit -F arch=b64 -S adjtimex -S settimeofday -k audit_time_rules</pre>
</p><span class="label label-primary">Rationale:</span><p>Arbitrary changes to the system time can be used to obfuscate 
nefarious activities in log files, as well as to confuse network services that 
are highly dependent upon an accurate system time (such as sshd). All changes 
to the system time should be audited.</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-3(10)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-1(b)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(a)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(d)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12(a)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IR-5</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-10.4.2.b</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">1487</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">169</a></p></div><span class="label label-success">Remediation script:</span><pre><code>

# First perform the remediation of the syscall rule
# Retrieve hardware architecture of the underlying system
[ "$(getconf LONG_BIT)" = "32" ] &amp;&amp; RULE_ARCHS=("b32") || RULE_ARCHS=("b32" "b64")

for ARCH in "${RULE_ARCHS[@]}"
do
	PATTERN="-a always,exit -F arch=$ARCH -S clock_settime -F a0=.* \(-F key=\|-k \).*"
	GROUP="clock_settime"
	FULL_RULE="-a always,exit -F arch=$ARCH -S clock_settime -F a0=0x0 -k time-change"

function fix_audit_syscall_rule {

# Load function arguments into local variables
local tool="$1"
local pattern="$2"
local group="$3"
local arch="$4"
local full_rule="$5"

# Check sanity of the input
if [ $# -ne "5" ]
then
        echo "Usage: fix_audit_syscall_rule 'tool' 'pattern' 'group' 'arch' 'full rule'"
        echo "Aborting."
        exit 1
fi

# Create a list of audit *.rules files that should be inspected for presence and correctness
# of a particular audit rule. The scheme is as follows:
#
# -----------------------------------------------------------------------------------------
#  Tool used to load audit rules | Rule already defined  |  Audit rules file to inspect    |
# -----------------------------------------------------------------------------------------
#        auditctl                |     Doesn't matter    |  /etc/audit/audit.rules         |
# -----------------------------------------------------------------------------------------
#        augenrules              |          Yes          |  /etc/audit/rules.d/*.rules     |
#        augenrules              |          No           |  /etc/audit/rules.d/$key.rules  |
# -----------------------------------------------------------------------------------------
#
declare -a files_to_inspect

# First check sanity of the specified audit tool
if [ "$tool" != 'auditctl' ] &amp;&amp; [ "$tool" != 'augenrules' ]
then
        echo "Unknown audit rules loading tool: $1. Aborting."
        echo "Use either 'auditctl' or 'augenrules'!"
        exit 1
# If audit tool is 'auditctl', then add '/etc/audit/audit.rules'
# file to the list of files to be inspected
elif [ "$tool" == 'auditctl' ]
then
        files_to_inspect=("${files_to_inspect[@]}" '/etc/audit/audit.rules' )
# If audit tool is 'augenrules', then check if the audit rule is defined
# If rule is defined, add '/etc/audit/rules.d/*.rules' to the list for inspection
# If rule isn't defined yet, add '/etc/audit/rules.d/$key.rules' to the list for inspection
elif [ "$tool" == 'augenrules' ]
then
        # Extract audit $key from audit rule so we can use it later
        key=$(expr "$full_rule" : '.*-k[[:space:]]\([^[:space:]]\+\)')
        # Check if particular audit rule is already defined
        IFS=$'\n' matches=($(sed -s -n -e "/${pattern}/!d" -e "/${arch}/!d" -e "/${group}/!d;F" /etc/audit/rules.d/*.rules))
        # Reset IFS back to default
        unset $IFS
        for match in "${matches[@]}"
        do
                files_to_inspect=("${files_to_inspect[@]}" "${match}")
        done
        # Case when particular rule isn't defined in /etc/audit/rules.d/*.rules yet
        if [ ${#files_to_inspect[@]} -eq "0" ]
        then
                files_to_inspect="/etc/audit/rules.d/$key.rules"
                if [ ! -e "$files_to_inspect" ]
                then
                        touch "$files_to_inspect"
                        chmod 0640 "$files_to_inspect"
                fi
        fi
fi

#
# Indicator that we want to append $full_rule into $audit_file by default
local append_expected_rule=0

for audit_file in "${files_to_inspect[@]}"
do

        # Filter existing $audit_file rules' definitions to select those that:
        # * follow the rule pattern, and
        # * meet the hardware architecture requirement, and
        # * are current syscall group specific
        IFS=$'\n' existing_rules=($(sed -e "/${pattern}/!d" -e "/${arch}/!d" -e "/${group}/!d"  "$audit_file"))
        # Reset IFS back to default
        unset $IFS

        # Process rules found case-by-case
        for rule in "${existing_rules[@]}"
        do
                # Found rule is for same arch &amp; key, but differs (e.g. in count of -S arguments)
                if [ "${rule}" != "${full_rule}" ]
                then
                        # If so, isolate just '(-S \w)+' substring of that rule
                        rule_syscalls=$(echo $rule | grep -o -P '(-S \w+ )+')
                        # Check if list of '-S syscall' arguments of that rule is subset
                        # of '-S syscall' list of expected $full_rule
                        if grep -q -- "$rule_syscalls" &lt;&lt;&lt; "$full_rule"
                        then
                                # Rule is covered (i.e. the list of -S syscalls for this rule is
                                # subset of -S syscalls of $full_rule =&gt; existing rule can be deleted
                                # Thus delete the rule from audit.rules &amp; our array
                                sed -i -e "/$rule/d" "$audit_file"
                                existing_rules=("${existing_rules[@]//$rule/}")
                        else
                                # Rule isn't covered by $full_rule - it besides -S syscall arguments
                                # for this group contains also -S syscall arguments for other syscall
                                # group. Example: '-S lchown -S fchmod -S fchownat' =&gt; group='chown'
                                # since 'lchown' &amp; 'fchownat' share 'chown' substring
                                # Therefore:
                                # * 1) delete the original rule from audit.rules
                                # (original '-S lchown -S fchmod -S fchownat' rule would be deleted)
                                # * 2) delete the -S syscall arguments for this syscall group, but
                                # keep those not belonging to this syscall group
                                # (original '-S lchown -S fchmod -S fchownat' would become '-S fchmod'
                                # * 3) append the modified (filtered) rule again into audit.rules
                                # if the same rule not already present
                                #
                                # 1) Delete the original rule
                                sed -i -e "/$rule/d" "$audit_file"
                                # 2) Delete syscalls for this group, but keep those from other groups
                                # Convert current rule syscall's string into array splitting by '-S' delimiter
                                IFS=$'-S' read -a rule_syscalls_as_array &lt;&lt;&lt; "$rule_syscalls"
                                # Reset IFS back to default
                                unset $IFS
                                # Declare new empty string to hold '-S syscall' arguments from other groups
                                new_syscalls_for_rule=''
                                # Walk through existing '-S syscall' arguments
                                for syscall_arg in "${rule_syscalls_as_array[@]}"
                                do
                                        # Skip empty $syscall_arg values
                                        if [ "$syscall_arg" == '' ]
                                        then
                                                continue
                                        fi
                                        # If the '-S syscall' doesn't belong to current group add it to the new list
                                        # (together with adding '-S' delimiter back for each of such item found)
                                        if grep -q -v -- "$group" &lt;&lt;&lt; "$syscall_arg"
                                        then
                                                new_syscalls_for_rule="$new_syscalls_for_rule -S $syscall_arg"
                                        fi
                                done
                                # Replace original '-S syscall' list with the new one for this rule
                                updated_rule=${rule//$rule_syscalls/$new_syscalls_for_rule}
                                # Squeeze repeated whitespace characters in rule definition (if any) into one
                                updated_rule=$(echo "$updated_rule" | tr -s '[:space:]')
                                # 3) Append the modified / filtered rule again into audit.rules
                                #    (but only in case it's not present yet to prevent duplicate definitions)
                                if ! grep -q -- "$updated_rule" "$audit_file"
                                then
                                        echo "$updated_rule" &gt;&gt; "$audit_file"
                                fi
                        fi
                else
                        # $audit_file already contains the expected rule form for this
                        # architecture &amp; key =&gt; don't insert it second time
                        append_expected_rule=1
                fi
        done

        # We deleted all rules that were subset of the expected one for this arch &amp; key.
        # Also isolated rules containing system calls not from this system calls group.
        # Now append the expected rule if it's not present in $audit_file yet
        if [[ ${append_expected_rule} -eq "0" ]]
        then
                echo "$full_rule" &gt;&gt; "$audit_file"
        fi
done

}

	fix_audit_syscall_rule "auditctl" "$PATTERN" "$GROUP" "$ARCH" "$FULL_RULE"
done
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_audit_rules_time_watch_localtime" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_audit_rules_time_watch_localtime" id="guide-tree-leaf-idm45561208723216" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.4.2.b"><td style="padding-left: 95px"><h4>Record Attempts to Alter the localtime File<span class="label label-default pull-right">rule</span></h4><p>Add the following to <code>/etc/audit/audit.rules</code>:
<pre>-w /etc/localtime -p wa -k audit_time_rules</pre>
The -k option allows for the specification of a key in string form that can 
be used for better reporting capability through ausearch and aureport and
should always be used.
</p><span class="label label-primary">Rationale:</span><p>Arbitrary changes to the system time can be used to obfuscate 
nefarious activities in log files, as well as to confuse network services that 
are highly dependent upon an accurate system time (such as sshd). All changes 
to the system time should be audited.</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-3(10)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-1(b)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(a)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(d)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12(a)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IR-5</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-10.4.2.b</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">1487</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">169</a></p></div><span class="label label-success">Remediation script:</span><pre><code>

# Perform the remediation

function fix_audit_watch_rule {

# Load function arguments into local variables
local tool="$1"
local path="$2"
local required_access_bits="$3"
local key="$4"

# Check sanity of the input
if [ $# -ne "4" ]
then
        echo "Usage: fix_audit_watch_rule 'tool' 'path' 'bits' 'key'"
        echo "Aborting."
        exit 1
fi

# Create a list of audit *.rules files that should be inspected for presence and correctness
# of a particular audit rule. The scheme is as follows:
#
# -----------------------------------------------------------------------------------------
# Tool used to load audit rules | Rule already defined  |  Audit rules file to inspect    |
# -----------------------------------------------------------------------------------------
#       auditctl                |     Doesn't matter    |  /etc/audit/audit.rules         |
# -----------------------------------------------------------------------------------------
#       augenrules              |          Yes          |  /etc/audit/rules.d/*.rules     |
#       augenrules              |          No           |  /etc/audit/rules.d/$key.rules  |
# -----------------------------------------------------------------------------------------
declare -a files_to_inspect

# Check sanity of the specified audit tool
if [ "$tool" != 'auditctl' ] &amp;&amp; [ "$tool" != 'augenrules' ]
then
        echo "Unknown audit rules loading tool: $1. Aborting."
        echo "Use either 'auditctl' or 'augenrules'!"
        exit 1
# If the audit tool is 'auditctl', then add '/etc/audit/audit.rules'
# into the list of files to be inspected
elif [ "$tool" == 'auditctl' ]
then
        files_to_inspect=("${files_to_inspect[@]}" '/etc/audit/audit.rules')
# If the audit is 'augenrules', then check if rule is already defined
# If rule is defined, add '/etc/audit/rules.d/*.rules' to list of files for inspection.
# If rule isn't defined, add '/etc/audit/rules.d/$key.rules' to list of files for inspection.
elif [ "$tool" == 'augenrules' ]
then
        # Case when particular audit rule is already defined in some of /etc/audit/rules.d/*.rules file
        # Get pair -- filepath : matching_row into @matches array
        IFS=$'\n' matches=($(grep -P "[\s]*-w[\s]+$path" /etc/audit/rules.d/*.rules))
        # Reset IFS back to default
        unset $IFS
        # For each of the matched entries
        for match in "${matches[@]}"
        do
                # Extract filepath from the match
                rulesd_audit_file=$(echo $match | cut -f1 -d ':')
                # Append that path into list of files for inspection
                files_to_inspect=("${files_to_inspect[@]}" "$rulesd_audit_file")
        done
        # Case when particular audit rule isn't defined yet
        if [ ${#files_to_inspect[@]} -eq "0" ]
        then
                # Append '/etc/audit/rules.d/$key.rules' into list of files for inspection
                files_to_inspect="/etc/audit/rules.d/$key.rules"
                # If the $key.rules file doesn't exist yet, create it with correct permissions
                if [ ! -e "$files_to_inspect" ]
                then
                        touch "$files_to_inspect"
                        chmod 0640 "$files_to_inspect"
                fi
        fi
fi

# Finally perform the inspection and possible subsequent audit rule
# correction for each of the files previously identified for inspection
for audit_rules_file in "${files_to_inspect[@]}"
do

        # Check if audit watch file system object rule for given path already present
        if grep -q -P -- "[\s]*-w[\s]+$path" "$audit_rules_file"
        then
                # Rule is found =&gt; verify yet if existing rule definition contains
                # all of the required access type bits

                # Escape slashes in path for use in sed pattern below
                local esc_path=${path//$'/'/$'\/'}
                # Define BRE whitespace class shortcut
                local sp="[[:space:]]"
                # Extract current permission access types (e.g. -p [r|w|x|a] values) from audit rule
                current_access_bits=$(sed -ne "s/$sp*-w$sp\+$esc_path$sp\+-p$sp\+\([rxwa]\{1,4\}\).*/\1/p" "$audit_rules_file")
                # Split required access bits string into characters array
                # (to check bit's presence for one bit at a time)
                for access_bit in $(echo "$required_access_bits" | grep -o .)
                do
                        # For each from the required access bits (e.g. 'w', 'a') check
                        # if they are already present in current access bits for rule.
                        # If not, append that bit at the end
                        if ! grep -q "$access_bit" &lt;&lt;&lt; "$current_access_bits"
                        then
                                # Concatenate the existing mask with the missing bit
                                current_access_bits="$current_access_bits$access_bit"
                        fi
                done
                # Propagate the updated rule's access bits (original + the required
                # ones) back into the /etc/audit/audit.rules file for that rule
                sed -i "s/\($sp*-w$sp\+$esc_path$sp\+-p$sp\+\)\([rxwa]\{1,4\}\)\(.*\)/\1$current_access_bits\3/" "$audit_rules_file"
        else
                # Rule isn't present yet. Append it at the end of $audit_rules_file file
                # with proper key

                echo "-w $path -p $required_access_bits -k $key" &gt;&gt; "$audit_rules_file"
        fi
done
}

fix_audit_watch_rule "auditctl" "/etc/localtime" "wa" "audit_time_rules"
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-10.4.3" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-10.4.3" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.4"><td style="padding-left: 57px"><h3>10.4.3<span class="label label-default pull-right">group</span></h3><p>Time settings are received from</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.4.3" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.4"><td style="padding-left: 57px"><small>contains 1 rule</small></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_ntpd_specify_multiple_servers" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_ntpd_specify_multiple_servers" id="guide-tree-leaf-idm45561208691056" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.4.3"><td style="padding-left: 76px"><h4>Specify Additional Remote NTP Servers<span class="label label-default pull-right">rule</span></h4><p>Additional NTP servers can be specified for time synchronization
in the file <code>/etc/ntp.conf</code>.  To do so, add additional lines of the
following form, substituting the IP address or hostname of a remote NTP server for
<em>ntpserver</em>:
<pre>server <i>ntpserver</i></pre>
</p><span class="label label-primary">Rationale:</span><p>Specifying additional NTP servers increases the availability of
accurate time data, in the event that one of the specified servers becomes
unavailable. This is typical for a system acting as an NTP server for
other systems.
</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-8(1)</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-10.4.3</a></p></div></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_service_ntpd_enabled" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_service_ntpd_enabled" id="guide-tree-leaf-idm45561208844208" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.4"><td style="padding-left: 57px"><h4>Enable the NTP Daemon<span class="label label-default pull-right">rule</span></h4><p>
          
        The <code>ntpd</code> service can be enabled with the following command:
        <pre>$ sudo chkconfig --level 2345 ntpd on</pre>
        </p><span class="label label-primary">Rationale:</span><p>Enabling the <code>ntpd</code> service ensures that the <code>ntpd</code>
service will be running and that the system will synchronize its time to
any servers specified. This is important whether the system is configured to be
a client (and synchronize only its own clock) or it is also acting as an NTP
server to other systems.  Synchronizing time is essential for authentication
services such as Kerberos, but it is also important for maintaining accurate
logs and auditing possible security breaches.  
<br><br>
The NTP daemon offers all of the functionality of <code>ntpdate</code>, which is now 
deprecated.  Additional information on this is available at 
<a href="http://support.ntp.org/bin/view/Dev/DeprecatingNtpdate">http://support.ntp.org/bin/view/Dev/DeprecatingNtpdate</a></p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-8(1)</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-10.4</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">160</a></p></div><span class="label label-success">Remediation script:</span><pre><code>
function service_command {

# Load function arguments into local variables
local service_state=$1
local service=$2
local xinetd=$(echo $3 | cut -d'=' -f2)

# Check sanity of the input
if [ $# -lt "2" ]
then
  echo "Usage: service_command 'enable/disable' 'service_name.service'"
  echo
  echo "To enable or disable xinetd services add \'xinetd=service_name\'"
  echo "as the last argument"
  echo "Aborting."
  exit 1
fi

# If systemctl is installed, use systemctl command; otherwise, use the service/chkconfig commands
if [ -f "/usr/bin/systemctl" ] ; then
  service_util="/usr/bin/systemctl"
else
  service_util="/sbin/service"
  chkconfig_util="/sbin/chkconfig"
fi

# If disable is not specified in arg1, set variables to enable services.
# Otherwise, variables are to be set to disable services.
if [ "$service_state" != 'disable' ] ; then
  service_state="enable"
  service_operation="start"
  chkconfig_state="on"
else
  service_state="disable"
  service_operation="stop"
  chkconfig_state="off"
fi

# If chkconfig_util is not empty, use chkconfig/service commands.
if ! [ "x$chkconfig_util" = x ] ; then
  $service_util $service $service_operation
  $chkconfig_util --level 0123456 $service $chkconfig_state
else
  $service_util $service_operation $service
  $service_util $service_state $service
fi

# Test if local variable xinetd is empty using non-bashism.
# If empty, then xinetd is not being used.
if ! [ "x$xinetd" = x ] ; then
  grep -qi disable /etc/xinetd.d/$xinetd &amp;&amp; \

  if ! [ "$service_operation" != 'disable' ] ; then
    sed -i "s/disable.*/disable         = no/gI" /etc/xinetd.d/$xinetd
  else
    sed -i "s/disable.*/disable         = yes/gI" /etc/xinetd.d/$xinetd
  fi
fi

}

service_command enable ntpd
</code></pre><span class="label label-success">Remediation script:</span><pre><code>- name: Enable service ntpd
  service:
    name="{{item}}"
    enabled="yes"
    state="started"
  with_items:
    - ntpd

</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-10.5" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-10.5" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10."><td style="padding-left: 38px"><h3 id="xccdf_org.ssgproject.content_group_pcidss-req-10.5">10.5<span class="label label-default pull-right">group</span></h3><p>Secure audit trails so they cannot</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.5" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10."><td style="padding-left: 38px"><small>contains 22 rules</small></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-10.5.1" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-10.5.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.5"><td style="padding-left: 57px"><h3>10.5.1<span class="label label-default pull-right">group</span></h3><p>Limit viewing of audit trails to</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.5.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.5"><td style="padding-left: 57px"><small>contains 4 rules</small></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_rsyslog_files_ownership" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_rsyslog_files_ownership" id="guide-tree-leaf-idm45561208662256" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.5.1"><td style="padding-left: 76px"><h4>Ensure Log Files Are Owned By Appropriate User<span class="label label-default pull-right">rule</span></h4><p>The owner of all log files written by
<code>rsyslog</code> should be root.
These log files are determined by the second part of each Rule line in
<code>/etc/rsyslog.conf</code> and typically all appear in <code>/var/log</code>.
For each log file <i>LOGFILE</i> referenced in <code>/etc/rsyslog.conf</code>,
run the following command to inspect the file's owner:
<pre>$ ls -l <i>LOGFILE</i></pre>
If the owner is not <code>root</code>, run the following command to
correct this:
<pre>$ sudo chown root <i>LOGFILE</i></pre>
</p><span class="label label-primary">Rationale:</span><p>The log files generated by rsyslog contain valuable information regarding system
configuration, user authentication, and other such information. Log files should be
protected from unauthorized access.</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-6</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">SI-11</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">1314</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-10.5.1</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-10.5.2</a></p></div></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_rsyslog_files_groupownership" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_rsyslog_files_groupownership" id="guide-tree-leaf-idm45561208647696" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.5.1"><td style="padding-left: 76px"><h4>Ensure Log Files Are Owned By Appropriate Group<span class="label label-default pull-right">rule</span></h4><p>The group-owner of all log files written by
<code>rsyslog</code> should be root.
These log files are determined by the second part of each Rule line in
<code>/etc/rsyslog.conf</code> and typically all appear in <code>/var/log</code>.
For each log file <i>LOGFILE</i> referenced in <code>/etc/rsyslog.conf</code>,
run the following command to inspect the file's group owner:
<pre>$ ls -l <i>LOGFILE</i></pre>
If the owner is not <code>root</code>, run the following command to
correct this:
<pre>$ sudo chgrp root <i>LOGFILE</i></pre>
</p><span class="label label-primary">Rationale:</span><p>The log files generated by rsyslog contain valuable information regarding system
configuration, user authentication, and other such information. Log files should be
protected from unauthorized access.</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-6</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">SI-11</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">1314</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-10.5.1</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-10.5.2</a></p></div></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_rsyslog_files_permissions" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_rsyslog_files_permissions" id="guide-tree-leaf-idm45561208633088" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.5.1"><td style="padding-left: 76px"><h4>Ensure System Log Files Have Correct Permissions<span class="label label-default pull-right">rule</span></h4><p>The file permissions for all log files written by
<code>rsyslog</code> should be set to 600, or more restrictive.
These log files are determined by the second part of each Rule line in
<code>/etc/rsyslog.conf</code> and typically all appear in <code>/var/log</code>. 
For each log file <i>LOGFILE</i> referenced in <code>/etc/rsyslog.conf</code>,
run the following command to inspect the file's permissions:
<pre>$ ls -l <i>LOGFILE</i></pre>
If the permissions are not 600 or more restrictive,
run the following command to correct this:
<pre>$ sudo chmod 0600 <i>LOGFILE</i></pre>
</p><span class="label label-primary">Rationale:</span><p>Log files can contain valuable information regarding system
configuration. If the system log files are not protected unauthorized
users could change the logged data, eliminating their forensic value.
</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">SI-11</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">1314</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-10.5.1</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-10.5.2</a></p></div><span class="label label-success">Remediation script:</span><pre><code>
# List of log file paths to be inspected for correct permissions
# * Primarily inspect log file paths listed in /etc/rsyslog.conf
RSYSLOG_ETC_CONFIG="/etc/rsyslog.conf"
# * And also the log file paths listed after rsyslog's $IncludeConfig directive
#   (store the result into array for the case there's shell glob used as value of IncludeConfig)
RSYSLOG_INCLUDE_CONFIG=($(grep -e "\$IncludeConfig[[:space:]]\+[^[:space:];]\+" /etc/rsyslog.conf | cut -d ' ' -f 2))
# Declare an array to hold the final list of different log file paths
declare -a LOG_FILE_PATHS

# Browse each file selected above as containing paths of log files
# ('/etc/rsyslog.conf' and '/etc/rsyslog.d/*.conf' in the default configuration)
for LOG_FILE in "${RSYSLOG_ETC_CONFIG}" "${RSYSLOG_INCLUDE_CONFIG[@]}"
do
	# From each of these files extract just particular log file path(s), thus:
	# * Ignore lines starting with space (' '), comment ('#"), or variable syntax ('$') characters,
	# * Ignore empty lines,
	# * From the remaining valid rows select only fields constituting a log file path
	# Text file column is understood to represent a log file path if and only if all of the following are met:
	# * it contains at least one slash '/' character,
	# * it doesn't contain space (' '), colon (':'), and semicolon (';') characters
	# Search log file for path(s) only in case it exists!
	if [[ -f "${LOG_FILE}" ]]
	then
		MATCHED_ITEMS=$(sed -e "/^[[:space:]|#|$]/d ; s/[^\/]*[[:space:]]*\([^:;[:space:]]*\)/\1/g ; /^$/d" "${LOG_FILE}")
		# Since above sed command might return more than one item (delimited by newline), split the particular
		# matches entries into new array specific for this log file
		readarray -t ARRAY_FOR_LOG_FILE &lt;&lt;&lt; "$MATCHED_ITEMS"
		# Concatenate the two arrays - previous content of $LOG_FILE_PATHS array with
		# items from newly created array for this log file
		LOG_FILE_PATHS=("${LOG_FILE_PATHS[@]}" "${ARRAY_FOR_LOG_FILE[@]}")
		# Delete the temporary array
		unset ARRAY_FOR_LOG_FILE
	fi
done

for PATH in "${LOG_FILE_PATHS[@]}"
do
	# Sanity check - if particular $PATH is empty string, skip it from further processing
	if [ -z "$PATH" ]
	then
		continue
	fi
	# Per https://access.redhat.com/solutions/66805 '/var/log/boot.log' log file needs special care =&gt; perform it
	if [ "$PATH" == "/var/log/boot.log" ]
	then
		# Ensure permissions of /var/log/boot.log are configured to be updated in /etc/rc.local
		if ! /bin/grep -q "boot.log" "/etc/rc.local"
		then
			echo "/bin/chmod 600 /var/log/boot.log" &gt;&gt; /etc/rc.local
		fi
		# Ensure /etc/rc.d/rc.local has user-executable permission
		# (in order to be actually executed during boot)
		if [ "$(/usr/bin/stat -c %a /etc/rc.d/rc.local)" -ne 744 ]
		then
			/bin/chmod u+x /etc/rc.d/rc.local
		fi
	fi
	# Also for each log file check if its permissions differ from 600. If so, correct them
	if [ "$(/usr/bin/stat -c %a "$PATH")" -ne 600 ]
	then
		/bin/chmod 600 "$PATH"
	fi
done
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_file_ownership_var_log_audit" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_file_ownership_var_log_audit" id="guide-tree-leaf-idm45561208614432" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.5.1"><td style="padding-left: 76px"><h4>System Audit Logs Must Be Owned By Root<span class="label label-default pull-right">rule</span></h4><p>
            
    To properly set the owner of <code>/var/log</code>, run the command:
    <pre xml:space="preserve">$ sudo chown root /var/log</pre>
          </p><span class="label label-primary">Rationale:</span><p>Failure to give ownership of the audit log files to root allows the designated 
owner, and unauthorized users, potential access to sensitive information.</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-6</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-1(b)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-9</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IR-5</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">166</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-10.5.1</a></p></div><span class="label label-success">Remediation script:</span><pre><code>
if `grep -q ^log_group /etc/audit/auditd.conf` ; then
  GROUP=$(awk -F "=" '/log_group/ {print $2}' /etc/audit/auditd.conf | tr -d ' ')
  if ! [ "${GROUP}" == 'root' ] ; then
    chown root.${GROUP} /var/log/audit
    chown root.${GROUP} /var/log/audit/audit.log*
  else
    chown root.root /var/log/audit
    chown root.root /var/log/audit/audit.log*
  fi
else
  chown root.root /var/log/audit
  chown root.root /var/log/audit/audit.log*
fi
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-10.5.2" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-10.5.2" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.5"><td style="padding-left: 57px"><h3>10.5.2<span class="label label-default pull-right">group</span></h3><p>Protect audit trail files from</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.5.2" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.5"><td style="padding-left: 57px"><small>contains 1 rule</small></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_audit_rules_immutable" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_audit_rules_immutable" id="guide-tree-leaf-idm45561208549952" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.5.2"><td style="padding-left: 76px"><h4>Make the auditd Configuration Immutable<span class="label label-default pull-right">rule</span></h4><p>Add the following to <code>/etc/audit/audit.rules</code> in order
to make the configuration immutable:
<pre>-e 2</pre>
With this setting, a reboot will be required to change any
audit rules.</p><span class="label label-primary">Rationale:</span><p>Making the audit configuration immutable prevents accidental as
well as malicious modification of the audit rules, although it may be
problematic if legitimate changes are needed during system
operation</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-6</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-1(b)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(a)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(d)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IR-5</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-10.5.2</a></p></div><span class="label label-success">Remediation script:</span><pre><code>
readonly AUDIT_RULES='/etc/audit/audit.rules'

# If '-e .*' setting present in audit.rules already, delete it since the
# auditctl(8) manual page instructs it should be the last rule in configuration
sed -i '/-e[[:space:]]\+.*/d' $AUDIT_RULES

# Append '-e 2' requirement at the end of audit.rules
echo '' &gt;&gt; $AUDIT_RULES
echo '# Set the audit.rules configuration immutable per security requirements' &gt;&gt; $AUDIT_RULES
echo '# Reboot is required to change audit rules once this setting is applied' &gt;&gt; $AUDIT_RULES
echo '-e 2' &gt;&gt; $AUDIT_RULES
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-10.5.3" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-10.5.3" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.5"><td style="padding-left: 57px"><h3>10.5.3<span class="label label-default pull-right">group</span></h3><p>Promptly back up audit trail files</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.5.3" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.5"><td style="padding-left: 57px"><small>contains 1 rule</small></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_auditd_audispd_syslog_plugin_activated" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_auditd_audispd_syslog_plugin_activated" id="guide-tree-leaf-idm45561208534080" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.5.3"><td style="padding-left: 76px"><h4>Configure auditd to use audispd's syslog plugin<span class="label label-default pull-right">rule</span></h4><p>To configure the <code>auditd</code> service to use the
<code>syslog</code> plug-in of the <code>audispd</code> audit event multiplexor, set
the <code>active</code> line in <code>/etc/audisp/plugins.d/syslog.conf</code> to
<code>yes</code>. Restart the <code>auditd</code> service:
<pre>$ sudo service auditd restart</pre>
</p><span class="label label-primary">Rationale:</span><p>The auditd service does not include the ability to send audit
records to a centralized server for management directly. It does, however,
include a plug-in for audit event multiplexor (audispd) to pass audit records
to the local syslog server</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-1(b)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-3(2)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IR-5</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">136</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-10.5.3</a></p></div><span class="label label-success">Remediation script:</span><pre><code>
grep -q ^active /etc/audisp/plugins.d/syslog.conf &amp;&amp; \
  sed -i "s/active.*/active = yes/g" /etc/audisp/plugins.d/syslog.conf
if ! [ $? -eq 0 ]; then
    echo "active = yes" &gt;&gt; /etc/audisp/plugins.d/syslog.conf
fi
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-10.5.4" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-10.5.4" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.5"><td style="padding-left: 57px"><h3>10.5.4<span class="label label-default pull-right">group</span></h3><p>Write logs for external-facing</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.5.4" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.5"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-10.5.5" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-10.5.5" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.5"><td style="padding-left: 57px"><h3>10.5.5<span class="label label-default pull-right">group</span></h3><p>Use file-integrity monitoring or</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.5.5" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.5"><td style="padding-left: 57px"><small>contains 15 rules</small></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_audit_rules_networkconfig_modification" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_audit_rules_networkconfig_modification" id="guide-tree-leaf-idm45561208513872" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.5.5"><td style="padding-left: 76px"><h4>Record Events that Modify the System's Network Environment<span class="label label-default pull-right">rule</span></h4><p>Add the following to <code>/etc/audit/audit.rules</code>, setting
ARCH to either b32 or b64 as appropriate for your system:
<pre># audit_rules_networkconfig_modification
-a always,exit -F arch=ARCH -S sethostname -S setdomainname -k audit_rules_networkconfig_modification
-w /etc/issue -p wa -k audit_rules_networkconfig_modification
-w /etc/issue.net -p wa -k audit_rules_networkconfig_modification
-w /etc/hosts -p wa -k audit_rules_networkconfig_modification
-w /etc/sysconfig/network -p wa -k audit_rules_networkconfig_modification</pre>
</p><span class="label label-primary">Rationale:</span><p>The network environment should not be modified by anything other
than administrator action. Any change to network parameters should be
audited.</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-3(10)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-1(b)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(a)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(d)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12(a)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IR-5</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-10.5.5</a></p></div><span class="label label-success">Remediation script:</span><pre><code>

# First perform the remediation of the syscall rule
# Retrieve hardware architecture of the underlying system
[ $(getconf LONG_BIT) = "32" ] &amp;&amp; RULE_ARCHS=("b32") || RULE_ARCHS=("b32" "b64")

for ARCH in "${RULE_ARCHS[@]}"
do
	PATTERN="-a always,exit -F arch=$ARCH -S .* -k *"
	# Use escaped BRE regex to specify rule group
	GROUP="set\(host\|domain\)name"
	FULL_RULE="-a always,exit -F arch=$ARCH -S sethostname -S setdomainname -k audit_rules_networkconfig_modification"

function fix_audit_syscall_rule {

# Load function arguments into local variables
local tool="$1"
local pattern="$2"
local group="$3"
local arch="$4"
local full_rule="$5"

# Check sanity of the input
if [ $# -ne "5" ]
then
        echo "Usage: fix_audit_syscall_rule 'tool' 'pattern' 'group' 'arch' 'full rule'"
        echo "Aborting."
        exit 1
fi

# Create a list of audit *.rules files that should be inspected for presence and correctness
# of a particular audit rule. The scheme is as follows:
#
# -----------------------------------------------------------------------------------------
#  Tool used to load audit rules | Rule already defined  |  Audit rules file to inspect    |
# -----------------------------------------------------------------------------------------
#        auditctl                |     Doesn't matter    |  /etc/audit/audit.rules         |
# -----------------------------------------------------------------------------------------
#        augenrules              |          Yes          |  /etc/audit/rules.d/*.rules     |
#        augenrules              |          No           |  /etc/audit/rules.d/$key.rules  |
# -----------------------------------------------------------------------------------------
#
declare -a files_to_inspect

# First check sanity of the specified audit tool
if [ "$tool" != 'auditctl' ] &amp;&amp; [ "$tool" != 'augenrules' ]
then
        echo "Unknown audit rules loading tool: $1. Aborting."
        echo "Use either 'auditctl' or 'augenrules'!"
        exit 1
# If audit tool is 'auditctl', then add '/etc/audit/audit.rules'
# file to the list of files to be inspected
elif [ "$tool" == 'auditctl' ]
then
        files_to_inspect=("${files_to_inspect[@]}" '/etc/audit/audit.rules' )
# If audit tool is 'augenrules', then check if the audit rule is defined
# If rule is defined, add '/etc/audit/rules.d/*.rules' to the list for inspection
# If rule isn't defined yet, add '/etc/audit/rules.d/$key.rules' to the list for inspection
elif [ "$tool" == 'augenrules' ]
then
        # Extract audit $key from audit rule so we can use it later
        key=$(expr "$full_rule" : '.*-k[[:space:]]\([^[:space:]]\+\)')
        # Check if particular audit rule is already defined
        IFS=$'\n' matches=($(sed -s -n -e "/${pattern}/!d" -e "/${arch}/!d" -e "/${group}/!d;F" /etc/audit/rules.d/*.rules))
        # Reset IFS back to default
        unset $IFS
        for match in "${matches[@]}"
        do
                files_to_inspect=("${files_to_inspect[@]}" "${match}")
        done
        # Case when particular rule isn't defined in /etc/audit/rules.d/*.rules yet
        if [ ${#files_to_inspect[@]} -eq "0" ]
        then
                files_to_inspect="/etc/audit/rules.d/$key.rules"
                if [ ! -e "$files_to_inspect" ]
                then
                        touch "$files_to_inspect"
                        chmod 0640 "$files_to_inspect"
                fi
        fi
fi

#
# Indicator that we want to append $full_rule into $audit_file by default
local append_expected_rule=0

for audit_file in "${files_to_inspect[@]}"
do

        # Filter existing $audit_file rules' definitions to select those that:
        # * follow the rule pattern, and
        # * meet the hardware architecture requirement, and
        # * are current syscall group specific
        IFS=$'\n' existing_rules=($(sed -e "/${pattern}/!d" -e "/${arch}/!d" -e "/${group}/!d"  "$audit_file"))
        # Reset IFS back to default
        unset $IFS

        # Process rules found case-by-case
        for rule in "${existing_rules[@]}"
        do
                # Found rule is for same arch &amp; key, but differs (e.g. in count of -S arguments)
                if [ "${rule}" != "${full_rule}" ]
                then
                        # If so, isolate just '(-S \w)+' substring of that rule
                        rule_syscalls=$(echo $rule | grep -o -P '(-S \w+ )+')
                        # Check if list of '-S syscall' arguments of that rule is subset
                        # of '-S syscall' list of expected $full_rule
                        if grep -q -- "$rule_syscalls" &lt;&lt;&lt; "$full_rule"
                        then
                                # Rule is covered (i.e. the list of -S syscalls for this rule is
                                # subset of -S syscalls of $full_rule =&gt; existing rule can be deleted
                                # Thus delete the rule from audit.rules &amp; our array
                                sed -i -e "/$rule/d" "$audit_file"
                                existing_rules=("${existing_rules[@]//$rule/}")
                        else
                                # Rule isn't covered by $full_rule - it besides -S syscall arguments
                                # for this group contains also -S syscall arguments for other syscall
                                # group. Example: '-S lchown -S fchmod -S fchownat' =&gt; group='chown'
                                # since 'lchown' &amp; 'fchownat' share 'chown' substring
                                # Therefore:
                                # * 1) delete the original rule from audit.rules
                                # (original '-S lchown -S fchmod -S fchownat' rule would be deleted)
                                # * 2) delete the -S syscall arguments for this syscall group, but
                                # keep those not belonging to this syscall group
                                # (original '-S lchown -S fchmod -S fchownat' would become '-S fchmod'
                                # * 3) append the modified (filtered) rule again into audit.rules
                                # if the same rule not already present
                                #
                                # 1) Delete the original rule
                                sed -i -e "/$rule/d" "$audit_file"
                                # 2) Delete syscalls for this group, but keep those from other groups
                                # Convert current rule syscall's string into array splitting by '-S' delimiter
                                IFS=$'-S' read -a rule_syscalls_as_array &lt;&lt;&lt; "$rule_syscalls"
                                # Reset IFS back to default
                                unset $IFS
                                # Declare new empty string to hold '-S syscall' arguments from other groups
                                new_syscalls_for_rule=''
                                # Walk through existing '-S syscall' arguments
                                for syscall_arg in "${rule_syscalls_as_array[@]}"
                                do
                                        # Skip empty $syscall_arg values
                                        if [ "$syscall_arg" == '' ]
                                        then
                                                continue
                                        fi
                                        # If the '-S syscall' doesn't belong to current group add it to the new list
                                        # (together with adding '-S' delimiter back for each of such item found)
                                        if grep -q -v -- "$group" &lt;&lt;&lt; "$syscall_arg"
                                        then
                                                new_syscalls_for_rule="$new_syscalls_for_rule -S $syscall_arg"
                                        fi
                                done
                                # Replace original '-S syscall' list with the new one for this rule
                                updated_rule=${rule//$rule_syscalls/$new_syscalls_for_rule}
                                # Squeeze repeated whitespace characters in rule definition (if any) into one
                                updated_rule=$(echo "$updated_rule" | tr -s '[:space:]')
                                # 3) Append the modified / filtered rule again into audit.rules
                                #    (but only in case it's not present yet to prevent duplicate definitions)
                                if ! grep -q -- "$updated_rule" "$audit_file"
                                then
                                        echo "$updated_rule" &gt;&gt; "$audit_file"
                                fi
                        fi
                else
                        # $audit_file already contains the expected rule form for this
                        # architecture &amp; key =&gt; don't insert it second time
                        append_expected_rule=1
                fi
        done

        # We deleted all rules that were subset of the expected one for this arch &amp; key.
        # Also isolated rules containing system calls not from this system calls group.
        # Now append the expected rule if it's not present in $audit_file yet
        if [[ ${append_expected_rule} -eq "0" ]]
        then
                echo "$full_rule" &gt;&gt; "$audit_file"
        fi
done

}

	fix_audit_syscall_rule "auditctl" "$PATTERN" "$GROUP" "$ARCH" "$FULL_RULE"
done

# Then perform the remediations for the watch rules

function fix_audit_watch_rule {

# Load function arguments into local variables
local tool="$1"
local path="$2"
local required_access_bits="$3"
local key="$4"

# Check sanity of the input
if [ $# -ne "4" ]
then
        echo "Usage: fix_audit_watch_rule 'tool' 'path' 'bits' 'key'"
        echo "Aborting."
        exit 1
fi

# Create a list of audit *.rules files that should be inspected for presence and correctness
# of a particular audit rule. The scheme is as follows:
#
# -----------------------------------------------------------------------------------------
# Tool used to load audit rules | Rule already defined  |  Audit rules file to inspect    |
# -----------------------------------------------------------------------------------------
#       auditctl                |     Doesn't matter    |  /etc/audit/audit.rules         |
# -----------------------------------------------------------------------------------------
#       augenrules              |          Yes          |  /etc/audit/rules.d/*.rules     |
#       augenrules              |          No           |  /etc/audit/rules.d/$key.rules  |
# -----------------------------------------------------------------------------------------
declare -a files_to_inspect

# Check sanity of the specified audit tool
if [ "$tool" != 'auditctl' ] &amp;&amp; [ "$tool" != 'augenrules' ]
then
        echo "Unknown audit rules loading tool: $1. Aborting."
        echo "Use either 'auditctl' or 'augenrules'!"
        exit 1
# If the audit tool is 'auditctl', then add '/etc/audit/audit.rules'
# into the list of files to be inspected
elif [ "$tool" == 'auditctl' ]
then
        files_to_inspect=("${files_to_inspect[@]}" '/etc/audit/audit.rules')
# If the audit is 'augenrules', then check if rule is already defined
# If rule is defined, add '/etc/audit/rules.d/*.rules' to list of files for inspection.
# If rule isn't defined, add '/etc/audit/rules.d/$key.rules' to list of files for inspection.
elif [ "$tool" == 'augenrules' ]
then
        # Case when particular audit rule is already defined in some of /etc/audit/rules.d/*.rules file
        # Get pair -- filepath : matching_row into @matches array
        IFS=$'\n' matches=($(grep -P "[\s]*-w[\s]+$path" /etc/audit/rules.d/*.rules))
        # Reset IFS back to default
        unset $IFS
        # For each of the matched entries
        for match in "${matches[@]}"
        do
                # Extract filepath from the match
                rulesd_audit_file=$(echo $match | cut -f1 -d ':')
                # Append that path into list of files for inspection
                files_to_inspect=("${files_to_inspect[@]}" "$rulesd_audit_file")
        done
        # Case when particular audit rule isn't defined yet
        if [ ${#files_to_inspect[@]} -eq "0" ]
        then
                # Append '/etc/audit/rules.d/$key.rules' into list of files for inspection
                files_to_inspect="/etc/audit/rules.d/$key.rules"
                # If the $key.rules file doesn't exist yet, create it with correct permissions
                if [ ! -e "$files_to_inspect" ]
                then
                        touch "$files_to_inspect"
                        chmod 0640 "$files_to_inspect"
                fi
        fi
fi

# Finally perform the inspection and possible subsequent audit rule
# correction for each of the files previously identified for inspection
for audit_rules_file in "${files_to_inspect[@]}"
do

        # Check if audit watch file system object rule for given path already present
        if grep -q -P -- "[\s]*-w[\s]+$path" "$audit_rules_file"
        then
                # Rule is found =&gt; verify yet if existing rule definition contains
                # all of the required access type bits

                # Escape slashes in path for use in sed pattern below
                local esc_path=${path//$'/'/$'\/'}
                # Define BRE whitespace class shortcut
                local sp="[[:space:]]"
                # Extract current permission access types (e.g. -p [r|w|x|a] values) from audit rule
                current_access_bits=$(sed -ne "s/$sp*-w$sp\+$esc_path$sp\+-p$sp\+\([rxwa]\{1,4\}\).*/\1/p" "$audit_rules_file")
                # Split required access bits string into characters array
                # (to check bit's presence for one bit at a time)
                for access_bit in $(echo "$required_access_bits" | grep -o .)
                do
                        # For each from the required access bits (e.g. 'w', 'a') check
                        # if they are already present in current access bits for rule.
                        # If not, append that bit at the end
                        if ! grep -q "$access_bit" &lt;&lt;&lt; "$current_access_bits"
                        then
                                # Concatenate the existing mask with the missing bit
                                current_access_bits="$current_access_bits$access_bit"
                        fi
                done
                # Propagate the updated rule's access bits (original + the required
                # ones) back into the /etc/audit/audit.rules file for that rule
                sed -i "s/\($sp*-w$sp\+$esc_path$sp\+-p$sp\+\)\([rxwa]\{1,4\}\)\(.*\)/\1$current_access_bits\3/" "$audit_rules_file"
        else
                # Rule isn't present yet. Append it at the end of $audit_rules_file file
                # with proper key

                echo "-w $path -p $required_access_bits -k $key" &gt;&gt; "$audit_rules_file"
        fi
done
}

fix_audit_watch_rule "auditctl" "/etc/issue" "wa" "audit_rules_networkconfig_modification"
fix_audit_watch_rule "auditctl" "/etc/issue.net" "wa" "audit_rules_networkconfig_modification"

function fix_audit_watch_rule {

# Load function arguments into local variables
local tool="$1"
local path="$2"
local required_access_bits="$3"
local key="$4"

# Check sanity of the input
if [ $# -ne "4" ]
then
        echo "Usage: fix_audit_watch_rule 'tool' 'path' 'bits' 'key'"
        echo "Aborting."
        exit 1
fi

# Create a list of audit *.rules files that should be inspected for presence and correctness
# of a particular audit rule. The scheme is as follows:
#
# -----------------------------------------------------------------------------------------
# Tool used to load audit rules | Rule already defined  |  Audit rules file to inspect    |
# -----------------------------------------------------------------------------------------
#       auditctl                |     Doesn't matter    |  /etc/audit/audit.rules         |
# -----------------------------------------------------------------------------------------
#       augenrules              |          Yes          |  /etc/audit/rules.d/*.rules     |
#       augenrules              |          No           |  /etc/audit/rules.d/$key.rules  |
# -----------------------------------------------------------------------------------------
declare -a files_to_inspect

# Check sanity of the specified audit tool
if [ "$tool" != 'auditctl' ] &amp;&amp; [ "$tool" != 'augenrules' ]
then
        echo "Unknown audit rules loading tool: $1. Aborting."
        echo "Use either 'auditctl' or 'augenrules'!"
        exit 1
# If the audit tool is 'auditctl', then add '/etc/audit/audit.rules'
# into the list of files to be inspected
elif [ "$tool" == 'auditctl' ]
then
        files_to_inspect=("${files_to_inspect[@]}" '/etc/audit/audit.rules')
# If the audit is 'augenrules', then check if rule is already defined
# If rule is defined, add '/etc/audit/rules.d/*.rules' to list of files for inspection.
# If rule isn't defined, add '/etc/audit/rules.d/$key.rules' to list of files for inspection.
elif [ "$tool" == 'augenrules' ]
then
        # Case when particular audit rule is already defined in some of /etc/audit/rules.d/*.rules file
        # Get pair -- filepath : matching_row into @matches array
        IFS=$'\n' matches=($(grep -P "[\s]*-w[\s]+$path" /etc/audit/rules.d/*.rules))
        # Reset IFS back to default
        unset $IFS
        # For each of the matched entries
        for match in "${matches[@]}"
        do
                # Extract filepath from the match
                rulesd_audit_file=$(echo $match | cut -f1 -d ':')
                # Append that path into list of files for inspection
                files_to_inspect=("${files_to_inspect[@]}" "$rulesd_audit_file")
        done
        # Case when particular audit rule isn't defined yet
        if [ ${#files_to_inspect[@]} -eq "0" ]
        then
                # Append '/etc/audit/rules.d/$key.rules' into list of files for inspection
                files_to_inspect="/etc/audit/rules.d/$key.rules"
                # If the $key.rules file doesn't exist yet, create it with correct permissions
                if [ ! -e "$files_to_inspect" ]
                then
                        touch "$files_to_inspect"
                        chmod 0640 "$files_to_inspect"
                fi
        fi
fi

# Finally perform the inspection and possible subsequent audit rule
# correction for each of the files previously identified for inspection
for audit_rules_file in "${files_to_inspect[@]}"
do

        # Check if audit watch file system object rule for given path already present
        if grep -q -P -- "[\s]*-w[\s]+$path" "$audit_rules_file"
        then
                # Rule is found =&gt; verify yet if existing rule definition contains
                # all of the required access type bits

                # Escape slashes in path for use in sed pattern below
                local esc_path=${path//$'/'/$'\/'}
                # Define BRE whitespace class shortcut
                local sp="[[:space:]]"
                # Extract current permission access types (e.g. -p [r|w|x|a] values) from audit rule
                current_access_bits=$(sed -ne "s/$sp*-w$sp\+$esc_path$sp\+-p$sp\+\([rxwa]\{1,4\}\).*/\1/p" "$audit_rules_file")
                # Split required access bits string into characters array
                # (to check bit's presence for one bit at a time)
                for access_bit in $(echo "$required_access_bits" | grep -o .)
                do
                        # For each from the required access bits (e.g. 'w', 'a') check
                        # if they are already present in current access bits for rule.
                        # If not, append that bit at the end
                        if ! grep -q "$access_bit" &lt;&lt;&lt; "$current_access_bits"
                        then
                                # Concatenate the existing mask with the missing bit
                                current_access_bits="$current_access_bits$access_bit"
                        fi
                done
                # Propagate the updated rule's access bits (original + the required
                # ones) back into the /etc/audit/audit.rules file for that rule
                sed -i "s/\($sp*-w$sp\+$esc_path$sp\+-p$sp\+\)\([rxwa]\{1,4\}\)\(.*\)/\1$current_access_bits\3/" "$audit_rules_file"
        else
                # Rule isn't present yet. Append it at the end of $audit_rules_file file
                # with proper key

                echo "-w $path -p $required_access_bits -k $key" &gt;&gt; "$audit_rules_file"
        fi
done
}

fix_audit_watch_rule "auditctl" "/etc/hosts" "wa" "audit_rules_networkconfig_modification"
fix_audit_watch_rule "auditctl" "/etc/sysconfig/network" "wa" "audit_rules_networkconfig_modification"
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_audit_rules_mac_modification" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_audit_rules_mac_modification" id="guide-tree-leaf-idm45561208492736" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.5.5"><td style="padding-left: 76px"><h4>Record Events that Modify the System's Mandatory Access Controls<span class="label label-default pull-right">rule</span></h4><p>Add the following to <code>/etc/audit/audit.rules</code>:
<pre>-w /etc/selinux/ -p wa -k MAC-policy</pre>
</p><span class="label label-primary">Rationale:</span><p>The system's mandatory access policy (SELinux) should not be
arbitrarily changed by anything other than administrator action. All changes to
MAC policy should be audited.</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-3(10)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-1(b)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(a)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(d)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12(a)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IR-5</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-10.5.5</a></p></div><span class="label label-success">Remediation script:</span><pre><code>

# Perform the remediation

function fix_audit_watch_rule {

# Load function arguments into local variables
local tool="$1"
local path="$2"
local required_access_bits="$3"
local key="$4"

# Check sanity of the input
if [ $# -ne "4" ]
then
        echo "Usage: fix_audit_watch_rule 'tool' 'path' 'bits' 'key'"
        echo "Aborting."
        exit 1
fi

# Create a list of audit *.rules files that should be inspected for presence and correctness
# of a particular audit rule. The scheme is as follows:
#
# -----------------------------------------------------------------------------------------
# Tool used to load audit rules | Rule already defined  |  Audit rules file to inspect    |
# -----------------------------------------------------------------------------------------
#       auditctl                |     Doesn't matter    |  /etc/audit/audit.rules         |
# -----------------------------------------------------------------------------------------
#       augenrules              |          Yes          |  /etc/audit/rules.d/*.rules     |
#       augenrules              |          No           |  /etc/audit/rules.d/$key.rules  |
# -----------------------------------------------------------------------------------------
declare -a files_to_inspect

# Check sanity of the specified audit tool
if [ "$tool" != 'auditctl' ] &amp;&amp; [ "$tool" != 'augenrules' ]
then
        echo "Unknown audit rules loading tool: $1. Aborting."
        echo "Use either 'auditctl' or 'augenrules'!"
        exit 1
# If the audit tool is 'auditctl', then add '/etc/audit/audit.rules'
# into the list of files to be inspected
elif [ "$tool" == 'auditctl' ]
then
        files_to_inspect=("${files_to_inspect[@]}" '/etc/audit/audit.rules')
# If the audit is 'augenrules', then check if rule is already defined
# If rule is defined, add '/etc/audit/rules.d/*.rules' to list of files for inspection.
# If rule isn't defined, add '/etc/audit/rules.d/$key.rules' to list of files for inspection.
elif [ "$tool" == 'augenrules' ]
then
        # Case when particular audit rule is already defined in some of /etc/audit/rules.d/*.rules file
        # Get pair -- filepath : matching_row into @matches array
        IFS=$'\n' matches=($(grep -P "[\s]*-w[\s]+$path" /etc/audit/rules.d/*.rules))
        # Reset IFS back to default
        unset $IFS
        # For each of the matched entries
        for match in "${matches[@]}"
        do
                # Extract filepath from the match
                rulesd_audit_file=$(echo $match | cut -f1 -d ':')
                # Append that path into list of files for inspection
                files_to_inspect=("${files_to_inspect[@]}" "$rulesd_audit_file")
        done
        # Case when particular audit rule isn't defined yet
        if [ ${#files_to_inspect[@]} -eq "0" ]
        then
                # Append '/etc/audit/rules.d/$key.rules' into list of files for inspection
                files_to_inspect="/etc/audit/rules.d/$key.rules"
                # If the $key.rules file doesn't exist yet, create it with correct permissions
                if [ ! -e "$files_to_inspect" ]
                then
                        touch "$files_to_inspect"
                        chmod 0640 "$files_to_inspect"
                fi
        fi
fi

# Finally perform the inspection and possible subsequent audit rule
# correction for each of the files previously identified for inspection
for audit_rules_file in "${files_to_inspect[@]}"
do

        # Check if audit watch file system object rule for given path already present
        if grep -q -P -- "[\s]*-w[\s]+$path" "$audit_rules_file"
        then
                # Rule is found =&gt; verify yet if existing rule definition contains
                # all of the required access type bits

                # Escape slashes in path for use in sed pattern below
                local esc_path=${path//$'/'/$'\/'}
                # Define BRE whitespace class shortcut
                local sp="[[:space:]]"
                # Extract current permission access types (e.g. -p [r|w|x|a] values) from audit rule
                current_access_bits=$(sed -ne "s/$sp*-w$sp\+$esc_path$sp\+-p$sp\+\([rxwa]\{1,4\}\).*/\1/p" "$audit_rules_file")
                # Split required access bits string into characters array
                # (to check bit's presence for one bit at a time)
                for access_bit in $(echo "$required_access_bits" | grep -o .)
                do
                        # For each from the required access bits (e.g. 'w', 'a') check
                        # if they are already present in current access bits for rule.
                        # If not, append that bit at the end
                        if ! grep -q "$access_bit" &lt;&lt;&lt; "$current_access_bits"
                        then
                                # Concatenate the existing mask with the missing bit
                                current_access_bits="$current_access_bits$access_bit"
                        fi
                done
                # Propagate the updated rule's access bits (original + the required
                # ones) back into the /etc/audit/audit.rules file for that rule
                sed -i "s/\($sp*-w$sp\+$esc_path$sp\+-p$sp\+\)\([rxwa]\{1,4\}\)\(.*\)/\1$current_access_bits\3/" "$audit_rules_file"
        else
                # Rule isn't present yet. Append it at the end of $audit_rules_file file
                # with proper key

                echo "-w $path -p $required_access_bits -k $key" &gt;&gt; "$audit_rules_file"
        fi
done
}

fix_audit_watch_rule "auditctl" "/etc/selinux/" "wa" "MAC-policy"
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_chmod" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_chmod" id="guide-tree-leaf-idm45561208475408" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.5.5"><td style="padding-left: 76px"><h4>Record Events that Modify the System's Discretionary Access Controls - chmod<span class="label label-default pull-right">rule</span></h4><p>At a minimum the audit system should collect file
permission changes for all users and root. Add the following to
<code>/etc/audit/audit.rules</code>:
<pre>-a always,exit -F arch=b32 -S chmod -F auid&gt;=500 -F auid!=4294967295 -k perm_mod</pre>
If the system is 64 bit then also add the following:
<pre>-a always,exit -F arch=b64 -S chmod  -F auid&gt;=500 -F auid!=4294967295 -k perm_mod</pre>
</p><div class="panel panel-warning"><div class="panel-heading"><span class="label label-warning">warning</span> 
                            Note that these rules can be configured in a 
number of ways while still achieving the desired effect.  Here the system calls 
have been placed independent of other system calls.  Grouping these system
calls with others as identifying earlier in this guide is more efficient.
</div></div><span class="label label-primary">Rationale:</span><p>The changing of file permissions could indicate that a user is attempting to
gain access to information that would otherwise be disallowed. Auditing DAC modifications
can facilitate the identification of patterns of abuse among both authorized and
unauthorized users.</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-3(10)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-1(b)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(a)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(d)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12(a)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IR-5</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">126</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-10.5.5</a></p></div><span class="label label-success">Remediation script:</span><pre><code>

# Perform the remediation for the syscall rule
# Retrieve hardware architecture of the underlying system
[ $(getconf LONG_BIT) = "32" ] &amp;&amp; RULE_ARCHS=("b32") || RULE_ARCHS=("b32" "b64")

for ARCH in "${RULE_ARCHS[@]}"
do
	PATTERN="-a always,exit -F arch=$ARCH -S .* -F auid&gt;=500 -F auid!=4294967295 -k *"
	GROUP="chmod"
	FULL_RULE="-a always,exit -F arch=$ARCH -S chmod -S fchmod -S fchmodat -F auid&gt;=500 -F auid!=4294967295 -k perm_mod"

function fix_audit_syscall_rule {

# Load function arguments into local variables
local tool="$1"
local pattern="$2"
local group="$3"
local arch="$4"
local full_rule="$5"

# Check sanity of the input
if [ $# -ne "5" ]
then
        echo "Usage: fix_audit_syscall_rule 'tool' 'pattern' 'group' 'arch' 'full rule'"
        echo "Aborting."
        exit 1
fi

# Create a list of audit *.rules files that should be inspected for presence and correctness
# of a particular audit rule. The scheme is as follows:
#
# -----------------------------------------------------------------------------------------
#  Tool used to load audit rules | Rule already defined  |  Audit rules file to inspect    |
# -----------------------------------------------------------------------------------------
#        auditctl                |     Doesn't matter    |  /etc/audit/audit.rules         |
# -----------------------------------------------------------------------------------------
#        augenrules              |          Yes          |  /etc/audit/rules.d/*.rules     |
#        augenrules              |          No           |  /etc/audit/rules.d/$key.rules  |
# -----------------------------------------------------------------------------------------
#
declare -a files_to_inspect

# First check sanity of the specified audit tool
if [ "$tool" != 'auditctl' ] &amp;&amp; [ "$tool" != 'augenrules' ]
then
        echo "Unknown audit rules loading tool: $1. Aborting."
        echo "Use either 'auditctl' or 'augenrules'!"
        exit 1
# If audit tool is 'auditctl', then add '/etc/audit/audit.rules'
# file to the list of files to be inspected
elif [ "$tool" == 'auditctl' ]
then
        files_to_inspect=("${files_to_inspect[@]}" '/etc/audit/audit.rules' )
# If audit tool is 'augenrules', then check if the audit rule is defined
# If rule is defined, add '/etc/audit/rules.d/*.rules' to the list for inspection
# If rule isn't defined yet, add '/etc/audit/rules.d/$key.rules' to the list for inspection
elif [ "$tool" == 'augenrules' ]
then
        # Extract audit $key from audit rule so we can use it later
        key=$(expr "$full_rule" : '.*-k[[:space:]]\([^[:space:]]\+\)')
        # Check if particular audit rule is already defined
        IFS=$'\n' matches=($(sed -s -n -e "/${pattern}/!d" -e "/${arch}/!d" -e "/${group}/!d;F" /etc/audit/rules.d/*.rules))
        # Reset IFS back to default
        unset $IFS
        for match in "${matches[@]}"
        do
                files_to_inspect=("${files_to_inspect[@]}" "${match}")
        done
        # Case when particular rule isn't defined in /etc/audit/rules.d/*.rules yet
        if [ ${#files_to_inspect[@]} -eq "0" ]
        then
                files_to_inspect="/etc/audit/rules.d/$key.rules"
                if [ ! -e "$files_to_inspect" ]
                then
                        touch "$files_to_inspect"
                        chmod 0640 "$files_to_inspect"
                fi
        fi
fi

#
# Indicator that we want to append $full_rule into $audit_file by default
local append_expected_rule=0

for audit_file in "${files_to_inspect[@]}"
do

        # Filter existing $audit_file rules' definitions to select those that:
        # * follow the rule pattern, and
        # * meet the hardware architecture requirement, and
        # * are current syscall group specific
        IFS=$'\n' existing_rules=($(sed -e "/${pattern}/!d" -e "/${arch}/!d" -e "/${group}/!d"  "$audit_file"))
        # Reset IFS back to default
        unset $IFS

        # Process rules found case-by-case
        for rule in "${existing_rules[@]}"
        do
                # Found rule is for same arch &amp; key, but differs (e.g. in count of -S arguments)
                if [ "${rule}" != "${full_rule}" ]
                then
                        # If so, isolate just '(-S \w)+' substring of that rule
                        rule_syscalls=$(echo $rule | grep -o -P '(-S \w+ )+')
                        # Check if list of '-S syscall' arguments of that rule is subset
                        # of '-S syscall' list of expected $full_rule
                        if grep -q -- "$rule_syscalls" &lt;&lt;&lt; "$full_rule"
                        then
                                # Rule is covered (i.e. the list of -S syscalls for this rule is
                                # subset of -S syscalls of $full_rule =&gt; existing rule can be deleted
                                # Thus delete the rule from audit.rules &amp; our array
                                sed -i -e "/$rule/d" "$audit_file"
                                existing_rules=("${existing_rules[@]//$rule/}")
                        else
                                # Rule isn't covered by $full_rule - it besides -S syscall arguments
                                # for this group contains also -S syscall arguments for other syscall
                                # group. Example: '-S lchown -S fchmod -S fchownat' =&gt; group='chown'
                                # since 'lchown' &amp; 'fchownat' share 'chown' substring
                                # Therefore:
                                # * 1) delete the original rule from audit.rules
                                # (original '-S lchown -S fchmod -S fchownat' rule would be deleted)
                                # * 2) delete the -S syscall arguments for this syscall group, but
                                # keep those not belonging to this syscall group
                                # (original '-S lchown -S fchmod -S fchownat' would become '-S fchmod'
                                # * 3) append the modified (filtered) rule again into audit.rules
                                # if the same rule not already present
                                #
                                # 1) Delete the original rule
                                sed -i -e "/$rule/d" "$audit_file"
                                # 2) Delete syscalls for this group, but keep those from other groups
                                # Convert current rule syscall's string into array splitting by '-S' delimiter
                                IFS=$'-S' read -a rule_syscalls_as_array &lt;&lt;&lt; "$rule_syscalls"
                                # Reset IFS back to default
                                unset $IFS
                                # Declare new empty string to hold '-S syscall' arguments from other groups
                                new_syscalls_for_rule=''
                                # Walk through existing '-S syscall' arguments
                                for syscall_arg in "${rule_syscalls_as_array[@]}"
                                do
                                        # Skip empty $syscall_arg values
                                        if [ "$syscall_arg" == '' ]
                                        then
                                                continue
                                        fi
                                        # If the '-S syscall' doesn't belong to current group add it to the new list
                                        # (together with adding '-S' delimiter back for each of such item found)
                                        if grep -q -v -- "$group" &lt;&lt;&lt; "$syscall_arg"
                                        then
                                                new_syscalls_for_rule="$new_syscalls_for_rule -S $syscall_arg"
                                        fi
                                done
                                # Replace original '-S syscall' list with the new one for this rule
                                updated_rule=${rule//$rule_syscalls/$new_syscalls_for_rule}
                                # Squeeze repeated whitespace characters in rule definition (if any) into one
                                updated_rule=$(echo "$updated_rule" | tr -s '[:space:]')
                                # 3) Append the modified / filtered rule again into audit.rules
                                #    (but only in case it's not present yet to prevent duplicate definitions)
                                if ! grep -q -- "$updated_rule" "$audit_file"
                                then
                                        echo "$updated_rule" &gt;&gt; "$audit_file"
                                fi
                        fi
                else
                        # $audit_file already contains the expected rule form for this
                        # architecture &amp; key =&gt; don't insert it second time
                        append_expected_rule=1
                fi
        done

        # We deleted all rules that were subset of the expected one for this arch &amp; key.
        # Also isolated rules containing system calls not from this system calls group.
        # Now append the expected rule if it's not present in $audit_file yet
        if [[ ${append_expected_rule} -eq "0" ]]
        then
                echo "$full_rule" &gt;&gt; "$audit_file"
        fi
done

}

	fix_audit_syscall_rule "auditctl" "$PATTERN" "$GROUP" "$ARCH" "$FULL_RULE"
done
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_chown" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_chown" id="guide-tree-leaf-idm45561208454272" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.5.5"><td style="padding-left: 76px"><h4>Record Events that Modify the System's Discretionary Access Controls - chown<span class="label label-default pull-right">rule</span></h4><p>At a minimum the audit system should collect file
permission changes for all users and root. Add the following to
<code>/etc/audit/audit.rules</code>:
<pre>-a always,exit -F arch=b32 -S chown -F auid&gt;=500 -F auid!=4294967295 -k perm_mod</pre>
If the system is 64 bit then also add the following:
<pre>-a always,exit -F arch=b64 -S chown -F auid&gt;=500 -F auid!=4294967295 -k perm_mod</pre>
</p><div class="panel panel-warning"><div class="panel-heading"><span class="label label-warning">warning</span> 
                            Note that these rules can be configured in a 
number of ways while still achieving the desired effect.  Here the system calls 
have been placed independent of other system calls.  Grouping these system 
calls with others as identifying earlier in this guide is more efficient.
</div></div><span class="label label-primary">Rationale:</span><p>The changing of file permissions could indicate that a user is attempting to
gain access to information that would otherwise be disallowed. Auditing DAC modifications
can facilitate the identification of patterns of abuse among both authorized and
unauthorized users.</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-3(10)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-1(b)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(a)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(d)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12(a)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IR-5</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">126</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-10.5.5</a></p></div><span class="label label-success">Remediation script:</span><pre><code>

# Perform the remediation for the syscall rule
# Retrieve hardware architecture of the underlying system
[ $(getconf LONG_BIT) = "32" ] &amp;&amp; RULE_ARCHS=("b32") || RULE_ARCHS=("b32" "b64")

for ARCH in ${RULE_ARCHS[@]}
do
	PATTERN="-a always,exit -F arch=$ARCH -S .* -F auid&gt;=500 -F auid!=4294967295 -k *"
	GROUP="chown"
	FULL_RULE="-a always,exit -F arch=$ARCH -S chown -S fchown -S fchownat -S lchown -F auid&gt;=500 -F auid!=4294967295 -k perm_mod"

function fix_audit_syscall_rule {

# Load function arguments into local variables
local tool="$1"
local pattern="$2"
local group="$3"
local arch="$4"
local full_rule="$5"

# Check sanity of the input
if [ $# -ne "5" ]
then
        echo "Usage: fix_audit_syscall_rule 'tool' 'pattern' 'group' 'arch' 'full rule'"
        echo "Aborting."
        exit 1
fi

# Create a list of audit *.rules files that should be inspected for presence and correctness
# of a particular audit rule. The scheme is as follows:
#
# -----------------------------------------------------------------------------------------
#  Tool used to load audit rules | Rule already defined  |  Audit rules file to inspect    |
# -----------------------------------------------------------------------------------------
#        auditctl                |     Doesn't matter    |  /etc/audit/audit.rules         |
# -----------------------------------------------------------------------------------------
#        augenrules              |          Yes          |  /etc/audit/rules.d/*.rules     |
#        augenrules              |          No           |  /etc/audit/rules.d/$key.rules  |
# -----------------------------------------------------------------------------------------
#
declare -a files_to_inspect

# First check sanity of the specified audit tool
if [ "$tool" != 'auditctl' ] &amp;&amp; [ "$tool" != 'augenrules' ]
then
        echo "Unknown audit rules loading tool: $1. Aborting."
        echo "Use either 'auditctl' or 'augenrules'!"
        exit 1
# If audit tool is 'auditctl', then add '/etc/audit/audit.rules'
# file to the list of files to be inspected
elif [ "$tool" == 'auditctl' ]
then
        files_to_inspect=("${files_to_inspect[@]}" '/etc/audit/audit.rules' )
# If audit tool is 'augenrules', then check if the audit rule is defined
# If rule is defined, add '/etc/audit/rules.d/*.rules' to the list for inspection
# If rule isn't defined yet, add '/etc/audit/rules.d/$key.rules' to the list for inspection
elif [ "$tool" == 'augenrules' ]
then
        # Extract audit $key from audit rule so we can use it later
        key=$(expr "$full_rule" : '.*-k[[:space:]]\([^[:space:]]\+\)')
        # Check if particular audit rule is already defined
        IFS=$'\n' matches=($(sed -s -n -e "/${pattern}/!d" -e "/${arch}/!d" -e "/${group}/!d;F" /etc/audit/rules.d/*.rules))
        # Reset IFS back to default
        unset $IFS
        for match in "${matches[@]}"
        do
                files_to_inspect=("${files_to_inspect[@]}" "${match}")
        done
        # Case when particular rule isn't defined in /etc/audit/rules.d/*.rules yet
        if [ ${#files_to_inspect[@]} -eq "0" ]
        then
                files_to_inspect="/etc/audit/rules.d/$key.rules"
                if [ ! -e "$files_to_inspect" ]
                then
                        touch "$files_to_inspect"
                        chmod 0640 "$files_to_inspect"
                fi
        fi
fi

#
# Indicator that we want to append $full_rule into $audit_file by default
local append_expected_rule=0

for audit_file in "${files_to_inspect[@]}"
do

        # Filter existing $audit_file rules' definitions to select those that:
        # * follow the rule pattern, and
        # * meet the hardware architecture requirement, and
        # * are current syscall group specific
        IFS=$'\n' existing_rules=($(sed -e "/${pattern}/!d" -e "/${arch}/!d" -e "/${group}/!d"  "$audit_file"))
        # Reset IFS back to default
        unset $IFS

        # Process rules found case-by-case
        for rule in "${existing_rules[@]}"
        do
                # Found rule is for same arch &amp; key, but differs (e.g. in count of -S arguments)
                if [ "${rule}" != "${full_rule}" ]
                then
                        # If so, isolate just '(-S \w)+' substring of that rule
                        rule_syscalls=$(echo $rule | grep -o -P '(-S \w+ )+')
                        # Check if list of '-S syscall' arguments of that rule is subset
                        # of '-S syscall' list of expected $full_rule
                        if grep -q -- "$rule_syscalls" &lt;&lt;&lt; "$full_rule"
                        then
                                # Rule is covered (i.e. the list of -S syscalls for this rule is
                                # subset of -S syscalls of $full_rule =&gt; existing rule can be deleted
                                # Thus delete the rule from audit.rules &amp; our array
                                sed -i -e "/$rule/d" "$audit_file"
                                existing_rules=("${existing_rules[@]//$rule/}")
                        else
                                # Rule isn't covered by $full_rule - it besides -S syscall arguments
                                # for this group contains also -S syscall arguments for other syscall
                                # group. Example: '-S lchown -S fchmod -S fchownat' =&gt; group='chown'
                                # since 'lchown' &amp; 'fchownat' share 'chown' substring
                                # Therefore:
                                # * 1) delete the original rule from audit.rules
                                # (original '-S lchown -S fchmod -S fchownat' rule would be deleted)
                                # * 2) delete the -S syscall arguments for this syscall group, but
                                # keep those not belonging to this syscall group
                                # (original '-S lchown -S fchmod -S fchownat' would become '-S fchmod'
                                # * 3) append the modified (filtered) rule again into audit.rules
                                # if the same rule not already present
                                #
                                # 1) Delete the original rule
                                sed -i -e "/$rule/d" "$audit_file"
                                # 2) Delete syscalls for this group, but keep those from other groups
                                # Convert current rule syscall's string into array splitting by '-S' delimiter
                                IFS=$'-S' read -a rule_syscalls_as_array &lt;&lt;&lt; "$rule_syscalls"
                                # Reset IFS back to default
                                unset $IFS
                                # Declare new empty string to hold '-S syscall' arguments from other groups
                                new_syscalls_for_rule=''
                                # Walk through existing '-S syscall' arguments
                                for syscall_arg in "${rule_syscalls_as_array[@]}"
                                do
                                        # Skip empty $syscall_arg values
                                        if [ "$syscall_arg" == '' ]
                                        then
                                                continue
                                        fi
                                        # If the '-S syscall' doesn't belong to current group add it to the new list
                                        # (together with adding '-S' delimiter back for each of such item found)
                                        if grep -q -v -- "$group" &lt;&lt;&lt; "$syscall_arg"
                                        then
                                                new_syscalls_for_rule="$new_syscalls_for_rule -S $syscall_arg"
                                        fi
                                done
                                # Replace original '-S syscall' list with the new one for this rule
                                updated_rule=${rule//$rule_syscalls/$new_syscalls_for_rule}
                                # Squeeze repeated whitespace characters in rule definition (if any) into one
                                updated_rule=$(echo "$updated_rule" | tr -s '[:space:]')
                                # 3) Append the modified / filtered rule again into audit.rules
                                #    (but only in case it's not present yet to prevent duplicate definitions)
                                if ! grep -q -- "$updated_rule" "$audit_file"
                                then
                                        echo "$updated_rule" &gt;&gt; "$audit_file"
                                fi
                        fi
                else
                        # $audit_file already contains the expected rule form for this
                        # architecture &amp; key =&gt; don't insert it second time
                        append_expected_rule=1
                fi
        done

        # We deleted all rules that were subset of the expected one for this arch &amp; key.
        # Also isolated rules containing system calls not from this system calls group.
        # Now append the expected rule if it's not present in $audit_file yet
        if [[ ${append_expected_rule} -eq "0" ]]
        then
                echo "$full_rule" &gt;&gt; "$audit_file"
        fi
done

}

	fix_audit_syscall_rule "auditctl" "$PATTERN" "$GROUP" "$ARCH" "$FULL_RULE"
done
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_fchmod" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_fchmod" id="guide-tree-leaf-idm45561208433120" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.5.5"><td style="padding-left: 76px"><h4>Record Events that Modify the System's Discretionary Access Controls - fchmod<span class="label label-default pull-right">rule</span></h4><p>At a minimum the audit system should collect file
permission changes for all users and root. Add the following to
<code>/etc/audit/audit.rules</code>:
<pre>-a always,exit -F arch=b32 -S fchmod -F auid&gt;=500 -F auid!=4294967295 -k perm_mod</pre>
If the system is 64 bit then also add the following:
<pre>-a always,exit -F arch=b64 -S fchmod -F auid&gt;=500 -F auid!=4294967295 -k perm_mod</pre>
</p><div class="panel panel-warning"><div class="panel-heading"><span class="label label-warning">warning</span> 
                            Note that these rules can be configured in a
number of ways while still achieving the desired effect.  Here the system calls
have been placed independent of other system calls.  Grouping these system
calls with others as identifying earlier in this guide is more efficient.
</div></div><span class="label label-primary">Rationale:</span><p>The changing of file permissions could indicate that a user is attempting to
gain access to information that would otherwise be disallowed. Auditing DAC modifications
can facilitate the identification of patterns of abuse among both authorized and
unauthorized users.</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-3(10)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-1(b)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(a)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(d)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12(a)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IR-5</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">126</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-10.5.5</a></p></div><span class="label label-success">Remediation script:</span><pre><code>

# Perform the remediation for the syscall rule
# Retrieve hardware architecture of the underlying system
[ $(getconf LONG_BIT) = "32" ] &amp;&amp; RULE_ARCHS=("b32") || RULE_ARCHS=("b32" "b64")

for ARCH in "${RULE_ARCHS[@]}"
do
	PATTERN="-a always,exit -F arch=$ARCH -S .* -F auid&gt;=500 -F auid!=4294967295 -k *"
	GROUP="chmod"
	FULL_RULE="-a always,exit -F arch=$ARCH -S chmod -S fchmod -S fchmodat -F auid&gt;=500 -F auid!=4294967295 -k perm_mod"

function fix_audit_syscall_rule {

# Load function arguments into local variables
local tool="$1"
local pattern="$2"
local group="$3"
local arch="$4"
local full_rule="$5"

# Check sanity of the input
if [ $# -ne "5" ]
then
        echo "Usage: fix_audit_syscall_rule 'tool' 'pattern' 'group' 'arch' 'full rule'"
        echo "Aborting."
        exit 1
fi

# Create a list of audit *.rules files that should be inspected for presence and correctness
# of a particular audit rule. The scheme is as follows:
#
# -----------------------------------------------------------------------------------------
#  Tool used to load audit rules | Rule already defined  |  Audit rules file to inspect    |
# -----------------------------------------------------------------------------------------
#        auditctl                |     Doesn't matter    |  /etc/audit/audit.rules         |
# -----------------------------------------------------------------------------------------
#        augenrules              |          Yes          |  /etc/audit/rules.d/*.rules     |
#        augenrules              |          No           |  /etc/audit/rules.d/$key.rules  |
# -----------------------------------------------------------------------------------------
#
declare -a files_to_inspect

# First check sanity of the specified audit tool
if [ "$tool" != 'auditctl' ] &amp;&amp; [ "$tool" != 'augenrules' ]
then
        echo "Unknown audit rules loading tool: $1. Aborting."
        echo "Use either 'auditctl' or 'augenrules'!"
        exit 1
# If audit tool is 'auditctl', then add '/etc/audit/audit.rules'
# file to the list of files to be inspected
elif [ "$tool" == 'auditctl' ]
then
        files_to_inspect=("${files_to_inspect[@]}" '/etc/audit/audit.rules' )
# If audit tool is 'augenrules', then check if the audit rule is defined
# If rule is defined, add '/etc/audit/rules.d/*.rules' to the list for inspection
# If rule isn't defined yet, add '/etc/audit/rules.d/$key.rules' to the list for inspection
elif [ "$tool" == 'augenrules' ]
then
        # Extract audit $key from audit rule so we can use it later
        key=$(expr "$full_rule" : '.*-k[[:space:]]\([^[:space:]]\+\)')
        # Check if particular audit rule is already defined
        IFS=$'\n' matches=($(sed -s -n -e "/${pattern}/!d" -e "/${arch}/!d" -e "/${group}/!d;F" /etc/audit/rules.d/*.rules))
        # Reset IFS back to default
        unset $IFS
        for match in "${matches[@]}"
        do
                files_to_inspect=("${files_to_inspect[@]}" "${match}")
        done
        # Case when particular rule isn't defined in /etc/audit/rules.d/*.rules yet
        if [ ${#files_to_inspect[@]} -eq "0" ]
        then
                files_to_inspect="/etc/audit/rules.d/$key.rules"
                if [ ! -e "$files_to_inspect" ]
                then
                        touch "$files_to_inspect"
                        chmod 0640 "$files_to_inspect"
                fi
        fi
fi

#
# Indicator that we want to append $full_rule into $audit_file by default
local append_expected_rule=0

for audit_file in "${files_to_inspect[@]}"
do

        # Filter existing $audit_file rules' definitions to select those that:
        # * follow the rule pattern, and
        # * meet the hardware architecture requirement, and
        # * are current syscall group specific
        IFS=$'\n' existing_rules=($(sed -e "/${pattern}/!d" -e "/${arch}/!d" -e "/${group}/!d"  "$audit_file"))
        # Reset IFS back to default
        unset $IFS

        # Process rules found case-by-case
        for rule in "${existing_rules[@]}"
        do
                # Found rule is for same arch &amp; key, but differs (e.g. in count of -S arguments)
                if [ "${rule}" != "${full_rule}" ]
                then
                        # If so, isolate just '(-S \w)+' substring of that rule
                        rule_syscalls=$(echo $rule | grep -o -P '(-S \w+ )+')
                        # Check if list of '-S syscall' arguments of that rule is subset
                        # of '-S syscall' list of expected $full_rule
                        if grep -q -- "$rule_syscalls" &lt;&lt;&lt; "$full_rule"
                        then
                                # Rule is covered (i.e. the list of -S syscalls for this rule is
                                # subset of -S syscalls of $full_rule =&gt; existing rule can be deleted
                                # Thus delete the rule from audit.rules &amp; our array
                                sed -i -e "/$rule/d" "$audit_file"
                                existing_rules=("${existing_rules[@]//$rule/}")
                        else
                                # Rule isn't covered by $full_rule - it besides -S syscall arguments
                                # for this group contains also -S syscall arguments for other syscall
                                # group. Example: '-S lchown -S fchmod -S fchownat' =&gt; group='chown'
                                # since 'lchown' &amp; 'fchownat' share 'chown' substring
                                # Therefore:
                                # * 1) delete the original rule from audit.rules
                                # (original '-S lchown -S fchmod -S fchownat' rule would be deleted)
                                # * 2) delete the -S syscall arguments for this syscall group, but
                                # keep those not belonging to this syscall group
                                # (original '-S lchown -S fchmod -S fchownat' would become '-S fchmod'
                                # * 3) append the modified (filtered) rule again into audit.rules
                                # if the same rule not already present
                                #
                                # 1) Delete the original rule
                                sed -i -e "/$rule/d" "$audit_file"
                                # 2) Delete syscalls for this group, but keep those from other groups
                                # Convert current rule syscall's string into array splitting by '-S' delimiter
                                IFS=$'-S' read -a rule_syscalls_as_array &lt;&lt;&lt; "$rule_syscalls"
                                # Reset IFS back to default
                                unset $IFS
                                # Declare new empty string to hold '-S syscall' arguments from other groups
                                new_syscalls_for_rule=''
                                # Walk through existing '-S syscall' arguments
                                for syscall_arg in "${rule_syscalls_as_array[@]}"
                                do
                                        # Skip empty $syscall_arg values
                                        if [ "$syscall_arg" == '' ]
                                        then
                                                continue
                                        fi
                                        # If the '-S syscall' doesn't belong to current group add it to the new list
                                        # (together with adding '-S' delimiter back for each of such item found)
                                        if grep -q -v -- "$group" &lt;&lt;&lt; "$syscall_arg"
                                        then
                                                new_syscalls_for_rule="$new_syscalls_for_rule -S $syscall_arg"
                                        fi
                                done
                                # Replace original '-S syscall' list with the new one for this rule
                                updated_rule=${rule//$rule_syscalls/$new_syscalls_for_rule}
                                # Squeeze repeated whitespace characters in rule definition (if any) into one
                                updated_rule=$(echo "$updated_rule" | tr -s '[:space:]')
                                # 3) Append the modified / filtered rule again into audit.rules
                                #    (but only in case it's not present yet to prevent duplicate definitions)
                                if ! grep -q -- "$updated_rule" "$audit_file"
                                then
                                        echo "$updated_rule" &gt;&gt; "$audit_file"
                                fi
                        fi
                else
                        # $audit_file already contains the expected rule form for this
                        # architecture &amp; key =&gt; don't insert it second time
                        append_expected_rule=1
                fi
        done

        # We deleted all rules that were subset of the expected one for this arch &amp; key.
        # Also isolated rules containing system calls not from this system calls group.
        # Now append the expected rule if it's not present in $audit_file yet
        if [[ ${append_expected_rule} -eq "0" ]]
        then
                echo "$full_rule" &gt;&gt; "$audit_file"
        fi
done

}

	fix_audit_syscall_rule "auditctl" "$PATTERN" "$GROUP" "$ARCH" "$FULL_RULE"
done
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_fchmodat" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_fchmodat" id="guide-tree-leaf-idm45561208411984" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.5.5"><td style="padding-left: 76px"><h4>Record Events that Modify the System's Discretionary Access Controls - fchmodat<span class="label label-default pull-right">rule</span></h4><p>At a minimum the audit system should collect file
permission changes for all users and root. Add the following to
<code>/etc/audit/audit.rules</code>:
<pre>-a always,exit -F arch=b32 -S fchmodat -F auid&gt;=500 -F auid!=4294967295 -k perm_mod</pre>
If the system is 64 bit then also add the following:
<pre>-a always,exit -F arch=b64 -S fchmodat -F auid&gt;=500 -F auid!=4294967295 -k perm_mod</pre>
</p><div class="panel panel-warning"><div class="panel-heading"><span class="label label-warning">warning</span> 
                            Note that these rules can be configured in a
number of ways while still achieving the desired effect.  Here the system calls
have been placed independent of other system calls.  Grouping these system
calls with others as identifying earlier in this guide is more efficient.
</div></div><span class="label label-primary">Rationale:</span><p>The changing of file permissions could indicate that a user is attempting to
gain access to information that would otherwise be disallowed. Auditing DAC modifications
can facilitate the identification of patterns of abuse among both authorized and
unauthorized users.</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-3(10)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-1(b)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(a)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(d)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12(a)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IR-5</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">126</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-10.5.5</a></p></div><span class="label label-success">Remediation script:</span><pre><code>

# Perform the remediation for the syscall rule
# Retrieve hardware architecture of the underlying system
[ $(getconf LONG_BIT) = "32" ] &amp;&amp; RULE_ARCHS=("b32") || RULE_ARCHS=("b32" "b64")

for ARCH in "${RULE_ARCHS[@]}"
do
	PATTERN="-a always,exit -F arch=$ARCH -S .* -F auid&gt;=500 -F auid!=4294967295 -k *"
	GROUP="chmod"
	FULL_RULE="-a always,exit -F arch=$ARCH -S chmod -S fchmod -S fchmodat -F auid&gt;=500 -F auid!=4294967295 -k perm_mod"

function fix_audit_syscall_rule {

# Load function arguments into local variables
local tool="$1"
local pattern="$2"
local group="$3"
local arch="$4"
local full_rule="$5"

# Check sanity of the input
if [ $# -ne "5" ]
then
        echo "Usage: fix_audit_syscall_rule 'tool' 'pattern' 'group' 'arch' 'full rule'"
        echo "Aborting."
        exit 1
fi

# Create a list of audit *.rules files that should be inspected for presence and correctness
# of a particular audit rule. The scheme is as follows:
#
# -----------------------------------------------------------------------------------------
#  Tool used to load audit rules | Rule already defined  |  Audit rules file to inspect    |
# -----------------------------------------------------------------------------------------
#        auditctl                |     Doesn't matter    |  /etc/audit/audit.rules         |
# -----------------------------------------------------------------------------------------
#        augenrules              |          Yes          |  /etc/audit/rules.d/*.rules     |
#        augenrules              |          No           |  /etc/audit/rules.d/$key.rules  |
# -----------------------------------------------------------------------------------------
#
declare -a files_to_inspect

# First check sanity of the specified audit tool
if [ "$tool" != 'auditctl' ] &amp;&amp; [ "$tool" != 'augenrules' ]
then
        echo "Unknown audit rules loading tool: $1. Aborting."
        echo "Use either 'auditctl' or 'augenrules'!"
        exit 1
# If audit tool is 'auditctl', then add '/etc/audit/audit.rules'
# file to the list of files to be inspected
elif [ "$tool" == 'auditctl' ]
then
        files_to_inspect=("${files_to_inspect[@]}" '/etc/audit/audit.rules' )
# If audit tool is 'augenrules', then check if the audit rule is defined
# If rule is defined, add '/etc/audit/rules.d/*.rules' to the list for inspection
# If rule isn't defined yet, add '/etc/audit/rules.d/$key.rules' to the list for inspection
elif [ "$tool" == 'augenrules' ]
then
        # Extract audit $key from audit rule so we can use it later
        key=$(expr "$full_rule" : '.*-k[[:space:]]\([^[:space:]]\+\)')
        # Check if particular audit rule is already defined
        IFS=$'\n' matches=($(sed -s -n -e "/${pattern}/!d" -e "/${arch}/!d" -e "/${group}/!d;F" /etc/audit/rules.d/*.rules))
        # Reset IFS back to default
        unset $IFS
        for match in "${matches[@]}"
        do
                files_to_inspect=("${files_to_inspect[@]}" "${match}")
        done
        # Case when particular rule isn't defined in /etc/audit/rules.d/*.rules yet
        if [ ${#files_to_inspect[@]} -eq "0" ]
        then
                files_to_inspect="/etc/audit/rules.d/$key.rules"
                if [ ! -e "$files_to_inspect" ]
                then
                        touch "$files_to_inspect"
                        chmod 0640 "$files_to_inspect"
                fi
        fi
fi

#
# Indicator that we want to append $full_rule into $audit_file by default
local append_expected_rule=0

for audit_file in "${files_to_inspect[@]}"
do

        # Filter existing $audit_file rules' definitions to select those that:
        # * follow the rule pattern, and
        # * meet the hardware architecture requirement, and
        # * are current syscall group specific
        IFS=$'\n' existing_rules=($(sed -e "/${pattern}/!d" -e "/${arch}/!d" -e "/${group}/!d"  "$audit_file"))
        # Reset IFS back to default
        unset $IFS

        # Process rules found case-by-case
        for rule in "${existing_rules[@]}"
        do
                # Found rule is for same arch &amp; key, but differs (e.g. in count of -S arguments)
                if [ "${rule}" != "${full_rule}" ]
                then
                        # If so, isolate just '(-S \w)+' substring of that rule
                        rule_syscalls=$(echo $rule | grep -o -P '(-S \w+ )+')
                        # Check if list of '-S syscall' arguments of that rule is subset
                        # of '-S syscall' list of expected $full_rule
                        if grep -q -- "$rule_syscalls" &lt;&lt;&lt; "$full_rule"
                        then
                                # Rule is covered (i.e. the list of -S syscalls for this rule is
                                # subset of -S syscalls of $full_rule =&gt; existing rule can be deleted
                                # Thus delete the rule from audit.rules &amp; our array
                                sed -i -e "/$rule/d" "$audit_file"
                                existing_rules=("${existing_rules[@]//$rule/}")
                        else
                                # Rule isn't covered by $full_rule - it besides -S syscall arguments
                                # for this group contains also -S syscall arguments for other syscall
                                # group. Example: '-S lchown -S fchmod -S fchownat' =&gt; group='chown'
                                # since 'lchown' &amp; 'fchownat' share 'chown' substring
                                # Therefore:
                                # * 1) delete the original rule from audit.rules
                                # (original '-S lchown -S fchmod -S fchownat' rule would be deleted)
                                # * 2) delete the -S syscall arguments for this syscall group, but
                                # keep those not belonging to this syscall group
                                # (original '-S lchown -S fchmod -S fchownat' would become '-S fchmod'
                                # * 3) append the modified (filtered) rule again into audit.rules
                                # if the same rule not already present
                                #
                                # 1) Delete the original rule
                                sed -i -e "/$rule/d" "$audit_file"
                                # 2) Delete syscalls for this group, but keep those from other groups
                                # Convert current rule syscall's string into array splitting by '-S' delimiter
                                IFS=$'-S' read -a rule_syscalls_as_array &lt;&lt;&lt; "$rule_syscalls"
                                # Reset IFS back to default
                                unset $IFS
                                # Declare new empty string to hold '-S syscall' arguments from other groups
                                new_syscalls_for_rule=''
                                # Walk through existing '-S syscall' arguments
                                for syscall_arg in "${rule_syscalls_as_array[@]}"
                                do
                                        # Skip empty $syscall_arg values
                                        if [ "$syscall_arg" == '' ]
                                        then
                                                continue
                                        fi
                                        # If the '-S syscall' doesn't belong to current group add it to the new list
                                        # (together with adding '-S' delimiter back for each of such item found)
                                        if grep -q -v -- "$group" &lt;&lt;&lt; "$syscall_arg"
                                        then
                                                new_syscalls_for_rule="$new_syscalls_for_rule -S $syscall_arg"
                                        fi
                                done
                                # Replace original '-S syscall' list with the new one for this rule
                                updated_rule=${rule//$rule_syscalls/$new_syscalls_for_rule}
                                # Squeeze repeated whitespace characters in rule definition (if any) into one
                                updated_rule=$(echo "$updated_rule" | tr -s '[:space:]')
                                # 3) Append the modified / filtered rule again into audit.rules
                                #    (but only in case it's not present yet to prevent duplicate definitions)
                                if ! grep -q -- "$updated_rule" "$audit_file"
                                then
                                        echo "$updated_rule" &gt;&gt; "$audit_file"
                                fi
                        fi
                else
                        # $audit_file already contains the expected rule form for this
                        # architecture &amp; key =&gt; don't insert it second time
                        append_expected_rule=1
                fi
        done

        # We deleted all rules that were subset of the expected one for this arch &amp; key.
        # Also isolated rules containing system calls not from this system calls group.
        # Now append the expected rule if it's not present in $audit_file yet
        if [[ ${append_expected_rule} -eq "0" ]]
        then
                echo "$full_rule" &gt;&gt; "$audit_file"
        fi
done

}

	fix_audit_syscall_rule "auditctl" "$PATTERN" "$GROUP" "$ARCH" "$FULL_RULE"
done
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_fchown" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_fchown" id="guide-tree-leaf-idm45561208390848" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.5.5"><td style="padding-left: 76px"><h4>Record Events that Modify the System's Discretionary Access Controls - fchown<span class="label label-default pull-right">rule</span></h4><p>At a minimum the audit system should collect file
permission changes for all users and root. Add the following to
<code>/etc/audit/audit.rules</code>:
<pre>-a always,exit -F arch=b32 -S fchown -F auid&gt;=500 -F auid!=4294967295 -k perm_mod</pre>
If the system is 64 bit then also add the following:
<pre>-a always,exit -F arch=b64 -S fchown -F auid&gt;=500 -F auid!=4294967295 -k perm_mod</pre>
</p><div class="panel panel-warning"><div class="panel-heading"><span class="label label-warning">warning</span> 
                            Note that these rules can be configured in a
number of ways while still achieving the desired effect.  Here the system calls
have been placed independent of other system calls.  Grouping these system
calls with others as identifying earlier in this guide is more efficient.
</div></div><span class="label label-primary">Rationale:</span><p>The changing of file permissions could indicate that a user is attempting to
gain access to information that would otherwise be disallowed. Auditing DAC modifications
can facilitate the identification of patterns of abuse among both authorized and
unauthorized users.</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-3(10)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-1(b)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(a)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(d)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12(a)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IR-5</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">126</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-10.5.5</a></p></div><span class="label label-success">Remediation script:</span><pre><code>

# Perform the remediation for the syscall rule
# Retrieve hardware architecture of the underlying system
[ $(getconf LONG_BIT) = "32" ] &amp;&amp; RULE_ARCHS=("b32") || RULE_ARCHS=("b32" "b64")

for ARCH in ${RULE_ARCHS[@]}
do
	PATTERN="-a always,exit -F arch=$ARCH -S .* -F auid&gt;=500 -F auid!=4294967295 -k *"
	GROUP="chown"
	FULL_RULE="-a always,exit -F arch=$ARCH -S chown -S fchown -S fchownat -S lchown -F auid&gt;=500 -F auid!=4294967295 -k perm_mod"

function fix_audit_syscall_rule {

# Load function arguments into local variables
local tool="$1"
local pattern="$2"
local group="$3"
local arch="$4"
local full_rule="$5"

# Check sanity of the input
if [ $# -ne "5" ]
then
        echo "Usage: fix_audit_syscall_rule 'tool' 'pattern' 'group' 'arch' 'full rule'"
        echo "Aborting."
        exit 1
fi

# Create a list of audit *.rules files that should be inspected for presence and correctness
# of a particular audit rule. The scheme is as follows:
#
# -----------------------------------------------------------------------------------------
#  Tool used to load audit rules | Rule already defined  |  Audit rules file to inspect    |
# -----------------------------------------------------------------------------------------
#        auditctl                |     Doesn't matter    |  /etc/audit/audit.rules         |
# -----------------------------------------------------------------------------------------
#        augenrules              |          Yes          |  /etc/audit/rules.d/*.rules     |
#        augenrules              |          No           |  /etc/audit/rules.d/$key.rules  |
# -----------------------------------------------------------------------------------------
#
declare -a files_to_inspect

# First check sanity of the specified audit tool
if [ "$tool" != 'auditctl' ] &amp;&amp; [ "$tool" != 'augenrules' ]
then
        echo "Unknown audit rules loading tool: $1. Aborting."
        echo "Use either 'auditctl' or 'augenrules'!"
        exit 1
# If audit tool is 'auditctl', then add '/etc/audit/audit.rules'
# file to the list of files to be inspected
elif [ "$tool" == 'auditctl' ]
then
        files_to_inspect=("${files_to_inspect[@]}" '/etc/audit/audit.rules' )
# If audit tool is 'augenrules', then check if the audit rule is defined
# If rule is defined, add '/etc/audit/rules.d/*.rules' to the list for inspection
# If rule isn't defined yet, add '/etc/audit/rules.d/$key.rules' to the list for inspection
elif [ "$tool" == 'augenrules' ]
then
        # Extract audit $key from audit rule so we can use it later
        key=$(expr "$full_rule" : '.*-k[[:space:]]\([^[:space:]]\+\)')
        # Check if particular audit rule is already defined
        IFS=$'\n' matches=($(sed -s -n -e "/${pattern}/!d" -e "/${arch}/!d" -e "/${group}/!d;F" /etc/audit/rules.d/*.rules))
        # Reset IFS back to default
        unset $IFS
        for match in "${matches[@]}"
        do
                files_to_inspect=("${files_to_inspect[@]}" "${match}")
        done
        # Case when particular rule isn't defined in /etc/audit/rules.d/*.rules yet
        if [ ${#files_to_inspect[@]} -eq "0" ]
        then
                files_to_inspect="/etc/audit/rules.d/$key.rules"
                if [ ! -e "$files_to_inspect" ]
                then
                        touch "$files_to_inspect"
                        chmod 0640 "$files_to_inspect"
                fi
        fi
fi

#
# Indicator that we want to append $full_rule into $audit_file by default
local append_expected_rule=0

for audit_file in "${files_to_inspect[@]}"
do

        # Filter existing $audit_file rules' definitions to select those that:
        # * follow the rule pattern, and
        # * meet the hardware architecture requirement, and
        # * are current syscall group specific
        IFS=$'\n' existing_rules=($(sed -e "/${pattern}/!d" -e "/${arch}/!d" -e "/${group}/!d"  "$audit_file"))
        # Reset IFS back to default
        unset $IFS

        # Process rules found case-by-case
        for rule in "${existing_rules[@]}"
        do
                # Found rule is for same arch &amp; key, but differs (e.g. in count of -S arguments)
                if [ "${rule}" != "${full_rule}" ]
                then
                        # If so, isolate just '(-S \w)+' substring of that rule
                        rule_syscalls=$(echo $rule | grep -o -P '(-S \w+ )+')
                        # Check if list of '-S syscall' arguments of that rule is subset
                        # of '-S syscall' list of expected $full_rule
                        if grep -q -- "$rule_syscalls" &lt;&lt;&lt; "$full_rule"
                        then
                                # Rule is covered (i.e. the list of -S syscalls for this rule is
                                # subset of -S syscalls of $full_rule =&gt; existing rule can be deleted
                                # Thus delete the rule from audit.rules &amp; our array
                                sed -i -e "/$rule/d" "$audit_file"
                                existing_rules=("${existing_rules[@]//$rule/}")
                        else
                                # Rule isn't covered by $full_rule - it besides -S syscall arguments
                                # for this group contains also -S syscall arguments for other syscall
                                # group. Example: '-S lchown -S fchmod -S fchownat' =&gt; group='chown'
                                # since 'lchown' &amp; 'fchownat' share 'chown' substring
                                # Therefore:
                                # * 1) delete the original rule from audit.rules
                                # (original '-S lchown -S fchmod -S fchownat' rule would be deleted)
                                # * 2) delete the -S syscall arguments for this syscall group, but
                                # keep those not belonging to this syscall group
                                # (original '-S lchown -S fchmod -S fchownat' would become '-S fchmod'
                                # * 3) append the modified (filtered) rule again into audit.rules
                                # if the same rule not already present
                                #
                                # 1) Delete the original rule
                                sed -i -e "/$rule/d" "$audit_file"
                                # 2) Delete syscalls for this group, but keep those from other groups
                                # Convert current rule syscall's string into array splitting by '-S' delimiter
                                IFS=$'-S' read -a rule_syscalls_as_array &lt;&lt;&lt; "$rule_syscalls"
                                # Reset IFS back to default
                                unset $IFS
                                # Declare new empty string to hold '-S syscall' arguments from other groups
                                new_syscalls_for_rule=''
                                # Walk through existing '-S syscall' arguments
                                for syscall_arg in "${rule_syscalls_as_array[@]}"
                                do
                                        # Skip empty $syscall_arg values
                                        if [ "$syscall_arg" == '' ]
                                        then
                                                continue
                                        fi
                                        # If the '-S syscall' doesn't belong to current group add it to the new list
                                        # (together with adding '-S' delimiter back for each of such item found)
                                        if grep -q -v -- "$group" &lt;&lt;&lt; "$syscall_arg"
                                        then
                                                new_syscalls_for_rule="$new_syscalls_for_rule -S $syscall_arg"
                                        fi
                                done
                                # Replace original '-S syscall' list with the new one for this rule
                                updated_rule=${rule//$rule_syscalls/$new_syscalls_for_rule}
                                # Squeeze repeated whitespace characters in rule definition (if any) into one
                                updated_rule=$(echo "$updated_rule" | tr -s '[:space:]')
                                # 3) Append the modified / filtered rule again into audit.rules
                                #    (but only in case it's not present yet to prevent duplicate definitions)
                                if ! grep -q -- "$updated_rule" "$audit_file"
                                then
                                        echo "$updated_rule" &gt;&gt; "$audit_file"
                                fi
                        fi
                else
                        # $audit_file already contains the expected rule form for this
                        # architecture &amp; key =&gt; don't insert it second time
                        append_expected_rule=1
                fi
        done

        # We deleted all rules that were subset of the expected one for this arch &amp; key.
        # Also isolated rules containing system calls not from this system calls group.
        # Now append the expected rule if it's not present in $audit_file yet
        if [[ ${append_expected_rule} -eq "0" ]]
        then
                echo "$full_rule" &gt;&gt; "$audit_file"
        fi
done

}

	fix_audit_syscall_rule "auditctl" "$PATTERN" "$GROUP" "$ARCH" "$FULL_RULE"
done
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_fchownat" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_fchownat" id="guide-tree-leaf-idm45561208369696" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.5.5"><td style="padding-left: 76px"><h4>Record Events that Modify the System's Discretionary Access Controls - fchownat<span class="label label-default pull-right">rule</span></h4><p>At a minimum the audit system should collect file
permission changes for all users and root. Add the following to
<code>/etc/audit/audit.rules</code>:
<pre>-a always,exit -F arch=b32 -S fchownat -F auid&gt;=500 -F auid!=4294967295 -k perm_mod</pre>
If the system is 64 bit then also add the following:
<pre>-a always,exit -F arch=b64 -S fchownat -F auid&gt;=500 -F auid!=4294967295 -k perm_mod</pre>
</p><div class="panel panel-warning"><div class="panel-heading"><span class="label label-warning">warning</span> 
                            Note that these rules can be configured in a
number of ways while still achieving the desired effect.  Here the system calls
have been placed independent of other system calls.  Grouping these system
calls with others as identifying earlier in this guide is more efficient.
</div></div><span class="label label-primary">Rationale:</span><p>The changing of file permissions could indicate that a user is attempting to
gain access to information that would otherwise be disallowed. Auditing DAC modifications
can facilitate the identification of patterns of abuse among both authorized and
unauthorized users.</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-3(10)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-1(b)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(a)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(d)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12(a)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IR-5</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">126</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-10.5.5</a></p></div><span class="label label-success">Remediation script:</span><pre><code>

# Perform the remediation for the syscall rule
# Retrieve hardware architecture of the underlying system
[ $(getconf LONG_BIT) = "32" ] &amp;&amp; RULE_ARCHS=("b32") || RULE_ARCHS=("b32" "b64")

for ARCH in ${RULE_ARCHS[@]}
do
	PATTERN="-a always,exit -F arch=$ARCH -S .* -F auid&gt;=500 -F auid!=4294967295 -k *"
	GROUP="chown"
	FULL_RULE="-a always,exit -F arch=$ARCH -S chown -S fchown -S fchownat -S lchown -F auid&gt;=500 -F auid!=4294967295 -k perm_mod"

function fix_audit_syscall_rule {

# Load function arguments into local variables
local tool="$1"
local pattern="$2"
local group="$3"
local arch="$4"
local full_rule="$5"

# Check sanity of the input
if [ $# -ne "5" ]
then
        echo "Usage: fix_audit_syscall_rule 'tool' 'pattern' 'group' 'arch' 'full rule'"
        echo "Aborting."
        exit 1
fi

# Create a list of audit *.rules files that should be inspected for presence and correctness
# of a particular audit rule. The scheme is as follows:
#
# -----------------------------------------------------------------------------------------
#  Tool used to load audit rules | Rule already defined  |  Audit rules file to inspect    |
# -----------------------------------------------------------------------------------------
#        auditctl                |     Doesn't matter    |  /etc/audit/audit.rules         |
# -----------------------------------------------------------------------------------------
#        augenrules              |          Yes          |  /etc/audit/rules.d/*.rules     |
#        augenrules              |          No           |  /etc/audit/rules.d/$key.rules  |
# -----------------------------------------------------------------------------------------
#
declare -a files_to_inspect

# First check sanity of the specified audit tool
if [ "$tool" != 'auditctl' ] &amp;&amp; [ "$tool" != 'augenrules' ]
then
        echo "Unknown audit rules loading tool: $1. Aborting."
        echo "Use either 'auditctl' or 'augenrules'!"
        exit 1
# If audit tool is 'auditctl', then add '/etc/audit/audit.rules'
# file to the list of files to be inspected
elif [ "$tool" == 'auditctl' ]
then
        files_to_inspect=("${files_to_inspect[@]}" '/etc/audit/audit.rules' )
# If audit tool is 'augenrules', then check if the audit rule is defined
# If rule is defined, add '/etc/audit/rules.d/*.rules' to the list for inspection
# If rule isn't defined yet, add '/etc/audit/rules.d/$key.rules' to the list for inspection
elif [ "$tool" == 'augenrules' ]
then
        # Extract audit $key from audit rule so we can use it later
        key=$(expr "$full_rule" : '.*-k[[:space:]]\([^[:space:]]\+\)')
        # Check if particular audit rule is already defined
        IFS=$'\n' matches=($(sed -s -n -e "/${pattern}/!d" -e "/${arch}/!d" -e "/${group}/!d;F" /etc/audit/rules.d/*.rules))
        # Reset IFS back to default
        unset $IFS
        for match in "${matches[@]}"
        do
                files_to_inspect=("${files_to_inspect[@]}" "${match}")
        done
        # Case when particular rule isn't defined in /etc/audit/rules.d/*.rules yet
        if [ ${#files_to_inspect[@]} -eq "0" ]
        then
                files_to_inspect="/etc/audit/rules.d/$key.rules"
                if [ ! -e "$files_to_inspect" ]
                then
                        touch "$files_to_inspect"
                        chmod 0640 "$files_to_inspect"
                fi
        fi
fi

#
# Indicator that we want to append $full_rule into $audit_file by default
local append_expected_rule=0

for audit_file in "${files_to_inspect[@]}"
do

        # Filter existing $audit_file rules' definitions to select those that:
        # * follow the rule pattern, and
        # * meet the hardware architecture requirement, and
        # * are current syscall group specific
        IFS=$'\n' existing_rules=($(sed -e "/${pattern}/!d" -e "/${arch}/!d" -e "/${group}/!d"  "$audit_file"))
        # Reset IFS back to default
        unset $IFS

        # Process rules found case-by-case
        for rule in "${existing_rules[@]}"
        do
                # Found rule is for same arch &amp; key, but differs (e.g. in count of -S arguments)
                if [ "${rule}" != "${full_rule}" ]
                then
                        # If so, isolate just '(-S \w)+' substring of that rule
                        rule_syscalls=$(echo $rule | grep -o -P '(-S \w+ )+')
                        # Check if list of '-S syscall' arguments of that rule is subset
                        # of '-S syscall' list of expected $full_rule
                        if grep -q -- "$rule_syscalls" &lt;&lt;&lt; "$full_rule"
                        then
                                # Rule is covered (i.e. the list of -S syscalls for this rule is
                                # subset of -S syscalls of $full_rule =&gt; existing rule can be deleted
                                # Thus delete the rule from audit.rules &amp; our array
                                sed -i -e "/$rule/d" "$audit_file"
                                existing_rules=("${existing_rules[@]//$rule/}")
                        else
                                # Rule isn't covered by $full_rule - it besides -S syscall arguments
                                # for this group contains also -S syscall arguments for other syscall
                                # group. Example: '-S lchown -S fchmod -S fchownat' =&gt; group='chown'
                                # since 'lchown' &amp; 'fchownat' share 'chown' substring
                                # Therefore:
                                # * 1) delete the original rule from audit.rules
                                # (original '-S lchown -S fchmod -S fchownat' rule would be deleted)
                                # * 2) delete the -S syscall arguments for this syscall group, but
                                # keep those not belonging to this syscall group
                                # (original '-S lchown -S fchmod -S fchownat' would become '-S fchmod'
                                # * 3) append the modified (filtered) rule again into audit.rules
                                # if the same rule not already present
                                #
                                # 1) Delete the original rule
                                sed -i -e "/$rule/d" "$audit_file"
                                # 2) Delete syscalls for this group, but keep those from other groups
                                # Convert current rule syscall's string into array splitting by '-S' delimiter
                                IFS=$'-S' read -a rule_syscalls_as_array &lt;&lt;&lt; "$rule_syscalls"
                                # Reset IFS back to default
                                unset $IFS
                                # Declare new empty string to hold '-S syscall' arguments from other groups
                                new_syscalls_for_rule=''
                                # Walk through existing '-S syscall' arguments
                                for syscall_arg in "${rule_syscalls_as_array[@]}"
                                do
                                        # Skip empty $syscall_arg values
                                        if [ "$syscall_arg" == '' ]
                                        then
                                                continue
                                        fi
                                        # If the '-S syscall' doesn't belong to current group add it to the new list
                                        # (together with adding '-S' delimiter back for each of such item found)
                                        if grep -q -v -- "$group" &lt;&lt;&lt; "$syscall_arg"
                                        then
                                                new_syscalls_for_rule="$new_syscalls_for_rule -S $syscall_arg"
                                        fi
                                done
                                # Replace original '-S syscall' list with the new one for this rule
                                updated_rule=${rule//$rule_syscalls/$new_syscalls_for_rule}
                                # Squeeze repeated whitespace characters in rule definition (if any) into one
                                updated_rule=$(echo "$updated_rule" | tr -s '[:space:]')
                                # 3) Append the modified / filtered rule again into audit.rules
                                #    (but only in case it's not present yet to prevent duplicate definitions)
                                if ! grep -q -- "$updated_rule" "$audit_file"
                                then
                                        echo "$updated_rule" &gt;&gt; "$audit_file"
                                fi
                        fi
                else
                        # $audit_file already contains the expected rule form for this
                        # architecture &amp; key =&gt; don't insert it second time
                        append_expected_rule=1
                fi
        done

        # We deleted all rules that were subset of the expected one for this arch &amp; key.
        # Also isolated rules containing system calls not from this system calls group.
        # Now append the expected rule if it's not present in $audit_file yet
        if [[ ${append_expected_rule} -eq "0" ]]
        then
                echo "$full_rule" &gt;&gt; "$audit_file"
        fi
done

}

	fix_audit_syscall_rule "auditctl" "$PATTERN" "$GROUP" "$ARCH" "$FULL_RULE"
done
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_fremovexattr" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_fremovexattr" id="guide-tree-leaf-idm45561208348544" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.5.5"><td style="padding-left: 76px"><h4>Record Events that Modify the System's Discretionary Access Controls - fremovexattr<span class="label label-default pull-right">rule</span></h4><p>At a minimum the audit system should collect file
permission changes for all users and root. Add the following to
<code>/etc/audit/audit.rules</code>:
<pre>-a always,exit -F arch=b32 -S fremovexattr -F auid&gt;=500 -F auid!=4294967295 -k perm_mod</pre>
If the system is 64 bit then also add the following:
<pre>-a always,exit -F arch=b64 -S fremovexattr -F auid&gt;=500 -F auid!=4294967295 -k perm_mod</pre>
</p><div class="panel panel-warning"><div class="panel-heading"><span class="label label-warning">warning</span> 
                            Note that these rules can be configured in a
number of ways while still achieving the desired effect.  Here the system calls
have been placed independent of other system calls.  Grouping these system
calls with others as identifying earlier in this guide is more efficient.
</div></div><span class="label label-primary">Rationale:</span><p>The changing of file permissions could indicate that a user is attempting to
gain access to information that would otherwise be disallowed. Auditing DAC modifications
can facilitate the identification of patterns of abuse among both authorized and
unauthorized users.</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-3(10)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-1(b)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(a)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(d)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12(a)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IR-5</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">126</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-10.5.5</a></p></div><span class="label label-success">Remediation script:</span><pre><code>

# Perform the remediation for the syscall rule
# Retrieve hardware architecture of the underlying system
[ $(getconf LONG_BIT) = "32" ] &amp;&amp; RULE_ARCHS=("b32") || RULE_ARCHS=("b32" "b64")

for ARCH in "${RULE_ARCHS[@]}"
do
	PATTERN="-a always,exit .* -F auid&gt;=500 -F auid!=4294967295 -k *"
	GROUP="xattr"
	FULL_RULE="-a always,exit -F arch=${ARCH} -S setxattr -S lsetxattr -S fsetxattr -S removexattr -S lremovexattr -S fremovexattr -F auid&gt;=500 -F auid!=4294967295 -k perm_mod"

function fix_audit_syscall_rule {

# Load function arguments into local variables
local tool="$1"
local pattern="$2"
local group="$3"
local arch="$4"
local full_rule="$5"

# Check sanity of the input
if [ $# -ne "5" ]
then
        echo "Usage: fix_audit_syscall_rule 'tool' 'pattern' 'group' 'arch' 'full rule'"
        echo "Aborting."
        exit 1
fi

# Create a list of audit *.rules files that should be inspected for presence and correctness
# of a particular audit rule. The scheme is as follows:
#
# -----------------------------------------------------------------------------------------
#  Tool used to load audit rules | Rule already defined  |  Audit rules file to inspect    |
# -----------------------------------------------------------------------------------------
#        auditctl                |     Doesn't matter    |  /etc/audit/audit.rules         |
# -----------------------------------------------------------------------------------------
#        augenrules              |          Yes          |  /etc/audit/rules.d/*.rules     |
#        augenrules              |          No           |  /etc/audit/rules.d/$key.rules  |
# -----------------------------------------------------------------------------------------
#
declare -a files_to_inspect

# First check sanity of the specified audit tool
if [ "$tool" != 'auditctl' ] &amp;&amp; [ "$tool" != 'augenrules' ]
then
        echo "Unknown audit rules loading tool: $1. Aborting."
        echo "Use either 'auditctl' or 'augenrules'!"
        exit 1
# If audit tool is 'auditctl', then add '/etc/audit/audit.rules'
# file to the list of files to be inspected
elif [ "$tool" == 'auditctl' ]
then
        files_to_inspect=("${files_to_inspect[@]}" '/etc/audit/audit.rules' )
# If audit tool is 'augenrules', then check if the audit rule is defined
# If rule is defined, add '/etc/audit/rules.d/*.rules' to the list for inspection
# If rule isn't defined yet, add '/etc/audit/rules.d/$key.rules' to the list for inspection
elif [ "$tool" == 'augenrules' ]
then
        # Extract audit $key from audit rule so we can use it later
        key=$(expr "$full_rule" : '.*-k[[:space:]]\([^[:space:]]\+\)')
        # Check if particular audit rule is already defined
        IFS=$'\n' matches=($(sed -s -n -e "/${pattern}/!d" -e "/${arch}/!d" -e "/${group}/!d;F" /etc/audit/rules.d/*.rules))
        # Reset IFS back to default
        unset $IFS
        for match in "${matches[@]}"
        do
                files_to_inspect=("${files_to_inspect[@]}" "${match}")
        done
        # Case when particular rule isn't defined in /etc/audit/rules.d/*.rules yet
        if [ ${#files_to_inspect[@]} -eq "0" ]
        then
                files_to_inspect="/etc/audit/rules.d/$key.rules"
                if [ ! -e "$files_to_inspect" ]
                then
                        touch "$files_to_inspect"
                        chmod 0640 "$files_to_inspect"
                fi
        fi
fi

#
# Indicator that we want to append $full_rule into $audit_file by default
local append_expected_rule=0

for audit_file in "${files_to_inspect[@]}"
do

        # Filter existing $audit_file rules' definitions to select those that:
        # * follow the rule pattern, and
        # * meet the hardware architecture requirement, and
        # * are current syscall group specific
        IFS=$'\n' existing_rules=($(sed -e "/${pattern}/!d" -e "/${arch}/!d" -e "/${group}/!d"  "$audit_file"))
        # Reset IFS back to default
        unset $IFS

        # Process rules found case-by-case
        for rule in "${existing_rules[@]}"
        do
                # Found rule is for same arch &amp; key, but differs (e.g. in count of -S arguments)
                if [ "${rule}" != "${full_rule}" ]
                then
                        # If so, isolate just '(-S \w)+' substring of that rule
                        rule_syscalls=$(echo $rule | grep -o -P '(-S \w+ )+')
                        # Check if list of '-S syscall' arguments of that rule is subset
                        # of '-S syscall' list of expected $full_rule
                        if grep -q -- "$rule_syscalls" &lt;&lt;&lt; "$full_rule"
                        then
                                # Rule is covered (i.e. the list of -S syscalls for this rule is
                                # subset of -S syscalls of $full_rule =&gt; existing rule can be deleted
                                # Thus delete the rule from audit.rules &amp; our array
                                sed -i -e "/$rule/d" "$audit_file"
                                existing_rules=("${existing_rules[@]//$rule/}")
                        else
                                # Rule isn't covered by $full_rule - it besides -S syscall arguments
                                # for this group contains also -S syscall arguments for other syscall
                                # group. Example: '-S lchown -S fchmod -S fchownat' =&gt; group='chown'
                                # since 'lchown' &amp; 'fchownat' share 'chown' substring
                                # Therefore:
                                # * 1) delete the original rule from audit.rules
                                # (original '-S lchown -S fchmod -S fchownat' rule would be deleted)
                                # * 2) delete the -S syscall arguments for this syscall group, but
                                # keep those not belonging to this syscall group
                                # (original '-S lchown -S fchmod -S fchownat' would become '-S fchmod'
                                # * 3) append the modified (filtered) rule again into audit.rules
                                # if the same rule not already present
                                #
                                # 1) Delete the original rule
                                sed -i -e "/$rule/d" "$audit_file"
                                # 2) Delete syscalls for this group, but keep those from other groups
                                # Convert current rule syscall's string into array splitting by '-S' delimiter
                                IFS=$'-S' read -a rule_syscalls_as_array &lt;&lt;&lt; "$rule_syscalls"
                                # Reset IFS back to default
                                unset $IFS
                                # Declare new empty string to hold '-S syscall' arguments from other groups
                                new_syscalls_for_rule=''
                                # Walk through existing '-S syscall' arguments
                                for syscall_arg in "${rule_syscalls_as_array[@]}"
                                do
                                        # Skip empty $syscall_arg values
                                        if [ "$syscall_arg" == '' ]
                                        then
                                                continue
                                        fi
                                        # If the '-S syscall' doesn't belong to current group add it to the new list
                                        # (together with adding '-S' delimiter back for each of such item found)
                                        if grep -q -v -- "$group" &lt;&lt;&lt; "$syscall_arg"
                                        then
                                                new_syscalls_for_rule="$new_syscalls_for_rule -S $syscall_arg"
                                        fi
                                done
                                # Replace original '-S syscall' list with the new one for this rule
                                updated_rule=${rule//$rule_syscalls/$new_syscalls_for_rule}
                                # Squeeze repeated whitespace characters in rule definition (if any) into one
                                updated_rule=$(echo "$updated_rule" | tr -s '[:space:]')
                                # 3) Append the modified / filtered rule again into audit.rules
                                #    (but only in case it's not present yet to prevent duplicate definitions)
                                if ! grep -q -- "$updated_rule" "$audit_file"
                                then
                                        echo "$updated_rule" &gt;&gt; "$audit_file"
                                fi
                        fi
                else
                        # $audit_file already contains the expected rule form for this
                        # architecture &amp; key =&gt; don't insert it second time
                        append_expected_rule=1
                fi
        done

        # We deleted all rules that were subset of the expected one for this arch &amp; key.
        # Also isolated rules containing system calls not from this system calls group.
        # Now append the expected rule if it's not present in $audit_file yet
        if [[ ${append_expected_rule} -eq "0" ]]
        then
                echo "$full_rule" &gt;&gt; "$audit_file"
        fi
done

}

	fix_audit_syscall_rule "auditctl" "$PATTERN" "$GROUP" "$ARCH" "$FULL_RULE"
done
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_fsetxattr" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_fsetxattr" id="guide-tree-leaf-idm45561208327248" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.5.5"><td style="padding-left: 76px"><h4>Record Events that Modify the System's Discretionary Access Controls - fsetxattr<span class="label label-default pull-right">rule</span></h4><p>At a minimum the audit system should collect file
permission changes for all users and root. Add the following to
<code>/etc/audit/audit.rules</code>:
<pre>-a always,exit -F arch=b32 -S fsetxattr -F auid&gt;=500 -F auid!=4294967295 -k perm_mod</pre>
If the system is 64 bit then also add the following:
<pre>-a always,exit -F arch=b64 -S fsetxattr -F auid&gt;=500 -F auid!=4294967295 -k perm_mod</pre>
</p><div class="panel panel-warning"><div class="panel-heading"><span class="label label-warning">warning</span> 
                            Note that these rules can be configured in a
number of ways while still achieving the desired effect.  Here the system calls
have been placed independent of other system calls.  Grouping these system
calls with others as identifying earlier in this guide is more efficient.
</div></div><span class="label label-primary">Rationale:</span><p>The changing of file permissions could indicate that a user is attempting to
gain access to information that would otherwise be disallowed. Auditing DAC modifications
can facilitate the identification of patterns of abuse among both authorized and
unauthorized users.</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-3(10)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-1(b)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(a)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(d)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12(a)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IR-5</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">126</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-10.5.5</a></p></div><span class="label label-success">Remediation script:</span><pre><code>

# Perform the remediation for the syscall rule
# Retrieve hardware architecture of the underlying system
[ $(getconf LONG_BIT) = "32" ] &amp;&amp; RULE_ARCHS=("b32") || RULE_ARCHS=("b32" "b64")

for ARCH in "${RULE_ARCHS[@]}"
do
	PATTERN="-a always,exit .* -F auid&gt;=500 -F auid!=4294967295 -k *"
	GROUP="xattr"
	FULL_RULE="-a always,exit -F arch=${ARCH} -S setxattr -S lsetxattr -S fsetxattr -S removexattr -S lremovexattr -S fremovexattr -F auid&gt;=500 -F auid!=4294967295 -k perm_mod"

function fix_audit_syscall_rule {

# Load function arguments into local variables
local tool="$1"
local pattern="$2"
local group="$3"
local arch="$4"
local full_rule="$5"

# Check sanity of the input
if [ $# -ne "5" ]
then
        echo "Usage: fix_audit_syscall_rule 'tool' 'pattern' 'group' 'arch' 'full rule'"
        echo "Aborting."
        exit 1
fi

# Create a list of audit *.rules files that should be inspected for presence and correctness
# of a particular audit rule. The scheme is as follows:
#
# -----------------------------------------------------------------------------------------
#  Tool used to load audit rules | Rule already defined  |  Audit rules file to inspect    |
# -----------------------------------------------------------------------------------------
#        auditctl                |     Doesn't matter    |  /etc/audit/audit.rules         |
# -----------------------------------------------------------------------------------------
#        augenrules              |          Yes          |  /etc/audit/rules.d/*.rules     |
#        augenrules              |          No           |  /etc/audit/rules.d/$key.rules  |
# -----------------------------------------------------------------------------------------
#
declare -a files_to_inspect

# First check sanity of the specified audit tool
if [ "$tool" != 'auditctl' ] &amp;&amp; [ "$tool" != 'augenrules' ]
then
        echo "Unknown audit rules loading tool: $1. Aborting."
        echo "Use either 'auditctl' or 'augenrules'!"
        exit 1
# If audit tool is 'auditctl', then add '/etc/audit/audit.rules'
# file to the list of files to be inspected
elif [ "$tool" == 'auditctl' ]
then
        files_to_inspect=("${files_to_inspect[@]}" '/etc/audit/audit.rules' )
# If audit tool is 'augenrules', then check if the audit rule is defined
# If rule is defined, add '/etc/audit/rules.d/*.rules' to the list for inspection
# If rule isn't defined yet, add '/etc/audit/rules.d/$key.rules' to the list for inspection
elif [ "$tool" == 'augenrules' ]
then
        # Extract audit $key from audit rule so we can use it later
        key=$(expr "$full_rule" : '.*-k[[:space:]]\([^[:space:]]\+\)')
        # Check if particular audit rule is already defined
        IFS=$'\n' matches=($(sed -s -n -e "/${pattern}/!d" -e "/${arch}/!d" -e "/${group}/!d;F" /etc/audit/rules.d/*.rules))
        # Reset IFS back to default
        unset $IFS
        for match in "${matches[@]}"
        do
                files_to_inspect=("${files_to_inspect[@]}" "${match}")
        done
        # Case when particular rule isn't defined in /etc/audit/rules.d/*.rules yet
        if [ ${#files_to_inspect[@]} -eq "0" ]
        then
                files_to_inspect="/etc/audit/rules.d/$key.rules"
                if [ ! -e "$files_to_inspect" ]
                then
                        touch "$files_to_inspect"
                        chmod 0640 "$files_to_inspect"
                fi
        fi
fi

#
# Indicator that we want to append $full_rule into $audit_file by default
local append_expected_rule=0

for audit_file in "${files_to_inspect[@]}"
do

        # Filter existing $audit_file rules' definitions to select those that:
        # * follow the rule pattern, and
        # * meet the hardware architecture requirement, and
        # * are current syscall group specific
        IFS=$'\n' existing_rules=($(sed -e "/${pattern}/!d" -e "/${arch}/!d" -e "/${group}/!d"  "$audit_file"))
        # Reset IFS back to default
        unset $IFS

        # Process rules found case-by-case
        for rule in "${existing_rules[@]}"
        do
                # Found rule is for same arch &amp; key, but differs (e.g. in count of -S arguments)
                if [ "${rule}" != "${full_rule}" ]
                then
                        # If so, isolate just '(-S \w)+' substring of that rule
                        rule_syscalls=$(echo $rule | grep -o -P '(-S \w+ )+')
                        # Check if list of '-S syscall' arguments of that rule is subset
                        # of '-S syscall' list of expected $full_rule
                        if grep -q -- "$rule_syscalls" &lt;&lt;&lt; "$full_rule"
                        then
                                # Rule is covered (i.e. the list of -S syscalls for this rule is
                                # subset of -S syscalls of $full_rule =&gt; existing rule can be deleted
                                # Thus delete the rule from audit.rules &amp; our array
                                sed -i -e "/$rule/d" "$audit_file"
                                existing_rules=("${existing_rules[@]//$rule/}")
                        else
                                # Rule isn't covered by $full_rule - it besides -S syscall arguments
                                # for this group contains also -S syscall arguments for other syscall
                                # group. Example: '-S lchown -S fchmod -S fchownat' =&gt; group='chown'
                                # since 'lchown' &amp; 'fchownat' share 'chown' substring
                                # Therefore:
                                # * 1) delete the original rule from audit.rules
                                # (original '-S lchown -S fchmod -S fchownat' rule would be deleted)
                                # * 2) delete the -S syscall arguments for this syscall group, but
                                # keep those not belonging to this syscall group
                                # (original '-S lchown -S fchmod -S fchownat' would become '-S fchmod'
                                # * 3) append the modified (filtered) rule again into audit.rules
                                # if the same rule not already present
                                #
                                # 1) Delete the original rule
                                sed -i -e "/$rule/d" "$audit_file"
                                # 2) Delete syscalls for this group, but keep those from other groups
                                # Convert current rule syscall's string into array splitting by '-S' delimiter
                                IFS=$'-S' read -a rule_syscalls_as_array &lt;&lt;&lt; "$rule_syscalls"
                                # Reset IFS back to default
                                unset $IFS
                                # Declare new empty string to hold '-S syscall' arguments from other groups
                                new_syscalls_for_rule=''
                                # Walk through existing '-S syscall' arguments
                                for syscall_arg in "${rule_syscalls_as_array[@]}"
                                do
                                        # Skip empty $syscall_arg values
                                        if [ "$syscall_arg" == '' ]
                                        then
                                                continue
                                        fi
                                        # If the '-S syscall' doesn't belong to current group add it to the new list
                                        # (together with adding '-S' delimiter back for each of such item found)
                                        if grep -q -v -- "$group" &lt;&lt;&lt; "$syscall_arg"
                                        then
                                                new_syscalls_for_rule="$new_syscalls_for_rule -S $syscall_arg"
                                        fi
                                done
                                # Replace original '-S syscall' list with the new one for this rule
                                updated_rule=${rule//$rule_syscalls/$new_syscalls_for_rule}
                                # Squeeze repeated whitespace characters in rule definition (if any) into one
                                updated_rule=$(echo "$updated_rule" | tr -s '[:space:]')
                                # 3) Append the modified / filtered rule again into audit.rules
                                #    (but only in case it's not present yet to prevent duplicate definitions)
                                if ! grep -q -- "$updated_rule" "$audit_file"
                                then
                                        echo "$updated_rule" &gt;&gt; "$audit_file"
                                fi
                        fi
                else
                        # $audit_file already contains the expected rule form for this
                        # architecture &amp; key =&gt; don't insert it second time
                        append_expected_rule=1
                fi
        done

        # We deleted all rules that were subset of the expected one for this arch &amp; key.
        # Also isolated rules containing system calls not from this system calls group.
        # Now append the expected rule if it's not present in $audit_file yet
        if [[ ${append_expected_rule} -eq "0" ]]
        then
                echo "$full_rule" &gt;&gt; "$audit_file"
        fi
done

}

	fix_audit_syscall_rule "auditctl" "$PATTERN" "$GROUP" "$ARCH" "$FULL_RULE"
done
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_lchown" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_lchown" id="guide-tree-leaf-idm45561208305984" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.5.5"><td style="padding-left: 76px"><h4>Record Events that Modify the System's Discretionary Access Controls - lchown<span class="label label-default pull-right">rule</span></h4><p>At a minimum the audit system should collect file 
permission changes for all users and root. Add the following to
<code>/etc/audit/audit.rules</code>:
<pre>-a always,exit -F arch=b32 -S lchown -F auid&gt;=500 -F auid!=4294967295 -k perm_mod</pre>
If the system is 64 bit then also add the following:
<pre>-a always,exit -F arch=b64 -S lchown -F auid&gt;=500 -F auid!=4294967295 -k perm_mod</pre>
</p><div class="panel panel-warning"><div class="panel-heading"><span class="label label-warning">warning</span> 
                            Note that these rules can be configured in a
number of ways while still achieving the desired effect.  Here the system calls
have been placed independent of other system calls.  Grouping these system
calls with others as identifying earlier in this guide is more efficient.
</div></div><span class="label label-primary">Rationale:</span><p>The changing of file permissions could indicate that a user is attempting to
gain access to information that would otherwise be disallowed. Auditing DAC modifications
can facilitate the identification of patterns of abuse among both authorized and
unauthorized users.</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-3(10)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-1(b)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(a)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(d)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12(a)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IR-5</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">126</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-10.5.5</a></p></div><span class="label label-success">Remediation script:</span><pre><code>

# Perform the remediation for the syscall rule
# Retrieve hardware architecture of the underlying system
[ $(getconf LONG_BIT) = "32" ] &amp;&amp; RULE_ARCHS=("b32") || RULE_ARCHS=("b32" "b64")

for ARCH in ${RULE_ARCHS[@]}
do
	PATTERN="-a always,exit -F arch=$ARCH -S .* -F auid&gt;=500 -F auid!=4294967295 -k *"
	GROUP="chown"
	FULL_RULE="-a always,exit -F arch=$ARCH -S chown -S fchown -S fchownat -S lchown -F auid&gt;=500 -F auid!=4294967295 -k perm_mod"

function fix_audit_syscall_rule {

# Load function arguments into local variables
local tool="$1"
local pattern="$2"
local group="$3"
local arch="$4"
local full_rule="$5"

# Check sanity of the input
if [ $# -ne "5" ]
then
        echo "Usage: fix_audit_syscall_rule 'tool' 'pattern' 'group' 'arch' 'full rule'"
        echo "Aborting."
        exit 1
fi

# Create a list of audit *.rules files that should be inspected for presence and correctness
# of a particular audit rule. The scheme is as follows:
#
# -----------------------------------------------------------------------------------------
#  Tool used to load audit rules | Rule already defined  |  Audit rules file to inspect    |
# -----------------------------------------------------------------------------------------
#        auditctl                |     Doesn't matter    |  /etc/audit/audit.rules         |
# -----------------------------------------------------------------------------------------
#        augenrules              |          Yes          |  /etc/audit/rules.d/*.rules     |
#        augenrules              |          No           |  /etc/audit/rules.d/$key.rules  |
# -----------------------------------------------------------------------------------------
#
declare -a files_to_inspect

# First check sanity of the specified audit tool
if [ "$tool" != 'auditctl' ] &amp;&amp; [ "$tool" != 'augenrules' ]
then
        echo "Unknown audit rules loading tool: $1. Aborting."
        echo "Use either 'auditctl' or 'augenrules'!"
        exit 1
# If audit tool is 'auditctl', then add '/etc/audit/audit.rules'
# file to the list of files to be inspected
elif [ "$tool" == 'auditctl' ]
then
        files_to_inspect=("${files_to_inspect[@]}" '/etc/audit/audit.rules' )
# If audit tool is 'augenrules', then check if the audit rule is defined
# If rule is defined, add '/etc/audit/rules.d/*.rules' to the list for inspection
# If rule isn't defined yet, add '/etc/audit/rules.d/$key.rules' to the list for inspection
elif [ "$tool" == 'augenrules' ]
then
        # Extract audit $key from audit rule so we can use it later
        key=$(expr "$full_rule" : '.*-k[[:space:]]\([^[:space:]]\+\)')
        # Check if particular audit rule is already defined
        IFS=$'\n' matches=($(sed -s -n -e "/${pattern}/!d" -e "/${arch}/!d" -e "/${group}/!d;F" /etc/audit/rules.d/*.rules))
        # Reset IFS back to default
        unset $IFS
        for match in "${matches[@]}"
        do
                files_to_inspect=("${files_to_inspect[@]}" "${match}")
        done
        # Case when particular rule isn't defined in /etc/audit/rules.d/*.rules yet
        if [ ${#files_to_inspect[@]} -eq "0" ]
        then
                files_to_inspect="/etc/audit/rules.d/$key.rules"
                if [ ! -e "$files_to_inspect" ]
                then
                        touch "$files_to_inspect"
                        chmod 0640 "$files_to_inspect"
                fi
        fi
fi

#
# Indicator that we want to append $full_rule into $audit_file by default
local append_expected_rule=0

for audit_file in "${files_to_inspect[@]}"
do

        # Filter existing $audit_file rules' definitions to select those that:
        # * follow the rule pattern, and
        # * meet the hardware architecture requirement, and
        # * are current syscall group specific
        IFS=$'\n' existing_rules=($(sed -e "/${pattern}/!d" -e "/${arch}/!d" -e "/${group}/!d"  "$audit_file"))
        # Reset IFS back to default
        unset $IFS

        # Process rules found case-by-case
        for rule in "${existing_rules[@]}"
        do
                # Found rule is for same arch &amp; key, but differs (e.g. in count of -S arguments)
                if [ "${rule}" != "${full_rule}" ]
                then
                        # If so, isolate just '(-S \w)+' substring of that rule
                        rule_syscalls=$(echo $rule | grep -o -P '(-S \w+ )+')
                        # Check if list of '-S syscall' arguments of that rule is subset
                        # of '-S syscall' list of expected $full_rule
                        if grep -q -- "$rule_syscalls" &lt;&lt;&lt; "$full_rule"
                        then
                                # Rule is covered (i.e. the list of -S syscalls for this rule is
                                # subset of -S syscalls of $full_rule =&gt; existing rule can be deleted
                                # Thus delete the rule from audit.rules &amp; our array
                                sed -i -e "/$rule/d" "$audit_file"
                                existing_rules=("${existing_rules[@]//$rule/}")
                        else
                                # Rule isn't covered by $full_rule - it besides -S syscall arguments
                                # for this group contains also -S syscall arguments for other syscall
                                # group. Example: '-S lchown -S fchmod -S fchownat' =&gt; group='chown'
                                # since 'lchown' &amp; 'fchownat' share 'chown' substring
                                # Therefore:
                                # * 1) delete the original rule from audit.rules
                                # (original '-S lchown -S fchmod -S fchownat' rule would be deleted)
                                # * 2) delete the -S syscall arguments for this syscall group, but
                                # keep those not belonging to this syscall group
                                # (original '-S lchown -S fchmod -S fchownat' would become '-S fchmod'
                                # * 3) append the modified (filtered) rule again into audit.rules
                                # if the same rule not already present
                                #
                                # 1) Delete the original rule
                                sed -i -e "/$rule/d" "$audit_file"
                                # 2) Delete syscalls for this group, but keep those from other groups
                                # Convert current rule syscall's string into array splitting by '-S' delimiter
                                IFS=$'-S' read -a rule_syscalls_as_array &lt;&lt;&lt; "$rule_syscalls"
                                # Reset IFS back to default
                                unset $IFS
                                # Declare new empty string to hold '-S syscall' arguments from other groups
                                new_syscalls_for_rule=''
                                # Walk through existing '-S syscall' arguments
                                for syscall_arg in "${rule_syscalls_as_array[@]}"
                                do
                                        # Skip empty $syscall_arg values
                                        if [ "$syscall_arg" == '' ]
                                        then
                                                continue
                                        fi
                                        # If the '-S syscall' doesn't belong to current group add it to the new list
                                        # (together with adding '-S' delimiter back for each of such item found)
                                        if grep -q -v -- "$group" &lt;&lt;&lt; "$syscall_arg"
                                        then
                                                new_syscalls_for_rule="$new_syscalls_for_rule -S $syscall_arg"
                                        fi
                                done
                                # Replace original '-S syscall' list with the new one for this rule
                                updated_rule=${rule//$rule_syscalls/$new_syscalls_for_rule}
                                # Squeeze repeated whitespace characters in rule definition (if any) into one
                                updated_rule=$(echo "$updated_rule" | tr -s '[:space:]')
                                # 3) Append the modified / filtered rule again into audit.rules
                                #    (but only in case it's not present yet to prevent duplicate definitions)
                                if ! grep -q -- "$updated_rule" "$audit_file"
                                then
                                        echo "$updated_rule" &gt;&gt; "$audit_file"
                                fi
                        fi
                else
                        # $audit_file already contains the expected rule form for this
                        # architecture &amp; key =&gt; don't insert it second time
                        append_expected_rule=1
                fi
        done

        # We deleted all rules that were subset of the expected one for this arch &amp; key.
        # Also isolated rules containing system calls not from this system calls group.
        # Now append the expected rule if it's not present in $audit_file yet
        if [[ ${append_expected_rule} -eq "0" ]]
        then
                echo "$full_rule" &gt;&gt; "$audit_file"
        fi
done

}

	fix_audit_syscall_rule "auditctl" "$PATTERN" "$GROUP" "$ARCH" "$FULL_RULE"
done
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_lremovexattr" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_lremovexattr" id="guide-tree-leaf-idm45561208284832" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.5.5"><td style="padding-left: 76px"><h4>Record Events that Modify the System's Discretionary Access Controls - lremovexattr<span class="label label-default pull-right">rule</span></h4><p>At a minimum the audit system should collect file
permission changes for all users and root. Add the following to
<code>/etc/audit/audit.rules</code>:
<pre>-a always,exit -F arch=b32 -S lremovexattr -F auid&gt;=500 -F auid!=4294967295 -k perm_mod</pre>
If the system is 64 bit then also add the following:
<pre>-a always,exit -F arch=b64 -S lremovexattr -F auid&gt;=500 -F auid!=4294967295 -k perm_mod</pre>
</p><div class="panel panel-warning"><div class="panel-heading"><span class="label label-warning">warning</span> 
                            Note that these rules can be configured in a
number of ways while still achieving the desired effect.  Here the system calls
have been placed independent of other system calls.  Grouping these system
calls with others as identifying earlier in this guide is more efficient.
</div></div><span class="label label-primary">Rationale:</span><p>The changing of file permissions could indicate that a user is attempting to
gain access to information that would otherwise be disallowed. Auditing DAC modifications
can facilitate the identification of patterns of abuse among both authorized and
unauthorized users.</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-3(10)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-1(b)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(a)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(d)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12(a)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IR-5</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">126</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-10.5.5</a></p></div><span class="label label-success">Remediation script:</span><pre><code>

# Perform the remediation for the syscall rule
# Retrieve hardware architecture of the underlying system
[ $(getconf LONG_BIT) = "32" ] &amp;&amp; RULE_ARCHS=("b32") || RULE_ARCHS=("b32" "b64")

for ARCH in "${RULE_ARCHS[@]}"
do
	PATTERN="-a always,exit .* -F auid&gt;=500 -F auid!=4294967295 -k *"
	GROUP="xattr"
	FULL_RULE="-a always,exit -F arch=${ARCH} -S setxattr -S lsetxattr -S fsetxattr -S removexattr -S lremovexattr -S fremovexattr -F auid&gt;=500 -F auid!=4294967295 -k perm_mod"

function fix_audit_syscall_rule {

# Load function arguments into local variables
local tool="$1"
local pattern="$2"
local group="$3"
local arch="$4"
local full_rule="$5"

# Check sanity of the input
if [ $# -ne "5" ]
then
        echo "Usage: fix_audit_syscall_rule 'tool' 'pattern' 'group' 'arch' 'full rule'"
        echo "Aborting."
        exit 1
fi

# Create a list of audit *.rules files that should be inspected for presence and correctness
# of a particular audit rule. The scheme is as follows:
#
# -----------------------------------------------------------------------------------------
#  Tool used to load audit rules | Rule already defined  |  Audit rules file to inspect    |
# -----------------------------------------------------------------------------------------
#        auditctl                |     Doesn't matter    |  /etc/audit/audit.rules         |
# -----------------------------------------------------------------------------------------
#        augenrules              |          Yes          |  /etc/audit/rules.d/*.rules     |
#        augenrules              |          No           |  /etc/audit/rules.d/$key.rules  |
# -----------------------------------------------------------------------------------------
#
declare -a files_to_inspect

# First check sanity of the specified audit tool
if [ "$tool" != 'auditctl' ] &amp;&amp; [ "$tool" != 'augenrules' ]
then
        echo "Unknown audit rules loading tool: $1. Aborting."
        echo "Use either 'auditctl' or 'augenrules'!"
        exit 1
# If audit tool is 'auditctl', then add '/etc/audit/audit.rules'
# file to the list of files to be inspected
elif [ "$tool" == 'auditctl' ]
then
        files_to_inspect=("${files_to_inspect[@]}" '/etc/audit/audit.rules' )
# If audit tool is 'augenrules', then check if the audit rule is defined
# If rule is defined, add '/etc/audit/rules.d/*.rules' to the list for inspection
# If rule isn't defined yet, add '/etc/audit/rules.d/$key.rules' to the list for inspection
elif [ "$tool" == 'augenrules' ]
then
        # Extract audit $key from audit rule so we can use it later
        key=$(expr "$full_rule" : '.*-k[[:space:]]\([^[:space:]]\+\)')
        # Check if particular audit rule is already defined
        IFS=$'\n' matches=($(sed -s -n -e "/${pattern}/!d" -e "/${arch}/!d" -e "/${group}/!d;F" /etc/audit/rules.d/*.rules))
        # Reset IFS back to default
        unset $IFS
        for match in "${matches[@]}"
        do
                files_to_inspect=("${files_to_inspect[@]}" "${match}")
        done
        # Case when particular rule isn't defined in /etc/audit/rules.d/*.rules yet
        if [ ${#files_to_inspect[@]} -eq "0" ]
        then
                files_to_inspect="/etc/audit/rules.d/$key.rules"
                if [ ! -e "$files_to_inspect" ]
                then
                        touch "$files_to_inspect"
                        chmod 0640 "$files_to_inspect"
                fi
        fi
fi

#
# Indicator that we want to append $full_rule into $audit_file by default
local append_expected_rule=0

for audit_file in "${files_to_inspect[@]}"
do

        # Filter existing $audit_file rules' definitions to select those that:
        # * follow the rule pattern, and
        # * meet the hardware architecture requirement, and
        # * are current syscall group specific
        IFS=$'\n' existing_rules=($(sed -e "/${pattern}/!d" -e "/${arch}/!d" -e "/${group}/!d"  "$audit_file"))
        # Reset IFS back to default
        unset $IFS

        # Process rules found case-by-case
        for rule in "${existing_rules[@]}"
        do
                # Found rule is for same arch &amp; key, but differs (e.g. in count of -S arguments)
                if [ "${rule}" != "${full_rule}" ]
                then
                        # If so, isolate just '(-S \w)+' substring of that rule
                        rule_syscalls=$(echo $rule | grep -o -P '(-S \w+ )+')
                        # Check if list of '-S syscall' arguments of that rule is subset
                        # of '-S syscall' list of expected $full_rule
                        if grep -q -- "$rule_syscalls" &lt;&lt;&lt; "$full_rule"
                        then
                                # Rule is covered (i.e. the list of -S syscalls for this rule is
                                # subset of -S syscalls of $full_rule =&gt; existing rule can be deleted
                                # Thus delete the rule from audit.rules &amp; our array
                                sed -i -e "/$rule/d" "$audit_file"
                                existing_rules=("${existing_rules[@]//$rule/}")
                        else
                                # Rule isn't covered by $full_rule - it besides -S syscall arguments
                                # for this group contains also -S syscall arguments for other syscall
                                # group. Example: '-S lchown -S fchmod -S fchownat' =&gt; group='chown'
                                # since 'lchown' &amp; 'fchownat' share 'chown' substring
                                # Therefore:
                                # * 1) delete the original rule from audit.rules
                                # (original '-S lchown -S fchmod -S fchownat' rule would be deleted)
                                # * 2) delete the -S syscall arguments for this syscall group, but
                                # keep those not belonging to this syscall group
                                # (original '-S lchown -S fchmod -S fchownat' would become '-S fchmod'
                                # * 3) append the modified (filtered) rule again into audit.rules
                                # if the same rule not already present
                                #
                                # 1) Delete the original rule
                                sed -i -e "/$rule/d" "$audit_file"
                                # 2) Delete syscalls for this group, but keep those from other groups
                                # Convert current rule syscall's string into array splitting by '-S' delimiter
                                IFS=$'-S' read -a rule_syscalls_as_array &lt;&lt;&lt; "$rule_syscalls"
                                # Reset IFS back to default
                                unset $IFS
                                # Declare new empty string to hold '-S syscall' arguments from other groups
                                new_syscalls_for_rule=''
                                # Walk through existing '-S syscall' arguments
                                for syscall_arg in "${rule_syscalls_as_array[@]}"
                                do
                                        # Skip empty $syscall_arg values
                                        if [ "$syscall_arg" == '' ]
                                        then
                                                continue
                                        fi
                                        # If the '-S syscall' doesn't belong to current group add it to the new list
                                        # (together with adding '-S' delimiter back for each of such item found)
                                        if grep -q -v -- "$group" &lt;&lt;&lt; "$syscall_arg"
                                        then
                                                new_syscalls_for_rule="$new_syscalls_for_rule -S $syscall_arg"
                                        fi
                                done
                                # Replace original '-S syscall' list with the new one for this rule
                                updated_rule=${rule//$rule_syscalls/$new_syscalls_for_rule}
                                # Squeeze repeated whitespace characters in rule definition (if any) into one
                                updated_rule=$(echo "$updated_rule" | tr -s '[:space:]')
                                # 3) Append the modified / filtered rule again into audit.rules
                                #    (but only in case it's not present yet to prevent duplicate definitions)
                                if ! grep -q -- "$updated_rule" "$audit_file"
                                then
                                        echo "$updated_rule" &gt;&gt; "$audit_file"
                                fi
                        fi
                else
                        # $audit_file already contains the expected rule form for this
                        # architecture &amp; key =&gt; don't insert it second time
                        append_expected_rule=1
                fi
        done

        # We deleted all rules that were subset of the expected one for this arch &amp; key.
        # Also isolated rules containing system calls not from this system calls group.
        # Now append the expected rule if it's not present in $audit_file yet
        if [[ ${append_expected_rule} -eq "0" ]]
        then
                echo "$full_rule" &gt;&gt; "$audit_file"
        fi
done

}

	fix_audit_syscall_rule "auditctl" "$PATTERN" "$GROUP" "$ARCH" "$FULL_RULE"
done
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_lsetxattr" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_lsetxattr" id="guide-tree-leaf-idm45561208263536" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.5.5"><td style="padding-left: 76px"><h4>Record Events that Modify the System's Discretionary Access Controls - lsetxattr<span class="label label-default pull-right">rule</span></h4><p>At a minimum the audit system should collect file
permission changes for all users and root. Add the following to
<code>/etc/audit/audit.rules</code>:
<pre>-a always,exit -F arch=b32 -S lsetxattr -F auid&gt;=500 -F auid!=4294967295 -k perm_mod</pre>
If the system is 64 bit then also add the following:
<pre>-a always,exit -F arch=b64 -S lsetxattr -F auid&gt;=500 -F auid!=4294967295 -k perm_mod</pre>
</p><div class="panel panel-warning"><div class="panel-heading"><span class="label label-warning">warning</span> 
                            Note that these rules can be configured in a
number of ways while still achieving the desired effect.  Here the system calls
have been placed independent of other system calls.  Grouping these system
calls with others as identifying earlier in this guide is more efficient.
</div></div><span class="label label-primary">Rationale:</span><p>The changing of file permissions could indicate that a user is attempting to
gain access to information that would otherwise be disallowed. Auditing DAC modifications
can facilitate the identification of patterns of abuse among both authorized and
unauthorized users.</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-3(10)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-1(b)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(a)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(d)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12(a)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IR-5</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">126</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-10.5.5</a></p></div><span class="label label-success">Remediation script:</span><pre><code>

# Perform the remediation for the syscall rule
# Retrieve hardware architecture of the underlying system
[ $(getconf LONG_BIT) = "32" ] &amp;&amp; RULE_ARCHS=("b32") || RULE_ARCHS=("b32" "b64")

for ARCH in "${RULE_ARCHS[@]}"
do
	PATTERN="-a always,exit .* -F auid&gt;=500 -F auid!=4294967295 -k *"
	GROUP="xattr"
	FULL_RULE="-a always,exit -F arch=${ARCH} -S setxattr -S lsetxattr -S fsetxattr -S removexattr -S lremovexattr -S fremovexattr -F auid&gt;=500 -F auid!=4294967295 -k perm_mod"

function fix_audit_syscall_rule {

# Load function arguments into local variables
local tool="$1"
local pattern="$2"
local group="$3"
local arch="$4"
local full_rule="$5"

# Check sanity of the input
if [ $# -ne "5" ]
then
        echo "Usage: fix_audit_syscall_rule 'tool' 'pattern' 'group' 'arch' 'full rule'"
        echo "Aborting."
        exit 1
fi

# Create a list of audit *.rules files that should be inspected for presence and correctness
# of a particular audit rule. The scheme is as follows:
#
# -----------------------------------------------------------------------------------------
#  Tool used to load audit rules | Rule already defined  |  Audit rules file to inspect    |
# -----------------------------------------------------------------------------------------
#        auditctl                |     Doesn't matter    |  /etc/audit/audit.rules         |
# -----------------------------------------------------------------------------------------
#        augenrules              |          Yes          |  /etc/audit/rules.d/*.rules     |
#        augenrules              |          No           |  /etc/audit/rules.d/$key.rules  |
# -----------------------------------------------------------------------------------------
#
declare -a files_to_inspect

# First check sanity of the specified audit tool
if [ "$tool" != 'auditctl' ] &amp;&amp; [ "$tool" != 'augenrules' ]
then
        echo "Unknown audit rules loading tool: $1. Aborting."
        echo "Use either 'auditctl' or 'augenrules'!"
        exit 1
# If audit tool is 'auditctl', then add '/etc/audit/audit.rules'
# file to the list of files to be inspected
elif [ "$tool" == 'auditctl' ]
then
        files_to_inspect=("${files_to_inspect[@]}" '/etc/audit/audit.rules' )
# If audit tool is 'augenrules', then check if the audit rule is defined
# If rule is defined, add '/etc/audit/rules.d/*.rules' to the list for inspection
# If rule isn't defined yet, add '/etc/audit/rules.d/$key.rules' to the list for inspection
elif [ "$tool" == 'augenrules' ]
then
        # Extract audit $key from audit rule so we can use it later
        key=$(expr "$full_rule" : '.*-k[[:space:]]\([^[:space:]]\+\)')
        # Check if particular audit rule is already defined
        IFS=$'\n' matches=($(sed -s -n -e "/${pattern}/!d" -e "/${arch}/!d" -e "/${group}/!d;F" /etc/audit/rules.d/*.rules))
        # Reset IFS back to default
        unset $IFS
        for match in "${matches[@]}"
        do
                files_to_inspect=("${files_to_inspect[@]}" "${match}")
        done
        # Case when particular rule isn't defined in /etc/audit/rules.d/*.rules yet
        if [ ${#files_to_inspect[@]} -eq "0" ]
        then
                files_to_inspect="/etc/audit/rules.d/$key.rules"
                if [ ! -e "$files_to_inspect" ]
                then
                        touch "$files_to_inspect"
                        chmod 0640 "$files_to_inspect"
                fi
        fi
fi

#
# Indicator that we want to append $full_rule into $audit_file by default
local append_expected_rule=0

for audit_file in "${files_to_inspect[@]}"
do

        # Filter existing $audit_file rules' definitions to select those that:
        # * follow the rule pattern, and
        # * meet the hardware architecture requirement, and
        # * are current syscall group specific
        IFS=$'\n' existing_rules=($(sed -e "/${pattern}/!d" -e "/${arch}/!d" -e "/${group}/!d"  "$audit_file"))
        # Reset IFS back to default
        unset $IFS

        # Process rules found case-by-case
        for rule in "${existing_rules[@]}"
        do
                # Found rule is for same arch &amp; key, but differs (e.g. in count of -S arguments)
                if [ "${rule}" != "${full_rule}" ]
                then
                        # If so, isolate just '(-S \w)+' substring of that rule
                        rule_syscalls=$(echo $rule | grep -o -P '(-S \w+ )+')
                        # Check if list of '-S syscall' arguments of that rule is subset
                        # of '-S syscall' list of expected $full_rule
                        if grep -q -- "$rule_syscalls" &lt;&lt;&lt; "$full_rule"
                        then
                                # Rule is covered (i.e. the list of -S syscalls for this rule is
                                # subset of -S syscalls of $full_rule =&gt; existing rule can be deleted
                                # Thus delete the rule from audit.rules &amp; our array
                                sed -i -e "/$rule/d" "$audit_file"
                                existing_rules=("${existing_rules[@]//$rule/}")
                        else
                                # Rule isn't covered by $full_rule - it besides -S syscall arguments
                                # for this group contains also -S syscall arguments for other syscall
                                # group. Example: '-S lchown -S fchmod -S fchownat' =&gt; group='chown'
                                # since 'lchown' &amp; 'fchownat' share 'chown' substring
                                # Therefore:
                                # * 1) delete the original rule from audit.rules
                                # (original '-S lchown -S fchmod -S fchownat' rule would be deleted)
                                # * 2) delete the -S syscall arguments for this syscall group, but
                                # keep those not belonging to this syscall group
                                # (original '-S lchown -S fchmod -S fchownat' would become '-S fchmod'
                                # * 3) append the modified (filtered) rule again into audit.rules
                                # if the same rule not already present
                                #
                                # 1) Delete the original rule
                                sed -i -e "/$rule/d" "$audit_file"
                                # 2) Delete syscalls for this group, but keep those from other groups
                                # Convert current rule syscall's string into array splitting by '-S' delimiter
                                IFS=$'-S' read -a rule_syscalls_as_array &lt;&lt;&lt; "$rule_syscalls"
                                # Reset IFS back to default
                                unset $IFS
                                # Declare new empty string to hold '-S syscall' arguments from other groups
                                new_syscalls_for_rule=''
                                # Walk through existing '-S syscall' arguments
                                for syscall_arg in "${rule_syscalls_as_array[@]}"
                                do
                                        # Skip empty $syscall_arg values
                                        if [ "$syscall_arg" == '' ]
                                        then
                                                continue
                                        fi
                                        # If the '-S syscall' doesn't belong to current group add it to the new list
                                        # (together with adding '-S' delimiter back for each of such item found)
                                        if grep -q -v -- "$group" &lt;&lt;&lt; "$syscall_arg"
                                        then
                                                new_syscalls_for_rule="$new_syscalls_for_rule -S $syscall_arg"
                                        fi
                                done
                                # Replace original '-S syscall' list with the new one for this rule
                                updated_rule=${rule//$rule_syscalls/$new_syscalls_for_rule}
                                # Squeeze repeated whitespace characters in rule definition (if any) into one
                                updated_rule=$(echo "$updated_rule" | tr -s '[:space:]')
                                # 3) Append the modified / filtered rule again into audit.rules
                                #    (but only in case it's not present yet to prevent duplicate definitions)
                                if ! grep -q -- "$updated_rule" "$audit_file"
                                then
                                        echo "$updated_rule" &gt;&gt; "$audit_file"
                                fi
                        fi
                else
                        # $audit_file already contains the expected rule form for this
                        # architecture &amp; key =&gt; don't insert it second time
                        append_expected_rule=1
                fi
        done

        # We deleted all rules that were subset of the expected one for this arch &amp; key.
        # Also isolated rules containing system calls not from this system calls group.
        # Now append the expected rule if it's not present in $audit_file yet
        if [[ ${append_expected_rule} -eq "0" ]]
        then
                echo "$full_rule" &gt;&gt; "$audit_file"
        fi
done

}

	fix_audit_syscall_rule "auditctl" "$PATTERN" "$GROUP" "$ARCH" "$FULL_RULE"
done
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_removexattr" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_removexattr" id="guide-tree-leaf-idm45561208242272" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.5.5"><td style="padding-left: 76px"><h4>Record Events that Modify the System's Discretionary Access Controls - removexattr<span class="label label-default pull-right">rule</span></h4><p>At a minimum the audit system should collect file
permission changes for all users and root. Add the following to
<code>/etc/audit/audit.rules</code>:
<pre>-a always,exit -F arch=b32 -S removexattr -F auid&gt;=500 -F auid!=4294967295 -k perm_mod</pre>
If the system is 64 bit then also add the following:
<pre>-a always,exit -F arch=b64 -S removexattr -F auid&gt;=500 -F auid!=4294967295 -k perm_mod</pre>
</p><div class="panel panel-warning"><div class="panel-heading"><span class="label label-warning">warning</span> 
                            Note that these rules can be configured in a
number of ways while still achieving the desired effect.  Here the system calls
have been placed independent of other system calls.  Grouping these system
calls with others as identifying earlier in this guide is more efficient.
</div></div><span class="label label-primary">Rationale:</span><p>The changing of file permissions could indicate that a user is attempting to
gain access to information that would otherwise be disallowed. Auditing DAC modifications
can facilitate the identification of patterns of abuse among both authorized and
unauthorized users.</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-3(10)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-1(b)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(a)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(d)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12(a)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IR-5</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">126</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-10.5.5</a></p></div><span class="label label-success">Remediation script:</span><pre><code>

# Perform the remediation for the syscall rule
# Retrieve hardware architecture of the underlying system
[ $(getconf LONG_BIT) = "32" ] &amp;&amp; RULE_ARCHS=("b32") || RULE_ARCHS=("b32" "b64")

for ARCH in "${RULE_ARCHS[@]}"
do
	PATTERN="-a always,exit .* -F auid&gt;=500 -F auid!=4294967295 -k *"
	GROUP="xattr"
	FULL_RULE="-a always,exit -F arch=${ARCH} -S setxattr -S lsetxattr -S fsetxattr -S removexattr -S lremovexattr -S fremovexattr -F auid&gt;=500 -F auid!=4294967295 -k perm_mod"

function fix_audit_syscall_rule {

# Load function arguments into local variables
local tool="$1"
local pattern="$2"
local group="$3"
local arch="$4"
local full_rule="$5"

# Check sanity of the input
if [ $# -ne "5" ]
then
        echo "Usage: fix_audit_syscall_rule 'tool' 'pattern' 'group' 'arch' 'full rule'"
        echo "Aborting."
        exit 1
fi

# Create a list of audit *.rules files that should be inspected for presence and correctness
# of a particular audit rule. The scheme is as follows:
#
# -----------------------------------------------------------------------------------------
#  Tool used to load audit rules | Rule already defined  |  Audit rules file to inspect    |
# -----------------------------------------------------------------------------------------
#        auditctl                |     Doesn't matter    |  /etc/audit/audit.rules         |
# -----------------------------------------------------------------------------------------
#        augenrules              |          Yes          |  /etc/audit/rules.d/*.rules     |
#        augenrules              |          No           |  /etc/audit/rules.d/$key.rules  |
# -----------------------------------------------------------------------------------------
#
declare -a files_to_inspect

# First check sanity of the specified audit tool
if [ "$tool" != 'auditctl' ] &amp;&amp; [ "$tool" != 'augenrules' ]
then
        echo "Unknown audit rules loading tool: $1. Aborting."
        echo "Use either 'auditctl' or 'augenrules'!"
        exit 1
# If audit tool is 'auditctl', then add '/etc/audit/audit.rules'
# file to the list of files to be inspected
elif [ "$tool" == 'auditctl' ]
then
        files_to_inspect=("${files_to_inspect[@]}" '/etc/audit/audit.rules' )
# If audit tool is 'augenrules', then check if the audit rule is defined
# If rule is defined, add '/etc/audit/rules.d/*.rules' to the list for inspection
# If rule isn't defined yet, add '/etc/audit/rules.d/$key.rules' to the list for inspection
elif [ "$tool" == 'augenrules' ]
then
        # Extract audit $key from audit rule so we can use it later
        key=$(expr "$full_rule" : '.*-k[[:space:]]\([^[:space:]]\+\)')
        # Check if particular audit rule is already defined
        IFS=$'\n' matches=($(sed -s -n -e "/${pattern}/!d" -e "/${arch}/!d" -e "/${group}/!d;F" /etc/audit/rules.d/*.rules))
        # Reset IFS back to default
        unset $IFS
        for match in "${matches[@]}"
        do
                files_to_inspect=("${files_to_inspect[@]}" "${match}")
        done
        # Case when particular rule isn't defined in /etc/audit/rules.d/*.rules yet
        if [ ${#files_to_inspect[@]} -eq "0" ]
        then
                files_to_inspect="/etc/audit/rules.d/$key.rules"
                if [ ! -e "$files_to_inspect" ]
                then
                        touch "$files_to_inspect"
                        chmod 0640 "$files_to_inspect"
                fi
        fi
fi

#
# Indicator that we want to append $full_rule into $audit_file by default
local append_expected_rule=0

for audit_file in "${files_to_inspect[@]}"
do

        # Filter existing $audit_file rules' definitions to select those that:
        # * follow the rule pattern, and
        # * meet the hardware architecture requirement, and
        # * are current syscall group specific
        IFS=$'\n' existing_rules=($(sed -e "/${pattern}/!d" -e "/${arch}/!d" -e "/${group}/!d"  "$audit_file"))
        # Reset IFS back to default
        unset $IFS

        # Process rules found case-by-case
        for rule in "${existing_rules[@]}"
        do
                # Found rule is for same arch &amp; key, but differs (e.g. in count of -S arguments)
                if [ "${rule}" != "${full_rule}" ]
                then
                        # If so, isolate just '(-S \w)+' substring of that rule
                        rule_syscalls=$(echo $rule | grep -o -P '(-S \w+ )+')
                        # Check if list of '-S syscall' arguments of that rule is subset
                        # of '-S syscall' list of expected $full_rule
                        if grep -q -- "$rule_syscalls" &lt;&lt;&lt; "$full_rule"
                        then
                                # Rule is covered (i.e. the list of -S syscalls for this rule is
                                # subset of -S syscalls of $full_rule =&gt; existing rule can be deleted
                                # Thus delete the rule from audit.rules &amp; our array
                                sed -i -e "/$rule/d" "$audit_file"
                                existing_rules=("${existing_rules[@]//$rule/}")
                        else
                                # Rule isn't covered by $full_rule - it besides -S syscall arguments
                                # for this group contains also -S syscall arguments for other syscall
                                # group. Example: '-S lchown -S fchmod -S fchownat' =&gt; group='chown'
                                # since 'lchown' &amp; 'fchownat' share 'chown' substring
                                # Therefore:
                                # * 1) delete the original rule from audit.rules
                                # (original '-S lchown -S fchmod -S fchownat' rule would be deleted)
                                # * 2) delete the -S syscall arguments for this syscall group, but
                                # keep those not belonging to this syscall group
                                # (original '-S lchown -S fchmod -S fchownat' would become '-S fchmod'
                                # * 3) append the modified (filtered) rule again into audit.rules
                                # if the same rule not already present
                                #
                                # 1) Delete the original rule
                                sed -i -e "/$rule/d" "$audit_file"
                                # 2) Delete syscalls for this group, but keep those from other groups
                                # Convert current rule syscall's string into array splitting by '-S' delimiter
                                IFS=$'-S' read -a rule_syscalls_as_array &lt;&lt;&lt; "$rule_syscalls"
                                # Reset IFS back to default
                                unset $IFS
                                # Declare new empty string to hold '-S syscall' arguments from other groups
                                new_syscalls_for_rule=''
                                # Walk through existing '-S syscall' arguments
                                for syscall_arg in "${rule_syscalls_as_array[@]}"
                                do
                                        # Skip empty $syscall_arg values
                                        if [ "$syscall_arg" == '' ]
                                        then
                                                continue
                                        fi
                                        # If the '-S syscall' doesn't belong to current group add it to the new list
                                        # (together with adding '-S' delimiter back for each of such item found)
                                        if grep -q -v -- "$group" &lt;&lt;&lt; "$syscall_arg"
                                        then
                                                new_syscalls_for_rule="$new_syscalls_for_rule -S $syscall_arg"
                                        fi
                                done
                                # Replace original '-S syscall' list with the new one for this rule
                                updated_rule=${rule//$rule_syscalls/$new_syscalls_for_rule}
                                # Squeeze repeated whitespace characters in rule definition (if any) into one
                                updated_rule=$(echo "$updated_rule" | tr -s '[:space:]')
                                # 3) Append the modified / filtered rule again into audit.rules
                                #    (but only in case it's not present yet to prevent duplicate definitions)
                                if ! grep -q -- "$updated_rule" "$audit_file"
                                then
                                        echo "$updated_rule" &gt;&gt; "$audit_file"
                                fi
                        fi
                else
                        # $audit_file already contains the expected rule form for this
                        # architecture &amp; key =&gt; don't insert it second time
                        append_expected_rule=1
                fi
        done

        # We deleted all rules that were subset of the expected one for this arch &amp; key.
        # Also isolated rules containing system calls not from this system calls group.
        # Now append the expected rule if it's not present in $audit_file yet
        if [[ ${append_expected_rule} -eq "0" ]]
        then
                echo "$full_rule" &gt;&gt; "$audit_file"
        fi
done

}

	fix_audit_syscall_rule "auditctl" "$PATTERN" "$GROUP" "$ARCH" "$FULL_RULE"
done
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_setxattr" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_setxattr" id="guide-tree-leaf-idm45561208220992" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.5.5"><td style="padding-left: 76px"><h4>Record Events that Modify the System's Discretionary Access Controls - setxattr<span class="label label-default pull-right">rule</span></h4><p>At a minimum the audit system should collect file
permission changes for all users and root. Add the following to
<code>/etc/audit/audit.rules</code>:
<pre>-a always,exit -F arch=b32 -S setxattr -F auid&gt;=500 -F auid!=4294967295 -k perm_mod</pre>
If the system is 64 bit then also add the following:
<pre>-a always,exit -F arch=b64 -S setxattr -F auid&gt;=500 -F auid!=4294967295 -k perm_mod</pre>
</p><div class="panel panel-warning"><div class="panel-heading"><span class="label label-warning">warning</span> 
                            Note that these rules can be configured in a
number of ways while still achieving the desired effect.  Here the system calls
have been placed independent of other system calls.  Grouping these system
calls with others as identifying earlier in this guide is more efficient.
</div></div><span class="label label-primary">Rationale:</span><p>The changing of file permissions could indicate that a user is attempting to
gain access to information that would otherwise be disallowed. Auditing DAC modifications
can facilitate the identification of patterns of abuse among both authorized and
unauthorized users.</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-3(10)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-1(b)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(a)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-2(d)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12(a)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IR-5</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">126</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-10.5.5</a></p></div><span class="label label-success">Remediation script:</span><pre><code>

# Perform the remediation for the syscall rule
# Retrieve hardware architecture of the underlying system
[ $(getconf LONG_BIT) = "32" ] &amp;&amp; RULE_ARCHS=("b32") || RULE_ARCHS=("b32" "b64")

for ARCH in "${RULE_ARCHS[@]}"
do
	PATTERN="-a always,exit .* -F auid&gt;=500 -F auid!=4294967295 -k *"
	GROUP="xattr"
	FULL_RULE="-a always,exit -F arch=${ARCH} -S setxattr -S lsetxattr -S fsetxattr -S removexattr -S lremovexattr -S fremovexattr -F auid&gt;=500 -F auid!=4294967295 -k perm_mod"

function fix_audit_syscall_rule {

# Load function arguments into local variables
local tool="$1"
local pattern="$2"
local group="$3"
local arch="$4"
local full_rule="$5"

# Check sanity of the input
if [ $# -ne "5" ]
then
        echo "Usage: fix_audit_syscall_rule 'tool' 'pattern' 'group' 'arch' 'full rule'"
        echo "Aborting."
        exit 1
fi

# Create a list of audit *.rules files that should be inspected for presence and correctness
# of a particular audit rule. The scheme is as follows:
#
# -----------------------------------------------------------------------------------------
#  Tool used to load audit rules | Rule already defined  |  Audit rules file to inspect    |
# -----------------------------------------------------------------------------------------
#        auditctl                |     Doesn't matter    |  /etc/audit/audit.rules         |
# -----------------------------------------------------------------------------------------
#        augenrules              |          Yes          |  /etc/audit/rules.d/*.rules     |
#        augenrules              |          No           |  /etc/audit/rules.d/$key.rules  |
# -----------------------------------------------------------------------------------------
#
declare -a files_to_inspect

# First check sanity of the specified audit tool
if [ "$tool" != 'auditctl' ] &amp;&amp; [ "$tool" != 'augenrules' ]
then
        echo "Unknown audit rules loading tool: $1. Aborting."
        echo "Use either 'auditctl' or 'augenrules'!"
        exit 1
# If audit tool is 'auditctl', then add '/etc/audit/audit.rules'
# file to the list of files to be inspected
elif [ "$tool" == 'auditctl' ]
then
        files_to_inspect=("${files_to_inspect[@]}" '/etc/audit/audit.rules' )
# If audit tool is 'augenrules', then check if the audit rule is defined
# If rule is defined, add '/etc/audit/rules.d/*.rules' to the list for inspection
# If rule isn't defined yet, add '/etc/audit/rules.d/$key.rules' to the list for inspection
elif [ "$tool" == 'augenrules' ]
then
        # Extract audit $key from audit rule so we can use it later
        key=$(expr "$full_rule" : '.*-k[[:space:]]\([^[:space:]]\+\)')
        # Check if particular audit rule is already defined
        IFS=$'\n' matches=($(sed -s -n -e "/${pattern}/!d" -e "/${arch}/!d" -e "/${group}/!d;F" /etc/audit/rules.d/*.rules))
        # Reset IFS back to default
        unset $IFS
        for match in "${matches[@]}"
        do
                files_to_inspect=("${files_to_inspect[@]}" "${match}")
        done
        # Case when particular rule isn't defined in /etc/audit/rules.d/*.rules yet
        if [ ${#files_to_inspect[@]} -eq "0" ]
        then
                files_to_inspect="/etc/audit/rules.d/$key.rules"
                if [ ! -e "$files_to_inspect" ]
                then
                        touch "$files_to_inspect"
                        chmod 0640 "$files_to_inspect"
                fi
        fi
fi

#
# Indicator that we want to append $full_rule into $audit_file by default
local append_expected_rule=0

for audit_file in "${files_to_inspect[@]}"
do

        # Filter existing $audit_file rules' definitions to select those that:
        # * follow the rule pattern, and
        # * meet the hardware architecture requirement, and
        # * are current syscall group specific
        IFS=$'\n' existing_rules=($(sed -e "/${pattern}/!d" -e "/${arch}/!d" -e "/${group}/!d"  "$audit_file"))
        # Reset IFS back to default
        unset $IFS

        # Process rules found case-by-case
        for rule in "${existing_rules[@]}"
        do
                # Found rule is for same arch &amp; key, but differs (e.g. in count of -S arguments)
                if [ "${rule}" != "${full_rule}" ]
                then
                        # If so, isolate just '(-S \w)+' substring of that rule
                        rule_syscalls=$(echo $rule | grep -o -P '(-S \w+ )+')
                        # Check if list of '-S syscall' arguments of that rule is subset
                        # of '-S syscall' list of expected $full_rule
                        if grep -q -- "$rule_syscalls" &lt;&lt;&lt; "$full_rule"
                        then
                                # Rule is covered (i.e. the list of -S syscalls for this rule is
                                # subset of -S syscalls of $full_rule =&gt; existing rule can be deleted
                                # Thus delete the rule from audit.rules &amp; our array
                                sed -i -e "/$rule/d" "$audit_file"
                                existing_rules=("${existing_rules[@]//$rule/}")
                        else
                                # Rule isn't covered by $full_rule - it besides -S syscall arguments
                                # for this group contains also -S syscall arguments for other syscall
                                # group. Example: '-S lchown -S fchmod -S fchownat' =&gt; group='chown'
                                # since 'lchown' &amp; 'fchownat' share 'chown' substring
                                # Therefore:
                                # * 1) delete the original rule from audit.rules
                                # (original '-S lchown -S fchmod -S fchownat' rule would be deleted)
                                # * 2) delete the -S syscall arguments for this syscall group, but
                                # keep those not belonging to this syscall group
                                # (original '-S lchown -S fchmod -S fchownat' would become '-S fchmod'
                                # * 3) append the modified (filtered) rule again into audit.rules
                                # if the same rule not already present
                                #
                                # 1) Delete the original rule
                                sed -i -e "/$rule/d" "$audit_file"
                                # 2) Delete syscalls for this group, but keep those from other groups
                                # Convert current rule syscall's string into array splitting by '-S' delimiter
                                IFS=$'-S' read -a rule_syscalls_as_array &lt;&lt;&lt; "$rule_syscalls"
                                # Reset IFS back to default
                                unset $IFS
                                # Declare new empty string to hold '-S syscall' arguments from other groups
                                new_syscalls_for_rule=''
                                # Walk through existing '-S syscall' arguments
                                for syscall_arg in "${rule_syscalls_as_array[@]}"
                                do
                                        # Skip empty $syscall_arg values
                                        if [ "$syscall_arg" == '' ]
                                        then
                                                continue
                                        fi
                                        # If the '-S syscall' doesn't belong to current group add it to the new list
                                        # (together with adding '-S' delimiter back for each of such item found)
                                        if grep -q -v -- "$group" &lt;&lt;&lt; "$syscall_arg"
                                        then
                                                new_syscalls_for_rule="$new_syscalls_for_rule -S $syscall_arg"
                                        fi
                                done
                                # Replace original '-S syscall' list with the new one for this rule
                                updated_rule=${rule//$rule_syscalls/$new_syscalls_for_rule}
                                # Squeeze repeated whitespace characters in rule definition (if any) into one
                                updated_rule=$(echo "$updated_rule" | tr -s '[:space:]')
                                # 3) Append the modified / filtered rule again into audit.rules
                                #    (but only in case it's not present yet to prevent duplicate definitions)
                                if ! grep -q -- "$updated_rule" "$audit_file"
                                then
                                        echo "$updated_rule" &gt;&gt; "$audit_file"
                                fi
                        fi
                else
                        # $audit_file already contains the expected rule form for this
                        # architecture &amp; key =&gt; don't insert it second time
                        append_expected_rule=1
                fi
        done

        # We deleted all rules that were subset of the expected one for this arch &amp; key.
        # Also isolated rules containing system calls not from this system calls group.
        # Now append the expected rule if it's not present in $audit_file yet
        if [[ ${append_expected_rule} -eq "0" ]]
        then
                echo "$full_rule" &gt;&gt; "$audit_file"
        fi
done

}

	fix_audit_syscall_rule "auditctl" "$PATTERN" "$GROUP" "$ARCH" "$FULL_RULE"
done
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_file_permissions_var_log_audit" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_file_permissions_var_log_audit" id="guide-tree-leaf-idm45561208680864" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.5"><td style="padding-left: 57px"><h4>System Audit Logs Must Have Mode 0640 or Less Permissive<span class="label label-default pull-right">rule</span></h4><p>
If <code>log_group</code> in <code>/etc/audit/auditd.conf</code> is set to a group other than the <code>root</code>
group account, change the mode of the audit log files with the following command:
<pre>$ sudo chmod 0640 <i>audit_file</i></pre>
<br>
Otherwise, change the mode of the audit log files with the following command:
<pre>$ sudo chmod 0600 <i>audit_file</i></pre>
</p><span class="label label-primary">Rationale:</span><p>
If users can write to audit logs, audit trails can be modified or destroyed.
</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-6</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-1(b)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-9</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IR-5</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">166</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-10.5</a></p></div><span class="label label-success">Remediation script:</span><pre><code>
if `grep -q ^log_group /etc/audit/auditd.conf` ; then
  GROUP=$(awk -F "=" '/log_group/ {print $2}' /etc/audit/auditd.conf | tr -d ' ')
  if ! [ "${GROUP}" == 'root' ] ; then
    chmod 0640 /var/log/audit/audit.log
    chmod 0440 /var/log/audit/audit.log.*
  else
    chmod 0600 /var/log/audit/audit.log
    chmod 0400 /var/log/audit/audit.log.*
  fi

  chmod 0640 /etc/audit/audit*
  chmod 0640 /etc/audit/rules.d/*
else
  chmod 0600 /var/log/audit/audit.log
  chmod 0400 /var/log/audit/audit.log.*
  chmod 0640 /etc/audit/audit*
  chmod 0640 /etc/audit/rules.d/*
fi
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-10.6" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-10.6" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10."><td style="padding-left: 38px"><h3 id="xccdf_org.ssgproject.content_group_pcidss-req-10.6">10.6<span class="label label-default pull-right">group</span></h3><p>Review logs and security events for</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.6" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10."><td style="padding-left: 38px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-10.6.1" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-10.6.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.6"><td style="padding-left: 57px"><h3>10.6.1<span class="label label-default pull-right">group</span></h3><p>Review the following at least</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.6.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.6"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-10.6.1.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-10.6.1.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.6.1"><td style="padding-left: 76px"><h3>10.6.1.a<span class="label label-default pull-right">group</span></h3><p>Examine security policies and procedures to verify that</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.6.1.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.6.1"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-10.6.1.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-10.6.1.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.6.1"><td style="padding-left: 76px"><h3>10.6.1.b<span class="label label-default pull-right">group</span></h3><p>Observe processes and interview personnel to verify</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.6.1.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.6.1"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-10.6.2" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-10.6.2" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.6"><td style="padding-left: 57px"><h3>10.6.2<span class="label label-default pull-right">group</span></h3><p>Review logs of all other system</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.6.2" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.6"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-10.6.2.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-10.6.2.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.6.2"><td style="padding-left: 76px"><h3>10.6.2.a<span class="label label-default pull-right">group</span></h3><p>Examine security policies and procedures to verify that</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.6.2.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.6.2"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-10.6.2.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-10.6.2.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.6.2"><td style="padding-left: 76px"><h3>10.6.2.b<span class="label label-default pull-right">group</span></h3><p></p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.6.2.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.6.2"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-10.6.3" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-10.6.3" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.6"><td style="padding-left: 57px"><h3>10.6.3<span class="label label-default pull-right">group</span></h3><p>Follow up exceptions and</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.6.3" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.6"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-10.6.3.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-10.6.3.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.6.3"><td style="padding-left: 76px"><h3>10.6.3.a<span class="label label-default pull-right">group</span></h3><p>Examine security policies and procedures to verify that</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.6.3.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.6.3"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-10.6.3.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-10.6.3.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.6.3"><td style="padding-left: 76px"><h3>10.6.3.b<span class="label label-default pull-right">group</span></h3><p>Observe processes and interview personnel to verify</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.6.3.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.6.3"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-10.7" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-10.7" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10."><td style="padding-left: 38px"><h3 id="xccdf_org.ssgproject.content_group_pcidss-req-10.7">10.7<span class="label label-default pull-right">group</span></h3><p>Retain audit trail history for at least</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.7" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10."><td style="padding-left: 38px"><small>contains 7 rules</small></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-10.7.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-10.7.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.7"><td style="padding-left: 57px"><h3>10.7.a<span class="label label-default pull-right">group</span></h3><p>Examine security policies and procedures to verify that they</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.7.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.7"><td style="padding-left: 57px"><small>contains 1 rule</small></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_auditd_data_retention_action_mail_acct" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_auditd_data_retention_action_mail_acct" id="guide-tree-leaf-idm45561208063264" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.7.a"><td style="padding-left: 76px"><h4>Configure auditd mail_acct Action on Low Disk Space<span class="label label-default pull-right">rule</span></h4><p>The <code>auditd</code> service can be configured to send email to
a designated account in certain situations. Add or correct the following line
in <code>/etc/audit/auditd.conf</code> to ensure that administrators are notified
via email for those situations:
<pre>action_mail_acct = <abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_var_auditd_action_mail_acct">root</abbr></pre>
</p><span class="label label-primary">Rationale:</span><p>Email sent to the root account is typically aliased to the
administrators of the system, who can take appropriate action.</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-1(b)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-4</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-5(a)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IR-5</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">139</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">144</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-10.7.a</a></p></div><span class="label label-success">Remediation script:</span><pre><code>
var_auditd_action_mail_acct="<abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_var_auditd_action_mail_acct">root</abbr>"

AUDITCONFIG=/etc/audit/auditd.conf

grep -q ^action_mail_acct $AUDITCONFIG &amp;&amp; \
  sed -i 's/^action_mail_acct.*/action_mail_acct = '"$var_auditd_action_mail_acct"'/g' $AUDITCONFIG
if ! [ $? -eq 0 ]; then
  echo "action_mail_acct = $var_auditd_action_mail_acct" &gt;&gt; $AUDITCONFIG
fi
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-10.7.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-10.7.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.7"><td style="padding-left: 57px"><h3>10.7.b<span class="label label-default pull-right">group</span></h3><p>Interview personnel and examine audit logs to verify that</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.7.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.7"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-10.7.c" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-10.7.c" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.7"><td style="padding-left: 57px"><h3>10.7.c<span class="label label-default pull-right">group</span></h3><p>Interview personnel and observe processes to verify that at</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.7.c" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.7"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_ensure_logrotate_activated" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_ensure_logrotate_activated" id="guide-tree-leaf-idm45561208179824" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.7"><td style="padding-left: 57px"><h4>Ensure Logrotate Runs Periodically<span class="label label-default pull-right">rule</span></h4><p>The <code>logrotate</code> utility allows for the automatic rotation of 
log files.  The frequency of rotation is specified in <code>/etc/logrotate.conf</code>, 
which triggers a cron task.  To configure logrotate to run daily, add or correct 
the following line in <code>/etc/logrotate.conf</code>:
<pre># rotate log files <i>frequency</i>
daily</pre>
</p><span class="label label-primary">Rationale:</span><p>Log files that are not properly rotated run the risk of growing so large
that they fill up the /var/log partition. Valuable logging information could be lost
if the /var/log partition becomes full.</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-9</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">366</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-10.7</a></p></div></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_auditd_data_retention_num_logs" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_auditd_data_retention_num_logs" id="guide-tree-leaf-idm45561208168784" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.7"><td style="padding-left: 57px"><h4>Configure auditd Number of Logs Retained<span class="label label-default pull-right">rule</span></h4><p>Determine how many log files
<code>auditd</code> should retain when it rotates logs.
Edit the file <code>/etc/audit/auditd.conf</code>. Add or modify the following
line, substituting <i>NUMLOGS</i> with the correct value of <abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_var_auditd_num_logs">5</abbr>:
<pre>num_logs = <i>NUMLOGS</i></pre>
Set the value to 5 for general-purpose systems. 
Note that values less than 2 result in no log rotation.</p><span class="label label-primary">Rationale:</span><p>The total storage for audit log files must be large enough to retain
log information over the period required. This is a function of the maximum log
file size and the number of logs retained.</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-1(b)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-11</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IR-5</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-10.7</a></p></div><span class="label label-success">Remediation script:</span><pre><code>
var_auditd_num_logs="<abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_var_auditd_num_logs">5</abbr>"

AUDITCONFIG=/etc/audit/auditd.conf

grep -q ^num_logs $AUDITCONFIG &amp;&amp; \
  sed -i 's/^num_logs.*/num_logs = '"$var_auditd_num_logs"'/g' $AUDITCONFIG
if ! [ $? -eq 0 ]; then
  echo "num_logs = $var_auditd_num_logs" &gt;&gt; $AUDITCONFIG
fi
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_auditd_data_retention_max_log_file" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_auditd_data_retention_max_log_file" id="guide-tree-leaf-idm45561208151536" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.7"><td style="padding-left: 57px"><h4>Configure auditd Max Log File Size<span class="label label-default pull-right">rule</span></h4><p>Determine the amount of audit data (in megabytes)
which should be retained in each log file. Edit the file
<code>/etc/audit/auditd.conf</code>. Add or modify the following line, substituting
the correct value of <abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_var_auditd_max_log_file">6</abbr> for <i>STOREMB</i>:
<pre>max_log_file = <i>STOREMB</i></pre>
Set the value to <code>6</code> (MB) or higher for general-purpose systems.
Larger values, of course,
support retention of even more audit data.</p><span class="label label-primary">Rationale:</span><p>The total storage for audit log files must be large enough to retain
log information over the period required. This is a function of the maximum
log file size and the number of logs retained.</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-1(b)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-11</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IR-5</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-10.7</a></p></div><span class="label label-success">Remediation script:</span><pre><code>
var_auditd_max_log_file="<abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_var_auditd_max_log_file">6</abbr>"

AUDITCONFIG=/etc/audit/auditd.conf

grep -q ^max_log_file $AUDITCONFIG &amp;&amp; \
  sed -i 's/^max_log_file.*/max_log_file = '"$var_auditd_max_log_file"'/g' $AUDITCONFIG
if ! [ $? -eq 0 ]; then
  echo "max_log_file = $var_auditd_max_log_file" &gt;&gt; $AUDITCONFIG
fi
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_auditd_data_retention_max_log_file_action" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_auditd_data_retention_max_log_file_action" id="guide-tree-leaf-idm45561208134176" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.7"><td style="padding-left: 57px"><h4>Configure auditd max_log_file_action Upon Reaching Maximum Log Size<span class="label label-default pull-right">rule</span></h4><p> The default action to take when the logs reach their maximum size
is to rotate the log files, discarding the oldest one. To configure the action taken
by <code>auditd</code>, add or correct the line in <code>/etc/audit/auditd.conf</code>:
<pre>max_log_file_action = <i>ACTION</i></pre>
Possible values for <i>ACTION</i> are described in the <code>auditd.conf</code> man
page. These include:
<ul><li><code>ignore</code></li><li><code>syslog</code></li><li><code>suspend</code></li><li><code>rotate</code></li><li><code>keep_logs</code></li></ul>
Set the <code><i>ACTION</i></code> to <code>rotate</code> to ensure log rotation
occurs.  This is the default.  The setting is case-insensitive.
</p><span class="label label-primary">Rationale:</span><p>Automatically rotating logs (by setting this to <code>rotate</code>)
minimizes the chances of the system unexpectedly running out of disk space by
being overwhelmed with log data. However, for systems that must never discard
log data, or which use external processes to transfer it and reclaim space,
<code>keep_logs</code> can be employed.</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-1(b)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-4</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-11</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IR-5</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-10.7</a></p></div><span class="label label-success">Remediation script:</span><pre><code>
var_auditd_max_log_file_action="<abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_var_auditd_max_log_file_action">rotate</abbr>"

AUDITCONFIG=/etc/audit/auditd.conf

grep -q ^max_log_file_action $AUDITCONFIG &amp;&amp; \
  sed -i 's/^max_log_file_action.*/max_log_file_action = '"$var_auditd_max_log_file_action"'/g' $AUDITCONFIG
if ! [ $? -eq 0 ]; then
  echo "max_log_file_action = $var_auditd_max_log_file_action" &gt;&gt; $AUDITCONFIG
fi
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_auditd_data_retention_space_left_action" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_auditd_data_retention_space_left_action" id="guide-tree-leaf-idm45561208111872" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.7"><td style="padding-left: 57px"><h4>Configure auditd space_left Action on Low Disk Space<span class="label label-default pull-right">rule</span></h4><p>The <code>auditd</code> service can be configured to take an action
when disk space <i>starts</i> to run low. 
Edit the file <code>/etc/audit/auditd.conf</code>. Modify the following line,
substituting <i>ACTION</i> appropriately:
<pre>space_left_action = <i>ACTION</i></pre>
Possible values for <i>ACTION</i> are described in the <code>auditd.conf</code> man page.
These include:
<ul><li><code>ignore</code></li><li><code>syslog</code></li><li><code>email</code></li><li><code>exec</code></li><li><code>suspend</code></li><li><code>single</code></li><li><code>halt</code></li></ul>
Set this to <code>email</code> (instead of the default,
which is <code>suspend</code>) as it is more likely to get prompt attention. Acceptable values
also include <code>suspend</code>, <code>single</code>, and <code>halt</code>.
</p><span class="label label-primary">Rationale:</span><p>Notifying administrators of an impending disk space problem may
allow them to take corrective action prior to any disruption.</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-1(b)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-4</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-5(b)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IR-5</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">140</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">143</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-10.7</a></p></div><span class="label label-success">Remediation script:</span><pre><code>
var_auditd_space_left_action="<abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_var_auditd_space_left_action">email</abbr>"

#
# If space_left_action present in /etc/audit/auditd.conf, change value
# to var_auditd_space_left_action, else
# add "space_left_action = $var_auditd_space_left_action" to /etc/audit/auditd.conf
#

if grep --silent ^space_left_action /etc/audit/auditd.conf ; then
        sed -i 's/^space_left_action.*/space_left_action = '"$var_auditd_space_left_action"'/g' /etc/audit/auditd.conf
else
        echo -e "\n# Set space_left_action to $var_auditd_space_left_action per security requirements" &gt;&gt; /etc/audit/auditd.conf
        echo "space_left_action = $var_auditd_space_left_action" &gt;&gt; /etc/audit/auditd.conf
fi
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_auditd_data_retention_admin_space_left_action" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_auditd_data_retention_admin_space_left_action" id="guide-tree-leaf-idm45561208086240" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.7"><td style="padding-left: 57px"><h4>Configure auditd admin_space_left Action on Low Disk Space<span class="label label-default pull-right">rule</span></h4><p>The <code>auditd</code> service can be configured to take an action
when disk space is running low but prior to running out of space completely. 
Edit the file <code>/etc/audit/auditd.conf</code>. Add or modify the following line,
substituting <i>ACTION</i> appropriately:
<pre>admin_space_left_action = <i>ACTION</i></pre>
Set this value to <code>single</code> to cause the system to switch to single-user
mode for corrective action. Acceptable values also include <code>suspend</code> and
<code>halt</code>. For certain systems, the need for availability
outweighs the need to log all actions, and a different setting should be
determined. Details regarding all possible values for <i>ACTION</i> are described in the
<code>auditd.conf</code> man page.
</p><span class="label label-primary">Rationale:</span><p>Administrators should be made aware of an inability to record
audit records. If a separate partition or logical volume of adequate size
is used, running low on space for audit records should never occur.
</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-1(b)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-4</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-5(b)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IR-5</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">140</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">1343</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-10.7</a></p></div><span class="label label-success">Remediation script:</span><pre><code>
var_auditd_admin_space_left_action="<abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_var_auditd_admin_space_left_action">single</abbr>"

grep -q ^admin_space_left_action /etc/audit/auditd.conf &amp;&amp; \
  sed -i "s/admin_space_left_action.*/admin_space_left_action = $var_auditd_admin_space_left_action/g" /etc/audit/auditd.conf
if ! [ $? -eq 0 ]; then
    echo "admin_space_left_action = $var_auditd_admin_space_left_action" &gt;&gt; /etc/audit/auditd.conf
fi
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-10.8" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-10.8" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10."><td style="padding-left: 38px"><h3 id="xccdf_org.ssgproject.content_group_pcidss-req-10.8">10.8<span class="label label-default pull-right">group</span></h3><p>Ensure that security policies and</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10.8" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-10."><td style="padding-left: 38px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-11." class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-11." data-tt-parent-id="children-xccdf_org.ssgproject.content_benchmark_PCIDSS-RHEL-6"><td style="padding-left: 19px"><h3 id="xccdf_org.ssgproject.content_group_pcidss-req-11.">11.<span class="label label-default pull-right">group</span></h3><p>Regularly test security systems and processes</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11." data-tt-parent-id="children-xccdf_org.ssgproject.content_benchmark_PCIDSS-RHEL-6"><td style="padding-left: 19px"><small>contains 7 rules</small></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-11.1" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-11.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11."><td style="padding-left: 38px"><h3 id="xccdf_org.ssgproject.content_group_pcidss-req-11.1">11.1<span class="label label-default pull-right">group</span></h3><p>Implement processes to test for the</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11."><td style="padding-left: 38px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-11.1.1" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-11.1.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.1"><td style="padding-left: 57px"><h3>11.1.1<span class="label label-default pull-right">group</span></h3><p>Maintain an inventory of</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.1.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.1"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-11.1.2" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-11.1.2" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.1"><td style="padding-left: 57px"><h3>11.1.2<span class="label label-default pull-right">group</span></h3><p>Implement incident response</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.1.2" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.1"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-11.1.2.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-11.1.2.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.1.2"><td style="padding-left: 76px"><h3>11.1.2.a<span class="label label-default pull-right">group</span></h3><p></p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.1.2.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.1.2"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-11.1.2.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-11.1.2.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.1.2"><td style="padding-left: 76px"><h3>11.1.2.b<span class="label label-default pull-right">group</span></h3><p>Interview responsible personnel and/or inspect</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.1.2.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.1.2"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-11.1.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-11.1.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.1"><td style="padding-left: 57px"><h3>11.1.a<span class="label label-default pull-right">group</span></h3><p>Examine policies and procedures to verify processes</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.1.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.1"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-11.1.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-11.1.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.1"><td style="padding-left: 57px"><h3>11.1.b<span class="label label-default pull-right">group</span></h3><p>Verify that the methodology is adequate to detect and</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.1.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.1"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-11.1.c" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-11.1.c" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.1"><td style="padding-left: 57px"><h3>11.1.c<span class="label label-default pull-right">group</span></h3><p>If wireless scanning is utilized, examine output from</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.1.c" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.1"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-11.1.d" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-11.1.d" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.1"><td style="padding-left: 57px"><h3>11.1.d<span class="label label-default pull-right">group</span></h3><p>If automated monitoring is utilized (for example,</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.1.d" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.1"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-11.2" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-11.2" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11."><td style="padding-left: 38px"><h3 id="xccdf_org.ssgproject.content_group_pcidss-req-11.2">11.2<span class="label label-default pull-right">group</span></h3><p>Run internal and external network</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.2" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11."><td style="padding-left: 38px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-11.2.1" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-11.2.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.2"><td style="padding-left: 57px"><h3>11.2.1<span class="label label-default pull-right">group</span></h3><p>Perform quarterly internal</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.2.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.2"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-11.2.1.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-11.2.1.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.2.1"><td style="padding-left: 76px"><h3>11.2.1.a<span class="label label-default pull-right">group</span></h3><p>Review the scan reports and verify that four</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.2.1.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.2.1"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-11.2.1.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-11.2.1.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.2.1"><td style="padding-left: 76px"><h3>11.2.1.b<span class="label label-default pull-right">group</span></h3><p>Review the scan reports and verify that the scan</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.2.1.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.2.1"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-11.2.2" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-11.2.2" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.2"><td style="padding-left: 57px"><h3>11.2.2<span class="label label-default pull-right">group</span></h3><p>Perform quarterly external</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.2.2" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.2"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-11.2.2.c" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-11.2.2.c" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.2.2"><td style="padding-left: 76px"><h3>11.2.2.c<span class="label label-default pull-right">group</span></h3><p>Review the scan reports to verify that the scans</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.2.2.c" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.2.2"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-11.2.3" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-11.2.3" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.2"><td style="padding-left: 57px"><h3>11.2.3<span class="label label-default pull-right">group</span></h3><p>Perform internal and external</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.2.3" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.2"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-11.2.3.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-11.2.3.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.2.3"><td style="padding-left: 76px"><h3>11.2.3.a<span class="label label-default pull-right">group</span></h3><p>Inspect and correlate change control</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.2.3.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.2.3"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-11.2.3.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-11.2.3.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.2.3"><td style="padding-left: 76px"><h3>11.2.3.b<span class="label label-default pull-right">group</span></h3><p>Review scan reports and verify that the scan</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.2.3.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.2.3"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-11.2.3.c" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-11.2.3.c" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.2.3"><td style="padding-left: 76px"><h3>11.2.3.c<span class="label label-default pull-right">group</span></h3><p>Validate that the scan was performed by a qualified</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.2.3.c" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.2.3"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-11.3" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-11.3" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11."><td style="padding-left: 38px"><h3 id="xccdf_org.ssgproject.content_group_pcidss-req-11.3">11.3<span class="label label-default pull-right">group</span></h3><p>Implement a methodology for</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.3" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11."><td style="padding-left: 38px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-11.3.1" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-11.3.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.3"><td style="padding-left: 57px"><h3>11.3.1<span class="label label-default pull-right">group</span></h3><p>Perform</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.3.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.3"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-11.3.1.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-11.3.1.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.3.1"><td style="padding-left: 76px"><h3>11.3.1.a<span class="label label-default pull-right">group</span></h3><p>Examine the scope of work and results from the</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.3.1.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.3.1"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-11.3.1.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-11.3.1.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.3.1"><td style="padding-left: 76px"><h3>11.3.1.b<span class="label label-default pull-right">group</span></h3><p>Verify that the test was performed by a qualified</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.3.1.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.3.1"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-11.3.2" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-11.3.2" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.3"><td style="padding-left: 57px"><h3>11.3.2<span class="label label-default pull-right">group</span></h3><p>Perform</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.3.2" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.3"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-11.3.2.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-11.3.2.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.3.2"><td style="padding-left: 76px"><h3>11.3.2.a<span class="label label-default pull-right">group</span></h3><p>Examine the scope of work and results from the</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.3.2.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.3.2"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-11.3.2.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-11.3.2.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.3.2"><td style="padding-left: 76px"><h3>11.3.2.b<span class="label label-default pull-right">group</span></h3><p>Verify that the test was performed by a qualified</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.3.2.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.3.2"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-11.3.3" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-11.3.3" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.3"><td style="padding-left: 57px"><h3>11.3.3<span class="label label-default pull-right">group</span></h3><p>Exploitable vulnerabilities found</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.3.3" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.3"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-11.3.4" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-11.3.4" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.3"><td style="padding-left: 57px"><h3>11.3.4<span class="label label-default pull-right">group</span></h3><p>If segmentation is used to isolate</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.3.4" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.3"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-11.3.4.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-11.3.4.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.3.4"><td style="padding-left: 76px"><h3>11.3.4.a<span class="label label-default pull-right">group</span></h3><p>Examine segmentation controls and review</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.3.4.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.3.4"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-11.3.4.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-11.3.4.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.3.4"><td style="padding-left: 76px"><h3>11.3.4.b<span class="label label-default pull-right">group</span></h3><p>Examine the results from the most recent</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.3.4.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.3.4"><td style="padding-left: 76px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-11.4" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-11.4" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11."><td style="padding-left: 38px"><h3 id="xccdf_org.ssgproject.content_group_pcidss-req-11.4">11.4<span class="label label-default pull-right">group</span></h3><p>Use intrusion-detection and/or</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.4" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11."><td style="padding-left: 38px"><small>contains 1 rule</small></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-11.4.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-11.4.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.4"><td style="padding-left: 57px"><h3>11.4.a<span class="label label-default pull-right">group</span></h3><p>Examine system configurations and network diagrams</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.4.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.4"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-11.4.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-11.4.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.4"><td style="padding-left: 57px"><h3>11.4.b<span class="label label-default pull-right">group</span></h3><p>Examine system configurations and interview</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.4.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.4"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-11.4.c" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-11.4.c" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.4"><td style="padding-left: 57px"><h3>11.4.c<span class="label label-default pull-right">group</span></h3><p>Examine IDS/IPS configurations and vendor</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.4.c" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.4"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_install_hids" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_install_hids" id="guide-tree-leaf-idm45561207981104" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.4"><td style="padding-left: 57px"><h4>Install Intrusion Detection Software<span class="label label-default pull-right">rule</span></h4><p>
The base Red Hat platform already includes a sophisticated auditing system that
can detect intruder activity, as well as SELinux, which provides host-based
intrusion prevention capabilities by confining privileged programs and user
sessions which may become compromised.<br>
In DoD environments, supplemental intrusion detection tools, such as, the McAfee
Host-based Security System, are available to integrate with existing infrastructure.
When these supplemental tools interfere with the proper functioning of SELinux, SELinux
takes precedence.
<br>
</p><span class="label label-primary">Rationale:</span><p>
Host-based intrusion detection tools provide a system-level defense when an
intruder gains access to a system or network.  
</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">SC-7</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">1263</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-11.4</a></p></div></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-11.5" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-11.5" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11."><td style="padding-left: 38px"><h3 id="xccdf_org.ssgproject.content_group_pcidss-req-11.5">11.5<span class="label label-default pull-right">group</span></h3><p>Deploy a change-detection</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.5" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11."><td style="padding-left: 38px"><small>contains 6 rules</small></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-11.5.1" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-11.5.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.5"><td style="padding-left: 57px"><h3>11.5.1<span class="label label-default pull-right">group</span></h3><p>Implement a process to respond to</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.5.1" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.5"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-11.5.a" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-11.5.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.5"><td style="padding-left: 57px"><h3>11.5.a<span class="label label-default pull-right">group</span></h3><p>Verify the use of a change-detection mechanism within</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.5.a" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.5"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-11.5.b" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-11.5.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.5"><td style="padding-left: 57px"><h3>11.5.b<span class="label label-default pull-right">group</span></h3><p>Verify the mechanism is configured to alert personnel</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.5.b" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.5"><td style="padding-left: 57px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_disable_prelink" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_disable_prelink" id="guide-tree-leaf-idm45561207965632" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.5"><td style="padding-left: 57px"><h4>Disable Prelinking<span class="label label-default pull-right">rule</span></h4><p>
The prelinking feature changes binaries in an attempt to decrease their startup
time.  In order to disable it, change or add the following line inside the file
<code>/etc/sysconfig/prelink</code>:
<pre>PRELINKING=no</pre>
Next, run the following command to return binaries to a normal, non-prelinked state:
<pre>$ sudo /usr/sbin/prelink -ua</pre>
</p><span class="label label-primary">Rationale:</span><p>
Because the prelinking feature changes binaries, it can interfere with the
operation of certain software and/or modes such as AIDE, FIPS, etc.
</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6(d)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">SC-28</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">SI-7</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-11.5</a></p></div><span class="label label-success">Remediation script:</span><pre><code>#
# Disable prelinking altogether
#
if grep -q ^PRELINKING /etc/sysconfig/prelink
then
  sed -i 's/PRELINKING.*/PRELINKING=no/g' /etc/sysconfig/prelink
else
  echo -e "\n# Set PRELINKING=no per security requirements" &gt;&gt; /etc/sysconfig/prelink
  echo "PRELINKING=no" &gt;&gt; /etc/sysconfig/prelink
fi

#
# Undo previous prelink changes to binaries
#
/usr/sbin/prelink -ua
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_package_aide_installed" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_package_aide_installed" id="guide-tree-leaf-idm45561207954112" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.5"><td style="padding-left: 57px"><h4>Install AIDE<span class="label label-default pull-right">rule</span></h4><p>
Install the AIDE package with the command:
<pre>$ sudo yum install aide</pre>
</p><span class="label label-primary">Rationale:</span><p>
The AIDE package must be installed if it is to be available for integrity checking.
</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-3(d)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-3(e)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6(d)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">SC-28</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">SI-7</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">1069</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-11.5</a></p></div><span class="label label-success">Remediation script:</span><pre><code>
function package_command {

# Load function arguments into local variables
local package_operation=$1
local package=$2

# Check sanity of the input
if [ $# -ne "2" ]
then
  echo "Usage: package_command 'install/uninstall' 'rpm_package_name"
  echo "Aborting."
  exit 1
fi

# If dnf is installed, use dnf; otherwise, use yum
if [ -f "/usr/bin/dnf" ] ; then
  install_util="/usr/bin/dnf"
else
  install_util="/usr/bin/yum"
fi

if [ "$package_operation" != 'remove' ] ; then
  # If the rpm is not installed, install the rpm
  if ! /bin/rpm -q --quiet $package; then
    $install_util -y $package_operation $package
  fi
else
  # If the rpm is installed, uninstall the rpm
  if /bin/rpm -q --quiet $package; then
    $install_util -y $package_operation $package
  fi
fi

}

package_command install aide
</code></pre><span class="label label-success">Remediation script:</span><pre><code>- name: Ensure aide is installed
  package:
    name="{{item}}"
    state=present
  with_items:
    - aide
</code></pre><span class="label label-success">Remediation script:</span><pre><code>include install_aide

class install_aide {
  package { 'aide':
    ensure =&gt; 'installed',
  }
}
</code></pre><span class="label label-success">Remediation script:</span><pre><code>
package -add=aide
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_aide_build_database" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_aide_build_database" id="guide-tree-leaf-idm45561207934208" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.5"><td style="padding-left: 57px"><h4>Build and Test AIDE Database<span class="label label-default pull-right">rule</span></h4><p>Run the following command to generate a new database:
<pre>$ sudo /usr/sbin/aide --init</pre>
By default, the database will be written to the file <code>/var/lib/aide/aide.db.new.gz</code>.
Storing the database, the configuration file <code>/etc/aide.conf</code>, and the binary
<code>/usr/sbin/aide</code> (or hashes of these files), in a secure location (such as on read-only media) provides additional assurance about their integrity.
The newly-generated database can be installed as follows:
<pre>$ sudo cp /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz</pre>
To initiate a manual check, run the following command:
<pre>$ sudo /usr/sbin/aide --check</pre>
If this check produces any unexpected output, investigate.
</p><span class="label label-primary">Rationale:</span><p>
For AIDE to be effective, an initial database of "known-good" information about files
must be captured and it should be able to be verified against the installed files.
</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-3(d)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-3(e)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6(d)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">SC-28</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">SI-7</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">374</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">416</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">1069</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">1263</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">1297</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">1589</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-11.5</a></p></div><span class="label label-success">Remediation script:</span><pre><code>/usr/sbin/aide --init
/bin/cp -p /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_aide_periodic_cron_checking" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_aide_periodic_cron_checking" id="guide-tree-leaf-idm45561207913984" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.5"><td style="padding-left: 57px"><h4>Configure Periodic Execution of AIDE<span class="label label-default pull-right">rule</span></h4><p>
To implement a daily execution of AIDE at 4:05am using cron, add the following line to <code>/etc/crontab</code>:
<pre>05 4 * * * root /usr/sbin/aide --check</pre>
AIDE can be executed periodically through other means; this is merely one example.
</p><span class="label label-primary">Rationale:</span><p>
By default, AIDE does not install itself for periodic execution. Periodically
running AIDE is necessary to reveal unexpected changes in installed files.
</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-3(d)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-3(e)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6(d)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">SC-28</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">SI-7</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">374</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">416</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">1069</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">1263</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">1297</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">1589</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-11.5</a></p></div><span class="label label-success">Remediation script:</span><pre><code>echo "05 4 * * * root /usr/sbin/aide --check" &gt;&gt; /etc/crontab
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_rpm_verify_permissions" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_rpm_verify_permissions" id="guide-tree-leaf-idm45561207895888" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.5"><td style="padding-left: 57px"><h4>Verify and Correct File Permissions with RPM<span class="label label-default pull-right">rule</span></h4><p>
The RPM package management system can check file access
permissions of installed software packages, including many that are
important to system security. 
After locating a file with incorrect permissions, run the following command to determine which package owns it:
<pre>$ rpm -qf <i>FILENAME</i></pre>
Next, run the following command to reset its permissions to 
the correct values:
<pre>$ sudo rpm --setperms <i>PACKAGENAME</i></pre>
</p><div class="panel panel-warning"><div class="panel-heading"><span class="label label-warning">warning</span> 
                            
              <b>Note: Due to a bug in the <code>gdm</code> package,
the RPM verify command may continue to fail even after file permissions have
been correctly set on <code>/var/log/gdm</code>. This is being tracked in Red Hat
Bugzilla #1277603.</b>
            </div></div><span class="label label-primary">Rationale:</span><p>
Permissions on system binaries and configuration files that are too generous
could allow an unauthorized user to gain privileges that they should not have.
The permissions set by the vendor should be maintained. Any deviations from
this baseline should be investigated.
</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-6</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6(d)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">SI-7</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">1493</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">1494</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">1495</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-11.5</a></p></div><span class="label label-success">Remediation script:</span><pre><code>
# Declare array to hold list of RPM packages we need to correct permissions for
declare -a SETPERMS_RPM_LIST

# Create a list of files on the system having permissions different from what
# is expected by the RPM database
FILES_WITH_INCORRECT_PERMS=($(rpm -Va --nofiledigest | grep '^.M'))

# For each file path from that list:
# * Determine the RPM package the file path is shipped by,
# * Include it into SETPERMS_RPM_LIST array

for FILE_PATH in "${FILES_WITH_INCORRECT_PERMS[@]}"
do
	RPM_PACKAGE=$(rpm -qf "$FILE_PATH")
	SETPERMS_RPM_LIST=("${SETPERMS_RPM_LIST[@]}" "$RPM_PACKAGE")
done

# Remove duplicate mention of same RPM in $SETPERMS_RPM_LIST (if any)
SETPERMS_RPM_LIST=( $(echo "${SETPERMS_RPM_LIST[@]}" | sort -n | uniq) )

# For each of the RPM packages left in the list -- reset its permissions to the
# correct values
for RPM_PACKAGE in "${SETPERMS_RPM_LIST[@]}"
do
	rpm --setperms "${RPM_PACKAGE}"
done
</code></pre><span class="label label-success">Remediation script:</span><pre><code>
- name: "Read list of files with incorrect permissions"
  shell: "rpm -Va | grep '^.M' | sed -r 's;^.*\\s+(.+);\\1;g'"
  register: files_with_incorrect_permissions
  failed_when: False
  changed_when: False

- name: "Correct file permissions with RPM"
  shell: "rpm --setperms $(rpm -qf '{{item}}')"
  with_items: "{{ files_with_incorrect_permissions.stdout_lines }}"
  when: files_with_incorrect_permissions.stdout_lines | length &gt; 0

</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_rpm_verify_hashes" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_rpm_verify_hashes" id="guide-tree-leaf-idm45561207874448" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.5"><td style="padding-left: 57px"><h4>Verify File Hashes with RPM<span class="label label-default pull-right">rule</span></h4><p>The RPM package management system can check the hashes of
installed software packages, including many that are important to system
security. Run the following command to list which files on the system
have hashes that differ from what is expected by the RPM database:
<pre>$ rpm -Va | grep '^..5'</pre>
A "c" in the second column indicates that a file is a configuration file, which
may appropriately be expected to change.  If the file was not expected to
change, investigate the cause of the change using audit logs or other means.
The package can then be reinstalled to restore the file.
Run the following command to determine which package owns the file:
<pre>$ rpm -qf <i>FILENAME</i></pre>
The package can be reinstalled from a yum repository using the command:
<pre>$ sudo yum reinstall <i>PACKAGENAME</i></pre>
Alternatively, the package can be reinstalled from trusted media using the command:
<pre>$ sudo rpm -Uvh <i>PACKAGENAME</i></pre> 
</p><span class="label label-primary">Rationale:</span><p>
The hashes of important files like system executables should match the
information given by the RPM database. Executables with erroneous hashes could
be a sign of nefarious activity on the system.</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6(d)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">SI-7</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">1496</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-11.5</a></p></div><span class="label label-success">Remediation script:</span><pre><code>
- name: "Set fact: Package manager reinstall command (dnf)"
  set_fact:
    package_manager_reinstall_cmd: dnf reinstall -y
  when: ansible_distribution == "Fedora"

- name: "Set fact: Package manager reinstall command (yum)"
  set_fact:
    package_manager_reinstall_cmd: yum reinstall -y
  when: ansible_distribution == "RedHat"

- name: "Read files with incorrect hash"
  shell: "rpm -Va | grep -E '^..5.* /(bin|sbin|lib|lib64|usr)/' | sed -r 's;^.*\\s+(.+);\\1;g'"
  register: files_with_incorrect_hash
  changed_when: False
  when: package_manager_reinstall_cmd is defined

- name: "Reinstall packages of files with incorrect hash"
  shell: "{{package_manager_reinstall_cmd}} $(rpm -qf '{{item}}')"
  with_items: "{{ files_with_incorrect_hash.stdout_lines }}"
  when: package_manager_reinstall_cmd is defined and (files_with_incorrect_hash.stdout_lines | length &gt; 0)
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_pcidss-req-11.6" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_pcidss-req-11.6" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11."><td style="padding-left: 38px"><h3 id="xccdf_org.ssgproject.content_group_pcidss-req-11.6">11.6<span class="label label-default pull-right">group</span></h3><p>Ensure that security policies and</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11.6" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_pcidss-req-11."><td style="padding-left: 38px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_values" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_values" data-tt-parent-id="children-xccdf_org.ssgproject.content_benchmark_PCIDSS-RHEL-6"><td style="padding-left: 19px"><h3 id="xccdf_org.ssgproject.content_group_values">Values<span class="label label-default pull-right">group</span></h3><p>Group of values used in PCI-DSS profile</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_values" data-tt-parent-id="children-xccdf_org.ssgproject.content_benchmark_PCIDSS-RHEL-6"><td style="padding-left: 19px"></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_group_non-pci-dss" class="guide-tree-inner-node guide-tree-inner-node-id-xccdf_org.ssgproject.content_group_non-pci-dss" data-tt-parent-id="children-xccdf_org.ssgproject.content_benchmark_PCIDSS-RHEL-6"><td style="padding-left: 19px"><h3 id="xccdf_org.ssgproject.content_group_non-pci-dss">Non PCI-DSS<span class="label label-default pull-right">group</span></h3><p>Rules that are not part of PCI-DSS</p></td></tr><tr data-tt-id="children-xccdf_org.ssgproject.content_group_non-pci-dss" data-tt-parent-id="children-xccdf_org.ssgproject.content_benchmark_PCIDSS-RHEL-6"><td style="padding-left: 19px"><small>contains 3 rules</small></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_accounts_passwords_pam_faillock_unlock_time" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_accounts_passwords_pam_faillock_unlock_time" id="guide-tree-leaf-idm45561206265536" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_non-pci-dss"><td style="padding-left: 38px"><h4>Set Lockout Time For Failed Password Attempts<span class="label label-default pull-right">rule</span></h4><p>
To configure the system to lock out accounts after a number of incorrect login
attempts and require an administrator to unlock the account using <code>pam_faillock.so</code>,
modify the content of both <code>/etc/pam.d/system-auth</code> and <code>/etc/pam.d/password-auth</code> as follows:
<br><br>
<ul><li> Add the following line immediately <code>before</code> the <code>pam_unix.so</code> statement in the <code>AUTH</code> section:
<pre>auth required pam_faillock.so preauth silent deny=<abbr title="from Profile/refine-value: xccdf_org.ssgproject.content_value_var_accounts_passwords_pam_faillock_deny">6</abbr> unlock_time=<abbr title="from Profile/refine-value: xccdf_org.ssgproject.content_value_var_accounts_passwords_pam_faillock_unlock_time">1800</abbr> fail_interval=<abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_var_accounts_passwords_pam_faillock_fail_interval">900</abbr></pre></li><li> Add the following line immediately <code>after</code> the <code>pam_unix.so</code> statement in the <code>AUTH</code> section:
<pre>auth [default=die] pam_faillock.so authfail deny=<abbr title="from Profile/refine-value: xccdf_org.ssgproject.content_value_var_accounts_passwords_pam_faillock_deny">6</abbr> unlock_time=<abbr title="from Profile/refine-value: xccdf_org.ssgproject.content_value_var_accounts_passwords_pam_faillock_unlock_time">1800</abbr> fail_interval=<abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_var_accounts_passwords_pam_faillock_fail_interval">900</abbr></pre></li><li> Add the following line immediately <code>before</code> the <code>pam_unix.so</code> statement in the <code>ACCOUNT</code> section:
<pre>account required pam_faillock.so</pre></li></ul>
</p><span class="label label-primary">Rationale:</span><p>
Locking out user accounts after a number of incorrect attempts
prevents direct password guessing attacks.  Ensuring that an administrator is
involved in unlocking locked accounts draws appropriate attention to such
situations.
</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-7(b)</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">47</a>, <a href="">Req-8.1.7</a></p></div><span class="label label-success">Remediation script:</span><pre><code>
var_accounts_passwords_pam_faillock_unlock_time="<abbr title="from Profile/refine-value: xccdf_org.ssgproject.content_value_var_accounts_passwords_pam_faillock_unlock_time">1800</abbr>"

AUTH_FILES[0]="/etc/pam.d/system-auth"
AUTH_FILES[1]="/etc/pam.d/password-auth"

for pamFile in "${AUTH_FILES[@]}"
do
	
	# pam_faillock.so already present?
	if grep -q "^auth.*pam_faillock.so.*" $pamFile; then

		# pam_faillock.so present, unlock_time directive present?
		if grep -q "^auth.*[default=die].*pam_faillock.so.*authfail.*unlock_time=" $pamFile; then

			# both pam_faillock.so &amp; unlock_time present, just correct unlock_time directive value
			sed -i --follow-symlinks "s/\(^auth.*required.*pam_faillock.so.*preauth.*silent.*\)\(unlock_time *= *\).*/\1\2$var_accounts_passwords_pam_faillock_unlock_time/" $pamFile
			sed -i --follow-symlinks "s/\(^auth.*[default=die].*pam_faillock.so.*authfail.*\)\(unlock_time *= *\).*/\1\2$var_accounts_passwords_pam_faillock_unlock_time/" $pamFile

		# pam_faillock.so present, but unlock_time directive not yet
		else

			# append correct unlock_time value to appropriate places
			sed -i --follow-symlinks "/^auth.*required.*pam_faillock.so.*preauth.*silent.*/ s/$/ unlock_time=$var_accounts_passwords_pam_faillock_unlock_time/" $pamFile
			sed -i --follow-symlinks "/^auth.*[default=die].*pam_faillock.so.*authfail.*/ s/$/ unlock_time=$var_accounts_passwords_pam_faillock_unlock_time/" $pamFile
		fi

	# pam_faillock.so not present yet
	else

		# insert pam_faillock.so preauth &amp; authfail rows with proper value of the 'unlock_time' option
		sed -i --follow-symlinks "/^auth.*sufficient.*pam_unix.so.*/i auth        required      pam_faillock.so preauth silent unlock_time=$var_accounts_passwords_pam_faillock_unlock_time" $pamFile
		sed -i --follow-symlinks "/^auth.*sufficient.*pam_unix.so.*/a auth        [default=die] pam_faillock.so authfail unlock_time=$var_accounts_passwords_pam_faillock_unlock_time" $pamFile
		sed -i --follow-symlinks "/^account.*required.*pam_unix.so/i account     required      pam_faillock.so" $pamFile
	fi
done
</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_service_auditd_enabled" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_service_auditd_enabled" id="guide-tree-leaf-idm45561205251968" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_non-pci-dss"><td style="padding-left: 38px"><h4>Enable auditd Service<span class="label label-default pull-right">rule</span></h4><p>The <code>auditd</code> service is an essential userspace component of
the Linux Auditing System, as it is responsible for writing audit records to
disk.

        The <code>auditd</code> service can be enabled with the following command:
        <pre>$ sudo chkconfig --level 2345 auditd on</pre>
</p><span class="label label-primary">Rationale:</span><p>Ensuring the <code>auditd</code> service is active ensures 
audit records generated by the kernel can be written to disk, or that appropriate
actions will be taken if other obstacles exist.
</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-17(1)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-1(b)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-10</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12(a)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IR-5</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">347</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">157</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">172</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">880</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">1353</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">1462</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">1487</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">1115</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">1454</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">067</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">158</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">831</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">1190</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">1312</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">1263</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">130</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">120</a>, <a href="http://iase.disa.mil/stigs/cci/Pages/index.aspx">1589</a>, <a href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-1.pdf">Req-10</a></p></div><span class="label label-success">Remediation script:</span><pre><code>
function service_command {

# Load function arguments into local variables
local service_state=$1
local service=$2
local xinetd=$(echo $3 | cut -d'=' -f2)

# Check sanity of the input
if [ $# -lt "2" ]
then
  echo "Usage: service_command 'enable/disable' 'service_name.service'"
  echo
  echo "To enable or disable xinetd services add \'xinetd=service_name\'"
  echo "as the last argument"
  echo "Aborting."
  exit 1
fi

# If systemctl is installed, use systemctl command; otherwise, use the service/chkconfig commands
if [ -f "/usr/bin/systemctl" ] ; then
  service_util="/usr/bin/systemctl"
else
  service_util="/sbin/service"
  chkconfig_util="/sbin/chkconfig"
fi

# If disable is not specified in arg1, set variables to enable services.
# Otherwise, variables are to be set to disable services.
if [ "$service_state" != 'disable' ] ; then
  service_state="enable"
  service_operation="start"
  chkconfig_state="on"
else
  service_state="disable"
  service_operation="stop"
  chkconfig_state="off"
fi

# If chkconfig_util is not empty, use chkconfig/service commands.
if ! [ "x$chkconfig_util" = x ] ; then
  $service_util $service $service_operation
  $chkconfig_util --level 0123456 $service $chkconfig_state
else
  $service_util $service_operation $service
  $service_util $service_state $service
fi

# Test if local variable xinetd is empty using non-bashism.
# If empty, then xinetd is not being used.
if ! [ "x$xinetd" = x ] ; then
  grep -qi disable /etc/xinetd.d/$xinetd &amp;&amp; \

  if ! [ "$service_operation" != 'disable' ] ; then
    sed -i "s/disable.*/disable         = no/gI" /etc/xinetd.d/$xinetd
  else
    sed -i "s/disable.*/disable         = yes/gI" /etc/xinetd.d/$xinetd
  fi
fi

}

service_command enable auditd
</code></pre><span class="label label-success">Remediation script:</span><pre><code>- name: Enable service auditd
  service:
    name="{{item}}"
    enabled="yes"
    state="started"
  with_items:
    - auditd

</code></pre></td></tr><tr data-tt-id="xccdf_org.ssgproject.content_rule_audit_rules_login_events" class="guide-tree-leaf guide-tree-leaf-id-xccdf_org.ssgproject.content_rule_audit_rules_login_events" id="guide-tree-leaf-idm45561205204368" data-tt-parent-id="children-xccdf_org.ssgproject.content_group_non-pci-dss"><td style="padding-left: 38px"><h4>Record Attempts to Alter Login and Logout Events<span class="label label-default pull-right">rule</span></h4><p>
The audit system already collects login info for all users and root. To watch for attempted manual edits of
files involved in storing login events, add the following to <code>/etc/audit/audit.rules</code>:
<pre>-w /var/log/tallylog -p wa -k logins
-w /var/run/faillock/ -p wa -k logins
-w /var/log/lastlog -p wa -k logins</pre>
</p><span class="label label-primary">Rationale:</span><p>Manual editing of these files may indicate nefarious activity, such
as an attacker attempting to remove evidence of an intrusion.</p><div class="identifiers"><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">references:</span> 
            <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-3(10)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-1(b)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12(a)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12(c)</a>, <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IR-5</a></p></div><span class="label label-success">Remediation script:</span><pre><code>

# Perform the remediation

function fix_audit_watch_rule {

# Load function arguments into local variables
local tool="$1"
local path="$2"
local required_access_bits="$3"
local key="$4"

# Check sanity of the input
if [ $# -ne "4" ]
then
        echo "Usage: fix_audit_watch_rule 'tool' 'path' 'bits' 'key'"
        echo "Aborting."
        exit 1
fi

# Create a list of audit *.rules files that should be inspected for presence and correctness
# of a particular audit rule. The scheme is as follows:
#
# -----------------------------------------------------------------------------------------
# Tool used to load audit rules | Rule already defined  |  Audit rules file to inspect    |
# -----------------------------------------------------------------------------------------
#       auditctl                |     Doesn't matter    |  /etc/audit/audit.rules         |
# -----------------------------------------------------------------------------------------
#       augenrules              |          Yes          |  /etc/audit/rules.d/*.rules     |
#       augenrules              |          No           |  /etc/audit/rules.d/$key.rules  |
# -----------------------------------------------------------------------------------------
declare -a files_to_inspect

# Check sanity of the specified audit tool
if [ "$tool" != 'auditctl' ] &amp;&amp; [ "$tool" != 'augenrules' ]
then
        echo "Unknown audit rules loading tool: $1. Aborting."
        echo "Use either 'auditctl' or 'augenrules'!"
        exit 1
# If the audit tool is 'auditctl', then add '/etc/audit/audit.rules'
# into the list of files to be inspected
elif [ "$tool" == 'auditctl' ]
then
        files_to_inspect=("${files_to_inspect[@]}" '/etc/audit/audit.rules')
# If the audit is 'augenrules', then check if rule is already defined
# If rule is defined, add '/etc/audit/rules.d/*.rules' to list of files for inspection.
# If rule isn't defined, add '/etc/audit/rules.d/$key.rules' to list of files for inspection.
elif [ "$tool" == 'augenrules' ]
then
        # Case when particular audit rule is already defined in some of /etc/audit/rules.d/*.rules file
        # Get pair -- filepath : matching_row into @matches array
        IFS=$'\n' matches=($(grep -P "[\s]*-w[\s]+$path" /etc/audit/rules.d/*.rules))
        # Reset IFS back to default
        unset $IFS
        # For each of the matched entries
        for match in "${matches[@]}"
        do
                # Extract filepath from the match
                rulesd_audit_file=$(echo $match | cut -f1 -d ':')
                # Append that path into list of files for inspection
                files_to_inspect=("${files_to_inspect[@]}" "$rulesd_audit_file")
        done
        # Case when particular audit rule isn't defined yet
        if [ ${#files_to_inspect[@]} -eq "0" ]
        then
                # Append '/etc/audit/rules.d/$key.rules' into list of files for inspection
                files_to_inspect="/etc/audit/rules.d/$key.rules"
                # If the $key.rules file doesn't exist yet, create it with correct permissions
                if [ ! -e "$files_to_inspect" ]
                then
                        touch "$files_to_inspect"
                        chmod 0640 "$files_to_inspect"
                fi
        fi
fi

# Finally perform the inspection and possible subsequent audit rule
# correction for each of the files previously identified for inspection
for audit_rules_file in "${files_to_inspect[@]}"
do

        # Check if audit watch file system object rule for given path already present
        if grep -q -P -- "[\s]*-w[\s]+$path" "$audit_rules_file"
        then
                # Rule is found =&gt; verify yet if existing rule definition contains
                # all of the required access type bits

                # Escape slashes in path for use in sed pattern below
                local esc_path=${path//$'/'/$'\/'}
                # Define BRE whitespace class shortcut
                local sp="[[:space:]]"
                # Extract current permission access types (e.g. -p [r|w|x|a] values) from audit rule
                current_access_bits=$(sed -ne "s/$sp*-w$sp\+$esc_path$sp\+-p$sp\+\([rxwa]\{1,4\}\).*/\1/p" "$audit_rules_file")
                # Split required access bits string into characters array
                # (to check bit's presence for one bit at a time)
                for access_bit in $(echo "$required_access_bits" | grep -o .)
                do
                        # For each from the required access bits (e.g. 'w', 'a') check
                        # if they are already present in current access bits for rule.
                        # If not, append that bit at the end
                        if ! grep -q "$access_bit" &lt;&lt;&lt; "$current_access_bits"
                        then
                                # Concatenate the existing mask with the missing bit
                                current_access_bits="$current_access_bits$access_bit"
                        fi
                done
                # Propagate the updated rule's access bits (original + the required
                # ones) back into the /etc/audit/audit.rules file for that rule
                sed -i "s/\($sp*-w$sp\+$esc_path$sp\+-p$sp\+\)\([rxwa]\{1,4\}\)\(.*\)/\1$current_access_bits\3/" "$audit_rules_file"
        else
                # Rule isn't present yet. Append it at the end of $audit_rules_file file
                # with proper key

                echo "-w $path -p $required_access_bits -k $key" &gt;&gt; "$audit_rules_file"
        fi
done
}

fix_audit_watch_rule "auditctl" "/var/log/tallylog" "wa" "logins"
fix_audit_watch_rule "auditctl" "/var/run/faillock/" "wa" "logins"

function fix_audit_watch_rule {

# Load function arguments into local variables
local tool="$1"
local path="$2"
local required_access_bits="$3"
local key="$4"

# Check sanity of the input
if [ $# -ne "4" ]
then
        echo "Usage: fix_audit_watch_rule 'tool' 'path' 'bits' 'key'"
        echo "Aborting."
        exit 1
fi

# Create a list of audit *.rules files that should be inspected for presence and correctness
# of a particular audit rule. The scheme is as follows:
#
# -----------------------------------------------------------------------------------------
# Tool used to load audit rules | Rule already defined  |  Audit rules file to inspect    |
# -----------------------------------------------------------------------------------------
#       auditctl                |     Doesn't matter    |  /etc/audit/audit.rules         |
# -----------------------------------------------------------------------------------------
#       augenrules              |          Yes          |  /etc/audit/rules.d/*.rules     |
#       augenrules              |          No           |  /etc/audit/rules.d/$key.rules  |
# -----------------------------------------------------------------------------------------
declare -a files_to_inspect

# Check sanity of the specified audit tool
if [ "$tool" != 'auditctl' ] &amp;&amp; [ "$tool" != 'augenrules' ]
then
        echo "Unknown audit rules loading tool: $1. Aborting."
        echo "Use either 'auditctl' or 'augenrules'!"
        exit 1
# If the audit tool is 'auditctl', then add '/etc/audit/audit.rules'
# into the list of files to be inspected
elif [ "$tool" == 'auditctl' ]
then
        files_to_inspect=("${files_to_inspect[@]}" '/etc/audit/audit.rules')
# If the audit is 'augenrules', then check if rule is already defined
# If rule is defined, add '/etc/audit/rules.d/*.rules' to list of files for inspection.
# If rule isn't defined, add '/etc/audit/rules.d/$key.rules' to list of files for inspection.
elif [ "$tool" == 'augenrules' ]
then
        # Case when particular audit rule is already defined in some of /etc/audit/rules.d/*.rules file
        # Get pair -- filepath : matching_row into @matches array
        IFS=$'\n' matches=($(grep -P "[\s]*-w[\s]+$path" /etc/audit/rules.d/*.rules))
        # Reset IFS back to default
        unset $IFS
        # For each of the matched entries
        for match in "${matches[@]}"
        do
                # Extract filepath from the match
                rulesd_audit_file=$(echo $match | cut -f1 -d ':')
                # Append that path into list of files for inspection
                files_to_inspect=("${files_to_inspect[@]}" "$rulesd_audit_file")
        done
        # Case when particular audit rule isn't defined yet
        if [ ${#files_to_inspect[@]} -eq "0" ]
        then
                # Append '/etc/audit/rules.d/$key.rules' into list of files for inspection
                files_to_inspect="/etc/audit/rules.d/$key.rules"
                # If the $key.rules file doesn't exist yet, create it with correct permissions
                if [ ! -e "$files_to_inspect" ]
                then
                        touch "$files_to_inspect"
                        chmod 0640 "$files_to_inspect"
                fi
        fi
fi

# Finally perform the inspection and possible subsequent audit rule
# correction for each of the files previously identified for inspection
for audit_rules_file in "${files_to_inspect[@]}"
do

        # Check if audit watch file system object rule for given path already present
        if grep -q -P -- "[\s]*-w[\s]+$path" "$audit_rules_file"
        then
                # Rule is found =&gt; verify yet if existing rule definition contains
                # all of the required access type bits

                # Escape slashes in path for use in sed pattern below
                local esc_path=${path//$'/'/$'\/'}
                # Define BRE whitespace class shortcut
                local sp="[[:space:]]"
                # Extract current permission access types (e.g. -p [r|w|x|a] values) from audit rule
                current_access_bits=$(sed -ne "s/$sp*-w$sp\+$esc_path$sp\+-p$sp\+\([rxwa]\{1,4\}\).*/\1/p" "$audit_rules_file")
                # Split required access bits string into characters array
                # (to check bit's presence for one bit at a time)
                for access_bit in $(echo "$required_access_bits" | grep -o .)
                do
                        # For each from the required access bits (e.g. 'w', 'a') check
                        # if they are already present in current access bits for rule.
                        # If not, append that bit at the end
                        if ! grep -q "$access_bit" &lt;&lt;&lt; "$current_access_bits"
                        then
                                # Concatenate the existing mask with the missing bit
                                current_access_bits="$current_access_bits$access_bit"
                        fi
                done
                # Propagate the updated rule's access bits (original + the required
                # ones) back into the /etc/audit/audit.rules file for that rule
                sed -i "s/\($sp*-w$sp\+$esc_path$sp\+-p$sp\+\)\([rxwa]\{1,4\}\)\(.*\)/\1$current_access_bits\3/" "$audit_rules_file"
        else
                # Rule isn't present yet. Append it at the end of $audit_rules_file file
                # with proper key

                echo "-w $path -p $required_access_bits -k $key" &gt;&gt; "$audit_rules_file"
        fi
done
}

fix_audit_watch_rule "auditctl" "/var/log/lastlog" "wa" "logins"
</code></pre></td></tr></tbody></table></div><div id="rear-matter"><div class="row top-spacer-10"><div class="col-md-12 well well-lg"><div class="rear-matter">Red Hat and Red Hat Enterprise Linux are either registered
trademarks or trademarks of Red Hat, Inc. in the United States and other
countries. All other names are registered trademarks or trademarks of their
respective companies.</div></div></div></div></div></div><footer id="footer"><div class="container"><p class="muted credit">
                Generated using <a href="http://open-scap.org">OpenSCAP</a> 1.2.10</p></div></footer></body></html>
